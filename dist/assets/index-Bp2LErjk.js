var oc=t=>{throw TypeError(t)};var si=(t,s,r)=>s.has(t)||oc("Cannot "+r);var q=(t,s,r)=>(si(t,s,"read from private field"),r?r.call(t):s.get(t)),Fe=(t,s,r)=>s.has(t)?oc("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),Ae=(t,s,r,n)=>(si(t,s,"write to private field"),n?n.call(t,r):s.set(t,r),r),wt=(t,s,r)=>(si(t,s,"access private method"),r);var Ta=(t,s,r,n)=>({set _(a){Ae(t,s,a,r)},get _(){return q(t,s,n)}});import{r as Ad,a as nl,b as Ed}from"./react-vendor-sT__QgY4.js";import{s as J,l as Tr,a as ic,i as xo,g as Tx,b as Td,c as Mx,d as lc,e as kx,u as Rx,f as Ix,r as Fx,h as Lx,j as Ox,k as Ux,m as $x,n as Gx,o as Bx,p as Md,q as Vx,t as Wx,v as zx,w as Hx}from"./sales-l66_TeIE.js";import"./supabase-Cmt-ljYz.js";function qx(t,s){for(var r=0;r<s.length;r++){const n=s[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const o=Object.getOwnPropertyDescriptor(n,a);o&&Object.defineProperty(t,a,o.get?o:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var ri={exports:{}},Rn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cc;function Yx(){if(cc)return Rn;cc=1;var t=Ad(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(c,d,m){var h,u={},f=null,b=null;m!==void 0&&(f=""+m),d.key!==void 0&&(f=""+d.key),d.ref!==void 0&&(b=d.ref);for(h in d)n.call(d,h)&&!o.hasOwnProperty(h)&&(u[h]=d[h]);if(c&&c.defaultProps)for(h in d=c.defaultProps,d)u[h]===void 0&&(u[h]=d[h]);return{$$typeof:s,type:c,key:f,ref:b,props:u,_owner:a.current}}return Rn.Fragment=r,Rn.jsx=i,Rn.jsxs=i,Rn}var dc;function Kx(){return dc||(dc=1,ri.exports=Yx()),ri.exports}var e=Kx(),l=Ad();const Gs=nl(l),al=qx({__proto__:null,default:Gs},[l]);var Ma={},uc;function Jx(){if(uc)return Ma;uc=1;var t=Ed();return Ma.createRoot=t.createRoot,Ma.hydrateRoot=t.hydrateRoot,Ma}var Qx=Jx();const Xx=nl(Qx);var jn=Ed();const Zx=nl(jn);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jn(){return Jn=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jn.apply(this,arguments)}var mr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(mr||(mr={}));const mc="popstate";function ep(t){t===void 0&&(t={});function s(n,a){let{pathname:o,search:i,hash:c}=n.location;return Ei("",{pathname:o,search:i,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Xa(a)}return sp(s,r,null,t)}function lt(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function kd(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function tp(){return Math.random().toString(36).substr(2,8)}function hc(t,s){return{usr:t.state,key:t.key,idx:s}}function Ei(t,s,r,n){return r===void 0&&(r=null),Jn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?wn(s):s,{state:r,key:s&&s.key||n||tp()})}function Xa(t){let{pathname:s="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(s+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function wn(t){let s={};if(t){let r=t.indexOf("#");r>=0&&(s.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(s.search=t.substr(n),t=t.substr(0,n)),t&&(s.pathname=t)}return s}function sp(t,s,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:o=!1}=n,i=a.history,c=mr.Pop,d=null,m=h();m==null&&(m=0,i.replaceState(Jn({},i.state,{idx:m}),""));function h(){return(i.state||{idx:null}).idx}function u(){c=mr.Pop;let v=h(),y=v==null?null:v-m;m=v,d&&d({action:c,location:x.location,delta:y})}function f(v,y){c=mr.Push;let j=Ei(x.location,v,y);m=h()+1;let N=hc(j,m),g=x.createHref(j);try{i.pushState(N,"",g)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;a.location.assign(g)}o&&d&&d({action:c,location:x.location,delta:1})}function b(v,y){c=mr.Replace;let j=Ei(x.location,v,y);m=h();let N=hc(j,m),g=x.createHref(j);i.replaceState(N,"",g),o&&d&&d({action:c,location:x.location,delta:0})}function p(v){let y=a.location.origin!=="null"?a.location.origin:a.location.href,j=typeof v=="string"?v:Xa(v);return j=j.replace(/ $/,"%20"),lt(y,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,y)}let x={get action(){return c},get location(){return t(a,i)},listen(v){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(mc,u),d=v,()=>{a.removeEventListener(mc,u),d=null}},createHref(v){return s(a,v)},createURL:p,encodeLocation(v){let y=p(v);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:b,go(v){return i.go(v)}};return x}var fc;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(fc||(fc={}));function rp(t,s,r){return r===void 0&&(r="/"),np(t,s,r)}function np(t,s,r,n){let a=typeof s=="string"?wn(s):s,o=ol(a.pathname||"/",r);if(o==null)return null;let i=Rd(t);ap(i);let c=null;for(let d=0;c==null&&d<i.length;++d){let m=gp(o);c=fp(i[d],m)}return c}function Rd(t,s,r,n){s===void 0&&(s=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(o,i,c)=>{let d={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};d.relativePath.startsWith("/")&&(lt(d.relativePath.startsWith(n),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(n.length));let m=hr([n,d.relativePath]),h=r.concat(d);o.children&&o.children.length>0&&(lt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),Rd(o.children,s,h,m)),!(o.path==null&&!o.index)&&s.push({path:m,score:mp(m,o.index),routesMeta:h})};return t.forEach((o,i)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,i);else for(let d of Id(o.path))a(o,i,d)}),s}function Id(t){let s=t.split("/");if(s.length===0)return[];let[r,...n]=s,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let i=Id(n.join("/")),c=[];return c.push(...i.map(d=>d===""?o:[o,d].join("/"))),a&&c.push(...i),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function ap(t){t.sort((s,r)=>s.score!==r.score?r.score-s.score:hp(s.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const op=/^:[\w-]+$/,ip=3,lp=2,cp=1,dp=10,up=-2,xc=t=>t==="*";function mp(t,s){let r=t.split("/"),n=r.length;return r.some(xc)&&(n+=up),s&&(n+=lp),r.filter(a=>!xc(a)).reduce((a,o)=>a+(op.test(o)?ip:o===""?cp:dp),n)}function hp(t,s){return t.length===s.length&&t.slice(0,-1).every((n,a)=>n===s[a])?t[t.length-1]-s[s.length-1]:0}function fp(t,s,r){let{routesMeta:n}=t,a={},o="/",i=[];for(let c=0;c<n.length;++c){let d=n[c],m=c===n.length-1,h=o==="/"?s:s.slice(o.length)||"/",u=xp({path:d.relativePath,caseSensitive:d.caseSensitive,end:m},h),f=d.route;if(!u)return null;Object.assign(a,u.params),i.push({params:a,pathname:hr([o,u.pathname]),pathnameBase:jp(hr([o,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(o=hr([o,u.pathnameBase]))}return i}function xp(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=pp(t.path,t.caseSensitive,t.end),a=s.match(r);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:n.reduce((m,h,u)=>{let{paramName:f,isOptional:b}=h;if(f==="*"){let x=c[u]||"";i=o.slice(0,o.length-x.length).replace(/(.)\/+$/,"$1")}const p=c[u];return b&&!p?m[f]=void 0:m[f]=(p||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:i,pattern:t}}function pp(t,s,r){s===void 0&&(s=!1),r===void 0&&(r=!0),kd(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,c,d)=>(n.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,s?void 0:"i"),n]}function gp(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return kd(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function ol(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let r=s.endsWith("/")?s.length-1:s.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function vp(t,s){s===void 0&&(s="/");let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?wn(t):t;return{pathname:r?r.startsWith("/")?r:bp(r,s):s,search:wp(n),hash:Np(a)}}function bp(t,s){let r=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ni(t,s,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yp(t){return t.filter((s,r)=>r===0||s.route.path&&s.route.path.length>0)}function il(t,s){let r=yp(t);return s?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ll(t,s,r,n){n===void 0&&(n=!1);let a;typeof t=="string"?a=wn(t):(a=Jn({},t),lt(!a.pathname||!a.pathname.includes("?"),ni("?","pathname","search",a)),lt(!a.pathname||!a.pathname.includes("#"),ni("#","pathname","hash",a)),lt(!a.search||!a.search.includes("#"),ni("#","search","hash",a)));let o=t===""||a.pathname==="",i=o?"/":a.pathname,c;if(i==null)c=r;else{let u=s.length-1;if(!n&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),u-=1;a.pathname=f.join("/")}c=u>=0?s[u]:"/"}let d=vp(a,c),m=i&&i!=="/"&&i.endsWith("/"),h=(o||i===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(m||h)&&(d.pathname+="/"),d}const hr=t=>t.join("/").replace(/\/\/+/g,"/"),jp=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wp=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Np=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Sp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Fd=["post","put","patch","delete"];new Set(Fd);const Cp=["get",...Fd];new Set(Cp);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qn(){return Qn=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qn.apply(this,arguments)}const cl=l.createContext(null),Pp=l.createContext(null),wr=l.createContext(null),fa=l.createContext(null),Ds=l.createContext({outlet:null,matches:[],isDataRoute:!1}),Ld=l.createContext(null);function _p(t,s){let{relative:r}=s===void 0?{}:s;Nn()||lt(!1);let{basename:n,navigator:a}=l.useContext(wr),{hash:o,pathname:i,search:c}=Ud(t,{relative:r}),d=i;return n!=="/"&&(d=i==="/"?n:hr([n,i])),a.createHref({pathname:d,search:c,hash:o})}function Nn(){return l.useContext(fa)!=null}function St(){return Nn()||lt(!1),l.useContext(fa).location}function Dp(){return l.useContext(fa).navigationType}function Od(t){l.useContext(wr).static||l.useLayoutEffect(t)}function yt(){let{isDataRoute:t}=l.useContext(Ds);return t?Wp():Ap()}function Ap(){Nn()||lt(!1);let t=l.useContext(cl),{basename:s,future:r,navigator:n}=l.useContext(wr),{matches:a}=l.useContext(Ds),{pathname:o}=St(),i=JSON.stringify(il(a,r.v7_relativeSplatPath)),c=l.useRef(!1);return Od(()=>{c.current=!0}),l.useCallback(function(m,h){if(h===void 0&&(h={}),!c.current)return;if(typeof m=="number"){n.go(m);return}let u=ll(m,JSON.parse(i),o,h.relative==="path");t==null&&s!=="/"&&(u.pathname=u.pathname==="/"?s:hr([s,u.pathname])),(h.replace?n.replace:n.push)(u,h.state,h)},[s,n,i,o,t])}const Ep=l.createContext(null);function Tp(t){let s=l.useContext(Ds).outlet;return s&&l.createElement(Ep.Provider,{value:t},s)}function Mp(){let{matches:t}=l.useContext(Ds),s=t[t.length-1];return s?s.params:{}}function Ud(t,s){let{relative:r}=s===void 0?{}:s,{future:n}=l.useContext(wr),{matches:a}=l.useContext(Ds),{pathname:o}=St(),i=JSON.stringify(il(a,n.v7_relativeSplatPath));return l.useMemo(()=>ll(t,JSON.parse(i),o,r==="path"),[t,i,o,r])}function kp(t,s){return Rp(t,s)}function Rp(t,s,r,n){Nn()||lt(!1);let{navigator:a,static:o}=l.useContext(wr),{matches:i}=l.useContext(Ds),c=i[i.length-1],d=c?c.params:{};c&&c.pathname;let m=c?c.pathnameBase:"/";c&&c.route;let h=St(),u;if(s){var f;let y=typeof s=="string"?wn(s):s;m==="/"||(f=y.pathname)!=null&&f.startsWith(m)||lt(!1),u=y}else u=h;let b=u.pathname||"/",p=b;if(m!=="/"){let y=m.replace(/^\//,"").split("/");p="/"+b.replace(/^\//,"").split("/").slice(y.length).join("/")}let x=rp(t,{pathname:p}),v=Up(x&&x.map(y=>Object.assign({},y,{params:Object.assign({},d,y.params),pathname:hr([m,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?m:hr([m,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return s&&v?l.createElement(fa.Provider,{value:{location:Qn({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:mr.Pop}},v):v}function Ip(){let t=Vp(),s=Sp(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return l.createElement(l.Fragment,null,l.createElement("h2",null,"Unexpected Application Error!"),l.createElement("h3",{style:{fontStyle:"italic"}},s),r?l.createElement("pre",{style:a},r):null,null)}const Fp=l.createElement(Ip,null);class Lp extends l.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,r){return r.location!==s.location||r.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:r.error,location:r.location,revalidation:s.revalidation||r.revalidation}}componentDidCatch(s,r){console.error("React Router caught the following error during render",s,r)}render(){return this.state.error!==void 0?l.createElement(Ds.Provider,{value:this.props.routeContext},l.createElement(Ld.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Op(t){let{routeContext:s,match:r,children:n}=t,a=l.useContext(cl);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),l.createElement(Ds.Provider,{value:s},n)}function Up(t,s,r,n){var a;if(s===void 0&&(s=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var o;if(!r)return null;if(r.errors)t=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&s.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,c=(a=r)==null?void 0:a.errors;if(c!=null){let h=i.findIndex(u=>u.route.id&&(c==null?void 0:c[u.route.id])!==void 0);h>=0||lt(!1),i=i.slice(0,Math.min(i.length,h+1))}let d=!1,m=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<i.length;h++){let u=i[h];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(m=h),u.route.id){let{loaderData:f,errors:b}=r,p=u.route.loader&&f[u.route.id]===void 0&&(!b||b[u.route.id]===void 0);if(u.route.lazy||p){d=!0,m>=0?i=i.slice(0,m+1):i=[i[0]];break}}}return i.reduceRight((h,u,f)=>{let b,p=!1,x=null,v=null;r&&(b=c&&u.route.id?c[u.route.id]:void 0,x=u.route.errorElement||Fp,d&&(m<0&&f===0?(zp("route-fallback"),p=!0,v=null):m===f&&(p=!0,v=u.route.hydrateFallbackElement||null)));let y=s.concat(i.slice(0,f+1)),j=()=>{let N;return b?N=x:p?N=v:u.route.Component?N=l.createElement(u.route.Component,null):u.route.element?N=u.route.element:N=h,l.createElement(Op,{match:u,routeContext:{outlet:h,matches:y,isDataRoute:r!=null},children:N})};return r&&(u.route.ErrorBoundary||u.route.errorElement||f===0)?l.createElement(Lp,{location:r.location,revalidation:r.revalidation,component:x,error:b,children:j(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):j()},null)}var $d=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}($d||{}),Gd=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Gd||{});function $p(t){let s=l.useContext(cl);return s||lt(!1),s}function Gp(t){let s=l.useContext(Pp);return s||lt(!1),s}function Bp(t){let s=l.useContext(Ds);return s||lt(!1),s}function Bd(t){let s=Bp(),r=s.matches[s.matches.length-1];return r.route.id||lt(!1),r.route.id}function Vp(){var t;let s=l.useContext(Ld),r=Gp(),n=Bd();return s!==void 0?s:(t=r.errors)==null?void 0:t[n]}function Wp(){let{router:t}=$p($d.UseNavigateStable),s=Bd(Gd.UseNavigateStable),r=l.useRef(!1);return Od(()=>{r.current=!0}),l.useCallback(function(a,o){o===void 0&&(o={}),r.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Qn({fromRouteId:s},o)))},[t,s])}const pc={};function zp(t,s,r){pc[t]||(pc[t]=!0)}function Hp(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function bt(t){let{to:s,replace:r,state:n,relative:a}=t;Nn()||lt(!1);let{future:o,static:i}=l.useContext(wr),{matches:c}=l.useContext(Ds),{pathname:d}=St(),m=yt(),h=ll(s,il(c,o.v7_relativeSplatPath),d,a==="path"),u=JSON.stringify(h);return l.useEffect(()=>m(JSON.parse(u),{replace:r,state:n,relative:a}),[m,u,a,r,n]),null}function qp(t){return Tp(t.context)}function Ce(t){lt(!1)}function Yp(t){let{basename:s="/",children:r=null,location:n,navigationType:a=mr.Pop,navigator:o,static:i=!1,future:c}=t;Nn()&&lt(!1);let d=s.replace(/^\/*/,"/"),m=l.useMemo(()=>({basename:d,navigator:o,static:i,future:Qn({v7_relativeSplatPath:!1},c)}),[d,c,o,i]);typeof n=="string"&&(n=wn(n));let{pathname:h="/",search:u="",hash:f="",state:b=null,key:p="default"}=n,x=l.useMemo(()=>{let v=ol(h,d);return v==null?null:{location:{pathname:v,search:u,hash:f,state:b,key:p},navigationType:a}},[d,h,u,f,b,p,a]);return x==null?null:l.createElement(wr.Provider,{value:m},l.createElement(fa.Provider,{children:r,value:x}))}function Xn(t){let{children:s,location:r}=t;return kp(Ti(s),r)}new Promise(()=>{});function Ti(t,s){s===void 0&&(s=[]);let r=[];return l.Children.forEach(t,(n,a)=>{if(!l.isValidElement(n))return;let o=[...s,a];if(n.type===l.Fragment){r.push.apply(r,Ti(n.props.children,o));return}n.type!==Ce&&lt(!1),!n.props.index||!n.props.children||lt(!1);let i={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Ti(n.props.children,o)),r.push(i)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mi(){return Mi=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mi.apply(this,arguments)}function Kp(t,s){if(t==null)return{};var r={},n=Object.keys(t),a,o;for(o=0;o<n.length;o++)a=n[o],!(s.indexOf(a)>=0)&&(r[a]=t[a]);return r}function Jp(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Qp(t,s){return t.button===0&&(!s||s==="_self")&&!Jp(t)}const Xp=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Zp="6";try{window.__reactRouterVersion=Zp}catch{}const eg="startTransition",gc=al[eg];function tg(t){let{basename:s,children:r,future:n,window:a}=t,o=l.useRef();o.current==null&&(o.current=ep({window:a,v5Compat:!0}));let i=o.current,[c,d]=l.useState({action:i.action,location:i.location}),{v7_startTransition:m}=n||{},h=l.useCallback(u=>{m&&gc?gc(()=>d(u)):d(u)},[d,m]);return l.useLayoutEffect(()=>i.listen(h),[i,h]),l.useEffect(()=>Hp(n),[n]),l.createElement(Yp,{basename:s,children:r,location:c.location,navigationType:c.action,navigator:i,future:n})}const sg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,us=l.forwardRef(function(s,r){let{onClick:n,relative:a,reloadDocument:o,replace:i,state:c,target:d,to:m,preventScrollReset:h,viewTransition:u}=s,f=Kp(s,Xp),{basename:b}=l.useContext(wr),p,x=!1;if(typeof m=="string"&&rg.test(m)&&(p=m,sg))try{let N=new URL(window.location.href),g=m.startsWith("//")?new URL(N.protocol+m):new URL(m),w=ol(g.pathname,b);g.origin===N.origin&&w!=null?m=w+g.search+g.hash:x=!0}catch{}let v=_p(m,{relative:a}),y=ng(m,{replace:i,state:c,target:d,preventScrollReset:h,relative:a,viewTransition:u});function j(N){n&&n(N),N.defaultPrevented||y(N)}return l.createElement("a",Mi({},f,{href:p||v,onClick:x||o?n:j,ref:r,target:d}))});var vc;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(vc||(vc={}));var bc;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(bc||(bc={}));function ng(t,s){let{target:r,replace:n,state:a,preventScrollReset:o,relative:i,viewTransition:c}=s===void 0?{}:s,d=yt(),m=St(),h=Ud(t,{relative:i});return l.useCallback(u=>{if(Qp(u,r)){u.preventDefault();let f=n!==void 0?n:Xa(m)===Xa(h);d(t,{replace:f,state:a,preventScrollReset:o,relative:i,viewTransition:c})}},[m,d,h,n,a,r,t,o,i,c])}function oe(t,s,{checkForDefaultPrevented:r=!0}={}){return function(a){if(t==null||t(a),r===!1||!a.defaultPrevented)return s==null?void 0:s(a)}}function yc(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function po(...t){return s=>{let r=!1;const n=t.map(a=>{const o=yc(a,s);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let a=0;a<n.length;a++){const o=n[a];typeof o=="function"?o():yc(t[a],null)}}}}function Me(...t){return l.useCallback(po(...t),t)}function ag(t,s){const r=l.createContext(s),n=o=>{const{children:i,...c}=o,d=l.useMemo(()=>c,Object.values(c));return e.jsx(r.Provider,{value:d,children:i})};n.displayName=t+"Provider";function a(o){const i=l.useContext(r);if(i)return i;if(s!==void 0)return s;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[n,a]}function Wt(t,s=[]){let r=[];function n(o,i){const c=l.createContext(i),d=r.length;r=[...r,i];const m=u=>{var y;const{scope:f,children:b,...p}=u,x=((y=f==null?void 0:f[t])==null?void 0:y[d])||c,v=l.useMemo(()=>p,Object.values(p));return e.jsx(x.Provider,{value:v,children:b})};m.displayName=o+"Provider";function h(u,f){var x;const b=((x=f==null?void 0:f[t])==null?void 0:x[d])||c,p=l.useContext(b);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${u}\` must be used within \`${o}\``)}return[m,h]}const a=()=>{const o=r.map(i=>l.createContext(i));return function(c){const d=(c==null?void 0:c[t])||o;return l.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[n,og(a,...s)]}function og(...t){const s=t[0];if(t.length===1)return s;const r=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const i=n.reduce((c,{useScope:d,scopeName:m})=>{const u=d(o)[`__scope${m}`];return{...c,...u}},{});return l.useMemo(()=>({[`__scope${s.scopeName}`]:i}),[i])}};return r.scopeName=s.scopeName,r}function Lr(t){const s=lg(t),r=l.forwardRef((n,a)=>{const{children:o,...i}=n,c=l.Children.toArray(o),d=c.find(dg);if(d){const m=d.props.children,h=c.map(u=>u===d?l.Children.count(m)>1?l.Children.only(null):l.isValidElement(m)?m.props.children:null:u);return e.jsx(s,{...i,ref:a,children:l.isValidElement(m)?l.cloneElement(m,void 0,h):null})}return e.jsx(s,{...i,ref:a,children:o})});return r.displayName=`${t}.Slot`,r}var ig=Lr("Slot");function lg(t){const s=l.forwardRef((r,n)=>{const{children:a,...o}=r;if(l.isValidElement(a)){const i=mg(a),c=ug(o,a.props);return a.type!==l.Fragment&&(c.ref=n?po(n,i):i),l.cloneElement(a,c)}return l.Children.count(a)>1?l.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Vd=Symbol("radix.slottable");function cg(t){const s=({children:r})=>e.jsx(e.Fragment,{children:r});return s.displayName=`${t}.Slottable`,s.__radixId=Vd,s}function dg(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Vd}function ug(t,s){const r={...s};for(const n in s){const a=t[n],o=s[n];/^on[A-Z]/.test(n)?a&&o?r[n]=(...c)=>{o(...c),a(...c)}:a&&(r[n]=a):n==="style"?r[n]={...a,...o}:n==="className"&&(r[n]=[a,o].filter(Boolean).join(" "))}return{...t,...r}}function mg(t){var n,a;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function go(t){const s=t+"CollectionProvider",[r,n]=Wt(s),[a,o]=r(s,{collectionRef:{current:null},itemMap:new Map}),i=x=>{const{scope:v,children:y}=x,j=Gs.useRef(null),N=Gs.useRef(new Map).current;return e.jsx(a,{scope:v,itemMap:N,collectionRef:j,children:y})};i.displayName=s;const c=t+"CollectionSlot",d=Lr(c),m=Gs.forwardRef((x,v)=>{const{scope:y,children:j}=x,N=o(c,y),g=Me(v,N.collectionRef);return e.jsx(d,{ref:g,children:j})});m.displayName=c;const h=t+"CollectionItemSlot",u="data-radix-collection-item",f=Lr(h),b=Gs.forwardRef((x,v)=>{const{scope:y,children:j,...N}=x,g=Gs.useRef(null),w=Me(v,g),S=o(h,y);return Gs.useEffect(()=>(S.itemMap.set(g,{ref:g,...N}),()=>void S.itemMap.delete(g))),e.jsx(f,{[u]:"",ref:w,children:j})});b.displayName=h;function p(x){const v=o(t+"CollectionConsumer",x);return Gs.useCallback(()=>{const j=v.collectionRef.current;if(!j)return[];const N=Array.from(j.querySelectorAll(`[${u}]`));return Array.from(v.itemMap.values()).sort((S,P)=>N.indexOf(S.ref.current)-N.indexOf(P.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:i,Slot:m,ItemSlot:b},p,n]}var hg=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],je=hg.reduce((t,s)=>{const r=Lr(`Primitive.${s}`),n=l.forwardRef((a,o)=>{const{asChild:i,...c}=a,d=i?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:o})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{});function dl(t,s){t&&jn.flushSync(()=>t.dispatchEvent(s))}function st(t){const s=l.useRef(t);return l.useEffect(()=>{s.current=t}),l.useMemo(()=>(...r)=>{var n;return(n=s.current)==null?void 0:n.call(s,...r)},[])}function fg(t,s=globalThis==null?void 0:globalThis.document){const r=st(t);l.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return s.addEventListener("keydown",n,{capture:!0}),()=>s.removeEventListener("keydown",n,{capture:!0})},[r,s])}var xg="DismissableLayer",ki="dismissableLayer.update",pg="dismissableLayer.pointerDownOutside",gg="dismissableLayer.focusOutside",jc,Wd=l.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Sn=l.forwardRef((t,s)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:i,onDismiss:c,...d}=t,m=l.useContext(Wd),[h,u]=l.useState(null),f=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,b]=l.useState({}),p=Me(s,P=>u(P)),x=Array.from(m.layers),[v]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),y=x.indexOf(v),j=h?x.indexOf(h):-1,N=m.layersWithOutsidePointerEventsDisabled.size>0,g=j>=y,w=bg(P=>{const E=P.target,D=[...m.branches].some(G=>G.contains(E));!g||D||(a==null||a(P),i==null||i(P),P.defaultPrevented||c==null||c())},f),S=yg(P=>{const E=P.target;[...m.branches].some(G=>G.contains(E))||(o==null||o(P),i==null||i(P),P.defaultPrevented||c==null||c())},f);return fg(P=>{j===m.layers.size-1&&(n==null||n(P),!P.defaultPrevented&&c&&(P.preventDefault(),c()))},f),l.useEffect(()=>{if(h)return r&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(jc=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(h)),m.layers.add(h),wc(),()=>{r&&m.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=jc)}},[h,f,r,m]),l.useEffect(()=>()=>{h&&(m.layers.delete(h),m.layersWithOutsidePointerEventsDisabled.delete(h),wc())},[h,m]),l.useEffect(()=>{const P=()=>b({});return document.addEventListener(ki,P),()=>document.removeEventListener(ki,P)},[]),e.jsx(je.div,{...d,ref:p,style:{pointerEvents:N?g?"auto":"none":void 0,...t.style},onFocusCapture:oe(t.onFocusCapture,S.onFocusCapture),onBlurCapture:oe(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:oe(t.onPointerDownCapture,w.onPointerDownCapture)})});Sn.displayName=xg;var vg="DismissableLayerBranch",zd=l.forwardRef((t,s)=>{const r=l.useContext(Wd),n=l.useRef(null),a=Me(s,n);return l.useEffect(()=>{const o=n.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),e.jsx(je.div,{...t,ref:a})});zd.displayName=vg;function bg(t,s=globalThis==null?void 0:globalThis.document){const r=st(t),n=l.useRef(!1),a=l.useRef(()=>{});return l.useEffect(()=>{const o=c=>{if(c.target&&!n.current){let d=function(){Hd(pg,r,m,{discrete:!0})};const m={originalEvent:c};c.pointerType==="touch"?(s.removeEventListener("click",a.current),a.current=d,s.addEventListener("click",a.current,{once:!0})):d()}else s.removeEventListener("click",a.current);n.current=!1},i=window.setTimeout(()=>{s.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),s.removeEventListener("pointerdown",o),s.removeEventListener("click",a.current)}},[s,r]),{onPointerDownCapture:()=>n.current=!0}}function yg(t,s=globalThis==null?void 0:globalThis.document){const r=st(t),n=l.useRef(!1);return l.useEffect(()=>{const a=o=>{o.target&&!n.current&&Hd(gg,r,{originalEvent:o},{discrete:!1})};return s.addEventListener("focusin",a),()=>s.removeEventListener("focusin",a)},[s,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function wc(){const t=new CustomEvent(ki);document.dispatchEvent(t)}function Hd(t,s,r,{discrete:n}){const a=r.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});s&&a.addEventListener(t,s,{once:!0}),n?dl(a,o):a.dispatchEvent(o)}var jg=Sn,wg=zd,xt=globalThis!=null&&globalThis.document?l.useLayoutEffect:()=>{},Ng="Portal",xa=l.forwardRef((t,s)=>{var c;const{container:r,...n}=t,[a,o]=l.useState(!1);xt(()=>o(!0),[]);const i=r||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return i?Zx.createPortal(e.jsx(je.div,{...n,ref:s}),i):null});xa.displayName=Ng;function Sg(t,s){return l.useReducer((r,n)=>s[r][n]??r,t)}var jt=t=>{const{present:s,children:r}=t,n=Cg(s),a=typeof r=="function"?r({present:n.isPresent}):l.Children.only(r),o=Me(n.ref,Pg(a));return typeof r=="function"||n.isPresent?l.cloneElement(a,{ref:o}):null};jt.displayName="Presence";function Cg(t){const[s,r]=l.useState(),n=l.useRef(null),a=l.useRef(t),o=l.useRef("none"),i=t?"mounted":"unmounted",[c,d]=Sg(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return l.useEffect(()=>{const m=ka(n.current);o.current=c==="mounted"?m:"none"},[c]),xt(()=>{const m=n.current,h=a.current;if(h!==t){const f=o.current,b=ka(m);t?d("MOUNT"):b==="none"||(m==null?void 0:m.display)==="none"?d("UNMOUNT"):d(h&&f!==b?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,d]),xt(()=>{if(s){let m;const h=s.ownerDocument.defaultView??window,u=b=>{const x=ka(n.current).includes(b.animationName);if(b.target===s&&x&&(d("ANIMATION_END"),!a.current)){const v=s.style.animationFillMode;s.style.animationFillMode="forwards",m=h.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=v)})}},f=b=>{b.target===s&&(o.current=ka(n.current))};return s.addEventListener("animationstart",f),s.addEventListener("animationcancel",u),s.addEventListener("animationend",u),()=>{h.clearTimeout(m),s.removeEventListener("animationstart",f),s.removeEventListener("animationcancel",u),s.removeEventListener("animationend",u)}}else d("ANIMATION_END")},[s,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:l.useCallback(m=>{n.current=m?getComputedStyle(m):null,r(m)},[])}}function ka(t){return(t==null?void 0:t.animationName)||"none"}function Pg(t){var n,a;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var _g=al[" useInsertionEffect ".trim().toString()]||xt;function Ps({prop:t,defaultProp:s,onChange:r=()=>{},caller:n}){const[a,o,i]=Dg({defaultProp:s,onChange:r}),c=t!==void 0,d=c?t:a;{const h=l.useRef(t!==void 0);l.useEffect(()=>{const u=h.current;u!==c&&console.warn(`${n} is changing from ${u?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=c},[c,n])}const m=l.useCallback(h=>{var u;if(c){const f=Ag(h)?h(t):h;f!==t&&((u=i.current)==null||u.call(i,f))}else o(h)},[c,t,o,i]);return[d,m]}function Dg({defaultProp:t,onChange:s}){const[r,n]=l.useState(t),a=l.useRef(r),o=l.useRef(s);return _g(()=>{o.current=s},[s]),l.useEffect(()=>{var i;a.current!==r&&((i=o.current)==null||i.call(o,r),a.current=r)},[r,a]),[r,n,o]}function Ag(t){return typeof t=="function"}var qd=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Eg="VisuallyHidden",vo=l.forwardRef((t,s)=>e.jsx(je.span,{...t,ref:s,style:{...qd,...t.style}}));vo.displayName=Eg;var Tg=vo,ul="ToastProvider",[ml,Mg,kg]=go("Toast"),[Yd,CS]=Wt("Toast",[kg]),[Rg,bo]=Yd(ul),Kd=t=>{const{__scopeToast:s,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:o=50,children:i}=t,[c,d]=l.useState(null),[m,h]=l.useState(0),u=l.useRef(!1),f=l.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${ul}\`. Expected non-empty \`string\`.`),e.jsx(ml.Provider,{scope:s,children:e.jsx(Rg,{scope:s,label:r,duration:n,swipeDirection:a,swipeThreshold:o,toastCount:m,viewport:c,onViewportChange:d,onToastAdd:l.useCallback(()=>h(b=>b+1),[]),onToastRemove:l.useCallback(()=>h(b=>b-1),[]),isFocusedToastEscapeKeyDownRef:u,isClosePausedRef:f,children:i})})};Kd.displayName=ul;var Jd="ToastViewport",Ig=["F8"],Ri="toast.viewportPause",Ii="toast.viewportResume",Qd=l.forwardRef((t,s)=>{const{__scopeToast:r,hotkey:n=Ig,label:a="Notifications ({hotkey})",...o}=t,i=bo(Jd,r),c=Mg(r),d=l.useRef(null),m=l.useRef(null),h=l.useRef(null),u=l.useRef(null),f=Me(s,u,i.onViewportChange),b=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=i.toastCount>0;l.useEffect(()=>{const v=y=>{var N;n.length!==0&&n.every(g=>y[g]||y.code===g)&&((N=u.current)==null||N.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n]),l.useEffect(()=>{const v=d.current,y=u.current;if(p&&v&&y){const j=()=>{if(!i.isClosePausedRef.current){const S=new CustomEvent(Ri);y.dispatchEvent(S),i.isClosePausedRef.current=!0}},N=()=>{if(i.isClosePausedRef.current){const S=new CustomEvent(Ii);y.dispatchEvent(S),i.isClosePausedRef.current=!1}},g=S=>{!v.contains(S.relatedTarget)&&N()},w=()=>{v.contains(document.activeElement)||N()};return v.addEventListener("focusin",j),v.addEventListener("focusout",g),v.addEventListener("pointermove",j),v.addEventListener("pointerleave",w),window.addEventListener("blur",j),window.addEventListener("focus",N),()=>{v.removeEventListener("focusin",j),v.removeEventListener("focusout",g),v.removeEventListener("pointermove",j),v.removeEventListener("pointerleave",w),window.removeEventListener("blur",j),window.removeEventListener("focus",N)}}},[p,i.isClosePausedRef]);const x=l.useCallback(({tabbingDirection:v})=>{const j=c().map(N=>{const g=N.ref.current,w=[g,...Yg(g)];return v==="forwards"?w:w.reverse()});return(v==="forwards"?j.reverse():j).flat()},[c]);return l.useEffect(()=>{const v=u.current;if(v){const y=j=>{var w,S,P;const N=j.altKey||j.ctrlKey||j.metaKey;if(j.key==="Tab"&&!N){const E=document.activeElement,D=j.shiftKey;if(j.target===v&&D){(w=m.current)==null||w.focus();return}const L=x({tabbingDirection:D?"backwards":"forwards"}),T=L.findIndex(A=>A===E);ai(L.slice(T+1))?j.preventDefault():D?(S=m.current)==null||S.focus():(P=h.current)==null||P.focus()}};return v.addEventListener("keydown",y),()=>v.removeEventListener("keydown",y)}},[c,x]),e.jsxs(wg,{ref:d,role:"region","aria-label":a.replace("{hotkey}",b),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&e.jsx(Fi,{ref:m,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"forwards"});ai(v)}}),e.jsx(ml.Slot,{scope:r,children:e.jsx(je.ol,{tabIndex:-1,...o,ref:f})}),p&&e.jsx(Fi,{ref:h,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"backwards"});ai(v)}})]})});Qd.displayName=Jd;var Xd="ToastFocusProxy",Fi=l.forwardRef((t,s)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=t,o=bo(Xd,r);return e.jsx(vo,{"aria-hidden":!0,tabIndex:0,...a,ref:s,style:{position:"fixed"},onFocus:i=>{var m;const c=i.relatedTarget;!((m=o.viewport)!=null&&m.contains(c))&&n()}})});Fi.displayName=Xd;var pa="Toast",Fg="toast.swipeStart",Lg="toast.swipeMove",Og="toast.swipeCancel",Ug="toast.swipeEnd",Zd=l.forwardRef((t,s)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:o,...i}=t,[c,d]=Ps({prop:n,defaultProp:a??!0,onChange:o,caller:pa});return e.jsx(jt,{present:r||c,children:e.jsx(Bg,{open:c,...i,ref:s,onClose:()=>d(!1),onPause:st(t.onPause),onResume:st(t.onResume),onSwipeStart:oe(t.onSwipeStart,m=>{m.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:oe(t.onSwipeMove,m=>{const{x:h,y:u}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","move"),m.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${u}px`)}),onSwipeCancel:oe(t.onSwipeCancel,m=>{m.currentTarget.setAttribute("data-swipe","cancel"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:oe(t.onSwipeEnd,m=>{const{x:h,y:u}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","end"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${u}px`),d(!1)})})})});Zd.displayName=pa;var[$g,Gg]=Yd(pa,{onClose(){}}),Bg=l.forwardRef((t,s)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:o,onClose:i,onEscapeKeyDown:c,onPause:d,onResume:m,onSwipeStart:h,onSwipeMove:u,onSwipeCancel:f,onSwipeEnd:b,...p}=t,x=bo(pa,r),[v,y]=l.useState(null),j=Me(s,A=>y(A)),N=l.useRef(null),g=l.useRef(null),w=a||x.duration,S=l.useRef(0),P=l.useRef(w),E=l.useRef(0),{onToastAdd:D,onToastRemove:G}=x,se=st(()=>{var Y;(v==null?void 0:v.contains(document.activeElement))&&((Y=x.viewport)==null||Y.focus()),i()}),L=l.useCallback(A=>{!A||A===1/0||(window.clearTimeout(E.current),S.current=new Date().getTime(),E.current=window.setTimeout(se,A))},[se]);l.useEffect(()=>{const A=x.viewport;if(A){const Y=()=>{L(P.current),m==null||m()},te=()=>{const xe=new Date().getTime()-S.current;P.current=P.current-xe,window.clearTimeout(E.current),d==null||d()};return A.addEventListener(Ri,te),A.addEventListener(Ii,Y),()=>{A.removeEventListener(Ri,te),A.removeEventListener(Ii,Y)}}},[x.viewport,w,d,m,L]),l.useEffect(()=>{o&&!x.isClosePausedRef.current&&L(w)},[o,w,x.isClosePausedRef,L]),l.useEffect(()=>(D(),()=>G()),[D,G]);const T=l.useMemo(()=>v?ou(v):null,[v]);return x.viewport?e.jsxs(e.Fragment,{children:[T&&e.jsx(Vg,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:T}),e.jsx($g,{scope:r,onClose:se,children:jn.createPortal(e.jsx(ml.ItemSlot,{scope:r,children:e.jsx(jg,{asChild:!0,onEscapeKeyDown:oe(c,()=>{x.isFocusedToastEscapeKeyDownRef.current||se(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(je.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":x.swipeDirection,...p,ref:j,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:oe(t.onKeyDown,A=>{A.key==="Escape"&&(c==null||c(A.nativeEvent),A.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,se()))}),onPointerDown:oe(t.onPointerDown,A=>{A.button===0&&(N.current={x:A.clientX,y:A.clientY})}),onPointerMove:oe(t.onPointerMove,A=>{if(!N.current)return;const Y=A.clientX-N.current.x,te=A.clientY-N.current.y,xe=!!g.current,le=["left","right"].includes(x.swipeDirection),Q=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,pe=le?Q(0,Y):0,Pe=le?0:Q(0,te),Oe=A.pointerType==="touch"?10:2,qe={x:pe,y:Pe},M={originalEvent:A,delta:qe};xe?(g.current=qe,Ra(Lg,u,M,{discrete:!1})):Nc(qe,x.swipeDirection,Oe)?(g.current=qe,Ra(Fg,h,M,{discrete:!1}),A.target.setPointerCapture(A.pointerId)):(Math.abs(Y)>Oe||Math.abs(te)>Oe)&&(N.current=null)}),onPointerUp:oe(t.onPointerUp,A=>{const Y=g.current,te=A.target;if(te.hasPointerCapture(A.pointerId)&&te.releasePointerCapture(A.pointerId),g.current=null,N.current=null,Y){const xe=A.currentTarget,le={originalEvent:A,delta:Y};Nc(Y,x.swipeDirection,x.swipeThreshold)?Ra(Ug,b,le,{discrete:!0}):Ra(Og,f,le,{discrete:!0}),xe.addEventListener("click",Q=>Q.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),Vg=t=>{const{__scopeToast:s,children:r,...n}=t,a=bo(pa,s),[o,i]=l.useState(!1),[c,d]=l.useState(!1);return Hg(()=>i(!0)),l.useEffect(()=>{const m=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(m)},[]),c?null:e.jsx(xa,{asChild:!0,children:e.jsx(vo,{...n,children:o&&e.jsxs(e.Fragment,{children:[a.label," ",r]})})})},Wg="ToastTitle",eu=l.forwardRef((t,s)=>{const{__scopeToast:r,...n}=t;return e.jsx(je.div,{...n,ref:s})});eu.displayName=Wg;var zg="ToastDescription",tu=l.forwardRef((t,s)=>{const{__scopeToast:r,...n}=t;return e.jsx(je.div,{...n,ref:s})});tu.displayName=zg;var su="ToastAction",ru=l.forwardRef((t,s)=>{const{altText:r,...n}=t;return r.trim()?e.jsx(au,{altText:r,asChild:!0,children:e.jsx(hl,{...n,ref:s})}):(console.error(`Invalid prop \`altText\` supplied to \`${su}\`. Expected non-empty \`string\`.`),null)});ru.displayName=su;var nu="ToastClose",hl=l.forwardRef((t,s)=>{const{__scopeToast:r,...n}=t,a=Gg(nu,r);return e.jsx(au,{asChild:!0,children:e.jsx(je.button,{type:"button",...n,ref:s,onClick:oe(t.onClick,a.onClose)})})});hl.displayName=nu;var au=l.forwardRef((t,s)=>{const{__scopeToast:r,altText:n,...a}=t;return e.jsx(je.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:s})});function ou(t){const s=[];return Array.from(t.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&s.push(n.textContent),qg(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!a)if(o){const i=n.dataset.radixToastAnnounceAlt;i&&s.push(i)}else s.push(...ou(n))}}),s}function Ra(t,s,r,{discrete:n}){const a=r.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});s&&a.addEventListener(t,s,{once:!0}),n?dl(a,o):a.dispatchEvent(o)}var Nc=(t,s,r=0)=>{const n=Math.abs(t.x),a=Math.abs(t.y),o=n>a;return s==="left"||s==="right"?o&&n>r:!o&&a>r};function Hg(t=()=>{}){const s=st(t);xt(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(s)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[s])}function qg(t){return t.nodeType===t.ELEMENT_NODE}function Yg(t){const s=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)s.push(r.currentNode);return s}function ai(t){const s=document.activeElement;return t.some(r=>r===s?!0:(r.focus(),document.activeElement!==s))}var Kg=Kd,iu=Qd,lu=Zd,cu=eu,du=tu,uu=ru,mu=hl;function hu(t){var s,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(s=0;s<a;s++)t[s]&&(r=hu(t[s]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function fu(){for(var t,s,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(s=hu(t))&&(n&&(n+=" "),n+=s);return n}const Sc=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Cc=fu,ga=(t,s)=>r=>{var n;if((s==null?void 0:s.variants)==null)return Cc(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:o}=s,i=Object.keys(a).map(m=>{const h=r==null?void 0:r[m],u=o==null?void 0:o[m];if(h===null)return null;const f=Sc(h)||Sc(u);return a[m][f]}),c=r&&Object.entries(r).reduce((m,h)=>{let[u,f]=h;return f===void 0||(m[u]=f),m},{}),d=s==null||(n=s.compoundVariants)===null||n===void 0?void 0:n.reduce((m,h)=>{let{class:u,className:f,...b}=h;return Object.entries(b).every(p=>{let[x,v]=p;return Array.isArray(v)?v.includes({...o,...c}[x]):{...o,...c}[x]===v})?[...m,u,f]:m},[]);return Cc(t,i,d,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xu=(...t)=>t.filter((s,r,n)=>!!s&&n.indexOf(s)===r).join(" ");/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qg={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=l.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:i,...c},d)=>l.createElement("svg",{ref:d,...Qg,width:s,height:s,stroke:t,strokeWidth:n?Number(r)*24/Number(s):r,className:xu("lucide",a),...c},[...i.map(([m,h])=>l.createElement(m,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=(t,s)=>{const r=l.forwardRef(({className:n,...a},o)=>l.createElement(Xg,{ref:o,iconNode:s,className:xu(`lucide-${Jg(t)}`,n),...a}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=me("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=me("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=me("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=me("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=me("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=me("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=me("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=me("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=me("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=me("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=me("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=me("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=me("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=me("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=me("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=me("ChartColumnIncreasing",[["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=me("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=me("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=me("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=me("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=me("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=me("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=me("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=me("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=me("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=me("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=me("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=me("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=me("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=me("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=me("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=me("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=me("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=me("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=me("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=me("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=me("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=me("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=me("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=me("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=me("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=me("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=me("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=me("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0=me("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=me("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=me("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=me("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=me("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=me("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=me("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=me("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=me("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=me("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=me("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=me("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=me("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=me("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=me("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=me("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=me("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=me("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),vl="-",j0=t=>{const s=N0(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:i=>{const c=i.split(vl);return c[0]===""&&c.length!==1&&c.shift(),Nu(c,s)||w0(i)},getConflictingClassGroupIds:(i,c)=>{const d=r[i]||[];return c&&n[i]?[...d,...n[i]]:d}}},Nu=(t,s)=>{var i;if(t.length===0)return s.classGroupId;const r=t[0],n=s.nextPart.get(r),a=n?Nu(t.slice(1),n):void 0;if(a)return a;if(s.validators.length===0)return;const o=t.join(vl);return(i=s.validators.find(({validator:c})=>c(o)))==null?void 0:i.classGroupId},Ec=/^\[(.+)\]$/,w0=t=>{if(Ec.test(t)){const s=Ec.exec(t)[1],r=s==null?void 0:s.substring(0,s.indexOf(":"));if(r)return"arbitrary.."+r}},N0=t=>{const{theme:s,prefix:r}=t,n={nextPart:new Map,validators:[]};return C0(Object.entries(t.classGroups),r).forEach(([o,i])=>{Ui(i,n,o,s)}),n},Ui=(t,s,r,n)=>{t.forEach(a=>{if(typeof a=="string"){const o=a===""?s:Tc(s,a);o.classGroupId=r;return}if(typeof a=="function"){if(S0(a)){Ui(a(n),s,r,n);return}s.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([o,i])=>{Ui(i,Tc(s,o),r,n)})})},Tc=(t,s)=>{let r=t;return s.split(vl).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},S0=t=>t.isThemeGetter,C0=(t,s)=>s?t.map(([r,n])=>{const a=n.map(o=>typeof o=="string"?s+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,c])=>[s+i,c])):o);return[r,a]}):t,P0=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,r=new Map,n=new Map;const a=(o,i)=>{r.set(o,i),s++,s>t&&(s=0,n=r,r=new Map)};return{get(o){let i=r.get(o);if(i!==void 0)return i;if((i=n.get(o))!==void 0)return a(o,i),i},set(o,i){r.has(o)?r.set(o,i):a(o,i)}}},Su="!",_0=t=>{const{separator:s,experimentalParseClassName:r}=t,n=s.length===1,a=s[0],o=s.length,i=c=>{const d=[];let m=0,h=0,u;for(let v=0;v<c.length;v++){let y=c[v];if(m===0){if(y===a&&(n||c.slice(v,v+o)===s)){d.push(c.slice(h,v)),h=v+o;continue}if(y==="/"){u=v;continue}}y==="["?m++:y==="]"&&m--}const f=d.length===0?c:c.substring(h),b=f.startsWith(Su),p=b?f.substring(1):f,x=u&&u>h?u-h:void 0;return{modifiers:d,hasImportantModifier:b,baseClassName:p,maybePostfixModifierPosition:x}};return r?c=>r({className:c,parseClassName:i}):i},D0=t=>{if(t.length<=1)return t;const s=[];let r=[];return t.forEach(n=>{n[0]==="["?(s.push(...r.sort(),n),r=[]):r.push(n)}),s.push(...r.sort()),s},A0=t=>({cache:P0(t.cacheSize),parseClassName:_0(t),...j0(t)}),E0=/\s+/,T0=(t,s)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=s,o=[],i=t.trim().split(E0);let c="";for(let d=i.length-1;d>=0;d-=1){const m=i[d],{modifiers:h,hasImportantModifier:u,baseClassName:f,maybePostfixModifierPosition:b}=r(m);let p=!!b,x=n(p?f.substring(0,b):f);if(!x){if(!p){c=m+(c.length>0?" "+c:c);continue}if(x=n(f),!x){c=m+(c.length>0?" "+c:c);continue}p=!1}const v=D0(h).join(":"),y=u?v+Su:v,j=y+x;if(o.includes(j))continue;o.push(j);const N=a(x,p);for(let g=0;g<N.length;++g){const w=N[g];o.push(y+w)}c=m+(c.length>0?" "+c:c)}return c};function M0(){let t=0,s,r,n="";for(;t<arguments.length;)(s=arguments[t++])&&(r=Cu(s))&&(n&&(n+=" "),n+=r);return n}const Cu=t=>{if(typeof t=="string")return t;let s,r="";for(let n=0;n<t.length;n++)t[n]&&(s=Cu(t[n]))&&(r&&(r+=" "),r+=s);return r};function k0(t,...s){let r,n,a,o=i;function i(d){const m=s.reduce((h,u)=>u(h),t());return r=A0(m),n=r.cache.get,a=r.cache.set,o=c,c(d)}function c(d){const m=n(d);if(m)return m;const h=T0(d,r);return a(d,h),h}return function(){return o(M0.apply(null,arguments))}}const Xe=t=>{const s=r=>r[t]||[];return s.isThemeGetter=!0,s},Pu=/^\[(?:([a-z-]+):)?(.+)\]$/i,R0=/^\d+\/\d+$/,I0=new Set(["px","full","screen"]),F0=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,L0=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,O0=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,U0=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$0=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ls=t=>tn(t)||I0.has(t)||R0.test(t),er=t=>Pn(t,"length",Y0),tn=t=>!!t&&!Number.isNaN(Number(t)),ii=t=>Pn(t,"number",tn),In=t=>!!t&&Number.isInteger(Number(t)),G0=t=>t.endsWith("%")&&tn(t.slice(0,-1)),Te=t=>Pu.test(t),tr=t=>F0.test(t),B0=new Set(["length","size","percentage"]),V0=t=>Pn(t,B0,_u),W0=t=>Pn(t,"position",_u),z0=new Set(["image","url"]),H0=t=>Pn(t,z0,J0),q0=t=>Pn(t,"",K0),Fn=()=>!0,Pn=(t,s,r)=>{const n=Pu.exec(t);return n?n[1]?typeof s=="string"?n[1]===s:s.has(n[1]):r(n[2]):!1},Y0=t=>L0.test(t)&&!O0.test(t),_u=()=>!1,K0=t=>U0.test(t),J0=t=>$0.test(t),Q0=()=>{const t=Xe("colors"),s=Xe("spacing"),r=Xe("blur"),n=Xe("brightness"),a=Xe("borderColor"),o=Xe("borderRadius"),i=Xe("borderSpacing"),c=Xe("borderWidth"),d=Xe("contrast"),m=Xe("grayscale"),h=Xe("hueRotate"),u=Xe("invert"),f=Xe("gap"),b=Xe("gradientColorStops"),p=Xe("gradientColorStopPositions"),x=Xe("inset"),v=Xe("margin"),y=Xe("opacity"),j=Xe("padding"),N=Xe("saturate"),g=Xe("scale"),w=Xe("sepia"),S=Xe("skew"),P=Xe("space"),E=Xe("translate"),D=()=>["auto","contain","none"],G=()=>["auto","hidden","clip","visible","scroll"],se=()=>["auto",Te,s],L=()=>[Te,s],T=()=>["",Ls,er],A=()=>["auto",tn,Te],Y=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],te=()=>["solid","dashed","dotted","double","none"],xe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],le=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",Te],pe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Pe=()=>[tn,Te];return{cacheSize:500,separator:":",theme:{colors:[Fn],spacing:[Ls,er],blur:["none","",tr,Te],brightness:Pe(),borderColor:[t],borderRadius:["none","","full",tr,Te],borderSpacing:L(),borderWidth:T(),contrast:Pe(),grayscale:Q(),hueRotate:Pe(),invert:Q(),gap:L(),gradientColorStops:[t],gradientColorStopPositions:[G0,er],inset:se(),margin:se(),opacity:Pe(),padding:L(),saturate:Pe(),scale:Pe(),sepia:Q(),skew:Pe(),space:L(),translate:L()},classGroups:{aspect:[{aspect:["auto","square","video",Te]}],container:["container"],columns:[{columns:[tr]}],"break-after":[{"break-after":pe()}],"break-before":[{"break-before":pe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Y(),Te]}],overflow:[{overflow:G()}],"overflow-x":[{"overflow-x":G()}],"overflow-y":[{"overflow-y":G()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",In,Te]}],basis:[{basis:se()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Te]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",In,Te]}],"grid-cols":[{"grid-cols":[Fn]}],"col-start-end":[{col:["auto",{span:["full",In,Te]},Te]}],"col-start":[{"col-start":A()}],"col-end":[{"col-end":A()}],"grid-rows":[{"grid-rows":[Fn]}],"row-start-end":[{row:["auto",{span:[In,Te]},Te]}],"row-start":[{"row-start":A()}],"row-end":[{"row-end":A()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Te]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Te]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...le()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...le(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...le(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[j]}],px:[{px:[j]}],py:[{py:[j]}],ps:[{ps:[j]}],pe:[{pe:[j]}],pt:[{pt:[j]}],pr:[{pr:[j]}],pb:[{pb:[j]}],pl:[{pl:[j]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Te,s]}],"min-w":[{"min-w":[Te,s,"min","max","fit"]}],"max-w":[{"max-w":[Te,s,"none","full","min","max","fit","prose",{screen:[tr]},tr]}],h:[{h:[Te,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Te,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Te,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Te,s,"auto","min","max","fit"]}],"font-size":[{text:["base",tr,er]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ii]}],"font-family":[{font:[Fn]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Te]}],"line-clamp":[{"line-clamp":["none",tn,ii]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ls,Te]}],"list-image":[{"list-image":["none",Te]}],"list-style-type":[{list:["none","disc","decimal",Te]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...te(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ls,er]}],"underline-offset":[{"underline-offset":["auto",Ls,Te]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Te]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Te]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Y(),W0]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",V0]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},H0]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[b]}],"gradient-via":[{via:[b]}],"gradient-to":[{to:[b]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...te(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:te()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...te()]}],"outline-offset":[{"outline-offset":[Ls,Te]}],"outline-w":[{outline:[Ls,er]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:T()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Ls,er]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",tr,q0]}],"shadow-color":[{shadow:[Fn]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...xe(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":xe()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",tr,Te]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[u]}],saturate:[{saturate:[N]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Te]}],duration:[{duration:Pe()}],ease:[{ease:["linear","in","out","in-out",Te]}],delay:[{delay:Pe()}],animate:[{animate:["none","spin","ping","pulse","bounce",Te]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[g]}],"scale-x":[{"scale-x":[g]}],"scale-y":[{"scale-y":[g]}],rotate:[{rotate:[In,Te]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Te]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Te]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Te]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ls,er,ii]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},X0=k0(Q0);function ge(...t){return X0(fu(t))}const Z0=Kg,Du=l.forwardRef(({className:t,...s},r)=>e.jsx(iu,{ref:r,className:ge("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));Du.displayName=iu.displayName;const ev=ga("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Au=l.forwardRef(({className:t,variant:s,...r},n)=>e.jsx(lu,{ref:n,className:ge(ev({variant:s}),t),...r}));Au.displayName=lu.displayName;const tv=l.forwardRef(({className:t,...s},r)=>e.jsx(uu,{ref:r,className:ge("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));tv.displayName=uu.displayName;const sv=l.forwardRef(({className:t,...s},r)=>e.jsx(mu,{ref:r,className:ge("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(sa,{className:"h-4 w-4"})}));sv.displayName=mu.displayName;const rv=l.forwardRef(({className:t,...s},r)=>e.jsx(cu,{ref:r,className:ge("text-sm font-semibold [&+div]:text-xs",t),...s}));rv.displayName=cu.displayName;const nv=l.forwardRef(({className:t,...s},r)=>e.jsx(du,{ref:r,className:ge("text-sm opacity-90",t),...s}));nv.displayName=du.displayName;const av=3,ov=1e6;let li=0;function iv(){return li=(li+1)%Number.MAX_SAFE_INTEGER,li.toString()}const Ln=new Map,lv=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,av)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===s.toast.id?{...r,...s.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=s;return r===void 0?{...t,toasts:t.toasts.map(n=>({...n,open:!1}))}:{...t,toasts:t.toasts.map(n=>n.id===r?{...n,open:!1}:n)}}case"REMOVE_TOAST":{const{toastId:r}=s;return r===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==r)}}}},Eu=l.createContext(null);let $i=null;function bl(){const t=l.useContext(Eu);if(!t)throw console.error("[ToastContext] useToast called outside of ToastProvider"),new Error("useToast must be used within a ToastProvider");return t}function Tu({children:t}){const[s,r]=l.useReducer(lv,{toasts:[]});l.useEffect(()=>(console.log("[ToastContext] Provider mounted"),()=>{console.log("[ToastContext] Provider unmounted")}),[]);const n=l.useCallback(d=>{const m=iv();console.log(`[ToastContext] Adding toast: ${m}`,d);const h={...d,id:m,open:!0,onOpenChange:u=>{u||o(m)}};return r({type:"ADD_TOAST",toast:h}),m},[r]),a=l.useCallback(d=>{console.log(`[ToastContext] Updating toast: ${d.id}`,d),r({type:"UPDATE_TOAST",toast:d})},[r]),o=l.useCallback(d=>{console.log(`[ToastContext] Dismissing toast: ${d||"all"}`),r({type:"DISMISS_TOAST",toastId:d})},[r]),i=l.useCallback(d=>{console.log(`[ToastContext] Removing toast: ${d||"all"}`),d!==void 0&&Ln.has(d)&&(clearTimeout(Ln.get(d)),Ln.delete(d)),r({type:"REMOVE_TOAST",toastId:d})},[r]);l.useEffect(()=>{s.toasts.forEach(d=>{if(!d.open&&!Ln.has(d.id)){const m=setTimeout(()=>{i(d.id)},ov);Ln.set(d.id,m)}})},[s.toasts,i]);const c={toasts:s.toasts,addToast:n,removeToast:i,updateToast:a,dismissToast:o};return $i=c,console.log("[ToastContext] Rendering with state:",s),e.jsxs(Eu.Provider,{value:c,children:[t,e.jsxs(Z0,{children:[s.toasts.map(({id:d,title:m,description:h,action:u,...f})=>e.jsxs(Au,{...f,children:[m&&e.jsx("div",{className:"grid gap-1",children:m}),h&&e.jsx("div",{className:"text-sm opacity-90",children:h}),u]},d)),e.jsx(Du,{})]})]})}function Le(t){try{return $i?$i.addToast(t):(console.warn("[ToastContext] Toast context not available yet. Toast will not be displayed."),console.log("[ToastContext] Toast props:",t),"")}catch(s){return console.error("[ToastContext] Error displaying toast:",s),console.log("[ToastContext] Toast props:",t),""}}Le.success=function(t){return Le({...t,variant:"default"})};Le.error=function(t){return Le({...t,variant:"destructive"})};Le.warning=function(t){return Le({...t,variant:"warning"})};Le.info=function(t){return Le({...t,variant:"info"})};const Mu=l.createContext(void 0),Ia="salesperson",bs="finance_manager",On=1,cv=new Map,ut=(t,s)=>{const r=new Date().toISOString();console.log(`[AuthContext][${r}] ${t}`,{...s,app_version:"1.0.0",environment:"production",timestamp:r});try{typeof window<"u"&&(window.authEvents||(window.authEvents=[]),window.authEvents.length>100&&window.authEvents.shift(),window.authEvents.push({event:t,details:s,timestamp:r}))}catch(o){console.error("[AuthContext] Error logging auth event to window object:",o)}},Mc=(t,s)=>{const r=new Date().toISOString();console.warn(`[SecurityEvent][${r}] ${t}`,{...s,user_agent:navigator.userAgent,app_url:window.location.href,timestamp:r})},dv=({children:t})=>{const[s,r]=l.useState(null),[n,a]=l.useState(null),[o,i]=l.useState(!0),[c,d]=l.useState(!1),[m,h]=l.useState(!1),u=l.useRef(0),f=l.useRef(!1),[b,p]=l.useState(null),[x,v]=l.useState(null),[y,j]=l.useState(null),[N,g]=l.useState(null),[w,S]=l.useState(!1),[P,E]=l.useState(!1),D=async M=>{var re;try{console.warn(`[DEBUG AUTH] Fetching profile data for user ${M}`);const{data:ne,error:O}=await J.from("profiles").select("*").eq("id",M).maybeSingle();return O?(console.error("[DEBUG AUTH] Error fetching profile:",O),null):ne?(console.warn("[DEBUG AUTH] Profile data found:",ne),console.warn("[DEBUG AUTH] Group admin detection:",{isGroupAdmin:!!ne.is_group_admin,userEmail:ne.email,userRole:ne.role,userData:ne,userMetadata:s==null?void 0:s.user_metadata}),!ne.is_group_admin&&((re=s==null?void 0:s.user_metadata)!=null&&re.is_group_admin)&&(console.warn("[DEBUG AUTH] Group admin flag found in user metadata"),S(!0)),ne.is_group_admin?(console.warn("[DEBUG AUTH] User is a group admin!"),S(!0)):(console.warn("[DEBUG AUTH] User is not a group admin"),S(!1)),ne):(console.warn("[DEBUG AUTH] No profile data found"),null)}catch(ne){return console.error("[DEBUG AUTH] Error in fetchProfileData:",ne),null}},G=l.useCallback(M=>{ut("Setting dealership context",{dealership_id:M,previous_id:y,user_id:s==null?void 0:s.id,user_email:s==null?void 0:s.email}),j(M),J.from("dealerships").select("name").eq("id",M).single().then(({data:re,error:ne})=>{ne?console.error("[AuthContext] Error fetching dealership name:",ne):re&&(g(re.name),ut("Dealership name fetched",{dealership_id:M,dealership_name:re.name}))}),Tr("set_dealership_context",{userId:s==null?void 0:s.id,dealershipId:M,timestamp:new Date().toISOString()}).catch(re=>{console.error("[AuthContext] Error logging dealership context change:",re)})},[s,y]),se=l.useCallback((M,re)=>{try{Le({title:M,description:re,variant:"default"})}catch(ne){console.error("[AuthContext] Error showing success toast:",ne)}},[]),L=l.useCallback((M,re)=>{try{Le({title:M,description:re,variant:"destructive"})}catch(ne){console.error("[AuthContext] Error showing error toast:",ne)}},[]),T=l.useCallback((M,re)=>{try{Le({title:M,description:re,variant:"info"})}catch(ne){console.error("[AuthContext] Error showing info toast:",ne)}},[]),A=async M=>{try{ut("Checking profile existence",{user_id:M});const{data:re,error:ne}=await J.from("profiles").select("id").eq("id",M).maybeSingle();if(ne)return ut("Profile check error",{user_id:M,error:ne.message,code:ne.code}),!1;const O=!!re;return ut("Profile check result",{user_id:M,exists:O,data:re?"found":"not found"}),O}catch(re){return ut("Profile check exception",{user_id:M,error:re instanceof Error?re.message:String(re)}),!1}},Y=l.useCallback(async M=>{var re,ne;try{ut("Fetching user dealership",{user_id:M});const{data:O,error:ue}=await J.from("users").select("dealership_id, role_id, roles(name)").eq("id",M).maybeSingle();if(!ue&&(O!=null&&O.dealership_id)){if(ut("Fetched dealership from users table",{user_id:M,dealership_id:O.dealership_id,role_id:O.role_id,role_name:(re=O.roles)==null?void 0:re.name}),(ne=O.roles)!=null&&ne.name){const X=O.roles.name.toLowerCase();a(X),v(X),ut("Set user role from users table",{user_id:M,role:X})}return O.dealership_id}const{data:K,error:ce}=await J.from("profiles").select("dealership_id, role").eq("id",M).maybeSingle();if(ce)return ut("Error fetching user dealership from profiles",{user_id:M,error:ce.message,code:ce.code}),null;if(K!=null&&K.role){const X=K.role.toLowerCase();a(X),v(X),ut("Set user role from profiles table",{user_id:M,role:X})}return ut("Fetched dealership from profiles table",{user_id:M,dealership_id:K==null?void 0:K.dealership_id}),K!=null&&K.dealership_id&&J.from("dealerships").select("name").eq("id",K.dealership_id).single().then(({data:X,error:F})=>{F?ut("Error fetching dealership name",{dealership_id:K.dealership_id,error:F.message}):X&&(g(X.name),ut("Set dealership name",{dealership_id:K.dealership_id,dealership_name:X.name}))}),(K==null?void 0:K.dealership_id)||null}catch(O){return ut("Exception fetching user dealership",{user_id:M,error:O instanceof Error?O.message:String(O)}),null}},[]),te=l.useCallback(async M=>{var re,ne,O,ue,K;if(console.log("[AuthContext] fetchUserRole called for userId:",M,{timestamp:new Date().toISOString()}),console.log("[AuthContext] Role debugging - current states:",{currentRole:n,hasSession:c,dealershipId:y,userId:M}),f.current)return console.log("[AuthContext] Profile operation already in progress, waiting...",{userId:M,timestamp:new Date().toISOString()}),u.current<3?(u.current++,await new Promise(ce=>setTimeout(ce,500)),te(M)):(console.warn("[AuthContext] Max retries reached for fetchUserRole, using fallback role",{userId:M,timestamp:new Date().toISOString()}),bs);f.current=!0,u.current=0;try{if(await A(M)){console.log("[AuthContext] Profile exists, fetching role",{userId:M,timestamp:new Date().toISOString()});try{const{data:X,error:F}=await J.from("profiles").select("role, dealership_id").eq("id",M).maybeSingle();if(F)return console.error("[AuthContext] Error fetching role:",F,{userId:M,timestamp:new Date().toISOString()}),bs;if(console.log("[AuthContext] Profile data retrieved:",{profileData:X,hasRole:!!(X!=null&&X.role),rawRole:X==null?void 0:X.role,normalizedRole:(re=X==null?void 0:X.role)==null?void 0:re.toLowerCase(),isDealershipAdmin:((ne=X==null?void 0:X.role)==null?void 0:ne.toLowerCase())==="dealership_admin",timestamp:new Date().toISOString()}),X!=null&&X.dealership_id&&(j(X.dealership_id),console.log("[AuthContext] Set dealership ID:",X.dealership_id)),X!=null&&X.role){const _=X.role.toLowerCase();return console.log("[AuthContext] Role found:",X.role,{normalizedRole:_,userId:M,timestamp:new Date().toISOString()}),_}else return console.log("[AuthContext] Profile exists but no role found, using fallback role",{userId:M,timestamp:new Date().toISOString()}),bs}catch(X){return console.error("[AuthContext] Exception fetching role:",X,{userId:M,timestamp:new Date().toISOString()}),bs}}console.log("[AuthContext] Creating profile with default role",{userId:M,timestamp:new Date().toISOString()}),cv.set(M,!0);try{const{data:X}=await J.auth.getUser(),F={id:M,role:Ia,email:((O=X.user)==null?void 0:O.email)||"",name:((K=(ue=X.user)==null?void 0:ue.user_metadata)==null?void 0:K.name)||"",dealership_id:On};console.log("[AuthContext] Inserting profile with data:",JSON.stringify(F),{timestamp:new Date().toISOString()});const _=async()=>{try{const{error:de}=await J.from("profiles").insert([F]);return{error:de}}catch(de){return{error:de}}},$=new Promise(de=>{setTimeout(()=>{de({error:new Error("Profile insertion timeout")})},5e3)}),{error:Z}=await Promise.race([_(),$]);return Z?(console.error("[AuthContext] Error inserting profile:",Z,{userId:M,timestamp:new Date().toISOString()}),bs):(console.log("[AuthContext] Profile insertion successful",{userId:M,timestamp:new Date().toISOString()}),j(On),Tr("profile_creation",{userId:M,role:Ia,dealershipId:On,timestamp:new Date().toISOString()}).catch(de=>{console.error("[AuthContext] Error logging profile creation:",de)}),Ia)}catch(X){return console.error("[AuthContext] Error in profile creation:",X,{userId:M,timestamp:new Date().toISOString()}),bs}finally{f.current=!1}}catch(ce){return console.error("[AuthContext] Unexpected error in fetchUserRole:",ce,{userId:M,timestamp:new Date().toISOString()}),f.current=!1,bs}},[n]),xe=l.useCallback(async M=>{var re,ne;console.log("[AuthContext] Auth state changed, session exists:",!!M,{timestamp:new Date().toISOString(),userId:((re=M==null?void 0:M.user)==null?void 0:re.id)||"none",event:"auth_state_change"});try{if(d(!!M),M!=null&&M.user){if(r(M.user),console.log("[AuthContext] User set from session:",M.user.email,{userId:M.user.id,timestamp:new Date().toISOString()}),(ne=M.user.user_metadata)!=null&&ne.is_group_admin)console.warn("[AuthContext] Group admin flag found in user metadata, setting isGroupAdmin=true"),S(!0),a("dealer_group_admin"),v("dealer_group_admin");else try{console.warn("[DEBUG AUTH] Checking group admin status during auth state change");const O=await D(M.user.id);if(!w&&M.user.email&&M.user.email.toLowerCase().includes("group")&&M.user.email.toLowerCase().includes("@exampletest.com")){console.warn("[AuthContext] Email pattern suggests group admin but not set in profile/metadata"),S(!0),a("dealer_group_admin"),v("dealer_group_admin");try{await J.from("profiles").update({is_group_admin:!0,role:"dealer_group_admin"}).eq("id",M.user.id),await J.auth.updateUser({data:{is_group_admin:!0,role:"dealer_group_admin"}}),console.warn("[AuthContext] Updated profile and metadata for detected group admin")}catch(K){console.error("[AuthContext] Error updating group admin data:",K)}}}catch(O){console.error("[DEBUG AUTH] Error checking group admin status:",O)}try{u.current=0;const O=await te(M.user.id);if(console.log("[AuthContext] Role fetched successfully:",O,{userId:M.user.id,timestamp:new Date().toISOString()}),a(O),y===null){const ue=await Y(M.user.id);ue&&(j(ue),console.log("[AuthContext] Dealership ID set from profile:",ue),Tr("dealership_assignment",{userId:M.user.id,dealershipId:ue,timestamp:new Date().toISOString()}).catch(K=>{console.error("[AuthContext] Error logging dealership assignment:",K)}))}}catch(O){console.error("[AuthContext] Error fetching role, using fallback:",O,{userId:M.user.id,timestamp:new Date().toISOString()}),a(bs)}}else console.log("[AuthContext] No session, clearing user and role",{timestamp:new Date().toISOString()}),r(null),a(null),j(null)}catch(O){console.error("[AuthContext] Error in handleAuthStateChange:",O,{sessionExists:!!M,timestamp:new Date().toISOString()})}finally{i(!1),E(!0)}},[te,Y,y,w]);l.useEffect(()=>{let M=!0,re=null;(async()=>{var ue;if(!m)try{console.log("[AuthContext] Initializing auth context",{timestamp:new Date().toISOString()});const{data:{session:K},error:ce}=await J.auth.getSession();if(ce){console.error("[AuthContext] Error getting initial session:",ce,{timestamp:new Date().toISOString()}),M&&(i(!1),E(!0),p(ce));return}if(M&&(console.log("[AuthContext] Initial session exists:",!!K,{userId:((ue=K==null?void 0:K.user)==null?void 0:ue.id)||"none",timestamp:new Date().toISOString()}),d(!!K)),K!=null&&K.user&&M){console.log("[AuthContext] Found initial session for user:",K.user.email,{userId:K.user.id,timestamp:new Date().toISOString()}),r(K.user);try{console.warn("[DEBUG AUTH] Checking group admin status during initialization"),await D(K.user.id)}catch(X){console.error("[DEBUG AUTH] Error checking group admin status:",X)}try{const X=await te(K.user.id);M&&(console.log("[AuthContext] Setting initial role:",X,{userId:K.user.id,timestamp:new Date().toISOString()}),a(X))}catch(X){console.error("[AuthContext] Error fetching initial role, using fallback:",X,{userId:K.user.id,timestamp:new Date().toISOString()}),M&&(console.log("[AuthContext] Setting fallback role due to error",{role:bs,timestamp:new Date().toISOString()}),a(bs))}}M&&(i(!1),E(!0)),M&&(re=await J.auth.onAuthStateChange(async(X,F)=>{var _,$;if(M){if(console.log("[AuthContext] Auth event:",X,{userId:((_=F==null?void 0:F.user)==null?void 0:_.id)||"none",email:(($=F==null?void 0:F.user)==null?void 0:$.email)||"none",timestamp:new Date().toISOString()}),d(!!F),X==="INITIAL_SESSION"&&s&&n){console.log("[AuthContext] Skipping INITIAL_SESSION - already initialized",{userId:s.id,role:n,timestamp:new Date().toISOString()});return}await xe(F)}})),M&&h(!0)}catch(K){console.error("[AuthContext] Error in initialization:",K,{timestamp:new Date().toISOString()}),M&&(i(!1),E(!0),p(K instanceof Error?K:new Error("Unknown initialization error")))}})();const O=setTimeout(()=>{M&&o&&(console.error("[AuthContext] Safety timeout reached - forcing loading state to false"),i(!1),E(!0))},5e3);return()=>{var ue;M=!1,clearTimeout(O),(ue=re==null?void 0:re.data)!=null&&ue.subscription&&re.data.subscription.unsubscribe()}},[xe,m,s,n,te,o]);const le=async(M,re,ne)=>{var O,ue,K,ce,X;try{if(ut("Sign in attempt",{email:M,remember_me:!!ne,timestamp:new Date().toISOString()}),i(!0),p(null),console.log("[AuthContext] Signing in user:",M,{timestamp:new Date().toISOString(),rememberMe:!!ne}),xo(M)){console.log("[AuthContext] Test email detected, using special login flow");const we=await ic(M,re);if(we.error)throw we.error;const De=(O=we.data)==null?void 0:O.session;if(!De)throw new Error("No session returned from test login");console.log("[AuthContext] Test login successful for:",M,we),r(De.user),d(!0);const Ee=localStorage.getItem("force_redirect_after_login"),He=localStorage.getItem("force_redirect_timestamp"),$e=He&&Date.now()-parseInt(He)<1e4;if(Ee&&$e){console.log("[AuthContext] Force redirect detected for test user to:",Ee),localStorage.removeItem("force_redirect_after_login"),localStorage.removeItem("force_redirect_timestamp"),i(!1),se("Welcome Back!","Login successful - redirecting..."),window.location.href=Ee;return}const zt=M.toLowerCase().includes("group")&&M.toLowerCase().includes("@exampletest.com");if(w||we.isGroupAdmin){console.warn("[AuthContext] GROUP ADMIN test account detected, forcing immediate redirect"),i(!1),se("Welcome Back!","Group Admin login successful"),window.location.href="/group-admin";return}if(we.isGroupAdmin)console.log("[AuthContext] Direct group admin flag detected, setting isGroupAdmin=true"),S(!0),a("dealer_group_admin"),v("dealer_group_admin");else if(console.warn("[DEBUG AUTH] Checking group admin status after test login"),(ue=De.user)!=null&&ue.id){const ct=await D(De.user.id),pt=await Y(De.user.id);if(pt&&j(pt),ct!=null&&ct.role){const Qe=ct.role.toLowerCase();a(Qe),v(Qe)}}se("Welcome back!","You have successfully signed in as a test user."),i(!1);return}const{data:F,error:_}=await J.auth.signInWithPassword({email:M,password:re,options:{persistSession:ne??!1}});if(_)throw console.error("[AuthContext] Sign in error:",_),_;if(!F.user)throw console.error("[AuthContext] No user returned from authentication"),new Error("No user returned from authentication");console.log("[AuthContext] User authenticated successfully:",F.user.id),r(F.user),d(!0),console.warn("[DEBUG AUTH] Checking group admin status after login");const $=await D(F.user.id),Z=((K=F.user.email)==null?void 0:K.toLowerCase().includes("group"))&&((ce=F.user.email)==null?void 0:ce.toLowerCase().includes("@exampletest.com"));if(w||$!=null&&$.is_group_admin||Z||(X=F.user.user_metadata)!=null&&X.is_group_admin){console.warn("[DEBUG AUTH] Group admin detected, forcing immediate redirect"),i(!1),se("Sign In Successful","Welcome, Group Admin!"),setTimeout(()=>{window.location.href="/group-admin"},100);return}const de=await Y(F.user.id);de?(j(de),console.log(`[AuthContext] User belongs to dealership: ${de}`)):(console.log("[AuthContext] No dealership found for user, using default"),j(On)),se("Sign In Successful",`Welcome back, ${M}!`)}catch(F){ut("Sign in error",{email:M,error:F instanceof Error?F.message:String(F)}),Mc("Failed login attempt",{email:M,error:F instanceof Error?F.message:String(F),ip_address:"client-side"}),p(F instanceof Error?F:new Error("Unknown error occurred during sign in")),L("Sign In Failed",F instanceof Error?F.message:"Unknown error occurred during sign in")}finally{i(!1)}},Q=async(M,re,ne)=>{if(console.log("[AuthContext] Signing up:",M,{timestamp:new Date().toISOString()}),!(!M||!re||!ne))try{i(!0);const{data:O,error:ue}=await J.auth.signUp({email:M,password:re,options:{data:{first_name:ne.firstName,last_name:ne.lastName}}});if(ue){console.error("[AuthContext] Sign up error:",ue.message,{code:ue.name,timestamp:new Date().toISOString()}),p(ue),L("Sign up failed",ue.message);return}if(O.user){try{console.log("[AuthContext] Creating profile for new user:",O.user.id,{email:M,timestamp:new Date().toISOString()});const{error:K}=await J.from("profiles").insert([{id:O.user.id,email:M,name:`${ne.firstName} ${ne.lastName}`,role:Ia,dealership_id:On}]);K?console.error("[AuthContext] Error creating profile during signup:",K,{userId:O.user.id,timestamp:new Date().toISOString()}):console.log("[AuthContext] Profile successfully created during signup",{userId:O.user.id,timestamp:new Date().toISOString()})}catch(K){console.error("[AuthContext] Exception creating profile during signup:",K,{userId:O.user.id,timestamp:new Date().toISOString()})}console.log("[AuthContext] Sign up successful for:",M,{userId:O.user.id,timestamp:new Date().toISOString()}),se("Account created","Your account has been created successfully")}}catch(O){console.error("[AuthContext] Error in signUp:",O,{email:M,timestamp:new Date().toISOString()});const ue=O instanceof Error?O.message:String(O);p(O instanceof Error?O:new Error(ue)),L("Sign up failed",ue)}finally{i(!1)}},pe=async()=>{try{ut("Sign out initiated",{user_id:s==null?void 0:s.id,email:s==null?void 0:s.email}),console.log("[AuthContext] Signing out user:",s==null?void 0:s.email,{userId:s==null?void 0:s.id,timestamp:new Date().toISOString()});try{localStorage.setItem("logout_in_progress","true"),i(!0),T("Signing Out","Please wait while we sign you out...")}catch(M){console.error("[AuthContext] Error during pre-logout cleanup:",M)}console.log("[AuthContext] Redirecting to logout page"),window.location.href="/logout";return}catch(M){ut("Sign out error",{user_id:s==null?void 0:s.id,error:M instanceof Error?M.message:String(M)}),console.error("[AuthContext] Error during signOut:",M),p(M instanceof Error?M:new Error("Unknown error occurred during sign out")),L("Sign Out Failed",M instanceof Error?M.message:"Unknown error occurred"),window.location.href="/logout"}finally{i(!1)}},Pe=l.useCallback(async(M,re,ne={})=>{try{console.log(`[AuthContext] Fetching data from schema for dealership: ${M}, table: ${re}`,{timestamp:new Date().toISOString(),query:ne});const{data:O,error:ue}=await J.from("dealerships").select("schema_name").eq("id",M).single();if(ue||!(O!=null&&O.schema_name))return console.error(`[AuthContext] Error fetching schema name for dealership ${M}:`,ue),{data:null,error:ue||new Error("No schema name found for dealership")};const K=O.schema_name;console.log(`[AuthContext] Using schema: ${K} for dealership: ${M}`);let ce=J.from(`${K}.${re}`);if(ne.select?ce=ce.select(ne.select):ce=ce.select("*"),ne.filters)for(const _ of ne.filters)_.type==="eq"?ce=ce.eq(_.column,_.value):_.type==="in"?ce=ce.in(_.column,_.value):_.type==="gt"?ce=ce.gt(_.column,_.value):_.type==="lt"&&(ce=ce.lt(_.column,_.value));ne.order&&(ce=ce.order(ne.order.column,{ascending:ne.order.ascending})),ne.limit&&(ce=ce.limit(ne.limit));const{data:X,error:F}=await ce;return F?(console.error(`[AuthContext] Error fetching data from ${K}.${re}:`,F),{data:null,error:F}):(console.log(`[AuthContext] Successfully fetched data from ${K}.${re}:`,{count:X==null?void 0:X.length}),{data:X,error:null})}catch(O){return console.error("[AuthContext] Exception in fetchFromDealershipSchema:",O),{data:null,error:O instanceof Error?O:new Error("Unknown error")}}},[]),qe={user:s,role:n,signIn:le,signUp:Q,signOut:pe,loading:o,hasSession:c,error:b,userRole:x,dealershipId:y,setDealershipContext:G,currentDealershipName:N,fetchFromDealershipSchema:Pe,magicLinkLogin:async M=>{console.log(`[AuthContext] Magic link login attempt for ${M}`),i(!0),p(null);try{const{data:re,error:ne}=await J.auth.signInWithOtp({email:M,options:{shouldCreateUser:!1}});if(ne)throw console.error("[AuthContext] Magic link error:",ne),ne;console.log("[AuthContext] Magic link sent successfully"),se("Magic Link Sent",`Check your email (${M}) for a login link. For test accounts, you can check the console for the magic link.`)}catch(re){if(console.error("[AuthContext] Magic link process failed:",re),re instanceof Error)p(re),L("Magic Link Failed",re.message);else{const ne=new Error("An unknown error occurred during magic link generation");p(ne),L("Magic Link Failed","An unknown error occurred")}}finally{i(!1)}},loginTestAccount:ic,logAccessAttempt:(M,re,ne)=>{ut(re?"Access granted":"Access denied",{path:M,user_id:s==null?void 0:s.id,email:s==null?void 0:s.email,role:n||x,dealership_id:y,dealership_name:N,details:ne,allowed:re}),re||Mc("Unauthorized access attempt",{path:M,user_id:s==null?void 0:s.id,email:s==null?void 0:s.email,role:n||x})},isGroupAdmin:w,authCheckComplete:P};return e.jsx(Mu.Provider,{value:qe,children:t})},et=()=>{const t=l.useContext(Mu);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},B=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:ge("rounded-xl border bg-card text-card-foreground shadow",t),...s}));B.displayName="Card";const W=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:ge("flex flex-col space-y-1.5 p-6",t),...s}));W.displayName="CardHeader";const z=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:ge("font-semibold leading-none tracking-tight",t),...s}));z.displayName="CardTitle";const Be=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:ge("text-sm text-muted-foreground",t),...s}));Be.displayName="CardDescription";const V=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:ge("p-6 pt-0",t),...s}));V.displayName="CardContent";const $t=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:ge("flex items-center p-6 pt-0",t),...s}));$t.displayName="CardFooter";const uv=ga("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),I=l.forwardRef(({className:t,variant:s,size:r,asChild:n=!1,...a},o)=>{const i=n?ig:"button";return e.jsx(i,{className:ge(uv({variant:s,size:r,className:t})),ref:o,...a})});I.displayName="Button";const be=l.forwardRef(({className:t,type:s,...r},n)=>e.jsx("input",{type:s,className:ge("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...r}));be.displayName="Input";var mv="Label",ku=l.forwardRef((t,s)=>e.jsx(je.label,{...t,ref:s,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));ku.displayName=mv;var Ru=ku;const hv=ga("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fe=l.forwardRef(({className:t,...s},r)=>e.jsx(Ru,{ref:r,className:ge(hv(),t),...s}));fe.displayName=Ru.displayName;function fv(){const{signIn:t,magicLinkLogin:s,hasSession:r,user:n,role:a,userRole:o}=et(),[i,c]=l.useState(""),[d,m]=l.useState(""),[h,u]=l.useState(""),[f,b]=l.useState(!1),[p,x]=l.useState(0),[v,y]=l.useState(!1),[j,N]=l.useState(!1),[g,w]=l.useState(!1),[S,P]=l.useState(!1),[E,D]=l.useState(!1),G=St(),se=yt(),[L,T]=l.useState(""),[A,Y]=l.useState(""),[te,xe]=l.useState(""),[le,Q]=l.useState(null);l.useEffect(()=>{var ne,O;const re=new Date().toISOString();return console.log("[AUTH DEBUG][LoginForm] Mounted",{timestamp:re,hasSession:r,from:((O=(ne=G.state)==null?void 0:ne.from)==null?void 0:O.pathname)||"direct",path:G.pathname,userEmail:n==null?void 0:n.email}),()=>{console.log("[AUTH DEBUG][LoginForm] Unmounted",{timestamp:new Date().toISOString(),hasSession:r}),le&&clearTimeout(le)}},[G.state,r,G.pathname,n,le]),l.useEffect(()=>{if(v&&n&&r){console.log("[AUTH DEBUG][LoginForm] Test admin account detected and authenticated");const re=setTimeout(()=>{console.log("[AUTH DEBUG][LoginForm] Redirecting test admin to master-admin after delay"),se("/master-admin")},500);return()=>clearTimeout(re)}},[v,n,r,se]),l.useEffect(()=>{if(j&&n&&r){console.log("[AUTH DEBUG][LoginForm] Dealer group admin account detected and authenticated",{email:n.email,id:n.id,hasSession:r,role:a||o,userData:n.user_metadata}),console.log("[AUTH DEBUG][LoginForm] Forcing immediate redirection to group-admin"),window.location.href="/group-admin";return}},[j,n,r,se,a,o]);const pe=()=>i?i.includes("@")?d?d.length<6?"Password must be at least 6 characters":null:"Password is required":"Invalid email format":"Email is required",Pe=re=>re.toLowerCase().includes("group")&&re.toLowerCase().includes("@exampletest.com"),Oe=re=>re.toLowerCase().includes("@exampletest.com")||re.toLowerCase().includes("@example.com"),qe=async re=>{var X,F;re.preventDefault(),le&&clearTimeout(le),b(!0),u(""),x(_=>_+1);const ne=Oe(i),O=i.toLowerCase()==="testadmin@example.com",ue=i.toLowerCase()==="dealer1.admin@exampletest.com",K=Pe(i);y(O),N(K),console.log("[AUTH DEBUG][LoginForm] Login attempt details:",{email:i,isTestEmail:ne,isTestAdmin:O,isDealerAdmin:ue,isGroupAdmin:K,rememberMe:E,timestamp:new Date().toISOString(),attempt_number:p+1});const ce=window.setTimeout(()=>{console.error("[AUTH DEBUG][LoginForm] Login timeout reached after 8 seconds"),J.auth.getSession().then(({data:_,error:$})=>{var Z;if(console.log("[AUTH DEBUG][LoginForm] Emergency session check:",{hasSession:!!(_!=null&&_.session),hasError:!!$,error:$==null?void 0:$.message,timestamp:new Date().toISOString()}),(Z=_==null?void 0:_.session)!=null&&Z.user){console.log("[AUTH DEBUG][LoginForm] Session exists despite timeout - forcing navigation",{email:_.session.user.email,id:_.session.user.id,created_at:_.session.user.created_at,expires_at:_.session.expires_at,last_sign_in_at:_.session.user.last_sign_in_at});const de=_.session.user.email||"";Pe(de)?window.location.href="/group-admin":de.toLowerCase()==="testadmin@example.com"?window.location.href="/master-admin":de.toLowerCase().includes("admin@exampletest.com")?window.location.href="/dashboard/admin":window.location.href="/dashboard"}else b(!1),u("Login attempt timed out. Please try again."),$&&(console.error("[AUTH DEBUG][LoginForm] Supabase session check error:",{error:$.message,code:$.code,details:$.details,hint:$.hint}),$.hint&&u(`Login timed out: ${$.hint}. Please try again.`))}).catch(_=>{console.error("[AUTH DEBUG][LoginForm] Error checking session during timeout:",{error:_.message,stack:_.stack,timestamp:new Date().toISOString()}),b(!1),u("Login attempt timed out. Please try again.")})},8e3);Q(ce);try{const _=pe();if(_){console.log("[AUTH DEBUG][LoginForm] Input validation failed:",_),u(_),b(!1),clearTimeout(ce);return}if(console.log("[AUTH DEBUG][LoginForm] Attempting login for",i),ne){console.log("[AUTH DEBUG][LoginForm] Using enhanced test user flow");const $=Date.now(),Z=await t(i,d,E),de=Date.now();console.log("[AUTH DEBUG][LoginForm] signIn call completed",{durationMs:de-$,success:!!(Z!=null&&Z.user),error:(X=Z==null?void 0:Z.error)==null?void 0:X.message,timestamp:new Date().toISOString()});const we=Date.now(),{data:De,error:Ee}=await J.auth.getSession(),He=Date.now();if(console.log("[AUTH DEBUG][LoginForm] Session check after login",{durationMs:He-we,hasSession:!!(De!=null&&De.session),sessionError:Ee==null?void 0:Ee.message,timestamp:new Date().toISOString()}),De!=null&&De.session){console.log("[AUTH DEBUG][LoginForm] Test user authenticated successfully",{session_expires_at:De.session.expires_at,user_id:De.session.user.id,user_email:De.session.user.email}),console.log("[AUTH DEBUG][LoginForm] Redirecting to test login handler"),clearTimeout(ce),setTimeout(()=>{window.location.href="/test-login-redirect"},500);return}else if(Ee)throw new Error(`Session error: ${Ee.message}`)}else{const $=Date.now(),Z=await t(i,d,E),de=Date.now();if(console.log("[AUTH DEBUG][LoginForm] Regular user signIn completed",{durationMs:de-$,success:!!(Z!=null&&Z.user),error:(F=Z==null?void 0:Z.error)==null?void 0:F.message,timestamp:new Date().toISOString()}),Z!=null&&Z.error)throw new Error(Z.error.message)}console.log("[AUTH DEBUG][LoginForm] Login successful, checking user type"),clearTimeout(ce),b(!1)}catch(_){console.error("[AUTH DEBUG][LoginForm] Login failed:",{error:_ instanceof Error?_.message:String(_),stack:_ instanceof Error?_.stack:"No stack trace",timestamp:new Date().toISOString()}),clearTimeout(ce),Q(null);const $=_ instanceof Error?_.message:"Failed to sign in";u(`Login failed: ${$}`),y(!1),N(!1)}},M=async()=>{if(!i){u("Please enter your email address");return}try{b(!0),await s(i),P(!0)}catch(re){console.error("[LoginForm] Magic link login failed:",re);const ne=re instanceof Error?re.message:"Failed to send magic link";u(`Magic link failed: ${ne}`)}finally{b(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"email",children:"Email"}),e.jsx(be,{id:"email",type:"email",value:i,onChange:re=>c(re.target.value.trim()),placeholder:"Enter your email",required:!0,disabled:f,className:"mt-1"})]}),!S&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{id:"password",type:g?"text":"password",value:d,onChange:re=>m(re.target.value),placeholder:"Enter your password",required:!0,disabled:f,className:"mt-1 pr-10"}),e.jsx("button",{type:"button",className:"absolute right-2 top-[calc(50%-6px)] text-gray-500 hover:text-gray-700",onClick:()=>w(!g),children:g?e.jsx(xl,{size:16}):e.jsx(pl,{size:16})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",checked:E,onChange:re=>D(re.target.checked)}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"#",className:"font-medium text-primary hover:text-primary/80",children:"Forgot password?"})})]}),h&&e.jsx("div",{className:"p-3 rounded bg-red-50 text-red-600 text-sm",children:h}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{type:"submit",disabled:f,className:"flex-1",children:f?"Signing in...":"Sign in"}),e.jsxs(I,{type:"button",variant:"outline",disabled:f||!i,onClick:M,className:"flex items-center",children:[e.jsx(f0,{className:"mr-2 h-4 w-4"}),"Magic Link"]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:`If you're using a test account and get "Email not confirmed" errors, try the Magic Link option above.`}),!1]}),S&&e.jsxs("div",{className:"p-4 rounded-md bg-blue-50 text-blue-800",children:[e.jsx("h3",{className:"font-medium mb-1",children:"Magic Link Sent"}),e.jsx("p",{className:"text-sm",children:"Check your email for a login link. For test accounts, the link might appear in console logs."})]})]})})}const Iu=({show:t=!0})=>{const[s,r]=l.useState(t),[n,a]=l.useState(null),[o,i]=l.useState(""),[c,d]=l.useState([]),{user:m,role:h,loading:u,hasSession:f,authCheckComplete:b,dealershipId:p,userRole:x,isGroupAdmin:v,error:y}=et();if(l.useEffect(()=>{try{d(w=>[...w,`AuthDebugger initialized at ${new Date().toISOString()}`]);const N={};for(let w=0;w<localStorage.length;w++){const S=localStorage.key(w);if(S)try{const P=localStorage.getItem(S);N[S]=P}catch(P){console.error(`Error reading localStorage key ${S}:`,P)}}i(JSON.stringify(N,null,2));const g=localStorage.getItem("sb-undefined-auth-token");if(g)try{a(JSON.parse(g)),d(w=>[...w,"Found session data in localStorage"])}catch(w){console.error("Error parsing session data:",w),d(S=>[...S,`Error parsing session data: ${w.message}`])}else d(w=>[...w,"No session found in localStorage"])}catch(N){console.error("Error accessing localStorage:",N),d(g=>[...g,`Error accessing localStorage: ${N.message}`])}},[]),l.useEffect(()=>{d(N=>[...N,`Auth state update at ${new Date().toISOString()} - loading: ${u}, hasSession: ${f}, authCheckComplete: ${b}`])},[u,f,b]),!s)return e.jsx("div",{className:"fixed bottom-4 right-4 p-2 bg-yellow-100 rounded shadow cursor-pointer",onClick:()=>r(!0),children:"Show Auth Debug"});const j=async()=>{d(N=>[...N,`Forcing auth recheck at ${new Date().toISOString()}`]);try{const{data:N,error:g}=await J.auth.getSession();if(g){d(w=>[...w,`Error getting session: ${g.message}`]);return}if(N!=null&&N.session){d(S=>[...S,"Session exists but not properly recognized by app, fixing..."]);const w=JSON.stringify({access_token:N.session.access_token,refresh_token:N.session.refresh_token,expires_at:Math.floor(Date.now()/1e3)+3600});localStorage.setItem("sb-undefined-auth-token",w),d(S=>[...S,"Session manually updated in localStorage"]),window.location.reload()}else d(w=>[...w,"No active session found"])}catch(N){d(g=>[...g,`Error in auth recheck: ${N.message}`])}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 text-white p-4 z-50 overflow-auto",children:e.jsxs("div",{className:"max-w-3xl mx-auto bg-gray-900 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Authentication Debugger"}),e.jsx("button",{className:"bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded",onClick:()=>r(!1),children:"Close"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-3 rounded",children:[e.jsx("h3",{className:"font-bold mb-2",children:"Authentication State"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Loading:"})," ",u?"":""]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Auth Check Complete:"})," ",b?"":""]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Has Session:"})," ",f?"":""]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"User:"})," ",m?m.email:"Not logged in"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Role:"})," ",h||"Unknown"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"User Role:"})," ",x||"Unknown"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Is Group Admin:"})," ",v?"":""]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Dealership ID:"})," ",p||"None"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400",children:"Error:"}),y?e.jsx("span",{className:"text-red-400",children:y.message}):"None"]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-3 rounded",children:[e.jsx("h3",{className:"font-bold mb-2",children:"Session Storage"}),e.jsx("p",{className:"mb-2 text-sm",children:n?`Session expires: ${new Date(n.expires_at*1e3).toLocaleTimeString()}`:"No session in localStorage"}),e.jsx("button",{className:"bg-blue-700 hover:bg-blue-600 px-3 py-1 rounded text-sm",onClick:j,children:"Force Auth Recheck"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 p-3 rounded",children:[e.jsx("h3",{className:"font-bold mb-2",children:"Auth Event Log"}),e.jsx("div",{className:"h-32 overflow-y-auto text-xs font-mono bg-black/50 p-2 rounded",children:c.map((N,g)=>e.jsx("div",{className:"mb-1",children:N},g))})]}),e.jsxs("div",{className:"bg-gray-800 p-3 rounded",children:[e.jsx("h3",{className:"font-bold mb-2",children:"Raw Local Storage"}),e.jsx("pre",{className:"h-32 overflow-auto text-xs bg-black/50 p-2 rounded",children:o})]})]})]})})},xv=({placement:t="bottom-right"})=>{const[s,r]=l.useState(!1),n={"top-right":"top-4 right-4","bottom-right":"bottom-4 right-4","top-left":"top-4 left-4","bottom-left":"bottom-4 left-4"}[t];return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`fixed ${n} z-50 bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded-lg shadow-lg text-xs`,onClick:()=>r(!0),children:"Debug Auth"}),s&&e.jsx(Iu,{show:!0})]})},pv=()=>{var u,f,b;const{user:t,loading:s,hasSession:r,isGroupAdmin:n}=et(),a=yt(),o=St(),[i,c]=l.useState(!1),d=new URLSearchParams(o.search),m=d.has("noredirect"),h=d.has("forcelogin");if(l.useEffect(()=>{let p;return s&&(console.log("[AuthPage] Setting safety timeout for loading state"),p=window.setTimeout(()=>{console.error("[AuthPage] Loading timeout reached"),c(!0)},1e4)),()=>{p&&window.clearTimeout(p)}},[s]),l.useEffect(()=>{var p,x;if(m||h){console.log("[AuthPage] Skipping redirects due to query parameters");return}if(t&&t.email&&!s){const v=t.email.toLowerCase().includes("group")&&t.email.toLowerCase().includes("@exampletest.com");(v||n||(p=t.user_metadata)!=null&&p.is_group_admin)&&(console.log("[AuthPage] *** GROUP ADMIN DETECTED - FORCING DIRECT REDIRECT ***",{email:t.email,byEmail:v,byFlag:n,byMetadata:(x=t.user_metadata)==null?void 0:x.is_group_admin}),window.location.href="/group-admin")}},[t,s,n,m,h]),l.useEffect(()=>{var p,x,v;if(console.log("[AuthPage] Auth state changed:",{hasUser:!!t,hasSession:r,loading:s,email:t==null?void 0:t.email,isGroupAdmin:n,noRedirect:m,forceLogin:h,timestamp:new Date().toISOString()}),m||h){console.log("[AuthPage] Skipping redirects due to query parameters");return}if(t&&r&&!s){if(((p=t.email)==null?void 0:p.toLowerCase().includes("group"))&&((x=t.email)==null?void 0:x.toLowerCase().includes("@exampletest.com"))||n||(v=t.user_metadata)!=null&&v.is_group_admin)return;console.log("[AuthPage] Regular user authenticated, redirecting to dashboard"),a("/dashboard",{replace:!0})}},[t,r,s,a,n,m,h]),s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-orange-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),i&&e.jsxs("div",{className:"text-sm text-white max-w-md text-center mt-4 flex items-center gap-2 bg-orange-600 p-2 rounded border border-orange-400",children:[e.jsx(va,{className:"h-4 w-4 text-orange-200"}),e.jsx("span",{children:"Taking longer than expected. Please try refreshing the page if this continues."})]})]})});if(h||m)console.log("[AuthPage] Showing login form due to query parameters");else if(t&&r)return((u=t.email)==null?void 0:u.toLowerCase().includes("group"))&&((f=t.email)==null?void 0:f.toLowerCase().includes("@exampletest.com"))||n||(b=t.user_metadata)!=null&&b.is_group_admin?(console.log("[AuthPage] Group admin authenticated, redirecting to group admin dashboard"),e.jsx(bt,{to:"/group-admin",replace:!0})):(console.log("[AuthPage] User is already authenticated, redirecting to dashboard"),e.jsx(bt,{to:"/dashboard",replace:!0}));return e.jsxs("div",{className:"min-h-screen bg-orange-500",children:[e.jsx("div",{className:"h-24 bg-black flex items-center justify-center",children:e.jsx("h1",{className:"text-white text-3xl font-bold text-center",children:"The DAS Board"})}),e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(B,{className:"bg-white",children:[e.jsxs(W,{className:"space-y-1",children:[e.jsx(z,{className:"text-2xl font-bold text-center text-gray-800",children:"The DAS Board Login"}),(h||m)&&e.jsx("p",{className:"text-sm text-center text-green-600",children:"Force login mode active - you can log in again"})]}),e.jsx(V,{children:e.jsx(fv,{})}),e.jsxs($t,{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Don't have an account? Contact your administrator."}),e.jsxs("div",{className:"text-center mt-2 flex flex-col gap-1",children:[e.jsx("a",{href:"/debug-auth",className:"text-xs text-blue-600 hover:text-blue-800 hover:underline",children:"Test User Login"}),e.jsx("a",{href:"/direct-login",className:"text-xs text-blue-600 hover:text-blue-800 hover:underline font-bold",children:"Reliable Direct Login"}),e.jsx("a",{href:"/force-login",className:"text-xs text-red-600 hover:text-red-800 hover:underline",children:"Emergency Force Login"}),e.jsx("a",{href:"/group-admin-bypass?auto=true",className:"text-xs text-green-600 hover:text-green-800 hover:underline font-bold",children:" Direct Group Admin Login "}),e.jsx("a",{href:"/logout",className:"text-xs text-red-600 hover:text-red-800 hover:underline mt-2",children:"Force Logout"})]})]})]})})}),e.jsx(xv,{placement:"bottom-right"})]})},Kt=[{id:"test-admin-id",email:"testadmin@example.com",role:"admin",isAdmin:!0,name:"Test Admin"},{id:"group-admin-id",email:"group1.admin@exampletest.com",role:"dealer_group_admin",isGroupAdmin:!0,name:"Group Admin"},{id:"dealership-admin-id",email:"dealer1.admin@exampletest.com",role:"dealership_admin",dealershipId:1,name:"Dealership Admin"},{id:"sales-manager-id",email:"sales.manager@exampletest.com",role:"sales_manager",dealershipId:1,name:"Sales Manager"},{id:"sales-id",email:"sales@exampletest.com",role:"salesperson",dealershipId:1,name:"Salesperson"}],yl="direct_auth_user",Fu="directauth_user";function Lu(t){const s=Kt.find(r=>r.email.toLowerCase()===t.toLowerCase());return s?(localStorage.setItem(yl,JSON.stringify(s)),{success:!0,message:`Logged in as ${s.name||s.email}`}):{success:!1,message:`No test account found for ${t}`}}function gr(){const t=localStorage.getItem(yl);if(t)try{return JSON.parse(t)}catch(r){console.error("[directAuth] Error parsing user from STORAGE_KEY",r)}const s=localStorage.getItem(Fu);if(s)try{return console.log("[directAuth] Found user from dashboard selector"),JSON.parse(s)}catch(r){console.error("[directAuth] Error parsing user from DASHBOARD_SELECTOR_KEY",r)}return null}function $r(){return gr()!==null}function Ou(){console.log("[directAuth] Logging out - clearing all auth keys"),localStorage.removeItem(yl),localStorage.removeItem(Fu),localStorage.removeItem("directauth_timestamp"),localStorage.removeItem("supabase.auth.token")}function Xt(t){return t.isAdmin?"/master-admin":t.isGroupAdmin?"/group-admin":t.role==="dealership_admin"?"/dashboard/admin":t.role==="sales_manager"?"/dashboard/sales-manager":t.role==="finance_manager"?"/dashboard/finance":t.role==="general_manager"?"/dashboard/gm":"/dashboard/sales"}const ft=({children:t,requiredRoles:s=[],requiredDealership:r})=>{var b;const{user:n,loading:a,hasSession:o,userRole:i,dealershipId:c,logAccessAttempt:d,authCheckComplete:m}=et(),h=St(),u="production";if(l.useEffect(()=>{if(h.pathname==="/logout"){console.log("[ProtectedRoute] Logout page accessed, skipping detailed access logging");return}const p=new Date().toISOString();console.log(`[ProtectedRoute][${p}] Checking access to ${h.pathname}`,{user_email:n==null?void 0:n.email,user_id:n==null?void 0:n.id,user_role:i,has_session:o,required_roles:s,user_dealership_id:c,required_dealership:r,is_loading:a,auth_check_complete:m,environment:u,source_path:h.pathname,source_query:h.search})},[n,a,h,i,o,c,s,r,u,m]),h.pathname==="/logout")return console.log("[ProtectedRoute] Allowing access to logout page without auth checks"),e.jsx(e.Fragment,{children:t});if(localStorage.getItem("logout_in_progress")==="true"&&h.pathname!=="/auth")return console.log("[ProtectedRoute] Logout in progress detected, allowing access"),e.jsx(e.Fragment,{children:t});if(a||!m)return console.log(`[ProtectedRoute] Still loading authentication state for ${h.pathname}`,{loading:a,authCheckComplete:m,path:h.pathname}),e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Je,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Verifying your access..."})]})});if($r()){const p=gr();if(p)return console.log("[ProtectedRoute] Direct auth user detected:",p.email),h.pathname==="/logout"?(console.log("[ProtectedRoute] Allowing logout for direct auth user"),e.jsx(e.Fragment,{children:t})):s.length>0&&!s.some(v=>v.toLowerCase()===p.role.toLowerCase())?(console.warn("[ProtectedRoute] Direct auth user doesn't have required role. Redirecting to correct dashboard."),e.jsx(bt,{to:Xt(p),replace:!0})):r&&p.dealershipId!==r?(console.warn("[ProtectedRoute] Direct auth user doesn't belong to required dealership. Redirecting."),e.jsx(bt,{to:Xt(p),replace:!0})):(console.log(`[ProtectedRoute] Direct auth access granted to ${h.pathname}`),e.jsx(e.Fragment,{children:t}))}if(n!=null&&n.email&&xo(n.email)){if(console.log(`[ProtectedRoute] Test user detected: ${n.email}`),n.email==="testadmin@example.com")return console.log("[ProtectedRoute] Test admin account detected"),h.pathname==="/master-admin"?(console.log("[ProtectedRoute] Allowing test admin to access master-admin panel"),e.jsx(e.Fragment,{children:t})):(console.log("[ProtectedRoute] Redirecting test admin to master-admin panel"),e.jsx(bt,{to:"/master-admin",replace:!0}));if(n.email.includes("group")&&n.email.includes("@exampletest.com"))return console.log("[ProtectedRoute] Group admin test account detected"),h.pathname==="/group-admin"?(console.log("[ProtectedRoute] Allowing group admin to access group-admin panel"),e.jsx(e.Fragment,{children:t})):(console.log("[ProtectedRoute] Redirecting group admin to group-admin panel"),e.jsx(bt,{to:"/group-admin",replace:!0}))}if(!n||!o)return console.warn(`[ProtectedRoute] Access denied - Not authenticated for ${h.pathname}`),d(h.pathname,!1,{reason:"Not authenticated",has_session:o,redirect_to:"/"}),e.jsx(bt,{to:"/",replace:!0,state:{from:h}});if(s.length>0&&i){const p=i.toLowerCase();let v=s.some(y=>y.toLowerCase()===p);if(s.includes("dealer_group_admin")&&h.pathname==="/group-admin"&&(console.log("[ProtectedRoute] This is the group admin route, checking is_group_admin flag"),((b=n.user_metadata)==null?void 0:b.is_group_admin)===!0?(console.log("[ProtectedRoute] User has is_group_admin flag in metadata, granting access"),v=!0):(console.log("[ProtectedRoute] User does not have is_group_admin flag, checking database"),(async()=>{try{const{data:N,error:g}=await J.from("profiles").select("is_group_admin").eq("id",n.id).maybeSingle();!g&&(N==null?void 0:N.is_group_admin)===!0&&(console.log("[ProtectedRoute] User has is_group_admin=true in profile table"),v=!0)}catch(N){console.error("[ProtectedRoute] Error checking is_group_admin flag:",N)}})())),!v&&s.includes("admin")&&p==="dealership_admin"&&(console.log("[ProtectedRoute] Dealership admin accessing route requiring 'admin' - checking compatibility"),v=!0),!v)return console.warn(`[ProtectedRoute] Access denied - User role ${i} not in required roles: ${s.join(", ")}`),d(h.pathname,!1,{reason:"Insufficient role permissions",user_role:i,required_roles:s,redirect_to:"/dashboard"}),e.jsx(bt,{to:"/dashboard",replace:!0})}return r&&c!==r?(console.warn(`[ProtectedRoute] Access denied - User dealership ${c} doesn't match required dealership ${r}`),d(h.pathname,!1,{reason:"Dealership mismatch",user_dealership:c,required_dealership:r,redirect_to:"/dashboard"}),e.jsx(bt,{to:"/dashboard",replace:!0})):(console.log(`[ProtectedRoute] Access granted to ${h.pathname}`),d(h.pathname,!0,{user_role:i,dealership_id:c}),e.jsx(e.Fragment,{children:t}))},vt=({children:t,title:s="The DAS Board"})=>{const{signOut:r,user:n,userRole:a,dealershipId:o,currentDealershipName:i}=et(),c=St(),d=()=>{window.location.href="/logout"},m=f=>c.pathname===f||c.pathname.startsWith(`${f}/`),h=c.pathname.startsWith("/dealership/"),u=h?c.pathname.split("/")[2]:null;return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsxs("div",{className:"w-64 bg-black shadow-md text-white",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("h1",{className:"text-2xl font-bold text-orange-500",children:s}),i&&e.jsxs("div",{className:"flex items-center mt-2 text-sm text-orange-300",children:[e.jsx(Kn,{size:14,className:"mr-1"}),e.jsx("span",{children:i})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx("div",{className:"bg-blue-900 p-2 rounded-full",children:e.jsx(Ur,{size:20,className:"text-blue-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:n==null?void 0:n.email}),e.jsx("p",{className:"text-xs text-gray-300",children:a||"User"})]})]}),e.jsxs("nav",{className:"space-y-1",children:[e.jsx(us,{to:h?`/dealership/${u}`:"/dashboard",children:e.jsxs("button",{className:`flex items-center w-full px-4 py-2 text-left text-sm rounded-md ${m("/dashboard")&&!m("/dashboard/deals")&&!m("/dashboard/schedule")||h&&!c.pathname.includes("/deals")&&!c.pathname.includes("/schedule")?"bg-gray-800 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:[e.jsx(c0,{size:18,className:"mr-2"}),"Home"]})}),e.jsx(us,{to:h?`/dealership/${u}/deals`:"/dashboard/deals",children:e.jsxs("button",{className:`flex items-center w-full px-4 py-2 text-left text-sm rounded-md ${m("/dashboard/deals")||h&&c.pathname.includes("/deals")?"bg-gray-800 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:[e.jsx(r0,{size:18,className:"mr-2"}),"Deals"]})}),e.jsx(us,{to:h?`/dealership/${u}/schedule`:"/dashboard/schedule",children:e.jsxs("button",{className:`flex items-center w-full px-4 py-2 text-left text-sm rounded-md ${m("/dashboard/schedule")||h&&c.pathname.includes("/schedule")?"bg-gray-800 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:[e.jsx(Bt,{size:18,className:"mr-2"}),"Schedule"]})}),a==="admin"&&!o&&e.jsx(us,{to:"/master-admin",children:e.jsxs("button",{className:`flex items-center w-full px-4 py-2 text-left text-sm rounded-md ${m("/master-admin")?"bg-gray-800 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:[e.jsx(Kn,{size:18,className:"mr-2"}),"Master Admin"]})})]})]}),e.jsx("div",{className:"absolute bottom-0 w-64 p-4 border-t border-gray-700",children:e.jsxs(I,{variant:"outline",className:"w-full flex items-center justify-center bg-gray-800 text-white border-gray-600 hover:bg-gray-700",onClick:d,children:[e.jsx(h0,{size:18,className:"mr-2"}),"Sign Out"]})})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("main",{className:"p-6",children:[t||e.jsx(qp,{}),!t&&!c.pathname.includes("/admin")&&!c.pathname.includes("/sales")&&e.jsxs("div",{style:{padding:"20px",backgroundColor:"#fff3cd",color:"#856404",border:"1px solid #ffeeba",borderRadius:"4px"},children:[e.jsx("p",{children:"Warning: No content to display for this route."}),e.jsxs("p",{children:["Current path: ",c.pathname]})]})]})})]})};function gv(){return e.jsx(Tu,{})}const jl=l.forwardRef(({className:t,...s},r)=>e.jsx("textarea",{className:ge("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s}));jl.displayName="Textarea";function Gi(t,[s,r]){return Math.min(r,Math.max(s,t))}var vv=l.createContext(void 0);function ba(t){const s=l.useContext(vv);return t||s||"ltr"}var ci=0;function wl(){l.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??kc()),document.body.insertAdjacentElement("beforeend",t[1]??kc()),ci++,()=>{ci===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),ci--}},[])}function kc(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var di="focusScope.autoFocusOnMount",ui="focusScope.autoFocusOnUnmount",Rc={bubbles:!1,cancelable:!0},bv="FocusScope",Co=l.forwardRef((t,s)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...i}=t,[c,d]=l.useState(null),m=st(a),h=st(o),u=l.useRef(null),f=Me(s,x=>d(x)),b=l.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;l.useEffect(()=>{if(n){let x=function(N){if(b.paused||!c)return;const g=N.target;c.contains(g)?u.current=g:nr(u.current,{select:!0})},v=function(N){if(b.paused||!c)return;const g=N.relatedTarget;g!==null&&(c.contains(g)||nr(u.current,{select:!0}))},y=function(N){if(document.activeElement===document.body)for(const w of N)w.removedNodes.length>0&&nr(c)};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const j=new MutationObserver(y);return c&&j.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),j.disconnect()}}},[n,c,b.paused]),l.useEffect(()=>{if(c){Fc.add(b);const x=document.activeElement;if(!c.contains(x)){const y=new CustomEvent(di,Rc);c.addEventListener(di,m),c.dispatchEvent(y),y.defaultPrevented||(yv(Cv(Uu(c)),{select:!0}),document.activeElement===x&&nr(c))}return()=>{c.removeEventListener(di,m),setTimeout(()=>{const y=new CustomEvent(ui,Rc);c.addEventListener(ui,h),c.dispatchEvent(y),y.defaultPrevented||nr(x??document.body,{select:!0}),c.removeEventListener(ui,h),Fc.remove(b)},0)}}},[c,m,h,b]);const p=l.useCallback(x=>{if(!r&&!n||b.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,y=document.activeElement;if(v&&y){const j=x.currentTarget,[N,g]=jv(j);N&&g?!x.shiftKey&&y===g?(x.preventDefault(),r&&nr(N,{select:!0})):x.shiftKey&&y===N&&(x.preventDefault(),r&&nr(g,{select:!0})):y===j&&x.preventDefault()}},[r,n,b.paused]);return e.jsx(je.div,{tabIndex:-1,...i,ref:f,onKeyDown:p})});Co.displayName=bv;function yv(t,{select:s=!1}={}){const r=document.activeElement;for(const n of t)if(nr(n,{select:s}),document.activeElement!==r)return}function jv(t){const s=Uu(t),r=Ic(s,t),n=Ic(s.reverse(),t);return[r,n]}function Uu(t){const s=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)s.push(r.currentNode);return s}function Ic(t,s){for(const r of t)if(!wv(r,{upTo:s}))return r}function wv(t,{upTo:s}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(s!==void 0&&t===s)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Nv(t){return t instanceof HTMLInputElement&&"select"in t}function nr(t,{select:s=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&Nv(t)&&s&&t.select()}}var Fc=Sv();function Sv(){let t=[];return{add(s){const r=t[0];s!==r&&(r==null||r.pause()),t=Lc(t,s),t.unshift(s)},remove(s){var r;t=Lc(t,s),(r=t[0])==null||r.resume()}}}function Lc(t,s){const r=[...t],n=r.indexOf(s);return n!==-1&&r.splice(n,1),r}function Cv(t){return t.filter(s=>s.tagName!=="A")}var Pv=al[" useId ".trim().toString()]||(()=>{}),_v=0;function Zt(t){const[s,r]=l.useState(Pv());return xt(()=>{r(n=>n??String(_v++))},[t]),s?`radix-${s}`:""}const Dv=["top","right","bottom","left"],vr=Math.min,Ot=Math.max,to=Math.round,Fa=Math.floor,Cs=t=>({x:t,y:t}),Av={left:"right",right:"left",bottom:"top",top:"bottom"},Ev={start:"end",end:"start"};function Bi(t,s,r){return Ot(t,vr(s,r))}function zs(t,s){return typeof t=="function"?t(s):t}function Hs(t){return t.split("-")[0]}function _n(t){return t.split("-")[1]}function Nl(t){return t==="x"?"y":"x"}function Sl(t){return t==="y"?"height":"width"}function br(t){return["top","bottom"].includes(Hs(t))?"y":"x"}function Cl(t){return Nl(br(t))}function Tv(t,s,r){r===void 0&&(r=!1);const n=_n(t),a=Cl(t),o=Sl(a);let i=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return s.reference[o]>s.floating[o]&&(i=so(i)),[i,so(i)]}function Mv(t){const s=so(t);return[Vi(t),s,Vi(s)]}function Vi(t){return t.replace(/start|end/g,s=>Ev[s])}function kv(t,s,r){const n=["left","right"],a=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(t){case"top":case"bottom":return r?s?a:n:s?n:a;case"left":case"right":return s?o:i;default:return[]}}function Rv(t,s,r,n){const a=_n(t);let o=kv(Hs(t),r==="start",n);return a&&(o=o.map(i=>i+"-"+a),s&&(o=o.concat(o.map(Vi)))),o}function so(t){return t.replace(/left|right|bottom|top/g,s=>Av[s])}function Iv(t){return{top:0,right:0,bottom:0,left:0,...t}}function $u(t){return typeof t!="number"?Iv(t):{top:t,right:t,bottom:t,left:t}}function ro(t){const{x:s,y:r,width:n,height:a}=t;return{width:n,height:a,top:r,left:s,right:s+n,bottom:r+a,x:s,y:r}}function Oc(t,s,r){let{reference:n,floating:a}=t;const o=br(s),i=Cl(s),c=Sl(i),d=Hs(s),m=o==="y",h=n.x+n.width/2-a.width/2,u=n.y+n.height/2-a.height/2,f=n[c]/2-a[c]/2;let b;switch(d){case"top":b={x:h,y:n.y-a.height};break;case"bottom":b={x:h,y:n.y+n.height};break;case"right":b={x:n.x+n.width,y:u};break;case"left":b={x:n.x-a.width,y:u};break;default:b={x:n.x,y:n.y}}switch(_n(s)){case"start":b[i]-=f*(r&&m?-1:1);break;case"end":b[i]+=f*(r&&m?-1:1);break}return b}const Fv=async(t,s,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:o=[],platform:i}=r,c=o.filter(Boolean),d=await(i.isRTL==null?void 0:i.isRTL(s));let m=await i.getElementRects({reference:t,floating:s,strategy:a}),{x:h,y:u}=Oc(m,n,d),f=n,b={},p=0;for(let x=0;x<c.length;x++){const{name:v,fn:y}=c[x],{x:j,y:N,data:g,reset:w}=await y({x:h,y:u,initialPlacement:n,placement:f,strategy:a,middlewareData:b,rects:m,platform:i,elements:{reference:t,floating:s}});h=j??h,u=N??u,b={...b,[v]:{...b[v],...g}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(f=w.placement),w.rects&&(m=w.rects===!0?await i.getElementRects({reference:t,floating:s,strategy:a}):w.rects),{x:h,y:u}=Oc(m,f,d)),x=-1)}return{x:h,y:u,placement:f,strategy:a,middlewareData:b}};async function ra(t,s){var r;s===void 0&&(s={});const{x:n,y:a,platform:o,rects:i,elements:c,strategy:d}=t,{boundary:m="clippingAncestors",rootBoundary:h="viewport",elementContext:u="floating",altBoundary:f=!1,padding:b=0}=zs(s,t),p=$u(b),v=c[f?u==="floating"?"reference":"floating":u],y=ro(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(v)))==null||r?v:v.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:m,rootBoundary:h,strategy:d})),j=u==="floating"?{x:n,y:a,width:i.floating.width,height:i.floating.height}:i.reference,N=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),g=await(o.isElement==null?void 0:o.isElement(N))?await(o.getScale==null?void 0:o.getScale(N))||{x:1,y:1}:{x:1,y:1},w=ro(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:j,offsetParent:N,strategy:d}):j);return{top:(y.top-w.top+p.top)/g.y,bottom:(w.bottom-y.bottom+p.bottom)/g.y,left:(y.left-w.left+p.left)/g.x,right:(w.right-y.right+p.right)/g.x}}const Lv=t=>({name:"arrow",options:t,async fn(s){const{x:r,y:n,placement:a,rects:o,platform:i,elements:c,middlewareData:d}=s,{element:m,padding:h=0}=zs(t,s)||{};if(m==null)return{};const u=$u(h),f={x:r,y:n},b=Cl(a),p=Sl(b),x=await i.getDimensions(m),v=b==="y",y=v?"top":"left",j=v?"bottom":"right",N=v?"clientHeight":"clientWidth",g=o.reference[p]+o.reference[b]-f[b]-o.floating[p],w=f[b]-o.reference[b],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(m));let P=S?S[N]:0;(!P||!await(i.isElement==null?void 0:i.isElement(S)))&&(P=c.floating[N]||o.floating[p]);const E=g/2-w/2,D=P/2-x[p]/2-1,G=vr(u[y],D),se=vr(u[j],D),L=G,T=P-x[p]-se,A=P/2-x[p]/2+E,Y=Bi(L,A,T),te=!d.arrow&&_n(a)!=null&&A!==Y&&o.reference[p]/2-(A<L?G:se)-x[p]/2<0,xe=te?A<L?A-L:A-T:0;return{[b]:f[b]+xe,data:{[b]:Y,centerOffset:A-Y-xe,...te&&{alignmentOffset:xe}},reset:te}}}),Ov=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(s){var r,n;const{placement:a,middlewareData:o,rects:i,initialPlacement:c,platform:d,elements:m}=s,{mainAxis:h=!0,crossAxis:u=!0,fallbackPlacements:f,fallbackStrategy:b="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:x=!0,...v}=zs(t,s);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const y=Hs(a),j=br(c),N=Hs(c)===c,g=await(d.isRTL==null?void 0:d.isRTL(m.floating)),w=f||(N||!x?[so(c)]:Mv(c)),S=p!=="none";!f&&S&&w.push(...Rv(c,x,p,g));const P=[c,...w],E=await ra(s,v),D=[];let G=((n=o.flip)==null?void 0:n.overflows)||[];if(h&&D.push(E[y]),u){const A=Tv(a,i,g);D.push(E[A[0]],E[A[1]])}if(G=[...G,{placement:a,overflows:D}],!D.every(A=>A<=0)){var se,L;const A=(((se=o.flip)==null?void 0:se.index)||0)+1,Y=P[A];if(Y)return{data:{index:A,overflows:G},reset:{placement:Y}};let te=(L=G.filter(xe=>xe.overflows[0]<=0).sort((xe,le)=>xe.overflows[1]-le.overflows[1])[0])==null?void 0:L.placement;if(!te)switch(b){case"bestFit":{var T;const xe=(T=G.filter(le=>{if(S){const Q=br(le.placement);return Q===j||Q==="y"}return!0}).map(le=>[le.placement,le.overflows.filter(Q=>Q>0).reduce((Q,pe)=>Q+pe,0)]).sort((le,Q)=>le[1]-Q[1])[0])==null?void 0:T[0];xe&&(te=xe);break}case"initialPlacement":te=c;break}if(a!==te)return{reset:{placement:te}}}return{}}}};function Uc(t,s){return{top:t.top-s.height,right:t.right-s.width,bottom:t.bottom-s.height,left:t.left-s.width}}function $c(t){return Dv.some(s=>t[s]>=0)}const Uv=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(s){const{rects:r}=s,{strategy:n="referenceHidden",...a}=zs(t,s);switch(n){case"referenceHidden":{const o=await ra(s,{...a,elementContext:"reference"}),i=Uc(o,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:$c(i)}}}case"escaped":{const o=await ra(s,{...a,altBoundary:!0}),i=Uc(o,r.floating);return{data:{escapedOffsets:i,escaped:$c(i)}}}default:return{}}}}};async function $v(t,s){const{placement:r,platform:n,elements:a}=t,o=await(n.isRTL==null?void 0:n.isRTL(a.floating)),i=Hs(r),c=_n(r),d=br(r)==="y",m=["left","top"].includes(i)?-1:1,h=o&&d?-1:1,u=zs(s,t);let{mainAxis:f,crossAxis:b,alignmentAxis:p}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return c&&typeof p=="number"&&(b=c==="end"?p*-1:p),d?{x:b*h,y:f*m}:{x:f*m,y:b*h}}const Gv=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(s){var r,n;const{x:a,y:o,placement:i,middlewareData:c}=s,d=await $v(s,t);return i===((r=c.offset)==null?void 0:r.placement)&&(n=c.arrow)!=null&&n.alignmentOffset?{}:{x:a+d.x,y:o+d.y,data:{...d,placement:i}}}}},Bv=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(s){const{x:r,y:n,placement:a}=s,{mainAxis:o=!0,crossAxis:i=!1,limiter:c={fn:v=>{let{x:y,y:j}=v;return{x:y,y:j}}},...d}=zs(t,s),m={x:r,y:n},h=await ra(s,d),u=br(Hs(a)),f=Nl(u);let b=m[f],p=m[u];if(o){const v=f==="y"?"top":"left",y=f==="y"?"bottom":"right",j=b+h[v],N=b-h[y];b=Bi(j,b,N)}if(i){const v=u==="y"?"top":"left",y=u==="y"?"bottom":"right",j=p+h[v],N=p-h[y];p=Bi(j,p,N)}const x=c.fn({...s,[f]:b,[u]:p});return{...x,data:{x:x.x-r,y:x.y-n,enabled:{[f]:o,[u]:i}}}}}},Vv=function(t){return t===void 0&&(t={}),{options:t,fn(s){const{x:r,y:n,placement:a,rects:o,middlewareData:i}=s,{offset:c=0,mainAxis:d=!0,crossAxis:m=!0}=zs(t,s),h={x:r,y:n},u=br(a),f=Nl(u);let b=h[f],p=h[u];const x=zs(c,s),v=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(d){const N=f==="y"?"height":"width",g=o.reference[f]-o.floating[N]+v.mainAxis,w=o.reference[f]+o.reference[N]-v.mainAxis;b<g?b=g:b>w&&(b=w)}if(m){var y,j;const N=f==="y"?"width":"height",g=["top","left"].includes(Hs(a)),w=o.reference[u]-o.floating[N]+(g&&((y=i.offset)==null?void 0:y[u])||0)+(g?0:v.crossAxis),S=o.reference[u]+o.reference[N]+(g?0:((j=i.offset)==null?void 0:j[u])||0)-(g?v.crossAxis:0);p<w?p=w:p>S&&(p=S)}return{[f]:b,[u]:p}}}},Wv=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(s){var r,n;const{placement:a,rects:o,platform:i,elements:c}=s,{apply:d=()=>{},...m}=zs(t,s),h=await ra(s,m),u=Hs(a),f=_n(a),b=br(a)==="y",{width:p,height:x}=o.floating;let v,y;u==="top"||u==="bottom"?(v=u,y=f===(await(i.isRTL==null?void 0:i.isRTL(c.floating))?"start":"end")?"left":"right"):(y=u,v=f==="end"?"top":"bottom");const j=x-h.top-h.bottom,N=p-h.left-h.right,g=vr(x-h[v],j),w=vr(p-h[y],N),S=!s.middlewareData.shift;let P=g,E=w;if((r=s.middlewareData.shift)!=null&&r.enabled.x&&(E=N),(n=s.middlewareData.shift)!=null&&n.enabled.y&&(P=j),S&&!f){const G=Ot(h.left,0),se=Ot(h.right,0),L=Ot(h.top,0),T=Ot(h.bottom,0);b?E=p-2*(G!==0||se!==0?G+se:Ot(h.left,h.right)):P=x-2*(L!==0||T!==0?L+T:Ot(h.top,h.bottom))}await d({...s,availableWidth:E,availableHeight:P});const D=await i.getDimensions(c.floating);return p!==D.width||x!==D.height?{reset:{rects:!0}}:{}}}};function Po(){return typeof window<"u"}function Dn(t){return Gu(t)?(t.nodeName||"").toLowerCase():"#document"}function Gt(t){var s;return(t==null||(s=t.ownerDocument)==null?void 0:s.defaultView)||window}function As(t){var s;return(s=(Gu(t)?t.ownerDocument:t.document)||window.document)==null?void 0:s.documentElement}function Gu(t){return Po()?t instanceof Node||t instanceof Gt(t).Node:!1}function hs(t){return Po()?t instanceof Element||t instanceof Gt(t).Element:!1}function _s(t){return Po()?t instanceof HTMLElement||t instanceof Gt(t).HTMLElement:!1}function Gc(t){return!Po()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Gt(t).ShadowRoot}function ya(t){const{overflow:s,overflowX:r,overflowY:n,display:a}=fs(t);return/auto|scroll|overlay|hidden|clip/.test(s+n+r)&&!["inline","contents"].includes(a)}function zv(t){return["table","td","th"].includes(Dn(t))}function _o(t){return[":popover-open",":modal"].some(s=>{try{return t.matches(s)}catch{return!1}})}function Pl(t){const s=_l(),r=hs(t)?fs(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!s&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!s&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function Hv(t){let s=yr(t);for(;_s(s)&&!pn(s);){if(Pl(s))return s;if(_o(s))return null;s=yr(s)}return null}function _l(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function pn(t){return["html","body","#document"].includes(Dn(t))}function fs(t){return Gt(t).getComputedStyle(t)}function Do(t){return hs(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function yr(t){if(Dn(t)==="html")return t;const s=t.assignedSlot||t.parentNode||Gc(t)&&t.host||As(t);return Gc(s)?s.host:s}function Bu(t){const s=yr(t);return pn(s)?t.ownerDocument?t.ownerDocument.body:t.body:_s(s)&&ya(s)?s:Bu(s)}function na(t,s,r){var n;s===void 0&&(s=[]),r===void 0&&(r=!0);const a=Bu(t),o=a===((n=t.ownerDocument)==null?void 0:n.body),i=Gt(a);if(o){const c=Wi(i);return s.concat(i,i.visualViewport||[],ya(a)?a:[],c&&r?na(c):[])}return s.concat(a,na(a,[],r))}function Wi(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Vu(t){const s=fs(t);let r=parseFloat(s.width)||0,n=parseFloat(s.height)||0;const a=_s(t),o=a?t.offsetWidth:r,i=a?t.offsetHeight:n,c=to(r)!==o||to(n)!==i;return c&&(r=o,n=i),{width:r,height:n,$:c}}function Dl(t){return hs(t)?t:t.contextElement}function sn(t){const s=Dl(t);if(!_s(s))return Cs(1);const r=s.getBoundingClientRect(),{width:n,height:a,$:o}=Vu(s);let i=(o?to(r.width):r.width)/n,c=(o?to(r.height):r.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!c||!Number.isFinite(c))&&(c=1),{x:i,y:c}}const qv=Cs(0);function Wu(t){const s=Gt(t);return!_l()||!s.visualViewport?qv:{x:s.visualViewport.offsetLeft,y:s.visualViewport.offsetTop}}function Yv(t,s,r){return s===void 0&&(s=!1),!r||s&&r!==Gt(t)?!1:s}function Gr(t,s,r,n){s===void 0&&(s=!1),r===void 0&&(r=!1);const a=t.getBoundingClientRect(),o=Dl(t);let i=Cs(1);s&&(n?hs(n)&&(i=sn(n)):i=sn(t));const c=Yv(o,r,n)?Wu(o):Cs(0);let d=(a.left+c.x)/i.x,m=(a.top+c.y)/i.y,h=a.width/i.x,u=a.height/i.y;if(o){const f=Gt(o),b=n&&hs(n)?Gt(n):n;let p=f,x=Wi(p);for(;x&&n&&b!==p;){const v=sn(x),y=x.getBoundingClientRect(),j=fs(x),N=y.left+(x.clientLeft+parseFloat(j.paddingLeft))*v.x,g=y.top+(x.clientTop+parseFloat(j.paddingTop))*v.y;d*=v.x,m*=v.y,h*=v.x,u*=v.y,d+=N,m+=g,p=Gt(x),x=Wi(p)}}return ro({width:h,height:u,x:d,y:m})}function Al(t,s){const r=Do(t).scrollLeft;return s?s.left+r:Gr(As(t)).left+r}function zu(t,s,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),a=n.left+s.scrollLeft-(r?0:Al(t,n)),o=n.top+s.scrollTop;return{x:a,y:o}}function Kv(t){let{elements:s,rect:r,offsetParent:n,strategy:a}=t;const o=a==="fixed",i=As(n),c=s?_o(s.floating):!1;if(n===i||c&&o)return r;let d={scrollLeft:0,scrollTop:0},m=Cs(1);const h=Cs(0),u=_s(n);if((u||!u&&!o)&&((Dn(n)!=="body"||ya(i))&&(d=Do(n)),_s(n))){const b=Gr(n);m=sn(n),h.x=b.x+n.clientLeft,h.y=b.y+n.clientTop}const f=i&&!u&&!o?zu(i,d,!0):Cs(0);return{width:r.width*m.x,height:r.height*m.y,x:r.x*m.x-d.scrollLeft*m.x+h.x+f.x,y:r.y*m.y-d.scrollTop*m.y+h.y+f.y}}function Jv(t){return Array.from(t.getClientRects())}function Qv(t){const s=As(t),r=Do(t),n=t.ownerDocument.body,a=Ot(s.scrollWidth,s.clientWidth,n.scrollWidth,n.clientWidth),o=Ot(s.scrollHeight,s.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+Al(t);const c=-r.scrollTop;return fs(n).direction==="rtl"&&(i+=Ot(s.clientWidth,n.clientWidth)-a),{width:a,height:o,x:i,y:c}}function Xv(t,s){const r=Gt(t),n=As(t),a=r.visualViewport;let o=n.clientWidth,i=n.clientHeight,c=0,d=0;if(a){o=a.width,i=a.height;const m=_l();(!m||m&&s==="fixed")&&(c=a.offsetLeft,d=a.offsetTop)}return{width:o,height:i,x:c,y:d}}function Zv(t,s){const r=Gr(t,!0,s==="fixed"),n=r.top+t.clientTop,a=r.left+t.clientLeft,o=_s(t)?sn(t):Cs(1),i=t.clientWidth*o.x,c=t.clientHeight*o.y,d=a*o.x,m=n*o.y;return{width:i,height:c,x:d,y:m}}function Bc(t,s,r){let n;if(s==="viewport")n=Xv(t,r);else if(s==="document")n=Qv(As(t));else if(hs(s))n=Zv(s,r);else{const a=Wu(t);n={x:s.x-a.x,y:s.y-a.y,width:s.width,height:s.height}}return ro(n)}function Hu(t,s){const r=yr(t);return r===s||!hs(r)||pn(r)?!1:fs(r).position==="fixed"||Hu(r,s)}function eb(t,s){const r=s.get(t);if(r)return r;let n=na(t,[],!1).filter(c=>hs(c)&&Dn(c)!=="body"),a=null;const o=fs(t).position==="fixed";let i=o?yr(t):t;for(;hs(i)&&!pn(i);){const c=fs(i),d=Pl(i);!d&&c.position==="fixed"&&(a=null),(o?!d&&!a:!d&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||ya(i)&&!d&&Hu(t,i))?n=n.filter(h=>h!==i):a=c,i=yr(i)}return s.set(t,n),n}function tb(t){let{element:s,boundary:r,rootBoundary:n,strategy:a}=t;const i=[...r==="clippingAncestors"?_o(s)?[]:eb(s,this._c):[].concat(r),n],c=i[0],d=i.reduce((m,h)=>{const u=Bc(s,h,a);return m.top=Ot(u.top,m.top),m.right=vr(u.right,m.right),m.bottom=vr(u.bottom,m.bottom),m.left=Ot(u.left,m.left),m},Bc(s,c,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function sb(t){const{width:s,height:r}=Vu(t);return{width:s,height:r}}function rb(t,s,r){const n=_s(s),a=As(s),o=r==="fixed",i=Gr(t,!0,o,s);let c={scrollLeft:0,scrollTop:0};const d=Cs(0);if(n||!n&&!o)if((Dn(s)!=="body"||ya(a))&&(c=Do(s)),n){const f=Gr(s,!0,o,s);d.x=f.x+s.clientLeft,d.y=f.y+s.clientTop}else a&&(d.x=Al(a));const m=a&&!n&&!o?zu(a,c):Cs(0),h=i.left+c.scrollLeft-d.x-m.x,u=i.top+c.scrollTop-d.y-m.y;return{x:h,y:u,width:i.width,height:i.height}}function mi(t){return fs(t).position==="static"}function Vc(t,s){if(!_s(t)||fs(t).position==="fixed")return null;if(s)return s(t);let r=t.offsetParent;return As(t)===r&&(r=r.ownerDocument.body),r}function qu(t,s){const r=Gt(t);if(_o(t))return r;if(!_s(t)){let a=yr(t);for(;a&&!pn(a);){if(hs(a)&&!mi(a))return a;a=yr(a)}return r}let n=Vc(t,s);for(;n&&zv(n)&&mi(n);)n=Vc(n,s);return n&&pn(n)&&mi(n)&&!Pl(n)?r:n||Hv(t)||r}const nb=async function(t){const s=this.getOffsetParent||qu,r=this.getDimensions,n=await r(t.floating);return{reference:rb(t.reference,await s(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function ab(t){return fs(t).direction==="rtl"}const ob={convertOffsetParentRelativeRectToViewportRelativeRect:Kv,getDocumentElement:As,getClippingRect:tb,getOffsetParent:qu,getElementRects:nb,getClientRects:Jv,getDimensions:sb,getScale:sn,isElement:hs,isRTL:ab};function Yu(t,s){return t.x===s.x&&t.y===s.y&&t.width===s.width&&t.height===s.height}function ib(t,s){let r=null,n;const a=As(t);function o(){var c;clearTimeout(n),(c=r)==null||c.disconnect(),r=null}function i(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),o();const m=t.getBoundingClientRect(),{left:h,top:u,width:f,height:b}=m;if(c||s(),!f||!b)return;const p=Fa(u),x=Fa(a.clientWidth-(h+f)),v=Fa(a.clientHeight-(u+b)),y=Fa(h),N={rootMargin:-p+"px "+-x+"px "+-v+"px "+-y+"px",threshold:Ot(0,vr(1,d))||1};let g=!0;function w(S){const P=S[0].intersectionRatio;if(P!==d){if(!g)return i();P?i(!1,P):n=setTimeout(()=>{i(!1,1e-7)},1e3)}P===1&&!Yu(m,t.getBoundingClientRect())&&i(),g=!1}try{r=new IntersectionObserver(w,{...N,root:a.ownerDocument})}catch{r=new IntersectionObserver(w,N)}r.observe(t)}return i(!0),o}function lb(t,s,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=n,m=Dl(t),h=a||o?[...m?na(m):[],...na(s)]:[];h.forEach(y=>{a&&y.addEventListener("scroll",r,{passive:!0}),o&&y.addEventListener("resize",r)});const u=m&&c?ib(m,r):null;let f=-1,b=null;i&&(b=new ResizeObserver(y=>{let[j]=y;j&&j.target===m&&b&&(b.unobserve(s),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var N;(N=b)==null||N.observe(s)})),r()}),m&&!d&&b.observe(m),b.observe(s));let p,x=d?Gr(t):null;d&&v();function v(){const y=Gr(t);x&&!Yu(x,y)&&r(),x=y,p=requestAnimationFrame(v)}return r(),()=>{var y;h.forEach(j=>{a&&j.removeEventListener("scroll",r),o&&j.removeEventListener("resize",r)}),u==null||u(),(y=b)==null||y.disconnect(),b=null,d&&cancelAnimationFrame(p)}}const cb=Gv,db=Bv,ub=Ov,mb=Wv,hb=Uv,Wc=Lv,fb=Vv,xb=(t,s,r)=>{const n=new Map,a={platform:ob,...r},o={...a.platform,_c:n};return Fv(t,s,{...a,platform:o})};var Ya=typeof document<"u"?l.useLayoutEffect:l.useEffect;function no(t,s){if(t===s)return!0;if(typeof t!=typeof s)return!1;if(typeof t=="function"&&t.toString()===s.toString())return!0;let r,n,a;if(t&&s&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==s.length)return!1;for(n=r;n--!==0;)if(!no(t[n],s[n]))return!1;return!0}if(a=Object.keys(t),r=a.length,r!==Object.keys(s).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(s,a[n]))return!1;for(n=r;n--!==0;){const o=a[n];if(!(o==="_owner"&&t.$$typeof)&&!no(t[o],s[o]))return!1}return!0}return t!==t&&s!==s}function Ku(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function zc(t,s){const r=Ku(t);return Math.round(s*r)/r}function hi(t){const s=l.useRef(t);return Ya(()=>{s.current=t}),s}function pb(t){t===void 0&&(t={});const{placement:s="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:o,floating:i}={},transform:c=!0,whileElementsMounted:d,open:m}=t,[h,u]=l.useState({x:0,y:0,strategy:r,placement:s,middlewareData:{},isPositioned:!1}),[f,b]=l.useState(n);no(f,n)||b(n);const[p,x]=l.useState(null),[v,y]=l.useState(null),j=l.useCallback(le=>{le!==S.current&&(S.current=le,x(le))},[]),N=l.useCallback(le=>{le!==P.current&&(P.current=le,y(le))},[]),g=o||p,w=i||v,S=l.useRef(null),P=l.useRef(null),E=l.useRef(h),D=d!=null,G=hi(d),se=hi(a),L=hi(m),T=l.useCallback(()=>{if(!S.current||!P.current)return;const le={placement:s,strategy:r,middleware:f};se.current&&(le.platform=se.current),xb(S.current,P.current,le).then(Q=>{const pe={...Q,isPositioned:L.current!==!1};A.current&&!no(E.current,pe)&&(E.current=pe,jn.flushSync(()=>{u(pe)}))})},[f,s,r,se,L]);Ya(()=>{m===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,u(le=>({...le,isPositioned:!1})))},[m]);const A=l.useRef(!1);Ya(()=>(A.current=!0,()=>{A.current=!1}),[]),Ya(()=>{if(g&&(S.current=g),w&&(P.current=w),g&&w){if(G.current)return G.current(g,w,T);T()}},[g,w,T,G,D]);const Y=l.useMemo(()=>({reference:S,floating:P,setReference:j,setFloating:N}),[j,N]),te=l.useMemo(()=>({reference:g,floating:w}),[g,w]),xe=l.useMemo(()=>{const le={position:r,left:0,top:0};if(!te.floating)return le;const Q=zc(te.floating,h.x),pe=zc(te.floating,h.y);return c?{...le,transform:"translate("+Q+"px, "+pe+"px)",...Ku(te.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Q,top:pe}},[r,c,te.floating,h.x,h.y]);return l.useMemo(()=>({...h,update:T,refs:Y,elements:te,floatingStyles:xe}),[h,T,Y,te,xe])}const gb=t=>{function s(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:a}=typeof t=="function"?t(r):t;return n&&s(n)?n.current!=null?Wc({element:n.current,padding:a}).fn(r):{}:n?Wc({element:n,padding:a}).fn(r):{}}}},vb=(t,s)=>({...cb(t),options:[t,s]}),bb=(t,s)=>({...db(t),options:[t,s]}),yb=(t,s)=>({...fb(t),options:[t,s]}),jb=(t,s)=>({...ub(t),options:[t,s]}),wb=(t,s)=>({...mb(t),options:[t,s]}),Nb=(t,s)=>({...hb(t),options:[t,s]}),Sb=(t,s)=>({...gb(t),options:[t,s]});var Cb="Arrow",Ju=l.forwardRef((t,s)=>{const{children:r,width:n=10,height:a=5,...o}=t;return e.jsx(je.svg,{...o,ref:s,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});Ju.displayName=Cb;var Pb=Ju;function Qu(t){const[s,r]=l.useState(void 0);return xt(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let i,c;if("borderBoxSize"in o){const d=o.borderBoxSize,m=Array.isArray(d)?d[0]:d;i=m.inlineSize,c=m.blockSize}else i=t.offsetWidth,c=t.offsetHeight;r({width:i,height:c})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),s}var El="Popper",[Xu,An]=Wt(El),[_b,Zu]=Xu(El),em=t=>{const{__scopePopper:s,children:r}=t,[n,a]=l.useState(null);return e.jsx(_b,{scope:s,anchor:n,onAnchorChange:a,children:r})};em.displayName=El;var tm="PopperAnchor",sm=l.forwardRef((t,s)=>{const{__scopePopper:r,virtualRef:n,...a}=t,o=Zu(tm,r),i=l.useRef(null),c=Me(s,i);return l.useEffect(()=>{o.onAnchorChange((n==null?void 0:n.current)||i.current)}),n?null:e.jsx(je.div,{...a,ref:c})});sm.displayName=tm;var Tl="PopperContent",[Db,Ab]=Xu(Tl),rm=l.forwardRef((t,s)=>{var O,ue,K,ce,X,F;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:o="center",alignOffset:i=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:m=[],collisionPadding:h=0,sticky:u="partial",hideWhenDetached:f=!1,updatePositionStrategy:b="optimized",onPlaced:p,...x}=t,v=Zu(Tl,r),[y,j]=l.useState(null),N=Me(s,_=>j(_)),[g,w]=l.useState(null),S=Qu(g),P=(S==null?void 0:S.width)??0,E=(S==null?void 0:S.height)??0,D=n+(o!=="center"?"-"+o:""),G=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},se=Array.isArray(m)?m:[m],L=se.length>0,T={padding:G,boundary:se.filter(Tb),altBoundary:L},{refs:A,floatingStyles:Y,placement:te,isPositioned:xe,middlewareData:le}=pb({strategy:"fixed",placement:D,whileElementsMounted:(..._)=>lb(..._,{animationFrame:b==="always"}),elements:{reference:v.anchor},middleware:[vb({mainAxis:a+E,alignmentAxis:i}),d&&bb({mainAxis:!0,crossAxis:!1,limiter:u==="partial"?yb():void 0,...T}),d&&jb({...T}),wb({...T,apply:({elements:_,rects:$,availableWidth:Z,availableHeight:de})=>{const{width:we,height:De}=$.reference,Ee=_.floating.style;Ee.setProperty("--radix-popper-available-width",`${Z}px`),Ee.setProperty("--radix-popper-available-height",`${de}px`),Ee.setProperty("--radix-popper-anchor-width",`${we}px`),Ee.setProperty("--radix-popper-anchor-height",`${De}px`)}}),g&&Sb({element:g,padding:c}),Mb({arrowWidth:P,arrowHeight:E}),f&&Nb({strategy:"referenceHidden",...T})]}),[Q,pe]=om(te),Pe=st(p);xt(()=>{xe&&(Pe==null||Pe())},[xe,Pe]);const Oe=(O=le.arrow)==null?void 0:O.x,qe=(ue=le.arrow)==null?void 0:ue.y,M=((K=le.arrow)==null?void 0:K.centerOffset)!==0,[re,ne]=l.useState();return xt(()=>{y&&ne(window.getComputedStyle(y).zIndex)},[y]),e.jsx("div",{ref:A.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:xe?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(ce=le.transformOrigin)==null?void 0:ce.x,(X=le.transformOrigin)==null?void 0:X.y].join(" "),...((F=le.hide)==null?void 0:F.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(Db,{scope:r,placedSide:Q,onArrowChange:w,arrowX:Oe,arrowY:qe,shouldHideArrow:M,children:e.jsx(je.div,{"data-side":Q,"data-align":pe,...x,ref:N,style:{...x.style,animation:xe?void 0:"none"}})})})});rm.displayName=Tl;var nm="PopperArrow",Eb={top:"bottom",right:"left",bottom:"top",left:"right"},am=l.forwardRef(function(s,r){const{__scopePopper:n,...a}=s,o=Ab(nm,n),i=Eb[o.placedSide];return e.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:e.jsx(Pb,{...a,ref:r,style:{...a.style,display:"block"}})})});am.displayName=nm;function Tb(t){return t!==null}var Mb=t=>({name:"transformOrigin",options:t,fn(s){var v,y,j;const{placement:r,rects:n,middlewareData:a}=s,i=((v=a.arrow)==null?void 0:v.centerOffset)!==0,c=i?0:t.arrowWidth,d=i?0:t.arrowHeight,[m,h]=om(r),u={start:"0%",center:"50%",end:"100%"}[h],f=(((y=a.arrow)==null?void 0:y.x)??0)+c/2,b=(((j=a.arrow)==null?void 0:j.y)??0)+d/2;let p="",x="";return m==="bottom"?(p=i?u:`${f}px`,x=`${-d}px`):m==="top"?(p=i?u:`${f}px`,x=`${n.floating.height+d}px`):m==="right"?(p=`${-d}px`,x=i?u:`${b}px`):m==="left"&&(p=`${n.floating.width+d}px`,x=i?u:`${b}px`),{data:{x:p,y:x}}}});function om(t){const[s,r="center"]=t.split("-");return[s,r]}var Ml=em,kl=sm,Rl=rm,Il=am;function im(t){const s=l.useRef({value:t,previous:t});return l.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var kb=function(t){if(typeof document>"u")return null;var s=Array.isArray(t)?t[0]:t;return s.ownerDocument.body},Yr=new WeakMap,La=new WeakMap,Oa={},fi=0,lm=function(t){return t&&(t.host||lm(t.parentNode))},Rb=function(t,s){return s.map(function(r){if(t.contains(r))return r;var n=lm(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},Ib=function(t,s,r,n){var a=Rb(s,Array.isArray(t)?t:[t]);Oa[r]||(Oa[r]=new WeakMap);var o=Oa[r],i=[],c=new Set,d=new Set(a),m=function(u){!u||c.has(u)||(c.add(u),m(u.parentNode))};a.forEach(m);var h=function(u){!u||d.has(u)||Array.prototype.forEach.call(u.children,function(f){if(c.has(f))h(f);else try{var b=f.getAttribute(n),p=b!==null&&b!=="false",x=(Yr.get(f)||0)+1,v=(o.get(f)||0)+1;Yr.set(f,x),o.set(f,v),i.push(f),x===1&&p&&La.set(f,!0),v===1&&f.setAttribute(r,"true"),p||f.setAttribute(n,"true")}catch(y){console.error("aria-hidden: cannot operate on ",f,y)}})};return h(s),c.clear(),fi++,function(){i.forEach(function(u){var f=Yr.get(u)-1,b=o.get(u)-1;Yr.set(u,f),o.set(u,b),f||(La.has(u)||u.removeAttribute(n),La.delete(u)),b||u.removeAttribute(r)}),fi--,fi||(Yr=new WeakMap,Yr=new WeakMap,La=new WeakMap,Oa={})}},Fl=function(t,s,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),a=kb(t);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),Ib(n,a,r,"aria-hidden")):function(){return null}},Ns=function(){return Ns=Object.assign||function(s){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},Ns.apply(this,arguments)};function cm(t,s){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)s.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function Fb(t,s,r){if(r||arguments.length===2)for(var n=0,a=s.length,o;n<a;n++)(o||!(n in s))&&(o||(o=Array.prototype.slice.call(s,0,n)),o[n]=s[n]);return t.concat(o||Array.prototype.slice.call(s))}var Ka="right-scroll-bar-position",Ja="width-before-scroll-bar",Lb="with-scroll-bars-hidden",Ob="--removed-body-scroll-bar-size";function xi(t,s){return typeof t=="function"?t(s):t&&(t.current=s),t}function Ub(t,s){var r=l.useState(function(){return{value:t,callback:s,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=s,r.facade}var $b=typeof window<"u"?l.useLayoutEffect:l.useEffect,Hc=new WeakMap;function Gb(t,s){var r=Ub(null,function(n){return t.forEach(function(a){return xi(a,n)})});return $b(function(){var n=Hc.get(r);if(n){var a=new Set(n),o=new Set(t),i=r.current;a.forEach(function(c){o.has(c)||xi(c,null)}),o.forEach(function(c){a.has(c)||xi(c,i)})}Hc.set(r,t)},[t]),r}function Bb(t){return t}function Vb(t,s){s===void 0&&(s=Bb);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(o){var i=s(o,n);return r.push(i),function(){r=r.filter(function(c){return c!==i})}},assignSyncMedium:function(o){for(n=!0;r.length;){var i=r;r=[],i.forEach(o)}r={push:function(c){return o(c)},filter:function(){return r}}},assignMedium:function(o){n=!0;var i=[];if(r.length){var c=r;r=[],c.forEach(o),i=r}var d=function(){var h=i;i=[],h.forEach(o)},m=function(){return Promise.resolve().then(d)};m(),r={push:function(h){i.push(h),m()},filter:function(h){return i=i.filter(h),r}}}};return a}function Wb(t){t===void 0&&(t={});var s=Vb(null);return s.options=Ns({async:!0,ssr:!1},t),s}var dm=function(t){var s=t.sideCar,r=cm(t,["sideCar"]);if(!s)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=s.read();if(!n)throw new Error("Sidecar medium not found");return l.createElement(n,Ns({},r))};dm.isSideCarExport=!0;function zb(t,s){return t.useMedium(s),dm}var um=Wb(),pi=function(){},Ao=l.forwardRef(function(t,s){var r=l.useRef(null),n=l.useState({onScrollCapture:pi,onWheelCapture:pi,onTouchMoveCapture:pi}),a=n[0],o=n[1],i=t.forwardProps,c=t.children,d=t.className,m=t.removeScrollBar,h=t.enabled,u=t.shards,f=t.sideCar,b=t.noIsolation,p=t.inert,x=t.allowPinchZoom,v=t.as,y=v===void 0?"div":v,j=t.gapMode,N=cm(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),g=f,w=Gb([r,s]),S=Ns(Ns({},N),a);return l.createElement(l.Fragment,null,h&&l.createElement(g,{sideCar:um,removeScrollBar:m,shards:u,noIsolation:b,inert:p,setCallbacks:o,allowPinchZoom:!!x,lockRef:r,gapMode:j}),i?l.cloneElement(l.Children.only(c),Ns(Ns({},S),{ref:w})):l.createElement(y,Ns({},S,{className:d,ref:w}),c))});Ao.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ao.classNames={fullWidth:Ja,zeroRight:Ka};var Hb=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function qb(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var s=Hb();return s&&t.setAttribute("nonce",s),t}function Yb(t,s){t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}function Kb(t){var s=document.head||document.getElementsByTagName("head")[0];s.appendChild(t)}var Jb=function(){var t=0,s=null;return{add:function(r){t==0&&(s=qb())&&(Yb(s,r),Kb(s)),t++},remove:function(){t--,!t&&s&&(s.parentNode&&s.parentNode.removeChild(s),s=null)}}},Qb=function(){var t=Jb();return function(s,r){l.useEffect(function(){return t.add(s),function(){t.remove()}},[s&&r])}},mm=function(){var t=Qb(),s=function(r){var n=r.styles,a=r.dynamic;return t(n,a),null};return s},Xb={left:0,top:0,right:0,gap:0},gi=function(t){return parseInt(t||"",10)||0},Zb=function(t){var s=window.getComputedStyle(document.body),r=s[t==="padding"?"paddingLeft":"marginLeft"],n=s[t==="padding"?"paddingTop":"marginTop"],a=s[t==="padding"?"paddingRight":"marginRight"];return[gi(r),gi(n),gi(a)]},ey=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Xb;var s=Zb(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:s[0],top:s[1],right:s[2],gap:Math.max(0,n-r+s[2]-s[0])}},ty=mm(),rn="data-scroll-locked",sy=function(t,s,r,n){var a=t.left,o=t.top,i=t.right,c=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(Lb,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(c,"px ").concat(n,`;
  }
  body[`).concat(rn,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([s&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(c,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ka,` {
    right: `).concat(c,"px ").concat(n,`;
  }
  
  .`).concat(Ja,` {
    margin-right: `).concat(c,"px ").concat(n,`;
  }
  
  .`).concat(Ka," .").concat(Ka,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Ja," .").concat(Ja,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(rn,`] {
    `).concat(Ob,": ").concat(c,`px;
  }
`)},qc=function(){var t=parseInt(document.body.getAttribute(rn)||"0",10);return isFinite(t)?t:0},ry=function(){l.useEffect(function(){return document.body.setAttribute(rn,(qc()+1).toString()),function(){var t=qc()-1;t<=0?document.body.removeAttribute(rn):document.body.setAttribute(rn,t.toString())}},[])},ny=function(t){var s=t.noRelative,r=t.noImportant,n=t.gapMode,a=n===void 0?"margin":n;ry();var o=l.useMemo(function(){return ey(a)},[a]);return l.createElement(ty,{styles:sy(o,!s,a,r?"":"!important")})},zi=!1;if(typeof window<"u")try{var Ua=Object.defineProperty({},"passive",{get:function(){return zi=!0,!0}});window.addEventListener("test",Ua,Ua),window.removeEventListener("test",Ua,Ua)}catch{zi=!1}var Kr=zi?{passive:!1}:!1,ay=function(t){return t.tagName==="TEXTAREA"},hm=function(t,s){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[s]!=="hidden"&&!(r.overflowY===r.overflowX&&!ay(t)&&r[s]==="visible")},oy=function(t){return hm(t,"overflowY")},iy=function(t){return hm(t,"overflowX")},Yc=function(t,s){var r=s.ownerDocument,n=s;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=fm(t,n);if(a){var o=xm(t,n),i=o[1],c=o[2];if(i>c)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},ly=function(t){var s=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[s,r,n]},cy=function(t){var s=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[s,r,n]},fm=function(t,s){return t==="v"?oy(s):iy(s)},xm=function(t,s){return t==="v"?ly(s):cy(s)},dy=function(t,s){return t==="h"&&s==="rtl"?-1:1},uy=function(t,s,r,n,a){var o=dy(t,window.getComputedStyle(s).direction),i=o*n,c=r.target,d=s.contains(c),m=!1,h=i>0,u=0,f=0;do{var b=xm(t,c),p=b[0],x=b[1],v=b[2],y=x-v-o*p;(p||y)&&fm(t,c)&&(u+=y,f+=p),c instanceof ShadowRoot?c=c.host:c=c.parentNode}while(!d&&c!==document.body||d&&(s.contains(c)||s===c));return(h&&Math.abs(u)<1||!h&&Math.abs(f)<1)&&(m=!0),m},$a=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Kc=function(t){return[t.deltaX,t.deltaY]},Jc=function(t){return t&&"current"in t?t.current:t},my=function(t,s){return t[0]===s[0]&&t[1]===s[1]},hy=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},fy=0,Jr=[];function xy(t){var s=l.useRef([]),r=l.useRef([0,0]),n=l.useRef(),a=l.useState(fy++)[0],o=l.useState(mm)[0],i=l.useRef(t);l.useEffect(function(){i.current=t},[t]),l.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var x=Fb([t.lockRef.current],(t.shards||[]).map(Jc),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var c=l.useCallback(function(x,v){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!i.current.allowPinchZoom;var y=$a(x),j=r.current,N="deltaX"in x?x.deltaX:j[0]-y[0],g="deltaY"in x?x.deltaY:j[1]-y[1],w,S=x.target,P=Math.abs(N)>Math.abs(g)?"h":"v";if("touches"in x&&P==="h"&&S.type==="range")return!1;var E=Yc(P,S);if(!E)return!0;if(E?w=P:(w=P==="v"?"h":"v",E=Yc(P,S)),!E)return!1;if(!n.current&&"changedTouches"in x&&(N||g)&&(n.current=w),!w)return!0;var D=n.current||w;return uy(D,v,x,D==="h"?N:g)},[]),d=l.useCallback(function(x){var v=x;if(!(!Jr.length||Jr[Jr.length-1]!==o)){var y="deltaY"in v?Kc(v):$a(v),j=s.current.filter(function(w){return w.name===v.type&&(w.target===v.target||v.target===w.shadowParent)&&my(w.delta,y)})[0];if(j&&j.should){v.cancelable&&v.preventDefault();return}if(!j){var N=(i.current.shards||[]).map(Jc).filter(Boolean).filter(function(w){return w.contains(v.target)}),g=N.length>0?c(v,N[0]):!i.current.noIsolation;g&&v.cancelable&&v.preventDefault()}}},[]),m=l.useCallback(function(x,v,y,j){var N={name:x,delta:v,target:y,should:j,shadowParent:py(y)};s.current.push(N),setTimeout(function(){s.current=s.current.filter(function(g){return g!==N})},1)},[]),h=l.useCallback(function(x){r.current=$a(x),n.current=void 0},[]),u=l.useCallback(function(x){m(x.type,Kc(x),x.target,c(x,t.lockRef.current))},[]),f=l.useCallback(function(x){m(x.type,$a(x),x.target,c(x,t.lockRef.current))},[]);l.useEffect(function(){return Jr.push(o),t.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:f}),document.addEventListener("wheel",d,Kr),document.addEventListener("touchmove",d,Kr),document.addEventListener("touchstart",h,Kr),function(){Jr=Jr.filter(function(x){return x!==o}),document.removeEventListener("wheel",d,Kr),document.removeEventListener("touchmove",d,Kr),document.removeEventListener("touchstart",h,Kr)}},[]);var b=t.removeScrollBar,p=t.inert;return l.createElement(l.Fragment,null,p?l.createElement(o,{styles:hy(a)}):null,b?l.createElement(ny,{gapMode:t.gapMode}):null)}function py(t){for(var s=null;t!==null;)t instanceof ShadowRoot&&(s=t.host,t=t.host),t=t.parentNode;return s}const gy=zb(um,xy);var Eo=l.forwardRef(function(t,s){return l.createElement(Ao,Ns({},t,{ref:s,sideCar:gy}))});Eo.classNames=Ao.classNames;var vy=[" ","Enter","ArrowUp","ArrowDown"],by=[" ","Enter"],Br="Select",[To,Mo,yy]=go(Br),[En,PS]=Wt(Br,[yy,An]),ko=An(),[jy,Cr]=En(Br),[wy,Ny]=En(Br),pm=t=>{const{__scopeSelect:s,children:r,open:n,defaultOpen:a,onOpenChange:o,value:i,defaultValue:c,onValueChange:d,dir:m,name:h,autoComplete:u,disabled:f,required:b,form:p}=t,x=ko(s),[v,y]=l.useState(null),[j,N]=l.useState(null),[g,w]=l.useState(!1),S=ba(m),[P,E]=Ps({prop:n,defaultProp:a??!1,onChange:o,caller:Br}),[D,G]=Ps({prop:i,defaultProp:c,onChange:d,caller:Br}),se=l.useRef(null),L=v?p||!!v.closest("form"):!0,[T,A]=l.useState(new Set),Y=Array.from(T).map(te=>te.props.value).join(";");return e.jsx(Ml,{...x,children:e.jsxs(jy,{required:b,scope:s,trigger:v,onTriggerChange:y,valueNode:j,onValueNodeChange:N,valueNodeHasChildren:g,onValueNodeHasChildrenChange:w,contentId:Zt(),value:D,onValueChange:G,open:P,onOpenChange:E,dir:S,triggerPointerDownPosRef:se,disabled:f,children:[e.jsx(To.Provider,{scope:s,children:e.jsx(wy,{scope:t.__scopeSelect,onNativeOptionAdd:l.useCallback(te=>{A(xe=>new Set(xe).add(te))},[]),onNativeOptionRemove:l.useCallback(te=>{A(xe=>{const le=new Set(xe);return le.delete(te),le})},[]),children:r})}),L?e.jsxs($m,{"aria-hidden":!0,required:b,tabIndex:-1,name:h,autoComplete:u,value:D,onChange:te=>G(te.target.value),disabled:f,form:p,children:[D===void 0?e.jsx("option",{value:""}):null,Array.from(T)]},Y):null]})})};pm.displayName=Br;var gm="SelectTrigger",vm=l.forwardRef((t,s)=>{const{__scopeSelect:r,disabled:n=!1,...a}=t,o=ko(r),i=Cr(gm,r),c=i.disabled||n,d=Me(s,i.onTriggerChange),m=Mo(r),h=l.useRef("touch"),[u,f,b]=Bm(x=>{const v=m().filter(N=>!N.disabled),y=v.find(N=>N.value===i.value),j=Vm(v,x,y);j!==void 0&&i.onValueChange(j.value)}),p=x=>{c||(i.onOpenChange(!0),b()),x&&(i.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return e.jsx(kl,{asChild:!0,...o,children:e.jsx(je.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":Gm(i.value)?"":void 0,...a,ref:d,onClick:oe(a.onClick,x=>{x.currentTarget.focus(),h.current!=="mouse"&&p(x)}),onPointerDown:oe(a.onPointerDown,x=>{h.current=x.pointerType;const v=x.target;v.hasPointerCapture(x.pointerId)&&v.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(p(x),x.preventDefault())}),onKeyDown:oe(a.onKeyDown,x=>{const v=u.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&f(x.key),!(v&&x.key===" ")&&vy.includes(x.key)&&(p(),x.preventDefault())})})})});vm.displayName=gm;var bm="SelectValue",ym=l.forwardRef((t,s)=>{const{__scopeSelect:r,className:n,style:a,children:o,placeholder:i="",...c}=t,d=Cr(bm,r),{onValueNodeHasChildrenChange:m}=d,h=o!==void 0,u=Me(s,d.onValueNodeChange);return xt(()=>{m(h)},[m,h]),e.jsx(je.span,{...c,ref:u,style:{pointerEvents:"none"},children:Gm(d.value)?e.jsx(e.Fragment,{children:i}):o})});ym.displayName=bm;var Sy="SelectIcon",jm=l.forwardRef((t,s)=>{const{__scopeSelect:r,children:n,...a}=t;return e.jsx(je.span,{"aria-hidden":!0,...a,ref:s,children:n||""})});jm.displayName=Sy;var Cy="SelectPortal",wm=t=>e.jsx(xa,{asChild:!0,...t});wm.displayName=Cy;var Vr="SelectContent",Nm=l.forwardRef((t,s)=>{const r=Cr(Vr,t.__scopeSelect),[n,a]=l.useState();if(xt(()=>{a(new DocumentFragment)},[]),!r.open){const o=n;return o?jn.createPortal(e.jsx(Sm,{scope:t.__scopeSelect,children:e.jsx(To.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),o):null}return e.jsx(Cm,{...t,ref:s})});Nm.displayName=Vr;var is=10,[Sm,Pr]=En(Vr),Py="SelectContentImpl",_y=Lr("SelectContent.RemoveScroll"),Cm=l.forwardRef((t,s)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:i,side:c,sideOffset:d,align:m,alignOffset:h,arrowPadding:u,collisionBoundary:f,collisionPadding:b,sticky:p,hideWhenDetached:x,avoidCollisions:v,...y}=t,j=Cr(Vr,r),[N,g]=l.useState(null),[w,S]=l.useState(null),P=Me(s,O=>g(O)),[E,D]=l.useState(null),[G,se]=l.useState(null),L=Mo(r),[T,A]=l.useState(!1),Y=l.useRef(!1);l.useEffect(()=>{if(N)return Fl(N)},[N]),wl();const te=l.useCallback(O=>{const[ue,...K]=L().map(F=>F.ref.current),[ce]=K.slice(-1),X=document.activeElement;for(const F of O)if(F===X||(F==null||F.scrollIntoView({block:"nearest"}),F===ue&&w&&(w.scrollTop=0),F===ce&&w&&(w.scrollTop=w.scrollHeight),F==null||F.focus(),document.activeElement!==X))return},[L,w]),xe=l.useCallback(()=>te([E,N]),[te,E,N]);l.useEffect(()=>{T&&xe()},[T,xe]);const{onOpenChange:le,triggerPointerDownPosRef:Q}=j;l.useEffect(()=>{if(N){let O={x:0,y:0};const ue=ce=>{var X,F;O={x:Math.abs(Math.round(ce.pageX)-(((X=Q.current)==null?void 0:X.x)??0)),y:Math.abs(Math.round(ce.pageY)-(((F=Q.current)==null?void 0:F.y)??0))}},K=ce=>{O.x<=10&&O.y<=10?ce.preventDefault():N.contains(ce.target)||le(!1),document.removeEventListener("pointermove",ue),Q.current=null};return Q.current!==null&&(document.addEventListener("pointermove",ue),document.addEventListener("pointerup",K,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ue),document.removeEventListener("pointerup",K,{capture:!0})}}},[N,le,Q]),l.useEffect(()=>{const O=()=>le(!1);return window.addEventListener("blur",O),window.addEventListener("resize",O),()=>{window.removeEventListener("blur",O),window.removeEventListener("resize",O)}},[le]);const[pe,Pe]=Bm(O=>{const ue=L().filter(X=>!X.disabled),K=ue.find(X=>X.ref.current===document.activeElement),ce=Vm(ue,O,K);ce&&setTimeout(()=>ce.ref.current.focus())}),Oe=l.useCallback((O,ue,K)=>{const ce=!Y.current&&!K;(j.value!==void 0&&j.value===ue||ce)&&(D(O),ce&&(Y.current=!0))},[j.value]),qe=l.useCallback(()=>N==null?void 0:N.focus(),[N]),M=l.useCallback((O,ue,K)=>{const ce=!Y.current&&!K;(j.value!==void 0&&j.value===ue||ce)&&se(O)},[j.value]),re=n==="popper"?Hi:Pm,ne=re===Hi?{side:c,sideOffset:d,align:m,alignOffset:h,arrowPadding:u,collisionBoundary:f,collisionPadding:b,sticky:p,hideWhenDetached:x,avoidCollisions:v}:{};return e.jsx(Sm,{scope:r,content:N,viewport:w,onViewportChange:S,itemRefCallback:Oe,selectedItem:E,onItemLeave:qe,itemTextRefCallback:M,focusSelectedItem:xe,selectedItemText:G,position:n,isPositioned:T,searchRef:pe,children:e.jsx(Eo,{as:_y,allowPinchZoom:!0,children:e.jsx(Co,{asChild:!0,trapped:j.open,onMountAutoFocus:O=>{O.preventDefault()},onUnmountAutoFocus:oe(a,O=>{var ue;(ue=j.trigger)==null||ue.focus({preventScroll:!0}),O.preventDefault()}),children:e.jsx(Sn,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:O=>O.preventDefault(),onDismiss:()=>j.onOpenChange(!1),children:e.jsx(re,{role:"listbox",id:j.contentId,"data-state":j.open?"open":"closed",dir:j.dir,onContextMenu:O=>O.preventDefault(),...y,...ne,onPlaced:()=>A(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:oe(y.onKeyDown,O=>{const ue=O.ctrlKey||O.altKey||O.metaKey;if(O.key==="Tab"&&O.preventDefault(),!ue&&O.key.length===1&&Pe(O.key),["ArrowUp","ArrowDown","Home","End"].includes(O.key)){let ce=L().filter(X=>!X.disabled).map(X=>X.ref.current);if(["ArrowUp","End"].includes(O.key)&&(ce=ce.slice().reverse()),["ArrowUp","ArrowDown"].includes(O.key)){const X=O.target,F=ce.indexOf(X);ce=ce.slice(F+1)}setTimeout(()=>te(ce)),O.preventDefault()}})})})})})})});Cm.displayName=Py;var Dy="SelectItemAlignedPosition",Pm=l.forwardRef((t,s)=>{const{__scopeSelect:r,onPlaced:n,...a}=t,o=Cr(Vr,r),i=Pr(Vr,r),[c,d]=l.useState(null),[m,h]=l.useState(null),u=Me(s,P=>h(P)),f=Mo(r),b=l.useRef(!1),p=l.useRef(!0),{viewport:x,selectedItem:v,selectedItemText:y,focusSelectedItem:j}=i,N=l.useCallback(()=>{if(o.trigger&&o.valueNode&&c&&m&&x&&v&&y){const P=o.trigger.getBoundingClientRect(),E=m.getBoundingClientRect(),D=o.valueNode.getBoundingClientRect(),G=y.getBoundingClientRect();if(o.dir!=="rtl"){const X=G.left-E.left,F=D.left-X,_=P.left-F,$=P.width+_,Z=Math.max($,E.width),de=window.innerWidth-is,we=Gi(F,[is,Math.max(is,de-Z)]);c.style.minWidth=$+"px",c.style.left=we+"px"}else{const X=E.right-G.right,F=window.innerWidth-D.right-X,_=window.innerWidth-P.right-F,$=P.width+_,Z=Math.max($,E.width),de=window.innerWidth-is,we=Gi(F,[is,Math.max(is,de-Z)]);c.style.minWidth=$+"px",c.style.right=we+"px"}const se=f(),L=window.innerHeight-is*2,T=x.scrollHeight,A=window.getComputedStyle(m),Y=parseInt(A.borderTopWidth,10),te=parseInt(A.paddingTop,10),xe=parseInt(A.borderBottomWidth,10),le=parseInt(A.paddingBottom,10),Q=Y+te+T+le+xe,pe=Math.min(v.offsetHeight*5,Q),Pe=window.getComputedStyle(x),Oe=parseInt(Pe.paddingTop,10),qe=parseInt(Pe.paddingBottom,10),M=P.top+P.height/2-is,re=L-M,ne=v.offsetHeight/2,O=v.offsetTop+ne,ue=Y+te+O,K=Q-ue;if(ue<=M){const X=se.length>0&&v===se[se.length-1].ref.current;c.style.bottom="0px";const F=m.clientHeight-x.offsetTop-x.offsetHeight,_=Math.max(re,ne+(X?qe:0)+F+xe),$=ue+_;c.style.height=$+"px"}else{const X=se.length>0&&v===se[0].ref.current;c.style.top="0px";const _=Math.max(M,Y+x.offsetTop+(X?Oe:0)+ne)+K;c.style.height=_+"px",x.scrollTop=ue-M+x.offsetTop}c.style.margin=`${is}px 0`,c.style.minHeight=pe+"px",c.style.maxHeight=L+"px",n==null||n(),requestAnimationFrame(()=>b.current=!0)}},[f,o.trigger,o.valueNode,c,m,x,v,y,o.dir,n]);xt(()=>N(),[N]);const[g,w]=l.useState();xt(()=>{m&&w(window.getComputedStyle(m).zIndex)},[m]);const S=l.useCallback(P=>{P&&p.current===!0&&(N(),j==null||j(),p.current=!1)},[N,j]);return e.jsx(Ey,{scope:r,contentWrapper:c,shouldExpandOnScrollRef:b,onScrollButtonChange:S,children:e.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:g},children:e.jsx(je.div,{...a,ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Pm.displayName=Dy;var Ay="SelectPopperPosition",Hi=l.forwardRef((t,s)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=is,...o}=t,i=ko(r);return e.jsx(Rl,{...i,...o,ref:s,align:n,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Hi.displayName=Ay;var[Ey,Ll]=En(Vr,{}),qi="SelectViewport",_m=l.forwardRef((t,s)=>{const{__scopeSelect:r,nonce:n,...a}=t,o=Pr(qi,r),i=Ll(qi,r),c=Me(s,o.onViewportChange),d=l.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(To.Slot,{scope:r,children:e.jsx(je.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:oe(a.onScroll,m=>{const h=m.currentTarget,{contentWrapper:u,shouldExpandOnScrollRef:f}=i;if(f!=null&&f.current&&u){const b=Math.abs(d.current-h.scrollTop);if(b>0){const p=window.innerHeight-is*2,x=parseFloat(u.style.minHeight),v=parseFloat(u.style.height),y=Math.max(x,v);if(y<p){const j=y+b,N=Math.min(p,j),g=j-N;u.style.height=N+"px",u.style.bottom==="0px"&&(h.scrollTop=g>0?g:0,u.style.justifyContent="flex-end")}}}d.current=h.scrollTop})})})]})});_m.displayName=qi;var Dm="SelectGroup",[Ty,My]=En(Dm),ky=l.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=Zt();return e.jsx(Ty,{scope:r,id:a,children:e.jsx(je.div,{role:"group","aria-labelledby":a,...n,ref:s})})});ky.displayName=Dm;var Am="SelectLabel",Em=l.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=My(Am,r);return e.jsx(je.div,{id:a.id,...n,ref:s})});Em.displayName=Am;var ao="SelectItem",[Ry,Tm]=En(ao),Mm=l.forwardRef((t,s)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:o,...i}=t,c=Cr(ao,r),d=Pr(ao,r),m=c.value===n,[h,u]=l.useState(o??""),[f,b]=l.useState(!1),p=Me(s,j=>{var N;return(N=d.itemRefCallback)==null?void 0:N.call(d,j,n,a)}),x=Zt(),v=l.useRef("touch"),y=()=>{a||(c.onValueChange(n),c.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(Ry,{scope:r,value:n,disabled:a,textId:x,isSelected:m,onItemTextChange:l.useCallback(j=>{u(N=>N||((j==null?void 0:j.textContent)??"").trim())},[]),children:e.jsx(To.ItemSlot,{scope:r,value:n,disabled:a,textValue:h,children:e.jsx(je.div,{role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":m&&f,"data-state":m?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:p,onFocus:oe(i.onFocus,()=>b(!0)),onBlur:oe(i.onBlur,()=>b(!1)),onClick:oe(i.onClick,()=>{v.current!=="mouse"&&y()}),onPointerUp:oe(i.onPointerUp,()=>{v.current==="mouse"&&y()}),onPointerDown:oe(i.onPointerDown,j=>{v.current=j.pointerType}),onPointerMove:oe(i.onPointerMove,j=>{var N;v.current=j.pointerType,a?(N=d.onItemLeave)==null||N.call(d):v.current==="mouse"&&j.currentTarget.focus({preventScroll:!0})}),onPointerLeave:oe(i.onPointerLeave,j=>{var N;j.currentTarget===document.activeElement&&((N=d.onItemLeave)==null||N.call(d))}),onKeyDown:oe(i.onKeyDown,j=>{var g;((g=d.searchRef)==null?void 0:g.current)!==""&&j.key===" "||(by.includes(j.key)&&y(),j.key===" "&&j.preventDefault())})})})})});Mm.displayName=ao;var Hn="SelectItemText",km=l.forwardRef((t,s)=>{const{__scopeSelect:r,className:n,style:a,...o}=t,i=Cr(Hn,r),c=Pr(Hn,r),d=Tm(Hn,r),m=Ny(Hn,r),[h,u]=l.useState(null),f=Me(s,y=>u(y),d.onItemTextChange,y=>{var j;return(j=c.itemTextRefCallback)==null?void 0:j.call(c,y,d.value,d.disabled)}),b=h==null?void 0:h.textContent,p=l.useMemo(()=>e.jsx("option",{value:d.value,disabled:d.disabled,children:b},d.value),[d.disabled,d.value,b]),{onNativeOptionAdd:x,onNativeOptionRemove:v}=m;return xt(()=>(x(p),()=>v(p)),[x,v,p]),e.jsxs(e.Fragment,{children:[e.jsx(je.span,{id:d.textId,...o,ref:f}),d.isSelected&&i.valueNode&&!i.valueNodeHasChildren?jn.createPortal(o.children,i.valueNode):null]})});km.displayName=Hn;var Rm="SelectItemIndicator",Im=l.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t;return Tm(Rm,r).isSelected?e.jsx(je.span,{"aria-hidden":!0,...n,ref:s}):null});Im.displayName=Rm;var Yi="SelectScrollUpButton",Fm=l.forwardRef((t,s)=>{const r=Pr(Yi,t.__scopeSelect),n=Ll(Yi,t.__scopeSelect),[a,o]=l.useState(!1),i=Me(s,n.onScrollButtonChange);return xt(()=>{if(r.viewport&&r.isPositioned){let c=function(){const m=d.scrollTop>0;o(m)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),a?e.jsx(Om,{...t,ref:i,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});Fm.displayName=Yi;var Ki="SelectScrollDownButton",Lm=l.forwardRef((t,s)=>{const r=Pr(Ki,t.__scopeSelect),n=Ll(Ki,t.__scopeSelect),[a,o]=l.useState(!1),i=Me(s,n.onScrollButtonChange);return xt(()=>{if(r.viewport&&r.isPositioned){let c=function(){const m=d.scrollHeight-d.clientHeight,h=Math.ceil(d.scrollTop)<m;o(h)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),a?e.jsx(Om,{...t,ref:i,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});Lm.displayName=Ki;var Om=l.forwardRef((t,s)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=t,o=Pr("SelectScrollButton",r),i=l.useRef(null),c=Mo(r),d=l.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return l.useEffect(()=>()=>d(),[d]),xt(()=>{var h;const m=c().find(u=>u.ref.current===document.activeElement);(h=m==null?void 0:m.ref.current)==null||h.scrollIntoView({block:"nearest"})},[c]),e.jsx(je.div,{"aria-hidden":!0,...a,ref:s,style:{flexShrink:0,...a.style},onPointerDown:oe(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:oe(a.onPointerMove,()=>{var m;(m=o.onItemLeave)==null||m.call(o),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:oe(a.onPointerLeave,()=>{d()})})}),Iy="SelectSeparator",Um=l.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t;return e.jsx(je.div,{"aria-hidden":!0,...n,ref:s})});Um.displayName=Iy;var Ji="SelectArrow",Fy=l.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=ko(r),o=Cr(Ji,r),i=Pr(Ji,r);return o.open&&i.position==="popper"?e.jsx(Il,{...a,...n,ref:s}):null});Fy.displayName=Ji;var Ly="SelectBubbleInput",$m=l.forwardRef(({__scopeSelect:t,value:s,...r},n)=>{const a=l.useRef(null),o=Me(n,a),i=im(s);return l.useEffect(()=>{const c=a.current;if(!c)return;const d=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(d,"value").set;if(i!==s&&h){const u=new Event("change",{bubbles:!0});h.call(c,s),c.dispatchEvent(u)}},[i,s]),e.jsx(je.select,{...r,style:{...qd,...r.style},ref:o,defaultValue:s})});$m.displayName=Ly;function Gm(t){return t===""||t===void 0}function Bm(t){const s=st(t),r=l.useRef(""),n=l.useRef(0),a=l.useCallback(i=>{const c=r.current+i;s(c),function d(m){r.current=m,window.clearTimeout(n.current),m!==""&&(n.current=window.setTimeout(()=>d(""),1e3))}(c)},[s]),o=l.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return l.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,o]}function Vm(t,s,r){const a=s.length>1&&Array.from(s).every(m=>m===s[0])?s[0]:s,o=r?t.indexOf(r):-1;let i=Oy(t,Math.max(o,0));a.length===1&&(i=i.filter(m=>m!==r));const d=i.find(m=>m.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==r?d:void 0}function Oy(t,s){return t.map((r,n)=>t[(s+n)%t.length])}var Uy=pm,Wm=vm,$y=ym,Gy=jm,By=wm,zm=Nm,Vy=_m,Hm=Em,qm=Mm,Wy=km,zy=Im,Ym=Fm,Km=Lm,Jm=Um;const mt=Uy,ht=$y,rt=l.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(Wm,{ref:n,className:ge("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[s,e.jsx(Gy,{asChild:!0,children:e.jsx(ke,{className:"h-4 w-4 opacity-50"})})]}));rt.displayName=Wm.displayName;const Qm=l.forwardRef(({className:t,...s},r)=>e.jsx(Ym,{ref:r,className:ge("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Ut,{className:"h-4 w-4"})}));Qm.displayName=Ym.displayName;const Xm=l.forwardRef(({className:t,...s},r)=>e.jsx(Km,{ref:r,className:ge("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(ke,{className:"h-4 w-4"})}));Xm.displayName=Km.displayName;const nt=l.forwardRef(({className:t,children:s,position:r="popper",...n},a)=>e.jsx(By,{children:e.jsxs(zm,{ref:a,className:ge("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[e.jsx(Qm,{}),e.jsx(Vy,{className:ge("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Xm,{})]})}));nt.displayName=zm.displayName;const Hy=l.forwardRef(({className:t,...s},r)=>e.jsx(Hm,{ref:r,className:ge("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));Hy.displayName=Hm.displayName;const Re=l.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(qm,{ref:n,className:ge("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(zy,{children:e.jsx(Cn,{className:"h-4 w-4"})})}),e.jsx(Wy,{children:s})]}));Re.displayName=qm.displayName;const qy=l.forwardRef(({className:t,...s},r)=>e.jsx(Jm,{ref:r,className:ge("-mx-1 my-1 h-px bg-muted",t),...s}));qy.displayName=Jm.displayName;var vi="rovingFocusGroup.onEntryFocus",Yy={bubbles:!1,cancelable:!0},ja="RovingFocusGroup",[Qi,Zm,Ky]=go(ja),[Jy,Ro]=Wt(ja,[Ky]),[Qy,Xy]=Jy(ja),eh=l.forwardRef((t,s)=>e.jsx(Qi.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Qi.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Zy,{...t,ref:s})})}));eh.displayName=ja;var Zy=l.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:m,preventScrollOnEntryFocus:h=!1,...u}=t,f=l.useRef(null),b=Me(s,f),p=ba(o),[x,v]=Ps({prop:i,defaultProp:c??null,onChange:d,caller:ja}),[y,j]=l.useState(!1),N=st(m),g=Zm(r),w=l.useRef(!1),[S,P]=l.useState(0);return l.useEffect(()=>{const E=f.current;if(E)return E.addEventListener(vi,N),()=>E.removeEventListener(vi,N)},[N]),e.jsx(Qy,{scope:r,orientation:n,dir:p,loop:a,currentTabStopId:x,onItemFocus:l.useCallback(E=>v(E),[v]),onItemShiftTab:l.useCallback(()=>j(!0),[]),onFocusableItemAdd:l.useCallback(()=>P(E=>E+1),[]),onFocusableItemRemove:l.useCallback(()=>P(E=>E-1),[]),children:e.jsx(je.div,{tabIndex:y||S===0?-1:0,"data-orientation":n,...u,ref:b,style:{outline:"none",...t.style},onMouseDown:oe(t.onMouseDown,()=>{w.current=!0}),onFocus:oe(t.onFocus,E=>{const D=!w.current;if(E.target===E.currentTarget&&D&&!y){const G=new CustomEvent(vi,Yy);if(E.currentTarget.dispatchEvent(G),!G.defaultPrevented){const se=g().filter(te=>te.focusable),L=se.find(te=>te.active),T=se.find(te=>te.id===x),Y=[L,T,...se].filter(Boolean).map(te=>te.ref.current);rh(Y,h)}}w.current=!1}),onBlur:oe(t.onBlur,()=>j(!1))})})}),th="RovingFocusGroupItem",sh=l.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:o,children:i,...c}=t,d=Zt(),m=o||d,h=Xy(th,r),u=h.currentTabStopId===m,f=Zm(r),{onFocusableItemAdd:b,onFocusableItemRemove:p,currentTabStopId:x}=h;return l.useEffect(()=>{if(n)return b(),()=>p()},[n,b,p]),e.jsx(Qi.ItemSlot,{scope:r,id:m,focusable:n,active:a,children:e.jsx(je.span,{tabIndex:u?0:-1,"data-orientation":h.orientation,...c,ref:s,onMouseDown:oe(t.onMouseDown,v=>{n?h.onItemFocus(m):v.preventDefault()}),onFocus:oe(t.onFocus,()=>h.onItemFocus(m)),onKeyDown:oe(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){h.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const y=sj(v,h.orientation,h.dir);if(y!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let N=f().filter(g=>g.focusable).map(g=>g.ref.current);if(y==="last")N.reverse();else if(y==="prev"||y==="next"){y==="prev"&&N.reverse();const g=N.indexOf(v.currentTarget);N=h.loop?rj(N,g+1):N.slice(g+1)}setTimeout(()=>rh(N))}}),children:typeof i=="function"?i({isCurrentTabStop:u,hasTabStop:x!=null}):i})})});sh.displayName=th;var ej={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function tj(t,s){return s!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function sj(t,s,r){const n=tj(t.key,r);if(!(s==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(s==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return ej[n]}function rh(t,s=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:s}),document.activeElement!==r))return}function rj(t,s){return t.map((r,n)=>t[(s+n)%t.length])}var nh=eh,ah=sh,Io="Tabs",[nj,_S]=Wt(Io,[Ro]),oh=Ro(),[aj,Ol]=nj(Io),ih=l.forwardRef((t,s)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:o,orientation:i="horizontal",dir:c,activationMode:d="automatic",...m}=t,h=ba(c),[u,f]=Ps({prop:n,onChange:a,defaultProp:o??"",caller:Io});return e.jsx(aj,{scope:r,baseId:Zt(),value:u,onValueChange:f,orientation:i,dir:h,activationMode:d,children:e.jsx(je.div,{dir:h,"data-orientation":i,...m,ref:s})})});ih.displayName=Io;var lh="TabsList",ch=l.forwardRef((t,s)=>{const{__scopeTabs:r,loop:n=!0,...a}=t,o=Ol(lh,r),i=oh(r);return e.jsx(nh,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:n,children:e.jsx(je.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:s})})});ch.displayName=lh;var dh="TabsTrigger",uh=l.forwardRef((t,s)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...o}=t,i=Ol(dh,r),c=oh(r),d=fh(i.baseId,n),m=xh(i.baseId,n),h=n===i.value;return e.jsx(ah,{asChild:!0,...c,focusable:!a,active:h,children:e.jsx(je.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":m,"data-state":h?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:d,...o,ref:s,onMouseDown:oe(t.onMouseDown,u=>{!a&&u.button===0&&u.ctrlKey===!1?i.onValueChange(n):u.preventDefault()}),onKeyDown:oe(t.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&i.onValueChange(n)}),onFocus:oe(t.onFocus,()=>{const u=i.activationMode!=="manual";!h&&!a&&u&&i.onValueChange(n)})})})});uh.displayName=dh;var mh="TabsContent",hh=l.forwardRef((t,s)=>{const{__scopeTabs:r,value:n,forceMount:a,children:o,...i}=t,c=Ol(mh,r),d=fh(c.baseId,n),m=xh(c.baseId,n),h=n===c.value,u=l.useRef(h);return l.useEffect(()=>{const f=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(f)},[]),e.jsx(jt,{present:a||h,children:({present:f})=>e.jsx(je.div,{"data-state":h?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!f,id:m,tabIndex:0,...i,ref:s,style:{...t.style,animationDuration:u.current?"0s":void 0},children:f&&o})})});hh.displayName=mh;function fh(t,s){return`${t}-trigger-${s}`}function xh(t,s){return`${t}-content-${s}`}var oj=ih,ph=ch,gh=uh,vh=hh;const _r=oj,Xs=l.forwardRef(({className:t,...s},r)=>e.jsx(ph,{ref:r,className:ge("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...s}));Xs.displayName=ph.displayName;const Ve=l.forwardRef(({className:t,...s},r)=>e.jsx(gh,{ref:r,className:ge("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...s}));Ve.displayName=gh.displayName;const ze=l.forwardRef(({className:t,...s},r)=>e.jsx(vh,{ref:r,className:ge("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));ze.displayName=vh.displayName;const at=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:ge("w-full caption-bottom text-sm",t),...s})}));at.displayName="Table";const ot=l.forwardRef(({className:t,...s},r)=>e.jsx("thead",{ref:r,className:ge("[&_tr]:border-b",t),...s}));ot.displayName="TableHeader";const it=l.forwardRef(({className:t,...s},r)=>e.jsx("tbody",{ref:r,className:ge("[&_tr:last-child]:border-0",t),...s}));it.displayName="TableBody";const ij=l.forwardRef(({className:t,...s},r)=>e.jsx("tfoot",{ref:r,className:ge("border-t bg-muted/50 font-medium",t),...s}));ij.displayName="TableFooter";const Se=l.forwardRef(({className:t,...s},r)=>e.jsx("tr",{ref:r,className:ge("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s}));Se.displayName="TableRow";const H=l.forwardRef(({className:t,...s},r)=>e.jsx("th",{ref:r,className:ge("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s}));H.displayName="TableHead";const U=l.forwardRef(({className:t,...s},r)=>e.jsx("td",{ref:r,className:ge("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s}));U.displayName="TableCell";const lj=l.forwardRef(({className:t,...s},r)=>e.jsx("caption",{ref:r,className:ge("mt-4 text-sm text-muted-foreground",t),...s}));lj.displayName="TableCaption";const cj=ga("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ue({className:t,variant:s,...r}){return e.jsx("div",{className:ge(cj({variant:s}),t),...r})}function dj(t,s){return l.useReducer((r,n)=>s[r][n]??r,t)}var Ul="ScrollArea",[bh,DS]=Wt(Ul),[uj,ss]=bh(Ul),yh=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:o=600,...i}=t,[c,d]=l.useState(null),[m,h]=l.useState(null),[u,f]=l.useState(null),[b,p]=l.useState(null),[x,v]=l.useState(null),[y,j]=l.useState(0),[N,g]=l.useState(0),[w,S]=l.useState(!1),[P,E]=l.useState(!1),D=Me(s,se=>d(se)),G=ba(a);return e.jsx(uj,{scope:r,type:n,dir:G,scrollHideDelay:o,scrollArea:c,viewport:m,onViewportChange:h,content:u,onContentChange:f,scrollbarX:b,onScrollbarXChange:p,scrollbarXEnabled:w,onScrollbarXEnabledChange:S,scrollbarY:x,onScrollbarYChange:v,scrollbarYEnabled:P,onScrollbarYEnabledChange:E,onCornerWidthChange:j,onCornerHeightChange:g,children:e.jsx(je.div,{dir:G,...i,ref:D,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":N+"px",...t.style}})})});yh.displayName=Ul;var jh="ScrollAreaViewport",wh=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,children:n,nonce:a,...o}=t,i=ss(jh,r),c=l.useRef(null),d=Me(s,c,i.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),e.jsx(je.div,{"data-radix-scroll-area-viewport":"",...o,ref:d,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});wh.displayName=jh;var Es="ScrollAreaScrollbar",$l=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,a=ss(Es,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:i}=a,c=t.orientation==="horizontal";return l.useEffect(()=>(c?o(!0):i(!0),()=>{c?o(!1):i(!1)}),[c,o,i]),a.type==="hover"?e.jsx(mj,{...n,ref:s,forceMount:r}):a.type==="scroll"?e.jsx(hj,{...n,ref:s,forceMount:r}):a.type==="auto"?e.jsx(Nh,{...n,ref:s,forceMount:r}):a.type==="always"?e.jsx(Gl,{...n,ref:s}):null});$l.displayName=Es;var mj=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,a=ss(Es,t.__scopeScrollArea),[o,i]=l.useState(!1);return l.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const m=()=>{window.clearTimeout(d),i(!0)},h=()=>{d=window.setTimeout(()=>i(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",m),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",m),c.removeEventListener("pointerleave",h)}}},[a.scrollArea,a.scrollHideDelay]),e.jsx(jt,{present:r||o,children:e.jsx(Nh,{"data-state":o?"visible":"hidden",...n,ref:s})})}),hj=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,a=ss(Es,t.__scopeScrollArea),o=t.orientation==="horizontal",i=Lo(()=>d("SCROLL_END"),100),[c,d]=dj("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return l.useEffect(()=>{if(c==="idle"){const m=window.setTimeout(()=>d("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(m)}},[c,a.scrollHideDelay,d]),l.useEffect(()=>{const m=a.viewport,h=o?"scrollLeft":"scrollTop";if(m){let u=m[h];const f=()=>{const b=m[h];u!==b&&(d("SCROLL"),i()),u=b};return m.addEventListener("scroll",f),()=>m.removeEventListener("scroll",f)}},[a.viewport,o,d,i]),e.jsx(jt,{present:r||c!=="hidden",children:e.jsx(Gl,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:s,onPointerEnter:oe(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:oe(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),Nh=l.forwardRef((t,s)=>{const r=ss(Es,t.__scopeScrollArea),{forceMount:n,...a}=t,[o,i]=l.useState(!1),c=t.orientation==="horizontal",d=Lo(()=>{if(r.viewport){const m=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;i(c?m:h)}},10);return gn(r.viewport,d),gn(r.content,d),e.jsx(jt,{present:n||o,children:e.jsx(Gl,{"data-state":o?"visible":"hidden",...a,ref:s})})}),Gl=l.forwardRef((t,s)=>{const{orientation:r="vertical",...n}=t,a=ss(Es,t.__scopeScrollArea),o=l.useRef(null),i=l.useRef(0),[c,d]=l.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),m=Dh(c.viewport,c.content),h={...n,sizes:c,onSizesChange:d,hasThumb:m>0&&m<1,onThumbChange:f=>o.current=f,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:f=>i.current=f};function u(f,b){return bj(f,i.current,c,b)}return r==="horizontal"?e.jsx(fj,{...h,ref:s,onThumbPositionChange:()=>{if(a.viewport&&o.current){const f=a.viewport.scrollLeft,b=Qc(f,c,a.dir);o.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollLeft=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollLeft=u(f,a.dir))}}):r==="vertical"?e.jsx(xj,{...h,ref:s,onThumbPositionChange:()=>{if(a.viewport&&o.current){const f=a.viewport.scrollTop,b=Qc(f,c);o.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollTop=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollTop=u(f))}}):null}),fj=l.forwardRef((t,s)=>{const{sizes:r,onSizesChange:n,...a}=t,o=ss(Es,t.__scopeScrollArea),[i,c]=l.useState(),d=l.useRef(null),m=Me(s,d,o.onScrollbarXChange);return l.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(Ch,{"data-orientation":"horizontal",...a,ref:m,sizes:r,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Fo(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,u)=>{if(o.viewport){const f=o.viewport.scrollLeft+h.deltaX;t.onWheelScroll(f),Eh(f,u)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&i&&n({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:io(i.paddingLeft),paddingEnd:io(i.paddingRight)}})}})}),xj=l.forwardRef((t,s)=>{const{sizes:r,onSizesChange:n,...a}=t,o=ss(Es,t.__scopeScrollArea),[i,c]=l.useState(),d=l.useRef(null),m=Me(s,d,o.onScrollbarYChange);return l.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(Ch,{"data-orientation":"vertical",...a,ref:m,sizes:r,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Fo(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,u)=>{if(o.viewport){const f=o.viewport.scrollTop+h.deltaY;t.onWheelScroll(f),Eh(f,u)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&i&&n({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:io(i.paddingTop),paddingEnd:io(i.paddingBottom)}})}})}),[pj,Sh]=bh(Es),Ch=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:o,onThumbPointerUp:i,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:m,onWheelScroll:h,onResize:u,...f}=t,b=ss(Es,r),[p,x]=l.useState(null),v=Me(s,D=>x(D)),y=l.useRef(null),j=l.useRef(""),N=b.viewport,g=n.content-n.viewport,w=st(h),S=st(d),P=Lo(u,10);function E(D){if(y.current){const G=D.clientX-y.current.left,se=D.clientY-y.current.top;m({x:G,y:se})}}return l.useEffect(()=>{const D=G=>{const se=G.target;(p==null?void 0:p.contains(se))&&w(G,g)};return document.addEventListener("wheel",D,{passive:!1}),()=>document.removeEventListener("wheel",D,{passive:!1})},[N,p,g,w]),l.useEffect(S,[n,S]),gn(p,P),gn(b.content,P),e.jsx(pj,{scope:r,scrollbar:p,hasThumb:a,onThumbChange:st(o),onThumbPointerUp:st(i),onThumbPositionChange:S,onThumbPointerDown:st(c),children:e.jsx(je.div,{...f,ref:v,style:{position:"absolute",...f.style},onPointerDown:oe(t.onPointerDown,D=>{D.button===0&&(D.target.setPointerCapture(D.pointerId),y.current=p.getBoundingClientRect(),j.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),E(D))}),onPointerMove:oe(t.onPointerMove,E),onPointerUp:oe(t.onPointerUp,D=>{const G=D.target;G.hasPointerCapture(D.pointerId)&&G.releasePointerCapture(D.pointerId),document.body.style.webkitUserSelect=j.current,b.viewport&&(b.viewport.style.scrollBehavior=""),y.current=null})})})}),oo="ScrollAreaThumb",Ph=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,a=Sh(oo,t.__scopeScrollArea);return e.jsx(jt,{present:r||a.hasThumb,children:e.jsx(gj,{ref:s,...n})})}),gj=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,style:n,...a}=t,o=ss(oo,r),i=Sh(oo,r),{onThumbPositionChange:c}=i,d=Me(s,u=>i.onThumbChange(u)),m=l.useRef(void 0),h=Lo(()=>{m.current&&(m.current(),m.current=void 0)},100);return l.useEffect(()=>{const u=o.viewport;if(u){const f=()=>{if(h(),!m.current){const b=yj(u,c);m.current=b,c()}};return c(),u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[o.viewport,h,c]),e.jsx(je.div,{"data-state":i.hasThumb?"visible":"hidden",...a,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:oe(t.onPointerDownCapture,u=>{const b=u.target.getBoundingClientRect(),p=u.clientX-b.left,x=u.clientY-b.top;i.onThumbPointerDown({x:p,y:x})}),onPointerUp:oe(t.onPointerUp,i.onThumbPointerUp)})});Ph.displayName=oo;var Bl="ScrollAreaCorner",_h=l.forwardRef((t,s)=>{const r=ss(Bl,t.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?e.jsx(vj,{...t,ref:s}):null});_h.displayName=Bl;var vj=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,...n}=t,a=ss(Bl,r),[o,i]=l.useState(0),[c,d]=l.useState(0),m=!!(o&&c);return gn(a.scrollbarX,()=>{var u;const h=((u=a.scrollbarX)==null?void 0:u.offsetHeight)||0;a.onCornerHeightChange(h),d(h)}),gn(a.scrollbarY,()=>{var u;const h=((u=a.scrollbarY)==null?void 0:u.offsetWidth)||0;a.onCornerWidthChange(h),i(h)}),m?e.jsx(je.div,{...n,ref:s,style:{width:o,height:c,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function io(t){return t?parseInt(t,10):0}function Dh(t,s){const r=t/s;return isNaN(r)?0:r}function Fo(t){const s=Dh(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=(t.scrollbar.size-r)*s;return Math.max(n,18)}function bj(t,s,r,n="ltr"){const a=Fo(r),o=a/2,i=s||o,c=a-i,d=r.scrollbar.paddingStart+i,m=r.scrollbar.size-r.scrollbar.paddingEnd-c,h=r.content-r.viewport,u=n==="ltr"?[0,h]:[h*-1,0];return Ah([d,m],u)(t)}function Qc(t,s,r="ltr"){const n=Fo(s),a=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,o=s.scrollbar.size-a,i=s.content-s.viewport,c=o-n,d=r==="ltr"?[0,i]:[i*-1,0],m=Gi(t,d);return Ah([0,i],[0,c])(m)}function Ah(t,s){return r=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const n=(s[1]-s[0])/(t[1]-t[0]);return s[0]+n*(r-t[0])}}function Eh(t,s){return t>0&&t<s}var yj=(t,s=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},n=0;return function a(){const o={left:t.scrollLeft,top:t.scrollTop},i=r.left!==o.left,c=r.top!==o.top;(i||c)&&s(),r=o,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function Lo(t,s){const r=st(t),n=l.useRef(0);return l.useEffect(()=>()=>window.clearTimeout(n.current),[]),l.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,s)},[r,s])}function gn(t,s){const r=st(s);xt(()=>{let n=0;if(t){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(t),()=>{window.cancelAnimationFrame(n),a.unobserve(t)}}},[t,r])}var Th=yh,jj=wh,wj=_h;const Mh=l.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(Th,{ref:n,className:ge("relative overflow-hidden",t),...r,children:[e.jsx(jj,{className:"h-full w-full rounded-[inherit]",children:s}),e.jsx(kh,{}),e.jsx(wj,{})]}));Mh.displayName=Th.displayName;const kh=l.forwardRef(({className:t,orientation:s="vertical",...r},n)=>e.jsx($l,{ref:n,orientation:s,className:ge("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 border-t border-t-transparent p-[1px]",t),...r,children:e.jsx(Ph,{className:"relative flex-1 rounded-full bg-border"})}));kh.displayName=$l.displayName;var Oo="Checkbox",[Nj,AS]=Wt(Oo),[Sj,Cj]=Nj(Oo),Rh=l.forwardRef((t,s)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:o,required:i,disabled:c,value:d="on",onCheckedChange:m,form:h,...u}=t,[f,b]=l.useState(null),p=Me(s,g=>b(g)),x=l.useRef(!1),v=f?h||!!f.closest("form"):!0,[y,j]=Ps({prop:a,defaultProp:o??!1,onChange:m,caller:Oo}),N=l.useRef(y);return l.useEffect(()=>{const g=f==null?void 0:f.form;if(g){const w=()=>j(N.current);return g.addEventListener("reset",w),()=>g.removeEventListener("reset",w)}},[f,j]),e.jsxs(Sj,{scope:r,state:y,disabled:c,children:[e.jsx(je.button,{type:"button",role:"checkbox","aria-checked":xr(y)?"mixed":y,"aria-required":i,"data-state":Oh(y),"data-disabled":c?"":void 0,disabled:c,value:d,...u,ref:p,onKeyDown:oe(t.onKeyDown,g=>{g.key==="Enter"&&g.preventDefault()}),onClick:oe(t.onClick,g=>{j(w=>xr(w)?!0:!w),v&&(x.current=g.isPropagationStopped(),x.current||g.stopPropagation())})}),v&&e.jsx(Lh,{control:f,bubbles:!x.current,name:n,value:d,checked:y,required:i,disabled:c,form:h,style:{transform:"translateX(-100%)"},defaultChecked:xr(o)?!1:o})]})});Rh.displayName=Oo;var Ih="CheckboxIndicator",Fh=l.forwardRef((t,s)=>{const{__scopeCheckbox:r,forceMount:n,...a}=t,o=Cj(Ih,r);return e.jsx(jt,{present:n||xr(o.state)||o.state===!0,children:e.jsx(je.span,{"data-state":Oh(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:s,style:{pointerEvents:"none",...t.style}})})});Fh.displayName=Ih;var Pj="CheckboxBubbleInput",Lh=l.forwardRef(({__scopeCheckbox:t,control:s,checked:r,bubbles:n=!0,defaultChecked:a,...o},i)=>{const c=l.useRef(null),d=Me(c,i),m=im(r),h=Qu(s);l.useEffect(()=>{const f=c.current;if(!f)return;const b=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(b,"checked").set;if(m!==r&&x){const v=new Event("click",{bubbles:n});f.indeterminate=xr(r),x.call(f,xr(r)?!1:r),f.dispatchEvent(v)}},[m,r,n]);const u=l.useRef(xr(r)?!1:r);return e.jsx(je.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??u.current,...o,tabIndex:-1,ref:d,style:{...o.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Lh.displayName=Pj;function xr(t){return t==="indeterminate"}function Oh(t){return xr(t)?"indeterminate":t?"checked":"unchecked"}var Uh=Rh,_j=Fh;const aa=l.forwardRef(({className:t,...s},r)=>e.jsx(Uh,{ref:r,className:ge("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(_j,{className:ge("flex items-center justify-center text-current"),children:e.jsx(Cn,{className:"h-4 w-4"})})}));aa.displayName=Uh.displayName;var Uo="Dialog",[$h,ES]=Wt(Uo),[Dj,xs]=$h(Uo),Gh=t=>{const{__scopeDialog:s,children:r,open:n,defaultOpen:a,onOpenChange:o,modal:i=!0}=t,c=l.useRef(null),d=l.useRef(null),[m,h]=Ps({prop:n,defaultProp:a??!1,onChange:o,caller:Uo});return e.jsx(Dj,{scope:s,triggerRef:c,contentRef:d,contentId:Zt(),titleId:Zt(),descriptionId:Zt(),open:m,onOpenChange:h,onOpenToggle:l.useCallback(()=>h(u=>!u),[h]),modal:i,children:r})};Gh.displayName=Uo;var Bh="DialogTrigger",Vh=l.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=xs(Bh,r),o=Me(s,a.triggerRef);return e.jsx(je.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":zl(a.open),...n,ref:o,onClick:oe(t.onClick,a.onOpenToggle)})});Vh.displayName=Bh;var Vl="DialogPortal",[Aj,Wh]=$h(Vl,{forceMount:void 0}),zh=t=>{const{__scopeDialog:s,forceMount:r,children:n,container:a}=t,o=xs(Vl,s);return e.jsx(Aj,{scope:s,forceMount:r,children:l.Children.map(n,i=>e.jsx(jt,{present:r||o.open,children:e.jsx(xa,{asChild:!0,container:a,children:i})}))})};zh.displayName=Vl;var lo="DialogOverlay",Hh=l.forwardRef((t,s)=>{const r=Wh(lo,t.__scopeDialog),{forceMount:n=r.forceMount,...a}=t,o=xs(lo,t.__scopeDialog);return o.modal?e.jsx(jt,{present:n||o.open,children:e.jsx(Tj,{...a,ref:s})}):null});Hh.displayName=lo;var Ej=Lr("DialogOverlay.RemoveScroll"),Tj=l.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=xs(lo,r);return e.jsx(Eo,{as:Ej,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(je.div,{"data-state":zl(a.open),...n,ref:s,style:{pointerEvents:"auto",...n.style}})})}),Wr="DialogContent",qh=l.forwardRef((t,s)=>{const r=Wh(Wr,t.__scopeDialog),{forceMount:n=r.forceMount,...a}=t,o=xs(Wr,t.__scopeDialog);return e.jsx(jt,{present:n||o.open,children:o.modal?e.jsx(Mj,{...a,ref:s}):e.jsx(kj,{...a,ref:s})})});qh.displayName=Wr;var Mj=l.forwardRef((t,s)=>{const r=xs(Wr,t.__scopeDialog),n=l.useRef(null),a=Me(s,r.contentRef,n);return l.useEffect(()=>{const o=n.current;if(o)return Fl(o)},[]),e.jsx(Yh,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:oe(t.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:oe(t.onPointerDownOutside,o=>{const i=o.detail.originalEvent,c=i.button===0&&i.ctrlKey===!0;(i.button===2||c)&&o.preventDefault()}),onFocusOutside:oe(t.onFocusOutside,o=>o.preventDefault())})}),kj=l.forwardRef((t,s)=>{const r=xs(Wr,t.__scopeDialog),n=l.useRef(!1),a=l.useRef(!1);return e.jsx(Yh,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,c;(i=t.onCloseAutoFocus)==null||i.call(t,o),o.defaultPrevented||(n.current||(c=r.triggerRef.current)==null||c.focus(),o.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:o=>{var d,m;(d=t.onInteractOutside)==null||d.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=o.target;((m=r.triggerRef.current)==null?void 0:m.contains(i))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),Yh=l.forwardRef((t,s)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:o,...i}=t,c=xs(Wr,r),d=l.useRef(null),m=Me(s,d);return wl(),e.jsxs(e.Fragment,{children:[e.jsx(Co,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(Sn,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":zl(c.open),...i,ref:m,onDismiss:()=>c.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(Rj,{titleId:c.titleId}),e.jsx(Fj,{contentRef:d,descriptionId:c.descriptionId})]})]})}),Wl="DialogTitle",Kh=l.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=xs(Wl,r);return e.jsx(je.h2,{id:a.titleId,...n,ref:s})});Kh.displayName=Wl;var Jh="DialogDescription",Qh=l.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=xs(Jh,r);return e.jsx(je.p,{id:a.descriptionId,...n,ref:s})});Qh.displayName=Jh;var Xh="DialogClose",Zh=l.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=xs(Xh,r);return e.jsx(je.button,{type:"button",...n,ref:s,onClick:oe(t.onClick,()=>a.onOpenChange(!1))})});Zh.displayName=Xh;function zl(t){return t?"open":"closed"}var ef="DialogTitleWarning",[TS,tf]=ag(ef,{contentName:Wr,titleName:Wl,docsSlug:"dialog"}),Rj=({titleId:t})=>{const s=tf(ef),r=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return l.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},Ij="DialogDescriptionWarning",Fj=({contentRef:t,descriptionId:s})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${tf(Ij).contentName}}.`;return l.useEffect(()=>{var o;const a=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");s&&a&&(document.getElementById(s)||console.warn(n))},[n,t,s]),null},Lj=Gh,Oj=Vh,Uj=zh,sf=Hh,rf=qh,nf=Kh,af=Qh,$j=Zh;const jr=Lj,co=Oj,Gj=Uj,of=l.forwardRef(({className:t,...s},r)=>e.jsx(sf,{ref:r,className:ge("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));of.displayName=sf.displayName;const qs=l.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(Gj,{children:[e.jsx(of,{}),e.jsxs(rf,{ref:n,className:ge("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,e.jsxs($j,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qs.displayName=rf.displayName;const Ys=({className:t,...s})=>e.jsx("div",{className:ge("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});Ys.displayName="DialogHeader";const Ks=({className:t,...s})=>e.jsx("div",{className:ge("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Ks.displayName="DialogFooter";const Js=l.forwardRef(({className:t,...s},r)=>e.jsx(nf,{ref:r,className:ge("text-lg font-semibold leading-none tracking-tight",t),...s}));Js.displayName=nf.displayName;const Qs=l.forwardRef(({className:t,...s},r)=>e.jsx(af,{ref:r,className:ge("text-sm text-muted-foreground",t),...s}));Qs.displayName=af.displayName;const Bj=ga("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-yellow-500/30 bg-yellow-500/10 text-yellow-700 dark:border-yellow-600 [&>svg]:text-yellow-600",success:"border-green-500/30 bg-green-500/10 text-green-700 dark:border-green-600 [&>svg]:text-green-600"}},defaultVariants:{variant:"default"}}),vn=l.forwardRef(({className:t,variant:s,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:ge(Bj({variant:s}),t),...r}));vn.displayName="Alert";const Xi=l.forwardRef(({className:t,...s},r)=>e.jsx("h5",{ref:r,className:ge("mb-1 font-medium leading-none tracking-tight",t),...s}));Xi.displayName="AlertTitle";const bn=l.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:ge("text-sm [&_p]:leading-relaxed",t),...s}));bn.displayName="AlertDescription";var[$o,MS]=Wt("Tooltip",[An]),Go=An(),lf="TooltipProvider",Vj=700,Zi="tooltip.open",[Wj,Hl]=$o(lf),cf=t=>{const{__scopeTooltip:s,delayDuration:r=Vj,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:o}=t,i=l.useRef(!0),c=l.useRef(!1),d=l.useRef(0);return l.useEffect(()=>{const m=d.current;return()=>window.clearTimeout(m)},[]),e.jsx(Wj,{scope:s,isOpenDelayedRef:i,delayDuration:r,onOpen:l.useCallback(()=>{window.clearTimeout(d.current),i.current=!1},[]),onClose:l.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:l.useCallback(m=>{c.current=m},[]),disableHoverableContent:a,children:o})};cf.displayName=lf;var oa="Tooltip",[zj,Bo]=$o(oa),df=t=>{const{__scopeTooltip:s,children:r,open:n,defaultOpen:a,onOpenChange:o,disableHoverableContent:i,delayDuration:c}=t,d=Hl(oa,t.__scopeTooltip),m=Go(s),[h,u]=l.useState(null),f=Zt(),b=l.useRef(0),p=i??d.disableHoverableContent,x=c??d.delayDuration,v=l.useRef(!1),[y,j]=Ps({prop:n,defaultProp:a??!1,onChange:P=>{P?(d.onOpen(),document.dispatchEvent(new CustomEvent(Zi))):d.onClose(),o==null||o(P)},caller:oa}),N=l.useMemo(()=>y?v.current?"delayed-open":"instant-open":"closed",[y]),g=l.useCallback(()=>{window.clearTimeout(b.current),b.current=0,v.current=!1,j(!0)},[j]),w=l.useCallback(()=>{window.clearTimeout(b.current),b.current=0,j(!1)},[j]),S=l.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>{v.current=!0,j(!0),b.current=0},x)},[x,j]);return l.useEffect(()=>()=>{b.current&&(window.clearTimeout(b.current),b.current=0)},[]),e.jsx(Ml,{...m,children:e.jsx(zj,{scope:s,contentId:f,open:y,stateAttribute:N,trigger:h,onTriggerChange:u,onTriggerEnter:l.useCallback(()=>{d.isOpenDelayedRef.current?S():g()},[d.isOpenDelayedRef,S,g]),onTriggerLeave:l.useCallback(()=>{p?w():(window.clearTimeout(b.current),b.current=0)},[w,p]),onOpen:g,onClose:w,disableHoverableContent:p,children:r})})};df.displayName=oa;var el="TooltipTrigger",uf=l.forwardRef((t,s)=>{const{__scopeTooltip:r,...n}=t,a=Bo(el,r),o=Hl(el,r),i=Go(r),c=l.useRef(null),d=Me(s,c,a.onTriggerChange),m=l.useRef(!1),h=l.useRef(!1),u=l.useCallback(()=>m.current=!1,[]);return l.useEffect(()=>()=>document.removeEventListener("pointerup",u),[u]),e.jsx(kl,{asChild:!0,...i,children:e.jsx(je.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:d,onPointerMove:oe(t.onPointerMove,f=>{f.pointerType!=="touch"&&!h.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),h.current=!0)}),onPointerLeave:oe(t.onPointerLeave,()=>{a.onTriggerLeave(),h.current=!1}),onPointerDown:oe(t.onPointerDown,()=>{a.open&&a.onClose(),m.current=!0,document.addEventListener("pointerup",u,{once:!0})}),onFocus:oe(t.onFocus,()=>{m.current||a.onOpen()}),onBlur:oe(t.onBlur,a.onClose),onClick:oe(t.onClick,a.onClose)})})});uf.displayName=el;var Hj="TooltipPortal",[kS,qj]=$o(Hj,{forceMount:void 0}),yn="TooltipContent",mf=l.forwardRef((t,s)=>{const r=qj(yn,t.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...o}=t,i=Bo(yn,t.__scopeTooltip);return e.jsx(jt,{present:n||i.open,children:i.disableHoverableContent?e.jsx(hf,{side:a,...o,ref:s}):e.jsx(Yj,{side:a,...o,ref:s})})}),Yj=l.forwardRef((t,s)=>{const r=Bo(yn,t.__scopeTooltip),n=Hl(yn,t.__scopeTooltip),a=l.useRef(null),o=Me(s,a),[i,c]=l.useState(null),{trigger:d,onClose:m}=r,h=a.current,{onPointerInTransitChange:u}=n,f=l.useCallback(()=>{c(null),u(!1)},[u]),b=l.useCallback((p,x)=>{const v=p.currentTarget,y={x:p.clientX,y:p.clientY},j=Zj(y,v.getBoundingClientRect()),N=ew(y,j),g=tw(x.getBoundingClientRect()),w=rw([...N,...g]);c(w),u(!0)},[u]);return l.useEffect(()=>()=>f(),[f]),l.useEffect(()=>{if(d&&h){const p=v=>b(v,h),x=v=>b(v,d);return d.addEventListener("pointerleave",p),h.addEventListener("pointerleave",x),()=>{d.removeEventListener("pointerleave",p),h.removeEventListener("pointerleave",x)}}},[d,h,b,f]),l.useEffect(()=>{if(i){const p=x=>{const v=x.target,y={x:x.clientX,y:x.clientY},j=(d==null?void 0:d.contains(v))||(h==null?void 0:h.contains(v)),N=!sw(y,i);j?f():N&&(f(),m())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[d,h,i,m,f]),e.jsx(hf,{...t,ref:o})}),[Kj,Jj]=$o(oa,{isInside:!1}),Qj=cg("TooltipContent"),hf=l.forwardRef((t,s)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...c}=t,d=Bo(yn,r),m=Go(r),{onClose:h}=d;return l.useEffect(()=>(document.addEventListener(Zi,h),()=>document.removeEventListener(Zi,h)),[h]),l.useEffect(()=>{if(d.trigger){const u=f=>{const b=f.target;b!=null&&b.contains(d.trigger)&&h()};return window.addEventListener("scroll",u,{capture:!0}),()=>window.removeEventListener("scroll",u,{capture:!0})}},[d.trigger,h]),e.jsx(Sn,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:u=>u.preventDefault(),onDismiss:h,children:e.jsxs(Rl,{"data-state":d.stateAttribute,...m,...c,ref:s,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Qj,{children:n}),e.jsx(Kj,{scope:r,isInside:!0,children:e.jsx(Tg,{id:d.contentId,role:"tooltip",children:a||n})})]})})});mf.displayName=yn;var ff="TooltipArrow",Xj=l.forwardRef((t,s)=>{const{__scopeTooltip:r,...n}=t,a=Go(r);return Jj(ff,r).isInside?null:e.jsx(Il,{...a,...n,ref:s})});Xj.displayName=ff;function Zj(t,s){const r=Math.abs(s.top-t.y),n=Math.abs(s.bottom-t.y),a=Math.abs(s.right-t.x),o=Math.abs(s.left-t.x);switch(Math.min(r,n,a,o)){case o:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function ew(t,s,r=5){const n=[];switch(s){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function tw(t){const{top:s,right:r,bottom:n,left:a}=t;return[{x:a,y:s},{x:r,y:s},{x:r,y:n},{x:a,y:n}]}function sw(t,s){const{x:r,y:n}=t;let a=!1;for(let o=0,i=s.length-1;o<s.length;i=o++){const c=s[o],d=s[i],m=c.x,h=c.y,u=d.x,f=d.y;h>n!=f>n&&r<(u-m)*(n-h)/(f-h)+m&&(a=!a)}return a}function rw(t){const s=t.slice();return s.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),nw(s)}function nw(t){if(t.length<=1)return t.slice();const s=[];for(let n=0;n<t.length;n++){const a=t[n];for(;s.length>=2;){const o=s[s.length-1],i=s[s.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))s.pop();else break}s.push(a)}s.pop();const r=[];for(let n=t.length-1;n>=0;n--){const a=t[n];for(;r.length>=2;){const o=r[r.length-1],i=r[r.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))r.pop();else break}r.push(a)}return r.pop(),s.length===1&&r.length===1&&s[0].x===r[0].x&&s[0].y===r[0].y?s:s.concat(r)}var aw=cf,ow=df,iw=uf,xf=mf;const Ga=aw,Ba=ow,Va=iw,qn=l.forwardRef(({className:t,sideOffset:s=4,...r},n)=>e.jsx(xf,{ref:n,sideOffset:s,className:ge("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));qn.displayName=xf.displayName;const Xc=["Acura","Audi","BMW","Buick","Cadillac","CDJR","Chevrolet","Ferrari","Ford","GMC","Honda","Hyundai","Lamborghini","Land Rover","Lexus","Lincoln","Lucid","Mazda","Mercedes","Mini","Mitsubishi","Porsche","Rivian","Subaru","Tesla","Toyota","Volkswagen","Volvo"],lw=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];function cw(){const{user:t}=et(),[s,r]=l.useState([]),[n,a]=l.useState([]),[o,i]=l.useState([]),[c,d]=l.useState(()=>{const C=localStorage.getItem("simulatedAdmins");return C?JSON.parse(C):[]}),[m,h]=l.useState(!1),[u,f]=l.useState(!1),[b,p]=l.useState(!1),[x,v]=l.useState(!1),[y,j]=l.useState(!1),[N,g]=l.useState(!1),[w,S]=l.useState({name:"",logo_url:"",brands:[]}),[P,E]=l.useState({name:"",group_id:"",logo_url:"",city:"",state:"",brands:[]}),[D,G]=l.useState({email:"",name:"",dealership_id:"",group_id:"",is_group_admin:!1,password:"",phone:""}),[se,L]=l.useState(null),[T,A]=l.useState(null),[Y,te]=l.useState([]),[xe,le]=l.useState(!1),[Q,pe]=l.useState(!1),[Pe,Oe]=l.useState(!1),[qe,M]=l.useState(!1),[re,ne]=l.useState(!1),[O,ue]=l.useState(!1),[K,ce]=l.useState(""),[X,F]=l.useState(""),[_,$]=l.useState([]),[Z,de]=l.useState(!1),[we,De]=l.useState(!1),[Ee,He]=l.useState(""),[$e,zt]=l.useState(""),[ct,pt]=l.useState(""),[Qe,gt]=l.useState(""),[dt,gs]=l.useState(null),[Ct,It]=l.useState(""),[vs,Ts]=l.useState([]),[Pt,Ms]=l.useState(0),[Mt,Jo]=l.useState(!1),Tn=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.includes("netlify")||window.location.hostname.includes("vercel"),Qo=async C=>{try{if(console.log("[MasterAdminPanel] Starting manual confirmation for:",C),!confirm(`Are you sure you want to manually confirm the email for ${C}? This is for emergency testing only.`))return;try{console.log("Attempting to get user list from auth system");const{data:ie,error:ae}=await J.from("auth").select("*").limit(1);ae&&console.log("Auth direct access failed as expected:",ae.message)}catch(ie){console.log("Auth direct access error:",ie)}console.log("Searching in profiles table");const{data:k,error:R}=await J.from("profiles").select("id, email").eq("email",C).maybeSingle();if(R||!k){const ie=C.split("@")[0],{data:ae,error:ye}=await J.from("profiles").select("id, email").or(`email.ilike.${ie}%,email.eq.${C}`).limit(10);if(console.log(`Profile search for ${ie}% found:`,(ae==null?void 0:ae.length)||0,"matches"),ye||!(ae!=null&&ae.length)){Ie({title:"Error",description:`Couldn't find any user with email similar to ${C}`,variant:"destructive"});return}if(ae.length>1){console.log("Found multiple possible matches:",ae);const Ge=ae.map(Ke=>Ke.email).join(`
`);alert(`Found multiple possible matches:
${Ge}

Please try with the exact email from this list.`),confirm(`Would you like to try confirming the first match: ${ae[0].email}?`)&&await Mn(ae[0].id,ae[0].email);return}const ve=ae[0].id,he=ae[0].email;await Mn(ve,he)}else await Mn(k.id,k.email)}catch(k){console.error("[MasterAdminPanel] Error in confirmTestAccount:",k),Ie({title:"Error",description:"Failed to confirm test account",variant:"destructive"})}},Mn=async(C,k)=>{try{console.log(`Attempting to confirm user: ${k} (${C})`);try{const R=await J.rpc("force_confirm_email",{user_id_param:C});if(console.log("Force confirm result:",R),R.error)throw console.error("SQL approach error:",R.error),R.error;Ie({title:"Success",description:`User ${k} has been confirmed via SQL. They can now log in with Password123!`}),console.log(`[MasterAdminPanel] Successfully confirmed test account ${k}`);return}catch(R){console.error("SQL method failed:",R)}try{console.log("Trying admin API approach"),Ie({title:"Warning",description:"Confirmation may have failed - RPC function unavailable. Try creating a new test account."})}catch(R){console.error("Admin update failed:",R)}alert(`The system couldn't automatically confirm the account. Consider these options:
1. Create a new test account in the Admin panel
2. Use a magic link login (requires proper email setup)
3. Check Supabase dashboard directly to confirm the email`)}catch(R){console.error("[MasterAdminPanel] Error updating confirmation status:",R),Ie({title:"Error",description:`Failed to confirm user: ${R}`,variant:"destructive"})}},Sa=()=>{const C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let k="";for(let R=0;R<12;R++)k+=C.charAt(Math.floor(Math.random()*C.length));return k};l.useEffect(()=>{localStorage.setItem("simulatedAdmins",JSON.stringify(c))},[c]);const Zs=async()=>{p(!0);try{console.log("[MasterAdminPanel] Fetching admin users...");let C=[];const{data:k,error:R}=await J.from("profiles").select("id, email, name, dealership_id, role, is_group_admin").or("role.eq.dealership_admin,role.eq.admin").order("name");if(R){console.error("[MasterAdminPanel] Error with OR query, trying alternate approach:",R);const{data:ve,error:he}=await J.from("profiles").select("id, email, name, dealership_id, role, is_group_admin").eq("role","admin").order("name"),{data:Ge,error:Ke}=await J.from("profiles").select("id, email, name, dealership_id, role, is_group_admin").eq("role","dealership_admin").order("name");he&&console.error("[MasterAdminPanel] Error fetching admin users:",he),Ke&&console.error("[MasterAdminPanel] Error fetching dealership admin users:",Ke),C=[...ve||[],...Ge||[]],C.length===0&&console.warn("[MasterAdminPanel] No admin users found in either query")}else C=k||[];console.log("[MasterAdminPanel] Admins before enhancement:",C.length);const ye=[...await Promise.all(C.map(async ve=>{const he=n.find(kt=>kt.id===ve.dealership_id),Ge=ve.is_group_admin||(he==null?void 0:he.group_id)!==null&&(he==null?void 0:he.group_id)!==void 0;let Ke=null;if(he!=null&&he.group_id){const kt=s.find(Lt=>Lt.id===he.group_id);Ke=kt==null?void 0:kt.name}return console.log(`[MasterAdminPanel] Admin ${ve.email} info:`,{dealership_id:ve.dealership_id,dealership_name:he==null?void 0:he.name,role:ve.role,is_group_admin:ve.is_group_admin,group_id:he==null?void 0:he.group_id,group_name:Ke}),{...ve,dealership_name:(he==null?void 0:he.name)||"Unknown Dealership",is_group_admin:Ge,group_id:he==null?void 0:he.group_id,group_name:Ke}}))||[],...c];i(ye),console.log("[MasterAdminPanel] Fetched admin users:",ye)}catch(C){console.error("[MasterAdminPanel] Error fetching admin users:",C),Ie({title:"Error",description:"Failed to load admin users",variant:"destructive"})}finally{p(!1)}};l.useEffect(()=>{Ca(),Dr(),Zs(),as(),ei();const C=setInterval(()=>{ei()},3e4);return()=>{clearInterval(C)}},[]);const Ca=async()=>{h(!0);try{const k=(await Tx()).map(R=>{const ie=s.find(ae=>ae.id===R.id);return ie&&ie._selectedBrands?{...R,_selectedBrands:ie._selectedBrands}:R});r(k),console.log("[MasterAdminPanel] Fetched dealership groups:",k)}catch(C){console.error("[MasterAdminPanel] Error fetching dealership groups:",C),Le&&typeof Le=="object"&&Le({title:"Error",description:"Failed to load dealership groups",variant:"destructive"})}finally{h(!1)}},Dr=async()=>{f(!0);try{console.log("[MasterAdminPanel] Fetching dealerships...");const C=await Td();console.log(`[MasterAdminPanel] Fetched ${C.length} dealerships with these group_ids:`,C.map(R=>({id:R.id,name:R.name,group_id:R.group_id})));const k={};C.forEach(R=>{R.group_id&&(k[R.group_id]=(k[R.group_id]||0)+1)}),console.log("[MasterAdminPanel] Dealerships per group:",k),a(C)}catch(C){console.error("[MasterAdminPanel] Error fetching dealerships:",C),Le&&typeof Le=="object"&&Le({title:"Error",description:"Failed to load dealerships",variant:"destructive"})}finally{f(!1)}},Pa=C=>{S(k=>{const R=[...k.brands],ie=R.indexOf(C);return ie===-1?R.push(C):R.splice(ie,1),{...k,brands:R}})},Ie=C=>{console.log("[MasterAdminPanel] Attempting to show toast:",C);try{typeof Le=="function"?(Le(C),console.log("[MasterAdminPanel] Toast displayed successfully")):console.log("[MasterAdminPanel] Toast function not available")}catch(k){console.error("[MasterAdminPanel] Error displaying toast:",k)}},Xo=()=>w.name?!0:(Ie({title:"Error",description:"Group name is required",variant:"destructive"}),!1),ee=C=>{C.preventDefault(),console.log("[MasterAdminPanel] Group form submitted, validating..."),Xo()&&(console.log("[MasterAdminPanel] Group validation passed, creating group..."),Ne())},Ne=async()=>{console.log("[MasterAdminPanel] Starting group creation process"),v(!0),M(!1);try{console.log("[MasterAdminPanel] Creating dealership group with name only");const C={name:w.name};console.log("[MasterAdminPanel] Group data to create:",C);const k=await Lx(C);console.log("[MasterAdminPanel] Group created successfully:",k);const R={...k,_selectedBrands:w.brands};r(ie=>[...ie,R]);try{console.log("[MasterAdminPanel] Creating dealerships for each brand in the group");const ie=w.brands.length>0?w.brands:["Default"],ae=[];for(const he of ie){const Ge=`dealership_${he.toLowerCase().replace(/[^a-z0-9]/g,"_")}_${k.name.toLowerCase().replace(/[^a-z0-9]/g,"_")}_${Date.now().toString().substring(0,10)}`,kt={name:he==="Default"?`${k.name} Main Dealership`:`${k.name} ${he}`,group_id:k.id,schema_name:Ge,brands:he!=="Default"?JSON.stringify([he]):null,store_hours:JSON.stringify({monday:"9AM-8PM",tuesday:"9AM-8PM",wednesday:"9AM-8PM",thursday:"9AM-8PM",friday:"9AM-8PM",saturday:"9AM-6PM",sunday:"Closed"}),num_teams:3};console.log(`[MasterAdminPanel] Creating dealership for brand "${he}"`,kt);const Lt=await Ox(kt);console.log(`[MasterAdminPanel] Dealership created for brand "${he}"`,Lt);try{const Is=await Ux(Ge);console.log(`[MasterAdminPanel] Schema creation result for ${he} dealership:`,Is)}catch(Is){console.error(`[MasterAdminPanel] Error creating schema for ${he} dealership:`,Is)}await Tr("create_brand_dealership",{dealershipId:Lt.id,dealershipName:Lt.name,groupId:k.id,groupName:k.name,brand:he,schemaName:Ge,createdBy:t==null?void 0:t.id,timestamp:new Date().toISOString()}),ae.push(Lt)}a(he=>[...he,...ae]);const ye=ae.length,ve=ie.length>1?`brands (${ie.join(", ")})`:ie[0]==="Default"?"default":`brand ${ie[0]}`;Ie({title:"Success",description:`Created ${ye} dealership${ye>1?"s":""} for ${ve}`})}catch(ie){console.error("[MasterAdminPanel] Error creating brand dealerships for group:",ie),Ie({title:"Warning",description:"Group created, but failed to create all dealerships. You may need to create additional dealerships manually.",variant:"destructive"})}S({name:"",logo_url:"",brands:[]}),Ie({title:"Success",description:`Dealership group "${k.name}" created successfully with ${newDealerships.length} dealership${newDealerships.length!==1?"s":""} for ${selectedBrands.length} brand${selectedBrands.length!==1?"s":""}`,duration:6e3}),Dr(),console.log("[MasterAdminPanel] Group creation process completed")}catch(C){console.error("[MasterAdminPanel] Error creating dealership group:",C),Ie({title:"Error",description:C instanceof Error?C.message:"Failed to create dealership group",variant:"destructive"})}finally{v(!1)}},Ze=C=>{C.preventDefault(),console.log("[MasterAdminPanel] Dealership form submitted, validating..."),Ye()&&(console.log("[MasterAdminPanel] Dealership validation passed, opening confirmation dialog"),ne(!0))},Ye=()=>P.name?!0:(Ie({title:"Error",description:"Dealership name is required",variant:"destructive"}),!1),_t=C=>{var ie;const k=["example.com","test.com","fake.com","testing.com","mailinator.com","temp-mail.org","tempmail.com","sportdursttest.com"],R=(ie=C.split("@").pop())==null?void 0:ie.toLowerCase();return k.includes(R||"")||(R==null?void 0:R.includes("test"))||(R==null?void 0:R.includes("fake"))||(R==null?void 0:R.includes("example"))||C.startsWith("test")||C.includes("test+")},Ft=C=>{if(C.includes("@exampletest.com"))return C;const k=C.includes("@")?C.split("@")[0]:C,R=new Date().getTime().toString().substring(6,10);return`${k}${R}@gmail.com`},ks=async C=>{try{if(!confirm(`Are you sure you want to completely purge the account ${C}? This will attempt to remove all traces of this account.`))return;console.log(`[MasterAdminPanel] Attempting to purge test account: ${C}`);const{data:k,error:R}=await J.from("profiles").select("id, email").or(`email.eq.${C},email.ilike.${C.replace("@","%")}`).limit(10);R&&console.error(`[MasterAdminPanel] Error finding profile for ${C}:`,R);try{const{data:ve,error:he}=await J.rpc("admin_delete_user_by_email",{email_param:C});he?console.warn(`[MasterAdminPanel] RPC delete failed: ${he.message}`):console.log("[MasterAdminPanel] RPC delete result:",ve)}catch(ve){console.error("[MasterAdminPanel] RPC error:",ve)}let ie=0;if(k&&k.length>0)for(const ve of k){console.log("[MasterAdminPanel] Deleting profile for user:",ve);const{error:he}=await J.from("profiles").delete().eq("id",ve.id);he?console.error(`[MasterAdminPanel] Error deleting profile for ${ve.email}:`,he):ie++;try{const{error:Ge}=await J.auth.admin.deleteUser(ve.id);Ge&&console.warn(`[MasterAdminPanel] Auth delete failed for ${ve.email}:`,Ge)}catch(Ge){console.error("[MasterAdminPanel] Auth delete error:",Ge)}}const ae=c.length;d(ve=>ve.filter(he=>he.email!==C&&!he.email.includes(C.split("@")[0])));const ye=ae-c.length;Ie({title:"Account Purge Attempted",description:`Removed ${ie} profile records and ${ye} simulated entries for ${C}. You should now be able to recreate this account.`}),Zs()}catch(k){console.error(`[MasterAdminPanel] Error purging account ${C}:`,k),Ie({title:"Error",description:"Failed to purge account completely",variant:"destructive"})}},rs=async()=>{try{if(!confirm("Are you sure you want to remove all test accounts except testadmin@example.com? This cannot be undone."))return;const{data:C,error:k}=await J.from("profiles").select("id, email, role, is_test_account").not("email","eq","testadmin@example.com");if(k)throw k;let R=0;const ie=C.filter(ae=>_t(ae.email)||ae.is_test_account===!0||c.some(ye=>ye.id===ae.id));console.log(`[MasterAdminPanel] Found ${ie.length} test accounts to clean up`);try{const ae=ie.map(he=>he.email),{data:ye,error:ve}=await J.rpc("admin_delete_test_accounts",{email_list:ae,exclude_email:"testadmin@example.com"});ve?console.warn(`[MasterAdminPanel] Bulk RPC delete failed: ${ve.message}`):(console.log("[MasterAdminPanel] Bulk RPC delete result:",ye),R=ye.count||0)}catch(ae){console.error("[MasterAdminPanel] Bulk RPC error:",ae)}if(R===0){console.log("[MasterAdminPanel] RPC bulk delete failed, falling back to individual deletion");for(const ae of ie)try{const{error:ye}=await J.from("profiles").delete().eq("id",ae.id);ye&&console.warn(`[MasterAdminPanel] Could not delete profile for ${ae.email}: ${ye.message}`);const{error:ve}=await J.auth.admin.deleteUser(ae.id);if(ve){console.warn(`[MasterAdminPanel] Could not delete user ${ae.email} from auth: ${ve.message}`);continue}R++}catch(ye){console.error(`[MasterAdminPanel] Error removing user ${ae.email}:`,ye)}}d([]),Ie({title:"Test Accounts Cleaned Up",description:`Attempted to remove ${ie.length} test accounts. Successfully removed ${R}. Main testadmin@example.com was preserved.`,duration:8e3}),Zs()}catch(C){console.error("[MasterAdminPanel] Error cleaning up test accounts:",C),Ie({title:"Error",description:"Failed to clean up test accounts",variant:"destructive"})}},ns=async(C,k,R)=>{try{console.log("[MasterAdminPanel] Creating test user directly via API:",C),console.log("[MasterAdminPanel] User data for test user:",R);const{data:ie,error:ae}=await J.auth.signUp({email:C,password:k,options:{data:R}});if(ae)throw ae;console.log("[MasterAdminPanel] Sign up successful for test user:",C),console.log("[MasterAdminPanel] User ID:",ie.user.id);try{console.log("[MasterAdminPanel] Attempting to auto-confirm test account:",C);const ye="auto_confirm_test_email",{error:ve}=await J.rpc(ye,{user_id:ie.user.id});ve?(console.warn("[MasterAdminPanel] Could not auto-confirm email via RPC:",ve.message),console.log("[MasterAdminPanel] Direct database update not available - test users will need to use magic link login")):console.log("[MasterAdminPanel] Successfully confirmed test email address")}catch(ye){console.warn("[MasterAdminPanel] Error in auto-confirm process:",ye)}try{console.log("[MasterAdminPanel] Creating/updating profile record for test user");const ye={id:ie.user.id,email:C,name:R.name||C.split("@")[0],role:R.role||"dealership_admin",dealership_id:R.dealership_id,is_group_admin:!!R.is_group_admin,is_test_account:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("[MasterAdminPanel] Profile data:",ye);const{error:ve}=await J.from("profiles").upsert(ye);if(ve){console.error("[MasterAdminPanel] Error creating profile:",ve),console.log("[MasterAdminPanel] Trying insert instead of upsert");const{error:he}=await J.from("profiles").insert(ye);he?console.error("[MasterAdminPanel] Insert also failed:",he):console.log("[MasterAdminPanel] Insert successful")}else console.log("[MasterAdminPanel] Profile upsert successful")}catch(ye){console.error("[MasterAdminPanel] Error in profile creation:",ye)}return Ie({title:"Test User Created",description:`Created ${R.role||"user"}: "${C}" with password: ${k}
        Use "Refresh List" to see the user if it doesn't appear automatically.`,duration:1e4}),console.log(`[MasterAdminPanel] Test user created - Email: ${C}, Password: ${k}`),ie.user}catch(ie){throw console.error("[MasterAdminPanel] Error creating test user directly:",ie),ie}},_a=async C=>{var k;C.preventDefault(),g(!0);try{console.log("[MasterAdminPanel] Creating admin user:",D),console.log("[MasterAdminPanel] Is group admin:",D.is_group_admin);const R=D.password||Sa();let ie;if(D.is_group_admin&&D.group_id){console.log(`[MasterAdminPanel] Creating group admin for group ID ${D.group_id}`),console.log("[MasterAdminPanel] Refreshing dealerships list before continuing");try{await Dr(),console.log("[MasterAdminPanel] Dealerships refreshed")}catch(Ge){console.error("[MasterAdminPanel] Error refreshing dealerships:",Ge)}const he=n.filter(Ge=>Ge.group_id===parseInt(D.group_id));if(he.length===0){console.log(`[MasterAdminPanel] No dealerships found in group ID ${D.group_id}`);const Ge=((k=s.find(Ke=>Ke.id===parseInt(D.group_id)))==null?void 0:k.name)||`ID ${D.group_id}`;throw new Error(`No dealerships found in group "${Ge}". This could be because the group was just created and the default dealership creation is not yet complete. Please try refreshing the page or manually create a dealership in this group first.`)}ie=he[0].id,console.log(`[MasterAdminPanel] Group admin will be assigned to first dealership in group: ${ie}`)}else if(D.dealership_id)ie=parseInt(D.dealership_id);else throw new Error("Please select a dealership or group");const ae=_t(D.email)||Tn,ye=ae?"Password123!":R,ve={name:D.name||D.email.split("@")[0],role:"dealership_admin",dealership_id:ie,is_group_admin:D.is_group_admin,is_test_account:ae};if(console.log("[MasterAdminPanel] Creating user with data:",{...ve,is_group_admin:D.is_group_admin,group_id:D.is_group_admin?D.group_id:null}),ae){const Ge=D.email.split("@")[0],Ke=Ft(D.email);Ke!==D.email?(console.log(`[MasterAdminPanel] Email transformed for compatibility: ${D.email}  ${Ke}`),Ie({title:"Email Format Changed",description:`For compatibility, the email was changed from ${D.email} to ${Ke}. Use this email to log in.`,duration:8e3})):console.log(`[MasterAdminPanel] Using original email format: ${Ke}`);const Lt={id:(await ns(Ke,ye,ve)).id,email:Ke,name:ve.name,dealership_id:ie,role:"dealership_admin",is_group_admin:D.is_group_admin,is_simulated:!0};d(Is=>[...Is,Lt])}else{const{data:he,error:Ge}=await J.auth.signUp({email:D.email,password:ye,options:{data:{...ve,is_group_admin:D.is_group_admin}}});if(Ge)throw Ge;if(!he.user)throw new Error("Failed to create user account");try{await Rx(he.user.id,"dealership_admin"),await J.from("profiles").upsert({id:he.user.id,email:D.email,name:ve.name,role:"dealership_admin",dealership_id:ie,is_group_admin:D.is_group_admin}),console.log("[MasterAdminPanel] Profile record created/updated successfully with:",{user_id:he.user.id,dealership_id:ie,is_group_admin:D.is_group_admin,group_id:D.is_group_admin?D.group_id:null})}catch(Ke){console.error("[MasterAdminPanel] Role update error:",Ke)}Ie({title:"Success",description:D.is_group_admin?`Dealer Group Admin "${D.email}" created. Check email for confirmation. They should log in and will be redirected to the Group Admin dashboard. Password: ${ye}`:`Dealer Admin "${D.email}" created. Check email for confirmation. Password: ${ye}`})}G({email:"",name:"",dealership_id:"",group_id:"",is_group_admin:!1,password:"",phone:""}),await Zs()}catch(R){console.error("[MasterAdminPanel] Error creating admin user:",R),Ie({title:"Error",description:typeof R=="object"&&R!==null&&"message"in R?String(R.message):"Failed to create admin user",variant:"destructive"})}finally{g(!1)}},Rs=async C=>{var k;try{if(!confirm("Are you sure you want to delete this dealership group? This action cannot be undone and will delete ALL dealerships in this group."))return;const R=((k=s.find(ae=>ae.id===C))==null?void 0:k.name)||`Group ID ${C}`;console.log(`[MasterAdminPanel] Starting deletion of dealership group: ${R} (ID: ${C})`);const ie=n.filter(ae=>ae.group_id===C);if(console.log(`[MasterAdminPanel] Found ${ie.length} dealerships to delete in group ${C}`),ie.length>0){Ie({title:"Deleting Group",description:`Deleting ${ie.length} dealerships in group "${R}"...`});for(const ae of ie)try{console.log(`[MasterAdminPanel] Deleting dealership: ${ae.name} (ID: ${ae.id})`);const ye=await lc(ae.id);await Tr("delete_dealership_in_group",{dealershipId:ae.id,dealershipName:ae.name,schemaName:ae.schema_name||ye.schemaName,groupId:C,groupName:R,deletedBy:t==null?void 0:t.id,timestamp:new Date().toISOString()}),console.log(`[MasterAdminPanel] Successfully deleted dealership: ${ae.name} with schema: ${ye.schemaName||ae.schema_name}`)}catch(ye){console.error(`[MasterAdminPanel] Error deleting dealership ${ae.id} in group:`,ye)}}await kx(C),await Tr("delete_dealership_group",{groupId:C,groupName:R,dealershipsDeleted:ie.length,deletedBy:t==null?void 0:t.id,timestamp:new Date().toISOString()}),Ca(),Dr(),Ie({title:"Success",description:`Dealership group "${R}" and all ${ie.length} associated dealerships have been deleted.`})}catch(R){console.error("[MasterAdminPanel] Error deleting dealership group:",R),Ie({title:"Error",description:R instanceof Error?R.message:"Failed to delete dealership group",variant:"destructive"})}},kn=async C=>{try{if(!confirm("Are you sure you want to delete this dealership? This action cannot be undone."))return;const k=await lc(C);await Tr("delete_dealership",{dealershipId:C,schemaName:k.schemaName,deletedBy:t==null?void 0:t.id,timestamp:new Date().toISOString()}),Dr(),Ie({title:"Success",description:"Dealership deleted successfully"})}catch(k){console.error("[MasterAdminPanel] Error deleting dealership:",k),Ie({title:"Error",description:k instanceof Error?k.message:"Failed to delete dealership",variant:"destructive"})}},Zo=async(C,k=!1)=>{try{if(!confirm("Are you sure you want to delete this admin user? This action cannot be undone."))return;const R=k?c.find(ae=>ae.id===C):o.find(ae=>ae.id===C);if(!R)throw new Error("Admin user not found");const ie=R.email;console.log(`[MasterAdminPanel] Deleting admin: ${ie} (${C}), isSimulated: ${k}`),k&&d(ae=>ae.filter(ye=>ye.id!==C));try{const{error:ae}=await J.from("profiles").delete().eq("id",C);ae&&console.warn(`[MasterAdminPanel] Error deleting profile: ${ae.message}`);const{error:ye}=await J.auth.admin.deleteUser(C);if(ye){console.warn(`[MasterAdminPanel] Error deleting from auth: ${ye.message}`);try{const{error:ve}=await J.rpc("admin_delete_user_by_email",{email_param:ie});ve&&console.warn(`[MasterAdminPanel] RPC delete failed: ${ve.message}`)}catch(ve){console.error("[MasterAdminPanel] RPC error:",ve)}}}catch(ae){console.error("[MasterAdminPanel] Database error during deletion:",ae)}Ie({title:"Success",description:`${k?"Test admin":"Admin user"} deleted successfully`}),Zs()}catch(R){console.error("[MasterAdminPanel] Error deleting admin user:",R),Ie({title:"Error",description:R instanceof Error?R.message:"Failed to delete admin user",variant:"destructive"})}},as=async()=>{try{de(!0);const C=await Mx();$(C),console.log("[MasterAdminPanel] Fetched signup requests:",C)}catch(C){console.error("[MasterAdminPanel] Error fetching signup requests:",C),Ie({title:"Error",description:"Failed to fetch signup requests",variant:"destructive"})}finally{de(!1)}},Da=async C=>{try{De(!0),console.log(`[MasterAdminPanel] Approving signup request: ${C}`);const k=_.find(ye=>ye.id===C);if(!k)throw new Error("Request not found");console.log("[MasterAdminPanel] Promotional pricing applied:",k.promo_applied);const R={createSchema:!0,addOns:k.add_ons||[],isPromotion:k.promo_applied||!1};if(k.tier==="dealership"||k.tier==="dealer_group"){const ye=k.dealership_name.toLowerCase().replace(/[^a-z0-9]/g,"_").substring(0,20);R.schemaName=`${ye}_${Date.now().toString(36)}`}k.tier==="dealer_group"&&(R.isDealerGroup=!0,R.groupLevel=k.group_level||"level_1",R.dealershipCount=k.dealership_count||2,console.log("Processing dealer group signup:",{level:R.groupLevel,dealershipCount:R.dealershipCount,addOns:R.addOns}));const ie=Sa();R.tempPassword=ie,R.adminEmail=k.email,R.adminName=k.contact_person;const ae=await Ix(C,R);ae.success?(Le({title:"Success",description:`${k.tier==="dealer_group"?"Dealer Group":"Dealership"} request approved successfully!`,variant:"default"}),k.tier==="dealer_group"&&(console.log("Dealer Group created:",{groupId:ae.groupId,dealershipIds:ae.dealershipIds,level:R.groupLevel,dealershipCount:R.dealershipCount}),Le({title:"Dealer Group Created",description:`Created group with ${R.dealershipCount} dealerships. Admin credentials sent to ${R.adminEmail}`,variant:"default"}))):Le({title:"Error",description:ae.message||"Failed to approve request",variant:"destructive"}),as()}catch(k){console.error("Error approving request:",k),Le({title:"Error",description:k instanceof Error?k.message:"An unknown error occurred",variant:"destructive"})}finally{setLoadingAction(!1)}},Ht=async C=>{try{De(!0),console.log(`[MasterAdminPanel] Rejecting signup request: ${C}`);const k=await Fx(C,Ct);k.success?(Le({title:"Success",description:"Signup request rejected successfully"}),as(),It(""),gs(null)):Le({title:"Error",description:k.message,variant:"destructive"})}catch(k){console.error("[MasterAdminPanel] Error rejecting signup request:",k),Le({title:"Error",description:"Failed to reject signup request",variant:"destructive"})}finally{De(!1)}},Aa=async()=>{try{console.log("[MasterAdminPanel] Running admin users debug query..."),console.log("[MasterAdminPanel] Locally stored simulated admins:",c);const{data:C,error:k}=await J.from("profiles").select("*").eq("role","admin").order("created_at",{ascending:!1}).limit(20);k?console.error("[MasterAdminPanel] Error querying admin profiles:",k):console.log("[MasterAdminPanel] Admin profiles:",C);const{data:R,error:ie}=await J.from("profiles").select("*").eq("role","dealership_admin").order("created_at",{ascending:!1}).limit(20);ie?console.error("[MasterAdminPanel] Error querying dealership_admin profiles:",ie):console.log("[MasterAdminPanel] Dealership admin profiles:",R);const{data:ae,error:ye}=await J.from("profiles").select("*").eq("is_group_admin",!0).order("created_at",{ascending:!1}).limit(20);ye?console.error("[MasterAdminPanel] Error querying is_group_admin profiles:",ye):console.log("[MasterAdminPanel] Group admin profiles (is_group_admin=true):",ae);const{data:ve,error:he}=await J.from("profiles").select("*").order("created_at",{ascending:!1}).limit(20);he?console.error("[MasterAdminPanel] Error querying recent profiles:",he):console.log("[MasterAdminPanel] Most recent profiles created:",ve);const{data:Ge,error:Ke}=await J.from("profiles").select("*").eq("email","jp@exampletest.com").maybeSingle();if(Ke)console.error("[MasterAdminPanel] Error querying for specific test user:",Ke);else if(Ge)console.log("[MasterAdminPanel] Found specific test user:",Ge);else{console.log("[MasterAdminPanel] Specific test user not found in profiles table");const{data:Fs,error:Ea}=await J.from("profiles").select("*").ilike("email","%jp%").limit(10);!Ea&&(Fs!=null&&Fs.length)&&console.log("[MasterAdminPanel] Found partial email matches:",Fs)}const kt=[...C||[],...R||[],...ve||[]],Lt=Array.from(new Map(kt.map(Fs=>[Fs.id,Fs])).values()),Is={};Lt.forEach(Fs=>{const Ea=Fs.role||"no_role";Is[Ea]=(Is[Ea]||0)+1}),Ie({title:"Admin Debug Results",description:`Found ${(C==null?void 0:C.length)||0} admin profiles and ${(R==null?void 0:R.length)||0} dealership_admin profiles. Group admins: ${(ae==null?void 0:ae.length)||0}. Recent: ${(ve==null?void 0:ve.length)||0}`,duration:1e4}),console.log("[MasterAdminPanel] Role distribution:",Is)}catch(C){console.error("[MasterAdminPanel] Debug error:",C),Ie({title:"Debug Error",description:"Error running diagnostics. Check console for details.",variant:"destructive"})}};l.useEffect(()=>{},[]);const ei=async()=>{try{console.log("[MasterAdminPanel] Fetching admin notifications");const{data:C,error:k}=await J.from("admin_notifications").select("*").order("created_at",{ascending:!1}).limit(10);if(k){console.error("[MasterAdminPanel] Error fetching notifications:",k);return}if(C){Ts(C);const R=C.filter(ie=>!ie.is_read).length;Ms(R),console.log(`[MasterAdminPanel] Found ${R} unread notifications`)}}catch(C){console.error("[MasterAdminPanel] Error in fetchAdminNotifications:",C)}},ti=async C=>{try{const{error:k}=await J.from("admin_notifications").update({is_read:!0}).eq("id",C);if(k){console.error("[MasterAdminPanel] Error marking notification as read:",k);return}Ts(R=>R.map(ie=>ie.id===C?{...ie,is_read:!0}:ie)),Ms(R=>Math.max(0,R-1))}catch(k){console.error("[MasterAdminPanel] Error in markNotificationAsRead:",k)}};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Master Admin Panel"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage dealerships, groups, and users"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(I,{variant:"outline",className:"relative",onClick:()=>Jo(!Mt),children:[e.jsx(Zg,{className:"h-5 w-5"}),Pt>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:Pt})]}),Mt&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white shadow-lg rounded-md border border-gray-200 z-50",children:[e.jsx("div",{className:"p-3 border-b border-gray-200 font-medium",children:"Notifications"}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:vs.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No notifications"}):vs.map(C=>e.jsx("div",{className:`p-3 border-b border-gray-100 hover:bg-gray-50 ${C.is_read?"":"bg-blue-50"}`,onClick:()=>ti(C.id),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`mr-3 mt-0.5 ${C.is_read?"text-gray-400":"text-blue-500"}`,children:C.type==="signup_request"?e.jsx(eo,{className:"h-5 w-5"}):e.jsx(Er,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:C.type==="signup_request"?`New ${C.content.tier.replace("_"," ")} signup`:"Notification"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[C.content.dealership_name," -"," ",C.content.contact_person]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(C.created_at).toLocaleString()})]})]})},C.id))})]})]})]}),e.jsxs(_r,{defaultValue:"dealerships",className:"w-full",children:[e.jsxs(Xs,{className:"grid w-full grid-cols-5",children:[e.jsx(Ve,{value:"dealerships",children:"Dealerships"}),e.jsx(Ve,{value:"groups",children:"Dealership Groups"}),e.jsx(Ve,{value:"admins",children:"Admin Users"}),e.jsx(Ve,{value:"projects",children:"Dealership Projects"}),e.jsx(Ve,{value:"signups",children:"Signup Requests"})]}),e.jsx(ze,{value:"dealerships",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Add New Dealership"}),e.jsx(Be,{children:"Create a new dealership and assign it to a group"})]}),e.jsx(V,{children:e.jsxs("form",{onSubmit:Ze,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"dealership-name",children:"Dealership Name *"}),e.jsx(be,{id:"dealership-name",value:P.name,onChange:C=>E({...P,name:C.target.value}),placeholder:"Enter dealership name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"dealership-group",children:"Dealership Group"}),e.jsxs(mt,{value:P.group_id,onValueChange:C=>E({...P,group_id:C}),children:[e.jsx(rt,{children:e.jsx(ht,{placeholder:"Select dealership group"})}),e.jsx(nt,{children:s.map(C=>e.jsx(Re,{value:String(C.id),children:C.name},C.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"dealership-logo",children:"Logo URL"}),e.jsx(be,{id:"dealership-logo",value:P.logo_url,onChange:C=>E({...P,logo_url:C.target.value}),placeholder:"Enter logo URL (optional)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"dealership-city",children:"City"}),e.jsx(be,{id:"dealership-city",value:P.city,onChange:C=>E({...P,city:C.target.value}),placeholder:"Enter city"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"dealership-state",children:"State"}),e.jsxs(mt,{value:P.state,onValueChange:C=>E({...P,state:C}),children:[e.jsx(rt,{children:e.jsx(ht,{placeholder:"Select state"})}),e.jsx(nt,{children:lw.map(C=>e.jsx(Re,{value:C,children:C},C))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"dealership-brand",children:"Primary Manufacturer"}),e.jsxs(mt,{value:P.brands.length>0?P.brands[0]:"",onValueChange:C=>E({...P,brands:[C]}),children:[e.jsx(rt,{className:"w-full",children:e.jsx(ht,{placeholder:"Select primary manufacturer"})}),e.jsx(nt,{children:Xc.map(C=>e.jsx(Re,{value:C,children:C},C))})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select the primary car manufacturer for this dealership (Note: Currently collected for display purposes only - not stored in database)"})]}),e.jsxs(I,{type:"submit",disabled:y,className:"mt-4",children:[y?e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Vs,{className:"mr-2 h-4 w-4"}),"Create Dealership"]})]})})]}),e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Dealerships"}),e.jsx(Be,{children:"List of all dealerships"})]}),e.jsx(V,{children:u?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Je,{className:"h-8 w-8 animate-spin"})}):e.jsx("div",{className:"max-h-[400px] overflow-auto",children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"ID"}),e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Group"}),e.jsx(H,{children:"Actions"})]})}),e.jsx(it,{children:n.length===0?e.jsx(Se,{children:e.jsx(U,{colSpan:4,className:"text-center",children:"No dealerships found"})}):n.map(C=>{var k;return e.jsxs(Se,{children:[e.jsx(U,{children:C.id}),e.jsx(U,{children:C.name}),e.jsx(U,{children:((k=s.find(R=>R.id===C.group_id))==null?void 0:k.name)||"None"}),e.jsx(U,{children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(I,{variant:"destructive",size:"sm",onClick:()=>kn(C.id),children:e.jsx(qa,{className:"h-4 w-4"})})})})]},C.id)})})]})})})]})]})}),e.jsx(ze,{value:"groups",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Add New Dealership Group"}),e.jsx(Be,{children:"Create a new dealership group"})]}),e.jsx(V,{children:e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"group-name",children:"Group Name *"}),e.jsx(be,{id:"group-name",value:w.name,onChange:C=>S({...w,name:C.target.value}),placeholder:"Enter group name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"group-logo",children:"Logo URL"}),e.jsx(be,{id:"group-logo",value:w.logo_url,onChange:C=>S({...w,logo_url:C.target.value}),placeholder:"Enter logo URL (optional)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(fe,{htmlFor:"group-brands",children:["Car Manufacturers"," ",w.brands.length>0&&`(${w.brands.length} selected)`]}),e.jsx("div",{className:"border rounded-md p-2",children:e.jsx(Mh,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2 p-2",children:Xc.map(C=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(aa,{id:`group-brand-${C}`,checked:w.brands.includes(C),onCheckedChange:()=>Pa(C)}),e.jsx("label",{htmlFor:`group-brand-${C}`,className:"text-sm cursor-pointer",children:C})]},C))})})}),w.brands.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:w.brands.map(C=>e.jsxs(Ue,{variant:"secondary",className:"mr-1 mb-1",children:[C,e.jsx("button",{className:"ml-1 text-xs",onClick:()=>Pa(C),type:"button",children:e.jsx(sa,{className:"h-3 w-3"})})]},C))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select all car manufacturers the dealership group sells (Note: Currently collected for display purposes only - not stored in database)"})]}),e.jsxs(I,{type:"submit",disabled:x,className:"mt-4",children:[x?e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Vs,{className:"mr-2 h-4 w-4"}),"Create Group"]})]})})]}),e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Dealership Groups"}),e.jsx(Be,{children:"List of all dealership groups"})]}),e.jsx(V,{children:m?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Je,{className:"h-8 w-8 animate-spin"})}):e.jsx("div",{className:"max-h-[400px] overflow-auto",children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"ID"}),e.jsx(H,{children:"Name"}),e.jsx(H,{children:e.jsx(Ga,{children:e.jsxs(Ba,{children:[e.jsx(Va,{asChild:!0,children:e.jsxs("span",{className:"cursor-help flex items-center",children:["Dealerships ",e.jsx(Er,{className:"ml-1 h-3 w-3"})]})}),e.jsx(qn,{children:e.jsx("p",{children:"Number of dealership locations in this group. Hover over the count to see names."})})]})})}),e.jsx(H,{children:e.jsx(Ga,{children:e.jsxs(Ba,{children:[e.jsx(Va,{asChild:!0,children:e.jsxs("span",{className:"cursor-help flex items-center",children:["Brands ",e.jsx(Er,{className:"ml-1 h-3 w-3"})]})}),e.jsx(qn,{children:e.jsx("p",{children:"Car manufacturers represented by this group. Multiple locations may sell the same brand."})})]})})}),e.jsx(H,{children:"Actions"})]})}),e.jsx(it,{children:s.length===0?e.jsx(Se,{children:e.jsx(U,{colSpan:5,className:"text-center",children:"No groups found"})}):s.map(C=>{const k=n.filter(R=>R.group_id===C.id);return e.jsxs(Se,{children:[e.jsx(U,{children:C.id}),e.jsx(U,{children:C.name}),e.jsx(U,{children:k.length>0?e.jsx(Ga,{children:e.jsxs(Ba,{children:[e.jsx(Va,{asChild:!0,children:e.jsx("span",{className:"cursor-help",children:k.length})}),e.jsx(qn,{children:e.jsx("p",{className:"max-w-xs",children:k.map(R=>R.name).join(", ")})})]})}):0}),e.jsx(U,{children:C._selectedBrands&&C._selectedBrands.length?e.jsx(Ga,{children:e.jsxs(Ba,{children:[e.jsx(Va,{asChild:!0,children:e.jsx("span",{className:"cursor-help",children:C._selectedBrands.length})}),e.jsx(qn,{children:e.jsx("p",{className:"max-w-xs",children:Array.isArray(C._selectedBrands)?C._selectedBrands.join(", "):"No brands"})})]})}):0}),e.jsx(U,{children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(I,{variant:"destructive",size:"sm",onClick:()=>Rs(C.id),children:e.jsx(qa,{className:"h-4 w-4"})})})})]},C.id)})})]})})})]})]})}),e.jsx(ze,{value:"admins",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Onboard New Admin"}),e.jsx(Be,{children:"Create a new admin user and assign to a dealership"})]}),e.jsx(V,{children:e.jsxs("form",{onSubmit:_a,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"admin-email",children:"Email *"}),e.jsx(be,{id:"admin-email",type:"email",value:D.email,onChange:C=>G({...D,email:C.target.value}),placeholder:"Enter admin email",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"admin-name",children:"Name *"}),e.jsx(be,{id:"admin-name",value:D.name,onChange:C=>G({...D,name:C.target.value}),placeholder:"Enter admin name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"admin-dealership",children:"Dealership"}),e.jsxs(mt,{value:D.dealership_id,onValueChange:C=>G({...D,dealership_id:C,group_id:"",is_group_admin:!1}),disabled:D.is_group_admin,children:[e.jsx(rt,{children:e.jsx(ht,{placeholder:"Select dealership"})}),e.jsx(nt,{children:n.map(C=>e.jsx(Re,{value:String(C.id),children:C.name},C.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(aa,{id:"admin-group",checked:D.is_group_admin,onCheckedChange:C=>{const k=!!C;G({...D,is_group_admin:k,dealership_id:k?"":D.dealership_id})}}),e.jsx(fe,{htmlFor:"admin-group",children:"Assign to Dealership Group instead"})]}),D.is_group_admin&&e.jsxs("div",{className:"mt-2",children:[e.jsxs(mt,{value:D.group_id,onValueChange:C=>G({...D,group_id:C}),children:[e.jsx(rt,{children:e.jsx(ht,{placeholder:"Select dealership group"})}),e.jsx(nt,{children:s.map(C=>e.jsx(Re,{value:String(C.id),children:C.name},C.id))})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"This admin will have access to all dealerships in the selected group."}),e.jsxs(vn,{className:"mt-2",children:[e.jsx(Er,{className:"h-4 w-4"}),e.jsx(Xi,{children:"Group Admin Access"}),e.jsx(bn,{children:"Group admins will be automatically redirected to the Group Admin Dashboard when they log in. They will be able to manage all dealerships in their group from a single interface."})]})]}),!D.is_group_admin&&D.dealership_id&&e.jsxs(vn,{className:"mt-2",children:[e.jsx(Er,{className:"h-4 w-4"}),e.jsx(Xi,{children:"Dealership Admin Access"}),e.jsx(bn,{children:"Dealership admins will be redirected to the Dealership Admin Dashboard for their specific dealership when they log in."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"admin-password",children:"Temporary Password (optional - will be generated if left blank)"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{id:"admin-password",type:O?"text":"password",value:D.password,onChange:C=>G({...D,password:C.target.value}),placeholder:"Enter temporary password",className:"pr-10"}),e.jsx("button",{type:"button",className:"absolute right-2 top-[calc(50%-6px)] text-gray-500 hover:text-gray-700",onClick:()=>ue(!O),children:O?e.jsx(xl,{size:16}):e.jsx(pl,{size:16})})]})]}),e.jsx(I,{type:"submit",disabled:N||!D.email||!D.name,children:N?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),D.is_group_admin?"Creating Group Admin...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Vs,{className:"mr-2 h-4 w-4"}),"Create Admin"]})})]})})]}),e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(z,{children:"Admin Users"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:Zs,children:"Refresh List"}),e.jsx(I,{variant:"outline",size:"sm",onClick:Aa,children:"Debug"}),e.jsx(I,{variant:"outline",size:"sm",onClick:rs,children:"Clean Up Test Accounts"})]})]}),e.jsx(Be,{children:"List of all admin users"})]}),e.jsx(V,{children:b?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Je,{className:"h-8 w-8 animate-spin"})}):e.jsx("div",{className:"max-h-[400px] overflow-auto",children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Email"}),e.jsx(H,{children:"Role"}),e.jsx(H,{children:"Connected To"}),e.jsx(H,{children:"Actions"})]})}),e.jsx(it,{children:o.length===0?e.jsx(Se,{children:e.jsx(U,{colSpan:5,className:"text-center",children:"No admin users found"})}):o.map(C=>e.jsxs(Se,{children:[e.jsx(U,{children:C.name||"N/A"}),e.jsx(U,{children:C.email}),e.jsxs(U,{children:[C.is_group_admin?e.jsx(Ue,{variant:"secondary",className:"bg-indigo-100 text-indigo-800",children:"Group Admin"}):e.jsx(Ue,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"Dealership Admin"}),C.is_simulated&&e.jsx(Ue,{variant:"outline",className:"ml-2",children:"Simulated"})]}),e.jsx(U,{children:C.is_group_admin?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:(()=>{if(C.group_name)return C.group_name;const k=n.find(ie=>ie.id===C.dealership_id);if(!(k!=null&&k.group_id))return"Unknown Group";const R=s.find(ie=>ie.id===k.group_id);return(R==null?void 0:R.name)||`Group ${k.group_id}`})()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(()=>{const k=n.find(R=>R.id===C.dealership_id);return k!=null&&k.group_id?`Group ID: ${k.group_id}`:""})()}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Primary Dealership:"," ",(()=>{const k=n.find(R=>R.id===C.dealership_id);return(k==null?void 0:k.name)||(C.dealership_id?`ID: ${C.dealership_id}`:"None")})()]})]}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:(()=>{const k=n.find(R=>R.id===C.dealership_id);return k?k.name:C.dealership_name?C.dealership_name:C.dealership_id?`Dealership ID: ${C.dealership_id}`:"No Dealership"})()}),(()=>{const k=n.find(ie=>ie.id===C.dealership_id);if(!(k!=null&&k.group_id))return null;const R=s.find(ie=>ie.id===k.group_id);return e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Part of group:"," ",(R==null?void 0:R.name)||`Group ${k.group_id}`]})})()]})}),e.jsx(U,{children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(I,{variant:"destructive",size:"sm",onClick:()=>Zo(C.id,C.is_simulated),children:e.jsx(qa,{className:"h-4 w-4"})})})})]},C.id))})]})})}),e.jsxs("div",{className:"px-6 pb-6 pt-0 border-t border-gray-200 mt-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2 mt-4",children:"Emergency Test Account Confirmation"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(be,{placeholder:"Enter test email to confirm",value:K,onChange:C=>ce(C.target.value),className:"flex-1"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Qo(K),disabled:!K,children:"Confirm Email"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`Use only for test accounts with "Email not confirmed" errors. Enter the email address you're having trouble with.`})]}),e.jsxs("div",{className:"px-6 pb-6 pt-0 border-t border-gray-200 mt-2",children:[e.jsx("h4",{className:"text-sm font-medium mb-2 mt-4",children:"Purge Test Account"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(be,{placeholder:"Enter test email to purge",value:X,onChange:C=>F(C.target.value),className:"flex-1"}),e.jsx(I,{variant:"destructive",size:"sm",onClick:()=>ks(X),disabled:!X,children:"Purge Account"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use this to completely remove a test account that can't be recreated. This will attempt to delete all traces of the account from auth and profiles tables."})]})]})]})}),e.jsx(ze,{value:"projects"}),e.jsx(ze,{value:"signups",children:e.jsx("div",{className:"grid md:grid-cols-1 gap-6",children:e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Signup Requests"}),e.jsx(Be,{children:"Review and process signup requests from the marketing website"})]}),e.jsx(V,{children:Z?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Je,{className:"h-8 w-8 animate-spin"})}):e.jsx("div",{className:"max-h-[600px] overflow-auto",children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"ID"}),e.jsx(H,{children:"Dealership"}),e.jsx(H,{children:"Contact"}),e.jsx(H,{children:"Email"}),e.jsx(H,{children:"Tier"}),e.jsx(H,{children:"Add-Ons"}),e.jsx(H,{children:"Status"}),e.jsx(H,{children:"Created"}),e.jsx(H,{children:"Actions"})]})}),e.jsx(it,{children:_.length===0?e.jsx(Se,{children:e.jsx(U,{colSpan:8,className:"text-center",children:"No signup requests found"})}):_.map(C=>e.jsxs(Se,{children:[e.jsxs(U,{className:"font-mono text-xs",children:[C.id.substring(0,8),"..."]}),e.jsx(U,{children:C.dealership_name}),e.jsx(U,{children:C.contact_person}),e.jsx(U,{children:C.email}),e.jsx(U,{children:e.jsx(Ue,{variant:C.tier==="free_trial"?"outline":C.tier==="finance_manager"?"secondary":C.tier==="dealership"?"default":"destructive",children:C.tier==="free_trial"?"Free Trial":C.tier==="finance_manager"?"Finance Manager":C.tier==="dealership"?"Dealership":"Dealer Group"})}),e.jsx(U,{children:C.add_ons&&C.add_ons.length>0?e.jsxs("div",{className:"space-y-1",children:[C.add_ons.includes("plus")&&e.jsx(Ue,{variant:"outline",className:"bg-blue-900/20 text-blue-400 border-blue-800",children:"+ Version"}),C.add_ons.includes("plusplus")&&e.jsx(Ue,{variant:"outline",className:"bg-indigo-900/20 text-indigo-400 border-indigo-800",children:"++ Version"})]}):e.jsx("span",{className:"text-gray-500",children:"None"})}),e.jsx(U,{children:e.jsx(Ue,{variant:C.status==="pending"?"outline":C.status==="approved"?"default":"destructive",children:C.status.charAt(0).toUpperCase()+C.status.slice(1)})}),e.jsx(U,{children:new Date(C.created_at).toLocaleDateString()}),e.jsx(U,{children:C.status==="pending"?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(jr,{children:[e.jsx(co,{asChild:!0,children:e.jsxs(I,{variant:"default",size:"sm",disabled:we,children:[e.jsx(Cn,{className:"h-4 w-4 mr-1"}),"Approve"]})}),e.jsxs(qs,{children:[e.jsxs(Ys,{children:[e.jsx(Js,{children:"Approve Signup Request"}),e.jsx(Qs,{children:"Review and approve this signup request. You can customize the onboarding details below."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Request Details"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Dealership:"})," ",C.dealership_name]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Contact:"})," ",C.contact_person]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Email:"})," ",C.email]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Tier:"})," ",C.tier==="free_trial"?"Free Trial":C.tier==="finance_manager"?"Finance Manager":C.tier==="dealership"?"Dealership":"Dealer Group"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Created:"})," ",new Date(C.created_at).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Onboarding Configuration"}),(C.tier==="dealership"||C.tier==="dealer_group")&&e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx(fe,{htmlFor:"schema-name",children:"Schema Name (optional)"}),e.jsx(be,{id:"schema-name",placeholder:"Leave empty for auto-generated",value:Ee,onChange:k=>He(k.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Only letters, numbers and underscores. If left empty, a random name will be generated."})]}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx(fe,{htmlFor:"admin-email",children:"Admin Email (optional)"}),e.jsx(be,{id:"admin-email",placeholder:C.email,value:$e,onChange:k=>zt(k.target.value)})]}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx(fe,{htmlFor:"admin-name",children:"Admin Name (optional)"}),e.jsx(be,{id:"admin-name",placeholder:C.contact_person,value:ct,onChange:k=>pt(k.target.value)})]}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx(fe,{htmlFor:"temp-password",children:"Temporary Password (optional)"}),e.jsx(be,{id:"temp-password",placeholder:"Leave empty for auto-generated",value:Qe,onChange:k=>gt(k.target.value)})]})]})]})}),e.jsxs(Ks,{children:[e.jsx(I,{variant:"outline",onClick:()=>{He(""),zt(""),pt(""),gt("")},children:"Reset"}),e.jsx(I,{onClick:()=>Da(C.id),disabled:we,children:we&&dt===C.id?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Approve Request"})]})]})]}),e.jsxs(jr,{children:[e.jsx(co,{asChild:!0,children:e.jsxs(I,{variant:"destructive",size:"sm",disabled:we,children:[e.jsx(sa,{className:"h-4 w-4 mr-1"}),"Reject"]})}),e.jsxs(qs,{children:[e.jsxs(Ys,{children:[e.jsx(Js,{children:"Reject Signup Request"}),e.jsx(Qs,{children:"Are you sure you want to reject this signup request?"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Request Details"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Dealership:"})," ",C.dealership_name]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Contact:"})," ",C.contact_person]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Email:"})," ",C.email]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Tier:"})," ",C.tier==="free_trial"?"Free Trial":C.tier==="finance_manager"?"Finance Manager":C.tier==="dealership"?"Dealership":"Dealer Group"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"rejection-reason",children:"Rejection Reason (optional)"}),e.jsx(jl,{id:"rejection-reason",placeholder:"Enter reason for rejection",value:Ct,onChange:k=>It(k.target.value)})]})]}),e.jsx(Ks,{children:e.jsx(I,{variant:"destructive",onClick:()=>Ht(C.id),disabled:we,children:we&&dt===C.id?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Confirm Rejection"})})]})]})]}):e.jsx(Ue,{variant:C.status==="approved"?"default":"destructive",children:C.status==="approved"?"Approved":"Rejected"})})]},C.id))})]})})}),e.jsx("div",{className:"px-6 pb-6",children:e.jsx(I,{variant:"outline",onClick:as,disabled:Z,children:Z?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):e.jsx(e.Fragment,{children:"Refresh"})})})]})})})]})]})}var Vo=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Wo=typeof window>"u"||"Deno"in globalThis;function ls(){}function dw(t,s){return typeof t=="function"?t(s):t}function uw(t){return typeof t=="number"&&t>=0&&t!==1/0}function mw(t,s){return Math.max(t+(s||0)-Date.now(),0)}function Zc(t,s){return typeof t=="function"?t(s):t}function hw(t,s){return typeof t=="function"?t(s):t}function ed(t,s){const{type:r="all",exact:n,fetchStatus:a,predicate:o,queryKey:i,stale:c}=t;if(i){if(n){if(s.queryHash!==ql(i,s.options))return!1}else if(!la(s.queryKey,i))return!1}if(r!=="all"){const d=s.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof c=="boolean"&&s.isStale()!==c||a&&a!==s.state.fetchStatus||o&&!o(s))}function td(t,s){const{exact:r,status:n,predicate:a,mutationKey:o}=t;if(o){if(!s.options.mutationKey)return!1;if(r){if(ia(s.options.mutationKey)!==ia(o))return!1}else if(!la(s.options.mutationKey,o))return!1}return!(n&&s.state.status!==n||a&&!a(s))}function ql(t,s){return((s==null?void 0:s.queryKeyHashFn)||ia)(t)}function ia(t){return JSON.stringify(t,(s,r)=>tl(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function la(t,s){return t===s?!0:typeof t!=typeof s?!1:t&&s&&typeof t=="object"&&typeof s=="object"?Object.keys(s).every(r=>la(t[r],s[r])):!1}function pf(t,s){if(t===s)return t;const r=sd(t)&&sd(s);if(r||tl(t)&&tl(s)){const n=r?t:Object.keys(t),a=n.length,o=r?s:Object.keys(s),i=o.length,c=r?[]:{};let d=0;for(let m=0;m<i;m++){const h=r?m:o[m];(!r&&n.includes(h)||r)&&t[h]===void 0&&s[h]===void 0?(c[h]=void 0,d++):(c[h]=pf(t[h],s[h]),c[h]===t[h]&&t[h]!==void 0&&d++)}return a===i&&d===a?t:c}return s}function sd(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function tl(t){if(!rd(t))return!1;const s=t.constructor;if(s===void 0)return!0;const r=s.prototype;return!(!rd(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function rd(t){return Object.prototype.toString.call(t)==="[object Object]"}function fw(t){return new Promise(s=>{setTimeout(s,t)})}function xw(t,s,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,s):r.structuralSharing!==!1?pf(t,s):s}function pw(t,s,r=0){const n=[...t,s];return r&&n.length>r?n.slice(1):n}function gw(t,s,r=0){const n=[s,...t];return r&&n.length>r?n.slice(0,-1):n}var Yl=Symbol();function gf(t,s){return!t.queryFn&&(s!=null&&s.initialPromise)?()=>s.initialPromise:!t.queryFn||t.queryFn===Yl?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Mr,ir,an,jd,vw=(jd=class extends Vo{constructor(){super();Fe(this,Mr);Fe(this,ir);Fe(this,an);Ae(this,an,s=>{if(!Wo&&window.addEventListener){const r=()=>s();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){q(this,ir)||this.setEventListener(q(this,an))}onUnsubscribe(){var s;this.hasListeners()||((s=q(this,ir))==null||s.call(this),Ae(this,ir,void 0))}setEventListener(s){var r;Ae(this,an,s),(r=q(this,ir))==null||r.call(this),Ae(this,ir,s(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(s){q(this,Mr)!==s&&(Ae(this,Mr,s),this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(r=>{r(s)})}isFocused(){var s;return typeof q(this,Mr)=="boolean"?q(this,Mr):((s=globalThis.document)==null?void 0:s.visibilityState)!=="hidden"}},Mr=new WeakMap,ir=new WeakMap,an=new WeakMap,jd),vf=new vw,on,lr,ln,wd,bw=(wd=class extends Vo{constructor(){super();Fe(this,on,!0);Fe(this,lr);Fe(this,ln);Ae(this,ln,s=>{if(!Wo&&window.addEventListener){const r=()=>s(!0),n=()=>s(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){q(this,lr)||this.setEventListener(q(this,ln))}onUnsubscribe(){var s;this.hasListeners()||((s=q(this,lr))==null||s.call(this),Ae(this,lr,void 0))}setEventListener(s){var r;Ae(this,ln,s),(r=q(this,lr))==null||r.call(this),Ae(this,lr,s(this.setOnline.bind(this)))}setOnline(s){q(this,on)!==s&&(Ae(this,on,s),this.listeners.forEach(n=>{n(s)}))}isOnline(){return q(this,on)}},on=new WeakMap,lr=new WeakMap,ln=new WeakMap,wd),uo=new bw;function yw(){let t,s;const r=new Promise((a,o)=>{t=a,s=o});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),t(a)},r.reject=a=>{n({status:"rejected",reason:a}),s(a)},r}function jw(t){return Math.min(1e3*2**t,3e4)}function bf(t){return(t??"online")==="online"?uo.isOnline():!0}var yf=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function bi(t){return t instanceof yf}function jf(t){let s=!1,r=0,n=!1,a;const o=yw(),i=x=>{var v;n||(f(new yf(x)),(v=t.abort)==null||v.call(t))},c=()=>{s=!0},d=()=>{s=!1},m=()=>vf.isFocused()&&(t.networkMode==="always"||uo.isOnline())&&t.canRun(),h=()=>bf(t.networkMode)&&t.canRun(),u=x=>{var v;n||(n=!0,(v=t.onSuccess)==null||v.call(t,x),a==null||a(),o.resolve(x))},f=x=>{var v;n||(n=!0,(v=t.onError)==null||v.call(t,x),a==null||a(),o.reject(x))},b=()=>new Promise(x=>{var v;a=y=>{(n||m())&&x(y)},(v=t.onPause)==null||v.call(t)}).then(()=>{var x;a=void 0,n||(x=t.onContinue)==null||x.call(t)}),p=()=>{if(n)return;let x;const v=r===0?t.initialPromise:void 0;try{x=v??t.fn()}catch(y){x=Promise.reject(y)}Promise.resolve(x).then(u).catch(y=>{var S;if(n)return;const j=t.retry??(Wo?0:3),N=t.retryDelay??jw,g=typeof N=="function"?N(r,y):N,w=j===!0||typeof j=="number"&&r<j||typeof j=="function"&&j(r,y);if(s||!w){f(y);return}r++,(S=t.onFail)==null||S.call(t,r,y),fw(g).then(()=>m()?void 0:b()).then(()=>{s?f(y):p()})})};return{promise:o,cancel:i,continue:()=>(a==null||a(),o),cancelRetry:c,continueRetry:d,canStart:h,start:()=>(h()?p():b().then(p),o)}}var ww=t=>setTimeout(t,0);function Nw(){let t=[],s=0,r=c=>{c()},n=c=>{c()},a=ww;const o=c=>{s?t.push(c):a(()=>{r(c)})},i=()=>{const c=t;t=[],c.length&&a(()=>{n(()=>{c.forEach(d=>{r(d)})})})};return{batch:c=>{let d;s++;try{d=c()}finally{s--,s||i()}return d},batchCalls:c=>(...d)=>{o(()=>{c(...d)})},schedule:o,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{n=c},setScheduler:c=>{a=c}}}var Et=Nw(),kr,Nd,wf=(Nd=class{constructor(){Fe(this,kr)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),uw(this.gcTime)&&Ae(this,kr,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Wo?1/0:5*60*1e3))}clearGcTimeout(){q(this,kr)&&(clearTimeout(q(this,kr)),Ae(this,kr,void 0))}},kr=new WeakMap,Nd),cn,dn,Yt,Rr,Nt,ma,Ir,cs,Us,Sd,Sw=(Sd=class extends wf{constructor(s){super();Fe(this,cs);Fe(this,cn);Fe(this,dn);Fe(this,Yt);Fe(this,Rr);Fe(this,Nt);Fe(this,ma);Fe(this,Ir);Ae(this,Ir,!1),Ae(this,ma,s.defaultOptions),this.setOptions(s.options),this.observers=[],Ae(this,Rr,s.client),Ae(this,Yt,q(this,Rr).getQueryCache()),this.queryKey=s.queryKey,this.queryHash=s.queryHash,Ae(this,cn,Pw(this.options)),this.state=s.state??q(this,cn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var s;return(s=q(this,Nt))==null?void 0:s.promise}setOptions(s){this.options={...q(this,ma),...s},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&q(this,Yt).remove(this)}setData(s,r){const n=xw(this.state.data,s,this.options);return wt(this,cs,Us).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(s,r){wt(this,cs,Us).call(this,{type:"setState",state:s,setStateOptions:r})}cancel(s){var n,a;const r=(n=q(this,Nt))==null?void 0:n.promise;return(a=q(this,Nt))==null||a.cancel(s),r?r.then(ls).catch(ls):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(q(this,cn))}isActive(){return this.observers.some(s=>hw(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Yl||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(s=0){return this.state.isInvalidated||this.state.data===void 0||!mw(this.state.dataUpdatedAt,s)}onFocus(){var r;const s=this.observers.find(n=>n.shouldFetchOnWindowFocus());s==null||s.refetch({cancelRefetch:!1}),(r=q(this,Nt))==null||r.continue()}onOnline(){var r;const s=this.observers.find(n=>n.shouldFetchOnReconnect());s==null||s.refetch({cancelRefetch:!1}),(r=q(this,Nt))==null||r.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),q(this,Yt).notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(r=>r!==s),this.observers.length||(q(this,Nt)&&(q(this,Ir)?q(this,Nt).cancel({revert:!0}):q(this,Nt).cancelRetry()),this.scheduleGc()),q(this,Yt).notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||wt(this,cs,Us).call(this,{type:"invalidate"})}fetch(s,r){var d,m,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(q(this,Nt))return q(this,Nt).continueRetry(),q(this,Nt).promise}if(s&&this.setOptions(s),!this.options.queryFn){const u=this.observers.find(f=>f.options.queryFn);u&&this.setOptions(u.options)}const n=new AbortController,a=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(Ae(this,Ir,!0),n.signal)})},o=()=>{const u=gf(this.options,r),f={client:q(this,Rr),queryKey:this.queryKey,meta:this.meta};return a(f),Ae(this,Ir,!1),this.options.persister?this.options.persister(u,f,this):u(f)},i={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:q(this,Rr),state:this.state,fetchFn:o};a(i),(d=this.options.behavior)==null||d.onFetch(i,this),Ae(this,dn,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=i.fetchOptions)==null?void 0:m.meta))&&wt(this,cs,Us).call(this,{type:"fetch",meta:(h=i.fetchOptions)==null?void 0:h.meta});const c=u=>{var f,b,p,x;bi(u)&&u.silent||wt(this,cs,Us).call(this,{type:"error",error:u}),bi(u)||((b=(f=q(this,Yt).config).onError)==null||b.call(f,u,this),(x=(p=q(this,Yt).config).onSettled)==null||x.call(p,this.state.data,u,this)),this.scheduleGc()};return Ae(this,Nt,jf({initialPromise:r==null?void 0:r.initialPromise,fn:i.fetchFn,abort:n.abort.bind(n),onSuccess:u=>{var f,b,p,x;if(u===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(u)}catch(v){c(v);return}(b=(f=q(this,Yt).config).onSuccess)==null||b.call(f,u,this),(x=(p=q(this,Yt).config).onSettled)==null||x.call(p,u,this.state.error,this),this.scheduleGc()},onError:c,onFail:(u,f)=>{wt(this,cs,Us).call(this,{type:"failed",failureCount:u,error:f})},onPause:()=>{wt(this,cs,Us).call(this,{type:"pause"})},onContinue:()=>{wt(this,cs,Us).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),q(this,Nt).start()}},cn=new WeakMap,dn=new WeakMap,Yt=new WeakMap,Rr=new WeakMap,Nt=new WeakMap,ma=new WeakMap,Ir=new WeakMap,cs=new WeakSet,Us=function(s){const r=n=>{switch(s.type){case"failed":return{...n,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Cw(n.data,this.options),fetchMeta:s.meta??null};case"success":return{...n,data:s.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=s.error;return bi(a)&&a.revert&&q(this,dn)?{...q(this,dn),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...s.state}}};this.state=r(this.state),Et.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),q(this,Yt).notify({query:this,type:"updated",action:s})})},Sd);function Cw(t,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:bf(s.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Pw(t){const s=typeof t.initialData=="function"?t.initialData():t.initialData,r=s!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var ys,Cd,_w=(Cd=class extends Vo{constructor(s={}){super();Fe(this,ys);this.config=s,Ae(this,ys,new Map)}build(s,r,n){const a=r.queryKey,o=r.queryHash??ql(a,r);let i=this.get(o);return i||(i=new Sw({client:s,queryKey:a,queryHash:o,options:s.defaultQueryOptions(r),state:n,defaultOptions:s.getQueryDefaults(a)}),this.add(i)),i}add(s){q(this,ys).has(s.queryHash)||(q(this,ys).set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const r=q(this,ys).get(s.queryHash);r&&(s.destroy(),r===s&&q(this,ys).delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){Et.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return q(this,ys).get(s)}getAll(){return[...q(this,ys).values()]}find(s){const r={exact:!0,...s};return this.getAll().find(n=>ed(r,n))}findAll(s={}){const r=this.getAll();return Object.keys(s).length>0?r.filter(n=>ed(s,n)):r}notify(s){Et.batch(()=>{this.listeners.forEach(r=>{r(s)})})}onFocus(){Et.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){Et.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},ys=new WeakMap,Cd),js,At,Fr,ws,ar,Pd,Dw=(Pd=class extends wf{constructor(s){super();Fe(this,ws);Fe(this,js);Fe(this,At);Fe(this,Fr);this.mutationId=s.mutationId,Ae(this,At,s.mutationCache),Ae(this,js,[]),this.state=s.state||Aw(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){q(this,js).includes(s)||(q(this,js).push(s),this.clearGcTimeout(),q(this,At).notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){Ae(this,js,q(this,js).filter(r=>r!==s)),this.scheduleGc(),q(this,At).notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){q(this,js).length||(this.state.status==="pending"?this.scheduleGc():q(this,At).remove(this))}continue(){var s;return((s=q(this,Fr))==null?void 0:s.continue())??this.execute(this.state.variables)}async execute(s){var o,i,c,d,m,h,u,f,b,p,x,v,y,j,N,g,w,S,P,E;const r=()=>{wt(this,ws,ar).call(this,{type:"continue"})};Ae(this,Fr,jf({fn:()=>this.options.mutationFn?this.options.mutationFn(s):Promise.reject(new Error("No mutationFn found")),onFail:(D,G)=>{wt(this,ws,ar).call(this,{type:"failed",failureCount:D,error:G})},onPause:()=>{wt(this,ws,ar).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>q(this,At).canRun(this)}));const n=this.state.status==="pending",a=!q(this,Fr).canStart();try{if(n)r();else{wt(this,ws,ar).call(this,{type:"pending",variables:s,isPaused:a}),await((i=(o=q(this,At).config).onMutate)==null?void 0:i.call(o,s,this));const G=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,s));G!==this.state.context&&wt(this,ws,ar).call(this,{type:"pending",context:G,variables:s,isPaused:a})}const D=await q(this,Fr).start();return await((h=(m=q(this,At).config).onSuccess)==null?void 0:h.call(m,D,s,this.state.context,this)),await((f=(u=this.options).onSuccess)==null?void 0:f.call(u,D,s,this.state.context)),await((p=(b=q(this,At).config).onSettled)==null?void 0:p.call(b,D,null,this.state.variables,this.state.context,this)),await((v=(x=this.options).onSettled)==null?void 0:v.call(x,D,null,s,this.state.context)),wt(this,ws,ar).call(this,{type:"success",data:D}),D}catch(D){try{throw await((j=(y=q(this,At).config).onError)==null?void 0:j.call(y,D,s,this.state.context,this)),await((g=(N=this.options).onError)==null?void 0:g.call(N,D,s,this.state.context)),await((S=(w=q(this,At).config).onSettled)==null?void 0:S.call(w,void 0,D,this.state.variables,this.state.context,this)),await((E=(P=this.options).onSettled)==null?void 0:E.call(P,void 0,D,s,this.state.context)),D}finally{wt(this,ws,ar).call(this,{type:"error",error:D})}}finally{q(this,At).runNext(this)}}},js=new WeakMap,At=new WeakMap,Fr=new WeakMap,ws=new WeakSet,ar=function(s){const r=n=>{switch(s.type){case"failed":return{...n,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...n,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:s.error,failureCount:n.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Et.batch(()=>{q(this,js).forEach(n=>{n.onMutationUpdate(s)}),q(this,At).notify({mutation:this,type:"updated",action:s})})},Pd);function Aw(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Bs,ds,ha,_d,Ew=(_d=class extends Vo{constructor(s={}){super();Fe(this,Bs);Fe(this,ds);Fe(this,ha);this.config=s,Ae(this,Bs,new Set),Ae(this,ds,new Map),Ae(this,ha,0)}build(s,r,n){const a=new Dw({mutationCache:this,mutationId:++Ta(this,ha)._,options:s.defaultMutationOptions(r),state:n});return this.add(a),a}add(s){q(this,Bs).add(s);const r=Wa(s);if(typeof r=="string"){const n=q(this,ds).get(r);n?n.push(s):q(this,ds).set(r,[s])}this.notify({type:"added",mutation:s})}remove(s){if(q(this,Bs).delete(s)){const r=Wa(s);if(typeof r=="string"){const n=q(this,ds).get(r);if(n)if(n.length>1){const a=n.indexOf(s);a!==-1&&n.splice(a,1)}else n[0]===s&&q(this,ds).delete(r)}}this.notify({type:"removed",mutation:s})}canRun(s){const r=Wa(s);if(typeof r=="string"){const n=q(this,ds).get(r),a=n==null?void 0:n.find(o=>o.state.status==="pending");return!a||a===s}else return!0}runNext(s){var n;const r=Wa(s);if(typeof r=="string"){const a=(n=q(this,ds).get(r))==null?void 0:n.find(o=>o!==s&&o.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Et.batch(()=>{q(this,Bs).forEach(s=>{this.notify({type:"removed",mutation:s})}),q(this,Bs).clear(),q(this,ds).clear()})}getAll(){return Array.from(q(this,Bs))}find(s){const r={exact:!0,...s};return this.getAll().find(n=>td(r,n))}findAll(s={}){return this.getAll().filter(r=>td(s,r))}notify(s){Et.batch(()=>{this.listeners.forEach(r=>{r(s)})})}resumePausedMutations(){const s=this.getAll().filter(r=>r.state.isPaused);return Et.batch(()=>Promise.all(s.map(r=>r.continue().catch(ls))))}},Bs=new WeakMap,ds=new WeakMap,ha=new WeakMap,_d);function Wa(t){var s;return(s=t.options.scope)==null?void 0:s.id}function nd(t){return{onFetch:(s,r)=>{var h,u,f,b,p;const n=s.options,a=(f=(u=(h=s.fetchOptions)==null?void 0:h.meta)==null?void 0:u.fetchMore)==null?void 0:f.direction,o=((b=s.state.data)==null?void 0:b.pages)||[],i=((p=s.state.data)==null?void 0:p.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const m=async()=>{let x=!1;const v=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(s.signal.aborted?x=!0:s.signal.addEventListener("abort",()=>{x=!0}),s.signal)})},y=gf(s.options,s.fetchOptions),j=async(N,g,w)=>{if(x)return Promise.reject();if(g==null&&N.pages.length)return Promise.resolve(N);const S={client:s.client,queryKey:s.queryKey,pageParam:g,direction:w?"backward":"forward",meta:s.options.meta};v(S);const P=await y(S),{maxPages:E}=s.options,D=w?gw:pw;return{pages:D(N.pages,P,E),pageParams:D(N.pageParams,g,E)}};if(a&&o.length){const N=a==="backward",g=N?Tw:ad,w={pages:o,pageParams:i},S=g(n,w);c=await j(w,S,N)}else{const N=t??o.length;do{const g=d===0?i[0]??n.initialPageParam:ad(n,c);if(d>0&&g==null)break;c=await j(c,g),d++}while(d<N)}return c};s.options.persister?s.fetchFn=()=>{var x,v;return(v=(x=s.options).persister)==null?void 0:v.call(x,m,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},r)}:s.fetchFn=m}}}function ad(t,{pages:s,pageParams:r}){const n=s.length-1;return s.length>0?t.getNextPageParam(s[n],s,r[n],r):void 0}function Tw(t,{pages:s,pageParams:r}){var n;return s.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,s[0],s,r[0],r):void 0}var tt,cr,dr,un,mn,ur,hn,fn,Dd,Mw=(Dd=class{constructor(t={}){Fe(this,tt);Fe(this,cr);Fe(this,dr);Fe(this,un);Fe(this,mn);Fe(this,ur);Fe(this,hn);Fe(this,fn);Ae(this,tt,t.queryCache||new _w),Ae(this,cr,t.mutationCache||new Ew),Ae(this,dr,t.defaultOptions||{}),Ae(this,un,new Map),Ae(this,mn,new Map),Ae(this,ur,0)}mount(){Ta(this,ur)._++,q(this,ur)===1&&(Ae(this,hn,vf.subscribe(async t=>{t&&(await this.resumePausedMutations(),q(this,tt).onFocus())})),Ae(this,fn,uo.subscribe(async t=>{t&&(await this.resumePausedMutations(),q(this,tt).onOnline())})))}unmount(){var t,s;Ta(this,ur)._--,q(this,ur)===0&&((t=q(this,hn))==null||t.call(this),Ae(this,hn,void 0),(s=q(this,fn))==null||s.call(this),Ae(this,fn,void 0))}isFetching(t){return q(this,tt).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return q(this,cr).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const s=this.defaultQueryOptions({queryKey:t});return(r=q(this,tt).get(s.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const s=this.defaultQueryOptions(t),r=q(this,tt).build(this,s),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Zc(s.staleTime,r))&&this.prefetchQuery(s),Promise.resolve(n))}getQueriesData(t){return q(this,tt).findAll(t).map(({queryKey:s,state:r})=>{const n=r.data;return[s,n]})}setQueryData(t,s,r){const n=this.defaultQueryOptions({queryKey:t}),a=q(this,tt).get(n.queryHash),o=a==null?void 0:a.state.data,i=dw(s,o);if(i!==void 0)return q(this,tt).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(t,s,r){return Et.batch(()=>q(this,tt).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,s,r)]))}getQueryState(t){var r;const s=this.defaultQueryOptions({queryKey:t});return(r=q(this,tt).get(s.queryHash))==null?void 0:r.state}removeQueries(t){const s=q(this,tt);Et.batch(()=>{s.findAll(t).forEach(r=>{s.remove(r)})})}resetQueries(t,s){const r=q(this,tt);return Et.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},s)))}cancelQueries(t,s={}){const r={revert:!0,...s},n=Et.batch(()=>q(this,tt).findAll(t).map(a=>a.cancel(r)));return Promise.all(n).then(ls).catch(ls)}invalidateQueries(t,s={}){return Et.batch(()=>(q(this,tt).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},s)))}refetchQueries(t,s={}){const r={...s,cancelRefetch:s.cancelRefetch??!0},n=Et.batch(()=>q(this,tt).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let o=a.fetch(void 0,r);return r.throwOnError||(o=o.catch(ls)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(ls)}fetchQuery(t){const s=this.defaultQueryOptions(t);s.retry===void 0&&(s.retry=!1);const r=q(this,tt).build(this,s);return r.isStaleByTime(Zc(s.staleTime,r))?r.fetch(s):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(ls).catch(ls)}fetchInfiniteQuery(t){return t.behavior=nd(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(ls).catch(ls)}ensureInfiniteQueryData(t){return t.behavior=nd(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return uo.isOnline()?q(this,cr).resumePausedMutations():Promise.resolve()}getQueryCache(){return q(this,tt)}getMutationCache(){return q(this,cr)}getDefaultOptions(){return q(this,dr)}setDefaultOptions(t){Ae(this,dr,t)}setQueryDefaults(t,s){q(this,un).set(ia(t),{queryKey:t,defaultOptions:s})}getQueryDefaults(t){const s=[...q(this,un).values()],r={};return s.forEach(n=>{la(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,s){q(this,mn).set(ia(t),{mutationKey:t,defaultOptions:s})}getMutationDefaults(t){const s=[...q(this,mn).values()],r={};return s.forEach(n=>{la(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const s={...q(this,dr).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return s.queryHash||(s.queryHash=ql(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===Yl&&(s.enabled=!1),s}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...q(this,dr).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){q(this,tt).clear(),q(this,cr).clear()}},tt=new WeakMap,cr=new WeakMap,dr=new WeakMap,un=new WeakMap,mn=new WeakMap,ur=new WeakMap,hn=new WeakMap,fn=new WeakMap,Dd),kw=l.createContext(void 0),Rw=({client:t,children:s})=>(l.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(kw.Provider,{value:t,children:s}));const Iw=new Mw({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:5*60*1e3}}}),Fw=()=>{const{user:t}=et(),[s,r]=l.useState([]),[n,a]=l.useState(!0),[o,i]=l.useState([5,8,15,18,25,27,29]),[c,d]=l.useState({expected:0,actual:0,progress:0,status:"neutral",progressRatio:0}),[m,h]=l.useState(new Date().getDate()),[u,f]=l.useState(new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate()),b=15;l.useEffect(()=>(console.log("[GoalTracking] Component mounted",{userId:t==null?void 0:t.id,currentDay:m,daysInMonth:u,timestamp:new Date().toISOString()}),p(),()=>{console.log("[GoalTracking] Component unmounting")}),[t]);const p=async()=>{try{if(a(!0),!(t!=null&&t.id)){console.log("[GoalTracking] No user ID available"),a(!1);return}console.log("[GoalTracking] Fetching goal data for user:",t.id);const S=await $x(t.id);r(S.deals),i(S.daysOff),d(S.progressMetrics),h(S.currentDay),f(S.daysInMonth),console.log("[GoalTracking] Goal data loaded:",S)}catch(S){console.error("[GoalTracking] Error fetching goal data:",S)}finally{a(!1)}},x=u-m,v=Math.max(0,b-c.actual),y=x>0?(v/x).toFixed(1):"0",j=()=>{switch(c.status){case"on-track":return"text-green-600";case"slightly-behind":return"text-amber-500";case"behind":return"text-red-500";default:return"text-gray-500"}},N=()=>{switch(c.status){case"on-track":return"bg-green-100";case"slightly-behind":return"bg-amber-100";case"behind":return"bg-red-100";default:return"bg-gray-100"}},g=()=>{switch(c.status){case"on-track":return e.jsxs("span",{className:"flex items-center",children:[e.jsx(So,{className:"h-4 w-4 mr-1"}),"On Track"]});case"slightly-behind":return e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ac,{className:"h-4 w-4 mr-1"}),"Slightly Behind"]});case"behind":return e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ac,{className:"h-4 w-4 mr-1"}),"Behind Target"]});default:return e.jsx("span",{className:"flex items-center",children:"Getting Started"})}},w=()=>Math.min(100,Math.round(c.actual/b*100));return e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"pb-2 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(z,{className:"text-lg font-medium flex items-center",children:[e.jsx(Or,{className:"mr-2 h-5 w-5 text-blue-600"}),"Goal Tracker"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"text-sm",children:[m,"/",u]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${c.status==="on-track"?"bg-green-500":c.status==="slightly-behind"?"bg-amber-500":c.status==="behind"?"bg-red-500":"bg-gray-400"} animate-pulse shadow-md`,title:`Status: ${c.status}`})]})]})}),e.jsx(V,{className:"pt-4",children:n?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(fr,{className:"h-8 w-8 mx-auto mb-2 animate-pulse text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading goal data..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:`w-32 h-32 rounded-full flex items-center justify-center mb-4 transition-all duration-500 ${N()}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:c.actual}),e.jsxs("div",{className:"text-sm",children:["of ",b]})]})}),e.jsx("div",{className:`text-lg font-bold ${j()}`,children:g()}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1 text-center",children:["You've sold ",c.actual," units this month.",c.expected>0&&` Expected by day ${m}: ${c.expected} units.`]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[w(),"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${c.status==="on-track"?"bg-green-500":c.status==="slightly-behind"?"bg-amber-500":"bg-red-500"}`,style:{width:`${w()}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-xs text-blue-600 mb-1",children:"Days Remaining"}),e.jsxs("div",{className:"text-xl font-bold",children:[x," days"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Until end of month"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-xs text-purple-600 mb-1",children:"Daily Pace Needed"}),e.jsx("div",{className:"text-xl font-bold",children:y}),e.jsx("div",{className:"text-xs text-gray-500",children:"Units per day to reach goal"})]})]}),c.actual>0&&e.jsxs("div",{className:"mt-5 bg-gradient-to-r from-blue-50 to-indigo-50 p-3 rounded-lg border border-blue-100",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-700 mb-2",children:"Achievements"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.actual>=1&&e.jsx("div",{className:"bg-white/80 px-2 py-1 rounded-full text-xs backdrop-blur-sm border border-blue-100",children:" First Sale"}),c.actual>=5&&e.jsx("div",{className:"bg-white/80 px-2 py-1 rounded-full text-xs backdrop-blur-sm border border-blue-100",children:" Consistent Performer"}),c.actual>=10&&e.jsx("div",{className:"bg-white/80 px-2 py-1 rounded-full text-xs backdrop-blur-sm border border-blue-100",children:" Sales Machine"}),c.actual>=b&&e.jsx("div",{className:"bg-gradient-to-r from-green-100 to-emerald-100 px-2 py-1 rounded-full text-xs font-bold border border-green-200",children:" Monthly Goal Achieved!"})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 text-right mt-4",children:[e.jsx(Bt,{className:"h-3 w-3 inline mr-1"}),"Data updated: ",new Date().toLocaleString()]})]})})]})},os=[{id:"D5421",stockNumber:"A7831",lastName:"Johnson",frontGross:1200,backEndGross:700,date:"2023-06-10",isNew:!0},{id:"D5398",stockNumber:"B2241",lastName:"Martinez",frontGross:800,backEndGross:900,date:"2023-06-08",isNew:!1},{id:"D5376",stockNumber:"C5532",lastName:"Williams",frontGross:0,backEndGross:500,date:"2023-06-05",isNew:!1},{id:"D5342",stockNumber:"A1277",lastName:"Garcia",frontGross:1500,backEndGross:800,date:"2023-06-01",isNew:!1},{id:"D5321",stockNumber:"B8773",lastName:"Miller",frontGross:950,backEndGross:600,date:"2023-05-29",isNew:!1},{id:"D5310",stockNumber:"C9912",lastName:"Davis",frontGross:0,backEndGross:450,date:"2023-05-27",isNew:!1},{id:"D5298",stockNumber:"A5523",lastName:"Rodriguez",frontGross:1300,backEndGross:750,date:"2023-05-25",isNew:!1}],za=[{emoji:"",name:"Compact",threshold:0},{emoji:"",name:"Sedan",threshold:20},{emoji:"",name:"SUV",threshold:40},{emoji:"",name:"Sports Car",threshold:60},{emoji:"",name:"Premium",threshold:80},{emoji:"",name:"Supercar",threshold:95}],Lw=[{day:"Monday",date:"12",shift:"Off",team:""},{day:"Tuesday",date:"13",shift:"10am - 7pm",team:"Team A"},{day:"Wednesday",date:"14",shift:"9am - 6pm",team:"Team A"},{day:"Thursday",date:"15",shift:"12pm - 9pm",team:"Team A"},{day:"Friday",date:"16",shift:"9am - 6pm",team:"Team B"},{day:"Saturday",date:"17",shift:"9am - 8pm",team:"Team B"},{day:"Sunday",date:"18",shift:"Off",team:""}],qt={frontEndGrossPercent:25,backEndGrossPercent:5,spiffs:350,bonusThreshold:12,bonusAmount:500},Nf=()=>{var L;const{user:t,role:s,dealershipId:r}=et(),[n,a]=l.useState(!0),[o,i]=l.useState(!0),[c,d]=l.useState(60),[m,h]=l.useState("this-month"),u=T=>{for(let A=za.length-1;A>=0;A--)if(T>=za[A].threshold)return za[A];return za[0]},f=()=>{const T=new Date().getDate(),A=new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),Y=Math.round(T/A*15),te=os.length;return te<Y-2?"red":te<Y?"yellow":"green"},b=os.reduce((T,A)=>T+A.frontGross,0),p=os.reduce((T,A)=>T+A.backEndGross,0),x=b+p,v=os.filter(T=>T.frontGross===0).length;u(c);const y=f(),j=b*(qt.frontEndGrossPercent/100)+p*(qt.backEndGrossPercent/100)+qt.spiffs,N=new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),g=new Date().getDate(),w=N/g,S=j*w,P=os.length*w,E=S+(P>=qt.bonusThreshold?qt.bonusAmount:0),D=T=>{const A=new Date,Y=A.toLocaleString("default",{month:"long"}),te=A.getFullYear();switch(T){case"this-month":return`${Y} ${te}`;case"last-month":const xe=A.getMonth()===0?"December":new Date(A.getFullYear(),A.getMonth()-1,1).toLocaleString("default",{month:"long"}),le=A.getMonth()===0?A.getFullYear()-1:A.getFullYear();return`${xe} ${le}`;case"last-quarter":const Q=Math.floor(A.getMonth()/3);return`Q${Q===0?4:Q} ${Q===0?te-1:te}`;case"ytd":return`Year to Date ${te}`;case"last-year":return`${te-1}`;default:return`${Y} ${te}`}},G=T=>{h(T.target.value)};l.useEffect(()=>(console.log("[SalesDashboard] Rendering sales dashboard",{userId:t==null?void 0:t.id,role:s,dealershipId:r,timestamp:new Date().toISOString()}),()=>{console.log("[SalesDashboard] Unmounting sales dashboard")}),[t,s,r]);const se=T=>{const A=new Date().getDay();return{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6}[T]===A};return e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sales Dashboard"}),e.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-md text-center flex-1 mx-8 border border-blue-100",children:e.jsxs("p",{className:"text-xs italic text-blue-800 truncate",children:[e.jsx(No,{className:"h-3 w-3 inline-block mr-1"}),e.jsx("strong",{children:"Daily Tip:"})," ",["Listen twice as much as you talk. You have two ears and one mouth for a reason.","The first 5 minutes with a customer sets the tone for the entire deal.","Be the expert they can trust, not just the salesperson they deal with.","Follow up with past customers - they're your best source of referrals.","Know your inventory better than anyone else on the floor.","Sell the experience and lifestyle, not just the vehicle.","Always ask for referrals - it's the easiest way to grow your business."][new Date().getDay()]]})})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:D(m)}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bt,{className:"h-5 w-5 text-gray-500 mr-1"}),e.jsxs("select",{value:m,onChange:G,className:"p-2 border rounded-md shadow-sm",children:[e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"last-quarter",children:"Last Quarter"}),e.jsx("option",{value:"ytd",children:"Year to Date"}),e.jsx("option",{value:"last-year",children:"Last Year"})]})]}),e.jsx("p",{className:"text-gray-500",children:"Sales Performance"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-2",children:e.jsx(Ur,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:((L=t==null?void 0:t.email)==null?void 0:L.split("@")[0])||"Sales Associate"}),e.jsx("div",{className:"text-xs text-gray-500",children:s||"Salesperson"})]})]})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[e.jsxs(B,{className:"border-l-4 border-l-blue-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(g0,{className:"mr-2 h-4 w-4 text-blue-500"}),"Total Deals This Month"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:os.length}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center mt-1",children:[e.jsx(Ut,{className:"h-3 w-3 mr-1"}),"8% from last month"]})]})]}),e.jsxs(B,{className:"border-l-4 border-l-green-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(ms,{className:"mr-2 h-4 w-4 text-green-500"}),"Gross"]})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",x.toLocaleString()]}),e.jsxs("div",{className:"flex flex-col text-xs mt-1",children:[n&&e.jsxs("span",{className:"text-green-600",children:["Front: $",b.toLocaleString()]}),o&&e.jsxs("span",{className:"text-blue-600",children:["Back: $",p.toLocaleString()]})]})]})]}),e.jsxs(B,{className:"border-l-4 border-l-amber-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(xn,{className:"mr-2 h-4 w-4 text-amber-500"}),"Minis"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:v}),e.jsx("p",{className:"text-xs text-amber-600 flex items-center mt-1",children:v>2?e.jsxs(e.Fragment,{children:[e.jsx(Ut,{className:"h-3 w-3 mr-1"}),"Focus on higher gross deals"]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"Good job keeping minis low"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-purple-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Or,{className:"mr-2 h-4 w-4 text-purple-500"}),"Monthly Goal Progress"]})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[c,"%"]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 mt-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${c}%`,background:`linear-gradient(90deg, #4338ca, #3b82f6 ${c}%)`}})})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"py-2 px-4 border-b",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(wo,{className:"mr-2 h-4 w-4 text-indigo-500"}),"Schedule"]})}),e.jsxs(V,{className:"py-2 px-0 relative",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 h-full",children:e.jsx(Ws,{className:"h-4 w-4"})}),e.jsx("div",{className:"grid grid-cols-7 text-center px-6",children:Lw.map((T,A)=>e.jsxs("div",{className:`p-1 ${se(T.day)?"bg-blue-50 border-b-2 border-blue-500":""}`,children:[e.jsxs("div",{className:"font-medium text-xs text-gray-800",children:[T.day.substring(0,3)," ",e.jsx("span",{className:"text-gray-500",children:T.date})]}),e.jsx("div",{className:`mt-1 text-xs ${T.shift==="Off"?"text-gray-400":"text-gray-800 font-medium"}`,children:T.shift==="Off"?"Off":T.shift.replace("am - ","-").replace("pm","").replace("am","")})]},A))}),e.jsx(I,{variant:"ghost",size:"sm",className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 h-full",children:e.jsx(Nr,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"py-2 px-4 border-b",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(ta,{className:"mr-2 h-4 w-4 text-yellow-500"}),"The Das Board"]})})}),e.jsxs(V,{className:"py-1",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-white border-b py-2 px-1",children:[e.jsx("div",{className:"w-10 text-center bg-gray-600 py-2 rounded-l-md",children:"#"}),e.jsx("div",{className:"w-40 flex-shrink-0 bg-gray-600 py-2 px-2",children:"Salesperson"}),e.jsxs("div",{className:"w-28 text-center bg-purple-600 py-2 flex items-center justify-center cursor-pointer hover:bg-purple-700",children:["PVR ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-center bg-green-600 py-2 flex items-center justify-center cursor-pointer hover:bg-green-700",children:["Total Gross ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-600 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-700",children:["Avg/Mo ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-500 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-600",children:["Last Mo ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-600 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-700",children:["YTD ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-500 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-600",children:["Annual ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-green-600 py-2 flex items-center justify-center cursor-pointer hover:bg-green-700",children:["New ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-amber-600 py-2 flex items-center justify-center cursor-pointer hover:bg-amber-700",children:["Used ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-right bg-indigo-600 py-2 pr-3 flex items-center justify-end cursor-pointer hover:bg-indigo-700 font-semibold rounded-r-md",children:["Current Month ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]})]}),e.jsx("div",{children:[{name:"Michael Scott",units:14,frontGross:18200,backGross:14300,totalGross:32500,avgMonth:12,lastMonth:15,ytd:82,annualPace:144,newUnits:9,usedUnits:5,pvr:2321},{name:"Jim Halpert",units:12,frontGross:16400,backGross:12500,totalGross:28900,avgMonth:10,lastMonth:11,ytd:65,annualPace:120,newUnits:7,usedUnits:5,pvr:2408},{name:"Dwight Schrute",units:11,frontGross:14800,backGross:11600,totalGross:26400,avgMonth:9,lastMonth:10,ytd:58,annualPace:108,newUnits:4,usedUnits:7,pvr:2400},{name:"Pam Beesly",units:9,frontGross:11900,backGross:9800,totalGross:21700,avgMonth:8,lastMonth:7,ytd:48,annualPace:96,newUnits:5,usedUnits:4,pvr:2411},{name:"Stanley Hudson",units:8,frontGross:10500,backGross:8700,totalGross:19200,avgMonth:7,lastMonth:9,ytd:42,annualPace:84,newUnits:3,usedUnits:5,pvr:2400}].map((T,A)=>e.jsxs("div",{className:`flex items-center py-2 px-1 ${A!==4?"border-b":""} border-gray-100 text-sm hover:bg-gray-50`,children:[e.jsx("div",{className:"w-10 flex justify-center",children:e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center
                      ${A===0?"bg-yellow-100 text-yellow-600":A===1?"bg-gray-100 text-gray-600":A===2?"bg-amber-100 text-amber-600":"bg-blue-50 text-blue-500"}`,children:e.jsx("span",{className:"text-xs font-bold",children:A+1})})}),e.jsx("div",{className:"w-40 flex-shrink-0 font-medium truncate px-2",children:T.name}),e.jsxs("div",{className:"w-28 text-center bg-purple-50",children:["$",T.pvr]}),e.jsxs("div",{className:"w-36 text-center bg-green-50",children:["$",T.totalGross.toLocaleString()]}),e.jsx("div",{className:"w-28 text-center bg-blue-50",children:T.avgMonth}),e.jsx("div",{className:"w-28 text-center",children:T.lastMonth}),e.jsx("div",{className:"w-28 text-center bg-blue-50",children:T.ytd}),e.jsx("div",{className:"w-28 text-center",children:T.annualPace}),e.jsx("div",{className:"w-24 text-center bg-green-50",children:T.newUnits}),e.jsx("div",{className:"w-24 text-center bg-amber-50",children:T.usedUnits}),e.jsx("div",{className:"w-36 text-right pr-3",children:e.jsx("span",{className:"text-lg font-bold text-indigo-700",children:T.units})})]},A))}),e.jsx("div",{className:"mt-2 pt-2 text-center",children:e.jsx(I,{variant:"ghost",size:"sm",className:"text-xs text-blue-600",children:"View All Salespeople"})})]})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(B,{className:"flex-grow border hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"pb-2 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(z,{className:"text-lg font-medium flex items-center",children:[e.jsx(Sr,{className:"mr-2 h-5 w-5 text-blue-500"}),"My Deals"]}),e.jsx("div",{className:`h-3 w-3 rounded-full ${y==="green"?"bg-green-500":y==="yellow"?"bg-yellow-500":"bg-red-500"}`})]})}),e.jsxs(V,{className:"pt-4",children:[e.jsx("div",{className:"overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"pb-2 font-medium text-xs text-gray-500",children:"STOCK #"}),e.jsx("th",{className:"pb-2 font-medium text-xs text-gray-500",children:"CUSTOMER"}),e.jsx("th",{className:"pb-2 font-medium text-xs text-gray-500 text-right",children:"FRONT"}),e.jsx("th",{className:"pb-2 font-medium text-xs text-gray-500 text-right",children:"BACK"}),e.jsx("th",{className:"pb-2 font-medium text-xs text-gray-500 text-right",children:"TOTAL"})]})}),e.jsx("tbody",{children:os.map((T,A)=>e.jsxs("tr",{className:`${A!==os.length-1?"border-b":""} ${T.isNew?"bg-blue-50":""}`,children:[e.jsx("td",{className:"py-3 text-sm",children:T.stockNumber}),e.jsx("td",{className:"py-3 text-sm",children:T.lastName}),e.jsxs("td",{className:`py-3 text-sm text-right ${T.frontGross===0?"text-red-500 font-medium":""}`,children:["$",T.frontGross.toLocaleString()]}),e.jsxs("td",{className:"py-3 text-sm text-right",children:["$",T.backEndGross.toLocaleString()]}),e.jsxs("td",{className:"py-3 text-sm font-medium text-right",children:["$",(T.frontGross+T.backEndGross).toLocaleString()]})]},T.id))})]})})}),e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"bg-blue-50 rounded-lg border border-blue-100 p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-700 mb-2",children:"Deal Performance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Front"}),e.jsxs("div",{className:"font-bold text-blue-700",children:["$",Math.round(b/os.length).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Back"}),e.jsxs("div",{className:"font-bold text-blue-700",children:["$",Math.round(p/os.length).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Total"}),e.jsxs("div",{className:"font-bold text-blue-700",children:["$",Math.round(x/os.length).toLocaleString()]})]})]})]})})]}),e.jsx($t,{className:"border-t px-6 py-3",children:e.jsxs(I,{variant:"ghost",size:"sm",className:"ml-auto flex items-center text-blue-600 text-sm",children:["View All Deals",e.jsx(gu,{className:"ml-1 h-4 w-4"})]})})]}),e.jsxs("div",{className:"flex flex-col gap-6 h-full",children:[e.jsx(Fw,{}),e.jsxs(B,{className:"border hover:shadow-md transition-shadow overflow-hidden bg-white z-10 relative",children:[e.jsx(W,{className:"pb-2 border-b bg-gradient-to-r from-green-400 to-teal-500",children:e.jsxs(z,{className:"text-lg font-medium flex items-center text-white",children:[e.jsx(jo,{className:"mr-2 h-5 w-5 text-white"}),"Pay Calculator"]})}),e.jsxs(V,{className:"pt-4 bg-white",children:[e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["$",Math.round(j).toLocaleString()]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Month-to-Date Earnings"})]})}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:["Front End (",qt.frontEndGrossPercent,"%)"]}),e.jsxs("span",{className:"text-xs font-medium",children:["$",Math.round(b*(qt.frontEndGrossPercent/100)).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:["Back End (",qt.backEndGrossPercent,"%)"]}),e.jsxs("span",{className:"text-xs font-medium",children:["$",Math.round(p*(qt.backEndGrossPercent/100)).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Spiffs & Bonuses"}),e.jsxs("span",{className:"text-xs font-medium",children:["$",qt.spiffs.toLocaleString()]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Potential Monthly Total"}),e.jsxs("span",{className:"text-xs font-bold text-green-600",children:["$",Math.round(E).toLocaleString()]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:P>=qt.bonusThreshold&&e.jsxs("div",{className:"text-green-600 mt-1 font-medium text-xs",children:["Includes $",qt.bonusAmount," volume bonus!"]})})]})]}),e.jsx("div",{className:"mt-3 pt-2 border-t",children:e.jsxs("p",{className:"text-[10px] text-gray-400 italic",children:[e.jsx("strong",{children:"Disclaimer:"})," These figures are estimates only and not actual earnings. Final compensation may vary based on dealership policies and deal structures."]})})]})]})]})]})]})},Ow=[{day:"Monday",date:"12",shift:"Off",team:""},{day:"Tuesday",date:"13",shift:"9am - 6pm",team:"Team A"},{day:"Wednesday",date:"14",shift:"10am - 7pm",team:"Team A"},{day:"Thursday",date:"15",shift:"9am - 6pm",team:"Team A"},{day:"Friday",date:"16",shift:"11am - 8pm",team:"Team B"},{day:"Saturday",date:"17",shift:"9am - 5pm",team:"Team B"},{day:"Sunday",date:"18",shift:"Off",team:""}],Uw=()=>{const[t,s]=l.useState([]),[r,n]=l.useState([]),[a,o]=l.useState("this-month"),[i,c]=l.useState({start:"",end:""}),[d,m]=l.useState(!1),[h,u]=l.useState([]),[f,b]=l.useState({mtdRevenue:0,dealsProcessed:0,productsPerDeal:0,pvr:0,productMix:{extendedWarranty:0,gapInsurance:0,paintProtection:0,tireWheel:0,ppm:0,other:0}}),p=g=>{const w=new Date;let S=new Date,P=new Date;switch(g){case"this-month":S=new Date(w.getFullYear(),w.getMonth(),1),P=w;break;case"last-month":S=new Date(w.getFullYear(),w.getMonth()-1,1),P=new Date(w.getFullYear(),w.getMonth(),0);break;case"last-quarter":const E=Math.floor(w.getMonth()/3);S=new Date(w.getFullYear(),E*3-3,1),P=new Date(w.getFullYear(),E*3,0);break;case"ytd":S=new Date(w.getFullYear(),0,1),P=w;break;case"last-year":S=new Date(w.getFullYear()-1,0,1),P=new Date(w.getFullYear()-1,11,31);break;case"custom":i.start&&i.end&&(S=new Date(i.start),P=new Date(i.end));break}return{startDate:S,endDate:P}},x=g=>{const{name:w,value:S}=g.target;c(P=>({...P,[w]:S}))},v=()=>{i.start&&i.end&&y()};l.useEffect(()=>{try{const g=localStorage.getItem("financeDeals");if(g){const w=JSON.parse(g);s(w);const S=w.filter(P=>P.status==="Pending"||P.status==="Bank Approval"||P.status==="Pending Documents"||P.status==="Contract Review"||P.status==="Insurance Verification");n(S)}}catch(g){console.error("Error loading deals from localStorage:",g)}},[]),l.useEffect(()=>{y()},[t,a,i]);const y=()=>{if(!t.length)return;const{startDate:g,endDate:w}=p(a),S=t.filter(P=>{const E=new Date(P.saleDate);return E>=g&&E<=w});u(S),j(S)},j=g=>{const w=g.reduce((Q,pe)=>Q+pe.profit,0),S=g.length,P=g.reduce((Q,pe)=>Q+pe.products.length,0),E=S>0?P/S:0,D=S>0?w/S:0;let G=0,se=0,L=0,T=0,A=0,Y=0;g.forEach(Q=>{Q.products.forEach(pe=>{pe==="Extended Warranty"||pe==="Vehicle Service Contract (VSC)"?G++:pe==="GAP Insurance"?se++:pe==="Paint Protection"||pe==="Paint and Fabric Protection"?L++:pe==="Tire & Wheel"||pe==="Tire & Wheel Bundle"?T++:pe==="PPM"||pe==="PrePaid Maintenance (PPM)"?A++:Y++})});const te=G+se+L+T+A+Y,xe=Q=>te>0?Math.round(Q/te*100):0,le={extendedWarranty:xe(G),gapInsurance:xe(se),paintProtection:xe(L),tireWheel:xe(T),ppm:xe(A),other:xe(Y)};b({mtdRevenue:w,dealsProcessed:S,productsPerDeal:E,pvr:D,productMix:le})},N=g=>{const w=new Date().getDay();return{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6}[g]===w};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{})}),e.jsx("div",{className:"flex flex-col md:flex-row gap-3",children:d&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",name:"start",value:i.start,onChange:x,className:"p-2 border rounded-md shadow-sm"}),e.jsx("span",{children:"to"}),e.jsx("input",{type:"date",name:"end",value:i.end,onChange:x,className:"p-2 border rounded-md shadow-sm"}),e.jsx(I,{size:"sm",onClick:v,children:"Apply"})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(B,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(ms,{className:"mr-2 h-4 w-4 text-green-500"}),"F&I Gross"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.mtdRevenue>0?`$${f.mtdRevenue.toLocaleString()}`:"No data yet"}),f.mtdRevenue>0&&e.jsxs("div",{className:"flex items-center pt-1 text-green-500",children:[e.jsx(Ut,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"8.2% from previous period"})]})]})]}),e.jsxs(B,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(fl,{className:"mr-2 h-4 w-4 text-blue-500"}),"Deals Processed"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.dealsProcessed>0?f.dealsProcessed:"No deals yet"}),f.dealsProcessed>0&&e.jsxs("div",{className:"flex items-center pt-1 text-green-500",children:[e.jsx(Ut,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"10.5% from previous period"})]})]})]}),e.jsxs(B,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Za,{className:"mr-2 h-4 w-4 text-purple-500"}),"Pay Calculator MTD"]})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",Math.round(f.mtdRevenue*.15).toLocaleString()]}),f.dealsProcessed>0&&e.jsxs("div",{className:"flex items-center pt-1 text-green-500",children:[e.jsx(Ut,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"15% of F&I revenue"})]})]})]}),e.jsxs(B,{className:"border-l-4 border-l-amber-500 hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(wu,{className:"mr-2 h-4 w-4 text-amber-500"}),"PVR"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.dealsProcessed>0?`$${f.pvr.toLocaleString()}`:"No data yet"}),f.dealsProcessed>0&&e.jsxs("div",{className:"flex items-center pt-1 text-green-500",children:[e.jsx(Ut,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:"$120 from previous period"})]})]})]})]}),e.jsx("div",{children:e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"py-2 px-4 border-b",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(wo,{className:"mr-2 h-4 w-4 text-indigo-500"}),"Finance Schedule"]})}),e.jsxs(V,{className:"py-2 px-0 relative",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 h-full",children:e.jsx(Ws,{className:"h-4 w-4"})}),e.jsx("div",{className:"grid grid-cols-7 text-center px-6",children:Ow.map((g,w)=>e.jsxs("div",{className:`p-1 ${N(g.day)?"bg-blue-50 border-b-2 border-blue-500":""}`,children:[e.jsxs("div",{className:"font-medium text-xs text-gray-800",children:[g.day.substring(0,3)," ",e.jsx("span",{className:"text-gray-500",children:g.date})]}),e.jsx("div",{className:`mt-1 text-xs ${g.shift==="Off"?"text-gray-400":"text-gray-800 font-medium"}`,children:g.shift==="Off"?"Off":g.shift.replace("am - ","-").replace("pm","").replace("am","")})]},w))}),e.jsx(I,{variant:"ghost",size:"sm",className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 h-full",children:e.jsx(Nr,{className:"h-4 w-4"})})]})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center text-lg font-medium",children:[e.jsx(Za,{className:"mr-2 h-5 w-5 text-blue-500"}),"F&I Product Mix & Avg. Profit"]})}),e.jsx(V,{children:f.dealsProcessed>0?e.jsxs("div",{className:"space-y-2",children:[[{name:"Vehicle Service Contract (VSC)",percent:f.productMix.extendedWarranty,value:`$${Math.round(f.mtdRevenue*f.productMix.extendedWarranty/100/Math.max(1,t.filter(g=>g.products.includes("Extended Warranty")||g.products.includes("Vehicle Service Contract (VSC)")).length)).toLocaleString()}`,color:"bg-teal-600"},{name:"PrePaid Maintenance (PPM)",percent:f.productMix.ppm,value:`$${Math.round(f.mtdRevenue*f.productMix.ppm/100/Math.max(1,t.filter(g=>g.products.includes("PPM")||g.products.includes("PrePaid Maintenance (PPM)")).length)).toLocaleString()}`,color:"bg-purple-600"},{name:"GAP Insurance",percent:f.productMix.gapInsurance,value:`$${Math.round(f.mtdRevenue*f.productMix.gapInsurance/100/Math.max(1,t.filter(g=>g.products.includes("GAP Insurance")).length)).toLocaleString()}`,color:"bg-green-600"},{name:"Paint and Fabric Protection",percent:f.productMix.paintProtection,value:`$${Math.round(f.mtdRevenue*f.productMix.paintProtection/100/Math.max(1,t.filter(g=>g.products.includes("Paint Protection")||g.products.includes("Paint and Fabric Protection")).length)).toLocaleString()}`,color:"bg-blue-600"},{name:"Tire & Wheel Bundle",percent:f.productMix.tireWheel,value:`$${Math.round(f.mtdRevenue*f.productMix.tireWheel/100/Math.max(1,t.filter(g=>g.products.includes("Tire & Wheel")||g.products.includes("Tire & Wheel Bundle")).length)).toLocaleString()}`,color:"bg-amber-600"},{name:"Other Products",percent:f.productMix.other,value:`$${Math.round(f.mtdRevenue*f.productMix.other/100/Math.max(1,t.filter(g=>!g.products.some(w=>w==="Extended Warranty"||w==="Vehicle Service Contract (VSC)"||w==="GAP Insurance"||w==="Paint Protection"||w==="Paint and Fabric Protection"||w==="Tire & Wheel"||w==="Tire & Wheel Bundle"||w==="PPM"||w==="PrePaid Maintenance (PPM)")).length)).toLocaleString()}`,color:"bg-gray-600"}].map((g,w)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium flex items-center text-sm",children:[e.jsx("div",{className:`w-3 h-3 ${g.color} rounded-full mr-2`}),g.name]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg. Profit"}),e.jsx("div",{className:"font-medium text-sm",children:g.value})]})]}),e.jsx("div",{className:"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full ${g.color}`,style:{width:`${g.percent}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-500",children:[g.percent,"%"]})]},w)),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-sm",children:"Products Per Deal (PPD)"}),e.jsx("div",{className:"font-bold text-lg text-purple-600",children:f.productsPerDeal.toFixed(1)})]})})]}):e.jsx("div",{className:"py-8 text-center text-gray-500",children:"No F&I product data available yet. Log deals with products to see the mix."})})]}),e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"py-2 px-4 border-b",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(ta,{className:"mr-2 h-4 w-4 text-yellow-500"}),"Finance Das Board"]})})}),e.jsxs(V,{className:"py-1",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-white border-b py-2 px-1",children:[e.jsx("div",{className:"w-10 text-center bg-gray-600 py-2 rounded-l-md",children:"#"}),e.jsx("div",{className:"w-36 flex-shrink-0 bg-gray-600 py-2 px-2",children:"F&I Manager"}),e.jsxs("div",{className:"w-28 text-center bg-purple-600 py-2 flex items-center justify-center cursor-pointer hover:bg-purple-700",children:["PVR ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-teal-600 py-2 flex items-center justify-center cursor-pointer hover:bg-teal-700",children:["VSC % ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-green-600 py-2 flex items-center justify-center cursor-pointer hover:bg-green-700",children:["GAP % ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-purple-600 py-2 flex items-center justify-center cursor-pointer hover:bg-purple-700",children:["PPM % ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-pink-600 py-2 flex items-center justify-center cursor-pointer hover:bg-pink-700",children:["PPD ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-right bg-indigo-600 py-2 pr-3 flex items-center justify-end cursor-pointer hover:bg-indigo-700 font-semibold rounded-r-md",children:["Profit ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]})]}),e.jsx("div",{children:[{name:"Ashley Rodriguez",pvr:2650,vscPen:68,gapPen:72,ppmPen:54,ppd:3.2,profit:143200},{name:"Michael Parker",pvr:2450,vscPen:65,gapPen:70,ppmPen:48,ppd:2.9,profit:127500},{name:"Sophia Martinez",pvr:2320,vscPen:61,gapPen:68,ppmPen:45,ppd:2.7,profit:115300},{name:"James Wilson",pvr:2200,vscPen:58,gapPen:65,ppmPen:42,ppd:2.5,profit:96500},{name:"Emma Johnson",pvr:2100,vscPen:55,gapPen:62,ppmPen:38,ppd:2.4,profit:89200}].map((g,w)=>e.jsxs("div",{className:`flex items-center py-2 px-1 ${w!==4?"border-b":""} border-gray-100 text-sm hover:bg-gray-50`,children:[e.jsx("div",{className:"w-10 flex justify-center",children:e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center
                        ${w===0?"bg-yellow-100 text-yellow-600":w===1?"bg-gray-100 text-gray-600":w===2?"bg-amber-100 text-amber-600":"bg-blue-50 text-blue-500"}`,children:e.jsx("span",{className:"text-xs font-bold",children:w+1})})}),e.jsx("div",{className:"w-36 flex-shrink-0 font-medium truncate px-2",children:g.name}),e.jsxs("div",{className:"w-28 text-center bg-purple-50",children:["$",g.pvr.toLocaleString()]}),e.jsxs("div",{className:"w-28 text-center bg-teal-50",children:[g.vscPen,"%"]}),e.jsxs("div",{className:"w-28 text-center bg-green-50",children:[g.gapPen,"%"]}),e.jsxs("div",{className:"w-28 text-center bg-purple-50",children:[g.ppmPen,"%"]}),e.jsx("div",{className:"w-24 text-center bg-pink-50",children:g.ppd}),e.jsx("div",{className:"w-36 text-right pr-3",children:e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",g.profit.toLocaleString()]})})]},w))})]})]})]}),e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2 border-b",children:[e.jsxs(z,{className:"text-lg font-medium flex items-center",children:[e.jsx(Sr,{className:"mr-2 h-5 w-5 text-blue-500"}),"Deals Log"]}),e.jsx(I,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(us,{to:"/dashboard/finance/deals",children:"View All"})})]}),e.jsx(V,{className:"pt-4 px-0",children:t.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs",children:[e.jsx("th",{className:"font-medium text-white py-2 pl-3 text-center bg-gray-600 w-12",children:"#"}),e.jsx("th",{className:"font-medium text-white py-2 pl-4 pr-2 text-left bg-blue-600",children:"Deal #"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-left bg-gray-600",children:"Stock #"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-left bg-gray-600",children:"Last Name"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-gray-600",children:"Date"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-indigo-600",children:"N/U/CPO"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-teal-600",children:"VSC"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-purple-600",children:"PPM"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-green-600",children:"GAP"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-amber-600",children:"T&W/Bundle"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-pink-600",children:"PPD"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-purple-600",children:"PVR"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-green-600",children:"Total"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-gray-600 rounded-tr-md w-20",children:"Status"})]})}),e.jsx("tbody",{children:t.slice(0,5).map((g,w)=>{const S=g.customer.split(" ").pop()||"",E=new Date(g.saleDate).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}),D=g.vehicle.toLowerCase().includes("new")?"N":g.vehicle.toLowerCase().includes("cpo")?"C":"U",G=g.products.includes("Extended Warranty")||g.products.includes("Vehicle Service Contract (VSC)")?Math.round(g.profit*.35):0,se=g.products.includes("Paint Protection")||g.products.includes("Paint and Fabric Protection")||g.products.includes("PPM")||g.products.includes("PrePaid Maintenance (PPM)")?Math.round(g.profit*.2):0,L=g.products.includes("GAP Insurance")?Math.round(g.profit*.25):0,T=g.products.includes("Tire & Wheel")||g.products.includes("Tire & Wheel Bundle")?Math.round(g.profit*.2):0,A=g.products.length,Y=Math.round(g.profit/(A||1)),te=g.status==="Complete"||g.status==="Funded"?"Funded":g.status==="Canceled"||g.status==="Unwound"?"Unwound":"Pending",xe=te==="Funded"?"bg-green-100 text-green-800 border-green-200":te==="Unwound"?"bg-red-100 text-red-800 border-red-200":"bg-amber-100 text-amber-800 border-amber-200";return e.jsxs("tr",{className:`border-b ${w%2===1?"bg-gray-50":""} hover:bg-blue-50`,children:[e.jsx("td",{className:"py-2 px-2 text-center font-medium",children:t.length-w}),e.jsx("td",{className:"py-2 pl-4 pr-2 text-left font-medium text-blue-600",children:g.id}),e.jsx("td",{className:"py-2 px-2 text-left",children:g.id.replace("D","S")}),e.jsx("td",{className:"py-2 px-2 text-left font-medium",children:S}),e.jsx("td",{className:"py-2 px-2 text-center text-gray-600",children:E}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${D==="N"?"bg-green-100 text-green-800":D==="C"?"bg-blue-100 text-blue-800":"bg-amber-100 text-amber-800"}`,children:D})}),e.jsxs("td",{className:"py-2 px-2 text-right bg-teal-50",children:["$",G.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",se.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-green-50",children:["$",L.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-amber-50",children:["$",T.toLocaleString()]}),e.jsx("td",{className:"py-2 px-2 text-center bg-pink-50 font-medium",children:A}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",Y.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right font-medium text-green-600",children:["$",g.profit.toLocaleString()]}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${xe}`,children:te})})]},g.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-100 border-t border-t-gray-200 font-medium",children:[e.jsx("td",{colSpan:6,className:"py-2 pl-4 text-left",children:"TOTALS"}),e.jsxs("td",{className:"py-2 px-2 text-right bg-teal-50",children:["$",t.slice(0,5).reduce((g,w)=>g+(w.products.includes("Extended Warranty")||w.products.includes("Vehicle Service Contract (VSC)")?Math.round(w.profit*.35):0),0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",t.slice(0,5).reduce((g,w)=>g+(w.products.includes("Paint Protection")||w.products.includes("Paint and Fabric Protection")||w.products.includes("PPM")||w.products.includes("PrePaid Maintenance (PPM)")?Math.round(w.profit*.2):0),0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-green-50",children:["$",t.slice(0,5).reduce((g,w)=>g+(w.products.includes("GAP Insurance")?Math.round(w.profit*.25):0),0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-amber-50",children:["$",t.slice(0,5).reduce((g,w)=>g+(w.products.includes("Tire & Wheel")||w.products.includes("Tire & Wheel Bundle")?Math.round(w.profit*.2):0),0).toLocaleString()]}),e.jsx("td",{className:"py-2 px-2 text-center bg-pink-50",children:(t.slice(0,5).reduce((g,w)=>g+w.products.length,0)/Math.max(1,t.slice(0,5).length)).toFixed(1)}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",Math.round(t.slice(0,5).reduce((g,w)=>g+w.profit,0)/Math.max(1,t.slice(0,5).length)).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right font-medium text-green-600",children:["$",t.slice(0,5).reduce((g,w)=>g+w.profit,0).toLocaleString()]}),e.jsx("td",{className:"py-2 px-2"})]})})]})}):e.jsx("div",{className:"py-8 text-center text-gray-500",children:'No deals logged yet. Use the "Log New Deal" button to add deals.'})})]})]})]})},Sf=()=>{const t=yt(),[s,r]=l.useState([]),[n,a]=l.useState(""),[o,i]=l.useState("All"),[c,d]=l.useState("saleDate"),[m,h]=l.useState("desc"),u=()=>{t("/dashboard/finance")};l.useEffect(()=>{try{const x=localStorage.getItem("financeDeals");if(x){const v=JSON.parse(x);r(v)}}catch(x){console.error("Error loading deals from localStorage:",x)}},[]);const f=s.filter(x=>{const v=x.customer.toLowerCase().includes(n.toLowerCase())||x.vehicle.toLowerCase().includes(n.toLowerCase())||x.id.toLowerCase().includes(n.toLowerCase())||x.vin&&x.vin.toLowerCase().includes(n.toLowerCase()),y=o==="All"||x.status===o;return v&&y}).sort((x,v)=>{const y=x[c],j=v[c];return typeof y=="string"&&typeof j=="string"?m==="asc"?y.localeCompare(j):j.localeCompare(y):typeof y=="number"&&typeof j=="number"?m==="asc"?y-j:j-y:0}),b=x=>{c===x?h(m==="asc"?"desc":"asc"):(d(x),h("asc"))},p=x=>{switch(x){case"Complete":return e.jsxs(Ue,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(Li,{className:"w-3 h-3 mr-1"})," ",x]});case"Bank Approval":case"Contract Review":case"Insurance Verification":return e.jsxs(Ue,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:[e.jsx(fr,{className:"w-3 h-3 mr-1"})," ",x]});case"Pending Documents":return e.jsxs(Ue,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(va,{className:"w-3 h-3 mr-1"})," ",x]});default:return e.jsx(Ue,{variant:"outline",children:x})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs("button",{type:"button",onClick:u,className:"mr-4 flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(yo,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Finance Deals"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(gl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(be,{placeholder:"Search deals by customer, vehicle, ID, or VIN",className:"pl-9 border-gray-300",value:n,onChange:x=>a(x.target.value)})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 bg-white border border-gray-200 rounded-md px-2",children:[e.jsx(ju,{size:16,className:"text-gray-500"}),e.jsxs("select",{className:"border-0 rounded p-2 text-sm focus:ring-0 focus:outline-none",value:o,onChange:x=>i(x.target.value),children:[e.jsx("option",{value:"All",children:"All Statuses"}),e.jsx("option",{value:"Bank Approval",children:"Bank Approval"}),e.jsx("option",{value:"Pending Documents",children:"Pending Documents"}),e.jsx("option",{value:"Contract Review",children:"Contract Review"}),e.jsx("option",{value:"Insurance Verification",children:"Insurance Verification"}),e.jsx("option",{value:"Complete",children:"Complete"})]})]})})]}),e.jsx(B,{className:"border hover:shadow-md transition-shadow",children:e.jsx(V,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"py-3 px-4 text-left font-medium",children:e.jsxs("button",{className:"flex items-center",onClick:()=>b("id"),children:["Deal #",c==="id"&&e.jsx(Rt,{size:14,className:"ml-1 text-gray-500"})]})}),e.jsx("th",{className:"py-3 px-4 text-left font-medium",children:e.jsxs("button",{className:"flex items-center",onClick:()=>b("saleDate"),children:["Date",c==="saleDate"&&e.jsx(Rt,{size:14,className:"ml-1 text-gray-500"})]})}),e.jsx("th",{className:"py-3 px-4 text-left font-medium",children:e.jsxs("button",{className:"flex items-center",onClick:()=>b("customer"),children:["Customer",c==="customer"&&e.jsx(Rt,{size:14,className:"ml-1 text-gray-500"})]})}),e.jsx("th",{className:"py-3 px-4 text-left font-medium",children:"Vehicle"}),e.jsx("th",{className:"py-3 px-4 text-left font-medium",children:"Salesperson"}),e.jsx("th",{className:"py-3 px-4 text-right font-medium",children:e.jsxs("button",{className:"flex items-center justify-end ml-auto",onClick:()=>b("amount"),children:["Amount",c==="amount"&&e.jsx(Rt,{size:14,className:"ml-1 text-gray-500"})]})}),e.jsx("th",{className:"py-3 px-4 text-right font-medium",children:e.jsxs("button",{className:"flex items-center justify-end ml-auto",onClick:()=>b("profit"),children:["F&I Profit",c==="profit"&&e.jsx(Rt,{size:14,className:"ml-1 text-gray-500"})]})}),e.jsx("th",{className:"py-3 px-4 text-center font-medium",children:"Status"}),e.jsx("th",{className:"py-3 px-4 text-center font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:f.length>0?f.map(x=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-left font-medium text-blue-600",children:x.id}),e.jsx("td",{className:"py-3 px-4 text-left",children:x.saleDate}),e.jsx("td",{className:"py-3 px-4 text-left font-medium",children:x.customer}),e.jsxs("td",{className:"py-3 px-4 text-left",children:[e.jsx("div",{children:x.vehicle}),e.jsxs("div",{className:"text-xs text-gray-500",children:["VIN: ",x.vin]})]}),e.jsx("td",{className:"py-3 px-4 text-left",children:x.salesperson}),e.jsxs("td",{className:"py-3 px-4 text-right font-medium",children:["$",x.amount.toLocaleString()]}),e.jsxs("td",{className:"py-3 px-4 text-right font-medium text-green-600",children:["$",x.profit.toLocaleString()]}),e.jsx("td",{className:"py-3 px-4 text-center",children:p(x.status)}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsxs(I,{variant:"ghost",size:"sm",className:"bg-blue-50 text-blue-600 hover:bg-blue-100",children:[e.jsx(l0,{size:16,className:"mr-1"}),"Edit"]})})]},x.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"py-10 text-center text-gray-500",children:"No deals match your filter criteria. Try adjusting your filters."})})})]})})})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",f.length," of ",s.length," deals"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",children:"Previous"}),e.jsx(I,{variant:"outline",size:"sm",children:"Next"})]})]})]})},od=[{id:1,customer:"John Smith",vehicle:"2024 Honda Accord",time:"9:00 AM",date:"2024-05-17",status:"Confirmed",type:"Final Document Signing"},{id:2,customer:"Sarah Wilson",vehicle:"2023 Toyota Camry",time:"10:30 AM",date:"2024-05-17",status:"Confirmed",type:"Contract Review"},{id:3,customer:"Michael Brown",vehicle:"2023 Nissan Rogue",time:"1:00 PM",date:"2024-05-17",status:"Pending",type:"Insurance Verification"},{id:4,customer:"Jessica Taylor",vehicle:"2024 Subaru Outback",time:"3:30 PM",date:"2024-05-17",status:"Confirmed",type:"Final Document Signing"},{id:5,customer:"David Anderson",vehicle:"2023 Mazda CX-5",time:"11:00 AM",date:"2024-05-18",status:"Confirmed",type:"Contract Review"},{id:6,customer:"Elizabeth Martin",vehicle:"2024 Jeep Grand Cherokee",time:"2:00 PM",date:"2024-05-18",status:"Pending",type:"Final Document Signing"},{id:7,customer:"Robert Miller",vehicle:"2024 Ford F-150",time:"9:30 AM",date:"2024-05-19",status:"Confirmed",type:"Insurance Verification"},{id:8,customer:"Jennifer Lee",vehicle:"2023 Chevy Equinox",time:"1:30 PM",date:"2024-05-19",status:"Confirmed",type:"Contract Review"}],$w=(t,s)=>{const r=new Date(t,s,1).getDay(),n=new Date(t,s+1,0).getDate(),a=[];for(let o=0;o<r;o++)a.push(null);for(let o=1;o<=n;o++)a.push(o);return a},Gw=()=>{const[t,s]=l.useState(new Date),[r,n]=l.useState(new Date().toISOString().split("T")[0]),a=t.getFullYear(),o=t.getMonth(),i=["January","February","March","April","May","June","July","August","September","October","November","December"],c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d=$w(a,o),m=()=>{s(new Date(a,o-1,1))},h=()=>{s(new Date(a,o+1,1))},u=(p,x,v)=>v===null?"":`${p}-${String(x+1).padStart(2,"0")}-${String(v).padStart(2,"0")}`,f=od.filter(p=>p.date===r).sort((p,x)=>{const v=new Date(`1970/01/01 ${p.time}`).getTime(),y=new Date(`1970/01/01 ${x.time}`).getTime();return v-y}),b=od.reduce((p,x)=>{const v=x.date;return p[v]||(p[v]=0),p[v]++,p},{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Finance Schedule"}),e.jsxs(I,{children:[e.jsx(Vs,{className:"mr-2 h-4 w-4"}),"New Appointment"]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-7 lg:grid-cols-12",children:[e.jsx("div",{className:"md:col-span-3 lg:col-span-4",children:e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(I,{variant:"ghost",onClick:m,children:e.jsx(Ws,{className:"h-4 w-4"})}),e.jsxs(z,{children:[i[o]," ",a]}),e.jsx(I,{variant:"ghost",onClick:h,children:e.jsx(Nr,{className:"h-4 w-4"})})]})}),e.jsxs(V,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center mb-2",children:c.map(p=>e.jsx("div",{className:"text-xs font-medium text-gray-500",children:p},p))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:d.map((p,x)=>{const v=p?u(a,o,p):"",y=v===new Date().toISOString().split("T")[0],j=v===r,N=v&&b[v]||0;return e.jsx("div",{onClick:()=>p&&n(u(a,o,p)),className:`
                        h-12 flex flex-col items-center justify-center rounded-md cursor-pointer text-sm
                        ${y?"border border-blue-500":""}
                        ${j?"bg-blue-100":p?"hover:bg-gray-100":""}
                        ${p?"":"text-gray-300"}
                      `,children:p&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:p}),N>0&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-blue-500 text-white rounded-full mt-1",children:N})]})},x)})})]})]})}),e.jsx("div",{className:"md:col-span-4 lg:col-span-8",children:e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs(z,{children:["Appointments for"," ",new Date(r).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})})}),e.jsx(V,{children:f.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Bt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No appointments scheduled for this day."}),e.jsxs(I,{className:"mt-4",variant:"outline",size:"sm",children:[e.jsx(Vs,{className:"mr-2 h-4 w-4"}),"Add Appointment"]})]}):e.jsx("div",{className:"space-y-4",children:f.map(p=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:p.customer}),e.jsx("p",{className:"text-sm text-gray-500",children:p.vehicle}),e.jsxs("div",{className:"flex items-center mt-2 text-sm text-gray-500",children:[e.jsx(fr,{className:"h-4 w-4 mr-1"}),p.time,e.jsx("span",{className:"mx-2",children:""}),e.jsx(Ue,{variant:p.status==="Confirmed"?"default":"outline",children:p.status}),e.jsx("span",{className:"mx-2",children:""}),p.type]})]}),e.jsx("div",{className:"flex",children:e.jsx(I,{variant:"ghost",size:"sm",children:"Edit"})})]})},p.id))})})]})})]})]})},Bw=["Ally Bank","American Credit Acceptance","Americredit","Bank of America","Capital One","Chase","Chrysler Capital","Crescent Bank","Exeter","First Help Financial","Ford Motor Credit","Global Lending Services","Huntington National Bank","Hyundai Financial","Navy Federal","Other","PNC Bank","Prestige Financial Services","Regional Acceptance","Santander","Stellantis","TD Auto","Tesla","Toyota Credit","Truist","US Bank","USAA","Wells Fargo","Westlake Financial Services"],Vw=["Finance","Lease","Cash"],Ww=["Pending","Funded","Unwound","Dead Deal"],zw=[{value:"N",label:"New"},{value:"U",label:"Used"},{value:"C",label:"CPO"}],sr=[{id:1,initials:"JD",firstName:"John",lastName:"Doe"},{id:2,initials:"TS",firstName:"Thomas",lastName:"Smith"},{id:3,initials:"MR",firstName:"Maria",lastName:"Rodriguez"},{id:4,initials:"AK",firstName:"Anna",lastName:"Kim"},{id:5,initials:"BH",firstName:"Brandon",lastName:"Harris"}],nn=({dashboardType:t="finance"})=>{const s=yt(),[r,n]=l.useState({dealNumber:"",stockNumber:"",vinLast8:"",vehicleType:"N",lastName:"",dealType:"",frontEndGross:"",vscProfit:"",ppmProfit:"",gapProfit:"",tireAndWheelProfit:"",appearanceProfit:"",otherProfit:"",reserveFlat:"",backEndGross:"",totalGross:"",lender:"",salespersonId:"",salesManagerId:"",isSplitDeal:!1,secondSalespersonId:"",dealStatus:"Pending",outsideFunding:!1,dealDate:new Date().toISOString().split("T")[0]}),a=()=>{s(t==="single-finance"?"/dashboard/single-finance":"/dashboard/finance")},o=d=>{const{name:m,value:h,type:u}=d.target;if(u==="checkbox"){n(f=>({...f,[m]:d.target.checked}));return}if(m==="stockNumber"||m==="vinLast8"){n(f=>({...f,[m]:h.toUpperCase()}));return}n(m==="dealType"&&h==="Cash"?f=>({...f,[m]:h,lender:""}):f=>({...f,[m]:h}))};l.useEffect(()=>{const d=()=>{const h=parseFloat(r.vscProfit)||0,u=parseFloat(r.ppmProfit)||0,f=parseFloat(r.gapProfit)||0,b=parseFloat(r.tireAndWheelProfit)||0,p=parseFloat(r.appearanceProfit)||0,x=parseFloat(r.otherProfit)||0,v=parseFloat(r.reserveFlat)||0;return(h+u+f+b+p+x+v).toFixed(2)},m=()=>{const h=parseFloat(r.frontEndGross)||0,u=parseFloat(d())||0;return(h+u).toFixed(2)};n(h=>({...h,backEndGross:d(),totalGross:m()}))},[r.vscProfit,r.ppmProfit,r.gapProfit,r.tireAndWheelProfit,r.appearanceProfit,r.otherProfit,r.reserveFlat,r.frontEndGross]);const i=d=>{d.preventDefault(),console.log("Form submitted:",r);const m=`D${Math.floor(1e3+Math.random()*9e3)}`,h=r.dealDate||new Date().toISOString().split("T")[0],u=sr.find(N=>N.id.toString()===r.salespersonId),f=u?u.initials:"";let b="";if(r.isSplitDeal&&r.secondSalespersonId){const N=sr.find(g=>g.id.toString()===r.secondSalespersonId);b=N?N.initials:""}const p=r.isSplitDeal&&b?`${f}/${b} (Split)`:f,x=parseFloat(r.backEndGross)||0,v=parseFloat(r.frontEndGross)||0;parseFloat(r.totalGross);const y=[];parseFloat(r.vscProfit)>0&&y.push("Extended Warranty"),parseFloat(r.gapProfit)>0&&y.push("GAP Insurance"),parseFloat(r.appearanceProfit)>0&&y.push("Paint and Fabric Protection"),parseFloat(r.tireAndWheelProfit)>0&&y.push("Tire & Wheel"),parseFloat(r.ppmProfit)>0&&y.push("PPM"),parseFloat(r.otherProfit)>0&&y.push("Other");const j={id:m,customer:r.lastName,vehicle:`${r.vehicleType==="N"?"New":r.vehicleType==="U"?"Used":"CPO"} - Stock #${r.stockNumber}`,vin:r.vinLast8,saleDate:h,salesperson:p,isSplitDeal:r.isSplitDeal,primarySalespersonId:r.salespersonId,secondarySalespersonId:r.isSplitDeal?r.secondSalespersonId:null,amount:v+x,status:r.dealStatus,products:y,profit:x,created_at:new Date().toISOString()};try{const N=localStorage.getItem("financeDeals"),g=N?JSON.parse(N):[],w=[j,...g];localStorage.setItem("financeDeals",JSON.stringify(w)),alert(`Deal ${m} successfully logged!`),s(t==="single-finance"?"/dashboard/single-finance":"/dashboard/finance")}catch(N){console.error("Error saving deal to localStorage:",N),alert("Failed to save deal. Please try again.")}},c=()=>{if(!r.salespersonId)return"";const d=sr.find(h=>h.id.toString()===r.salespersonId),m=d?d.initials:"";if(r.isSplitDeal&&r.secondSalespersonId){const h=sr.find(f=>f.id.toString()===r.secondSalespersonId),u=h?h.initials:"";return u?`${m}/${u} (Split)`:m}return m};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("button",{type:"button",onClick:a,className:"mr-4 flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(yo,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Log New Deal"})]})}),e.jsxs("form",{onSubmit:i,children:[e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsxs("div",{className:"bg-blue-50 border-b border-blue-100 px-6 py-4 rounded-t-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ss,{className:"h-5 w-5 text-blue-500 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-blue-700",children:"Deal Information"})]}),e.jsx("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 border border-transparent rounded-md shadow-sm py-2 px-6 text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Log Deal"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 mb-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"dealNumber",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Dc,{className:"h-4 w-4 mr-2 text-gray-500"}),"Deal #"]}),e.jsx("input",{type:"text",id:"dealNumber",name:"dealNumber",value:r.dealNumber,onChange:o,maxLength:8,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"dealDate",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Bt,{className:"h-4 w-4 mr-2 text-gray-500"}),"Deal Date"]}),e.jsx("input",{type:"date",id:"dealDate",name:"dealDate",value:r.dealDate||new Date().toISOString().split("T")[0],onChange:o,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"stockNumber",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Dc,{className:"h-4 w-4 mr-2 text-gray-500"}),"Stock #"]}),e.jsx("input",{type:"text",id:"stockNumber",name:"stockNumber",value:r.stockNumber,onChange:o,required:!0,maxLength:8,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"vinLast8",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2 text-gray-500"}),"Last 8 of VIN"]}),e.jsx("input",{type:"text",id:"vinLast8",name:"vinLast8",value:r.vinLast8,onChange:o,required:!0,maxLength:8,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"vehicleType",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2 text-gray-500"}),"Vehicle Type"]}),e.jsx("select",{id:"vehicleType",name:"vehicleType",value:r.vehicleType,onChange:o,required:!0,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base",children:zw.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"dealType",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(vu,{className:"h-4 w-4 mr-2 text-gray-500"}),"Deal Type"]}),e.jsxs("select",{id:"dealType",name:"dealType",value:r.dealType,onChange:o,required:!0,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base",children:[e.jsx("option",{value:"",children:"Select"}),Vw.map(d=>e.jsx("option",{value:d,children:d},d))]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-3",children:[e.jsxs("label",{htmlFor:"lastName",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Ur,{className:"h-4 w-4 mr-2 text-gray-500"}),"Last Name"]}),e.jsx("input",{type:"text",id:"lastName",name:"lastName",value:r.lastName,onChange:o,required:!0,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{htmlFor:"salespersonId",className:"flex items-center text-base font-bold text-gray-700",children:[e.jsx(Ur,{className:"h-4 w-4 mr-2 text-gray-500"}),"Salesperson"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isSplitDeal",name:"isSplitDeal",checked:r.isSplitDeal,onChange:o,className:"h-3 w-3 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"isSplitDeal",className:"ml-1 text-xs text-gray-500",children:"Split Deal"})]})]}),r.isSplitDeal?e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("select",{id:"salespersonId",name:"salespersonId",value:r.salespersonId,onChange:o,required:!0,className:"w-full h-10 px-2 text-sm rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Primary"}),sr.map(d=>e.jsxs("option",{value:d.id,children:[d.firstName," ",d.lastName]},d.id))]}),e.jsxs("select",{id:"secondSalespersonId",name:"secondSalespersonId",value:r.secondSalespersonId,onChange:o,required:r.isSplitDeal,className:"w-full h-10 px-2 text-sm rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Secondary"}),sr.filter(d=>d.id.toString()!==r.salespersonId).map(d=>e.jsxs("option",{value:d.id,children:[d.firstName," ",d.lastName]},d.id))]})]}):e.jsx(e.Fragment,{children:e.jsxs("select",{id:"salespersonId",name:"salespersonId",value:r.salespersonId,onChange:o,required:!0,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base",children:[e.jsx("option",{value:"",children:"Select"}),sr.map(d=>e.jsxs("option",{value:d.id,children:[d.firstName," ",d.lastName]},d.id))]})}),(r.salespersonId||r.isSplitDeal&&r.secondSalespersonId)&&e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Will display as: ",c()]})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{htmlFor:"lender",className:"flex items-center text-base font-bold text-gray-700",children:[e.jsx(fl,{className:"h-4 w-4 mr-2 text-gray-500"}),"Lender"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"outsideFunding",name:"outsideFunding",checked:r.outsideFunding,onChange:o,className:"h-3 w-3 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"outsideFunding",className:"ml-1 text-xs text-gray-500",children:"Outside Funding"})]})]}),e.jsxs("select",{id:"lender",name:"lender",value:r.lender,onChange:o,required:r.dealType==="Finance"||r.dealType==="Lease",disabled:r.dealType==="Cash",className:`w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base ${r.dealType==="Cash"?"bg-gray-100":""}`,children:[e.jsx("option",{value:"",children:"Select Lender"}),Bw.map(d=>e.jsx("option",{value:d,children:d},d))]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"dealStatus",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(xn,{className:"h-4 w-4 mr-2 text-gray-500"}),"Deal Status"]}),e.jsx("select",{id:"dealStatus",name:"dealStatus",value:r.dealStatus,onChange:o,required:!0,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base",children:Ww.map(d=>e.jsx("option",{value:d,children:d},d))})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"salesManagerId",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2 text-gray-500"}),"Sales Manager"]}),e.jsxs("select",{id:"salesManagerId",name:"salesManagerId",onChange:o,className:"w-full h-10 px-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base",children:[e.jsx("option",{value:"",children:"Select"}),sr.map(d=>e.jsxs("option",{value:d.id,children:[d.firstName," ",d.lastName]},d.id))]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-lg shadow h-full",children:[e.jsxs("div",{className:"bg-purple-50 border-b border-purple-100 px-6 py-4 rounded-t-lg flex items-center",children:[e.jsx(oi,{className:"h-5 w-5 text-purple-500 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-purple-700",children:"Product Profits"})]}),e.jsxs("div",{className:"p-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"vscProfit",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(p0,{className:"h-4 w-4 mr-2 text-red-500"}),"VSC Profit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"vscProfit",name:"vscProfit",value:r.vscProfit,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"ppmProfit",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(Bt,{className:"h-4 w-4 mr-2 text-amber-500"}),"PPM Profit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"ppmProfit",name:"ppmProfit",value:r.ppmProfit,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"gapProfit",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(pu,{className:"h-4 w-4 mr-2 text-cyan-500"}),"GAP Profit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"gapProfit",name:"gapProfit",value:r.gapProfit,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"tireAndWheelProfit",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(y0,{className:"h-4 w-4 mr-2 text-yellow-500"}),"T&W/Bundle Profit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"tireAndWheelProfit",name:"tireAndWheelProfit",value:r.tireAndWheelProfit,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"appearanceProfit",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(oi,{className:"h-4 w-4 mr-2 text-emerald-500"}),"Paint and Fabric Profit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"appearanceProfit",name:"appearanceProfit",value:r.appearanceProfit,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"otherProfit",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(oi,{className:"h-4 w-4 mr-2 text-gray-500"}),"Other Profit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"otherProfit",name:"otherProfit",value:r.otherProfit,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-lg shadow h-full",children:[e.jsxs("div",{className:"bg-green-50 border-b border-green-100 px-6 py-4 rounded-t-lg flex items-center",children:[e.jsx(ms,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-green-700",children:"Deal Profit"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"frontEndGross",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(So,{className:"h-4 w-4 mr-2 text-blue-500"}),"Front End Profit"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"frontEndGross",name:"frontEndGross",value:r.frontEndGross,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"reserveFlat",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(wu,{className:"h-4 w-4 mr-2 text-orange-500"}),"Reserve/Flat Amount"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"reserveFlat",name:"reserveFlat",value:r.reserveFlat,onChange:o,placeholder:"0.00",className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base"})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[e.jsxs("label",{htmlFor:"backEndGross",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(n0,{className:"h-4 w-4 mr-2 text-indigo-500"}),"Back End Gross (Auto-calculated)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"backEndGross",name:"backEndGross",value:r.backEndGross,readOnly:!0,className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-200 bg-gray-50 shadow-sm text-base font-semibold"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"totalGross",className:"flex items-center text-base font-bold text-gray-700 mb-2",children:[e.jsx(ms,{className:"h-4 w-4 mr-2 text-green-500"}),"Total Gross (Auto-calculated)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg",children:"$"})}),e.jsx("input",{type:"text",id:"totalGross",name:"totalGross",value:r.totalGross,readOnly:!0,className:"w-full h-10 pl-8 pr-4 rounded-md border border-gray-200 bg-gray-50 shadow-sm text-base font-semibold"})]})]})]})]})})]})]})]})},Cf=()=>{var f,b;const{user:t,role:s,dealershipId:r}=et(),n=St(),a=yt(),[o,i]=l.useState(!1),[c,d]=l.useState("this-month");l.useEffect(()=>{n.pathname.includes("/log-deal")||n.pathname.includes("/deal-log")||n.pathname.includes("/finance-deal-log")?i(!0):i(!1)},[n.pathname]),l.useEffect(()=>(console.log("[FinanceDashboard] Rendering finance dashboard",{userId:t==null?void 0:t.id,role:s,dealershipId:r,timestamp:new Date().toISOString(),path:n.pathname}),()=>{console.log("[FinanceDashboard] Unmounting finance dashboard")}),[t,s,r,n.pathname]);const m=p=>{p.preventDefault(),a("/finance-deal-log")},h=p=>{const x=new Date,v=x.toLocaleString("default",{month:"long"}),y=x.getFullYear();switch(p){case"this-month":return`${v} ${y}`;case"last-month":const j=x.getMonth()===0?"December":new Date(x.getFullYear(),x.getMonth()-1,1).toLocaleString("default",{month:"long"}),N=x.getMonth()===0?x.getFullYear()-1:x.getFullYear();return`${j} ${N}`;case"last-quarter":const g=Math.floor(x.getMonth()/3);return`Q${g===0?4:g} ${g===0?y-1:y}`;case"ytd":return`Year to Date ${y}`;case"last-year":return`${y-1}`;default:return`${v} ${y}`}};if(o)return e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Finance Manager Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Finance Manager: ",((f=t==null?void 0:t.email)==null?void 0:f.split("@")[0])||"Not Assigned"]})]}),e.jsx(I,{size:"lg",className:"bg-green-600 hover:bg-green-700",onClick:()=>a("/dashboard/finance"),children:"Back to Dashboard"})]}),e.jsx(nn,{dashboardType:"finance"})]});const u=["Present every product to every customer every time - consistency is key.","Build value first, then discuss investment. Never start with the price.","Use customer-friendly language instead of industry jargon when explaining products.","Focus on protection and peace of mind, not just financial benefits.","Keep your menu presentation simple and visual for maximum effectiveness.","Digital menus increase compliance and provide a more professional presentation.","Always congratulate the customer on their vehicle purchase before starting your presentation.","Listen to customer concerns about products and address them specifically.","Explain how each product benefits the customer's specific vehicle and usage patterns."];return e.jsxs("div",{className:"container py-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-6",children:e.jsx("div",{className:"flex-grow",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Finance Manager Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Finance Manager: ",((b=t==null?void 0:t.email)==null?void 0:b.split("@")[0])||"Not Assigned"]})]}),e.jsx("div",{className:"bg-blue-50 p-2 rounded-md mt-2 md:mt-0 border border-blue-100 max-w-2xl",children:e.jsxs("p",{className:"text-xs italic text-blue-800",children:[e.jsx(No,{className:"h-3 w-3 inline-block mr-1"}),e.jsx("strong",{children:"F&I Best Practice:"})," ",u[new Date().getDay()%u.length]]})})]})})}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h2",{className:"text-2xl font-bold mr-3",children:h(c)}),e.jsxs("select",{value:c,onChange:p=>d(p.target.value),className:"p-2 border rounded-md shadow-sm",children:[e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"last-quarter",children:"Last Quarter"}),e.jsx("option",{value:"ytd",children:"Year to Date"}),e.jsx("option",{value:"last-year",children:"Last Year"})]})]}),e.jsx(I,{size:"lg",className:"bg-green-600 hover:bg-green-700",onClick:m,children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(Zn,{className:"mr-2 h-5 w-5"}),"Log New Deal"]})})]}),e.jsxs(Xn,{children:[e.jsx(Ce,{path:"/",element:e.jsx(Uw,{})}),e.jsx(Ce,{path:"/deals",element:e.jsx(Sf,{})}),e.jsx(Ce,{path:"/schedule",element:e.jsx(Gw,{})}),e.jsx(Ce,{path:"*",element:e.jsx(bt,{to:"/dashboard/finance",replace:!0})})]})]})},Hw={totalGross:125600,frontEndGross:82400,financeGross:43200,totalUnits:86,newCars:52,usedCars:34,salesGoal:100,salesPerformance:86,avgPerDeal:1460,avgFrontGross:958,avgFinanceGross:502,lastMonthComparison:{totalGross:8.5,frontEndGross:6.2,financeGross:12.4,totalUnits:9.3,avgPerDeal:4.8}},id=[{day:"Monday",date:"12",shifts:[{team:"Team A",hours:"9am-6pm",members:"SJ, MC, DR"},{team:"Team B",hours:"Off",members:""}]},{day:"Tuesday",date:"13",shifts:[{team:"Team A",hours:"9am-6pm",members:"SJ, MC, DR"},{team:"Team B",hours:"Off",members:""}]},{day:"Wednesday",date:"14",shifts:[{team:"Team A",hours:"10am-7pm",members:"SJ, MC, DR"},{team:"Team B",hours:"Off",members:""}]},{day:"Thursday",date:"15",shifts:[{team:"Team A",hours:"Off",members:""},{team:"Team B",hours:"9am-6pm",members:"AW, RJ, KS"}]},{day:"Friday",date:"16",shifts:[{team:"Team A",hours:"Off",members:""},{team:"Team B",hours:"11am-8pm",members:"AW, RJ, KS"}]},{day:"Saturday",date:"17",shifts:[{team:"Team A",hours:"9am-5pm",members:"SJ, MC, DR"},{team:"Team B",hours:"9am-5pm",members:"AW, RJ, KS"}]},{day:"Sunday",date:"18",shifts:[{team:"Team A",hours:"Off",members:""},{team:"Team B",hours:"10am-4pm",members:"AW, RJ"}]}],Pf=()=>{const{user:t,role:s,dealershipId:r}=et(),[n,a]=l.useState(Hw),[o,i]=l.useState(null),[c,d]=l.useState(!1),[m,h]=l.useState(!1),[u,f]=l.useState("this-month"),b=yt();l.useEffect(()=>(console.log("[SalesManagerDashboard] Rendering sales manager dashboard",{userId:t==null?void 0:t.id,role:s,dealershipId:r,timestamp:new Date().toISOString()}),()=>{console.log("[SalesManagerDashboard] Unmounting sales manager dashboard")}),[t,s,r]);const p=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(S),v=(()=>{const S=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],P=new Date,E=P.getDay();return Array.from({length:7},(D,G)=>{const se=(E+G)%7,L=new Date(P);L.setDate(P.getDate()+G);const T=L.getDate(),A=id.findIndex(te=>te.day===S[se]),Y=A>=0?id[A].shifts:[{team:"Team A",hours:"Off",members:""},{team:"Team B",hours:"Off",members:""}];return{day:S[se],date:T.toString(),shifts:Y,isToday:G===0}})})(),y=S=>{if(o){const P=parseFloat(S.target.value)||0;i({...o,frontGross:P})}},j=S=>{o&&i({...o,status:S})},N=S=>{S.preventDefault(),o&&(h(!0),setTimeout(()=>{h(!1),d(!1),i(null),console.log("Deal updated:",o)},1e3))},g=S=>{const P=new Date,E=P.toLocaleString("default",{month:"long"}),D=P.getFullYear();switch(S){case"this-month":return`${E} ${D}`;case"last-month":const G=P.getMonth()===0?"December":new Date(P.getFullYear(),P.getMonth()-1,1).toLocaleString("default",{month:"long"}),se=P.getMonth()===0?P.getFullYear()-1:P.getFullYear();return`${G} ${se}`;case"last-quarter":const L=Math.floor(P.getMonth()/3);return`Q${L===0?4:L} ${L===0?D-1:D}`;case"ytd":return`Year to Date ${D}`;case"last-year":return`${D-1}`;default:return`${E} ${D}`}},w=S=>{f(S.target.value)};return e.jsxs("div",{className:"container py-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex-grow",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sales Manager Dashboard"}),e.jsx("div",{className:"bg-blue-50 p-2 rounded-md mt-2 border border-blue-100",children:e.jsxs("p",{className:"text-xs italic text-blue-800",children:[e.jsx(No,{className:"h-3 w-3 inline-block mr-1"}),e.jsx("strong",{children:"Management Tip:"})," ",["Great managers don't just set goals; they remove obstacles for their team members.","Feedback is a gift. Deliver it with respect, receive it with gratitude.","Celebrate small wins to build momentum toward big victories.","Know your numbers, but remember that your people drive those numbers.","The best way to predict the future is to create it through coaching and development.","The quality of your leadership determines the quality of your team.","Your team doesn't care how much you know until they know how much you care."][new Date().getDay()]]})})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:g(u)}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bt,{className:"h-5 w-5 text-gray-500 mr-1"}),e.jsxs("select",{value:u,onChange:w,className:"p-2 border rounded-md shadow-sm",children:[e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"last-quarter",children:"Last Quarter"}),e.jsx("option",{value:"ytd",children:"Year to Date"}),e.jsx("option",{value:"last-year",children:"Last Year"})]})]}),e.jsx("p",{className:"text-gray-500",children:"Sales Performance Dashboard"})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-lg font-medium text-gray-700",children:"Mike Johnson"})})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[e.jsxs(B,{className:"border-l-4 border-l-green-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(ms,{className:"mr-2 h-4 w-4 text-green-500"}),"Gross Profit"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p(n.totalGross)}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Front End Gross:"}),e.jsx("span",{className:"font-medium",children:p(n.frontEndGross)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Finance Gross:"}),e.jsx("span",{className:"font-medium",children:p(n.financeGross)})]})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsxs("span",{className:`flex items-center ${n.lastMonthComparison.totalGross>=0?"text-green-500":"text-red-500"}`,children:[n.lastMonthComparison.totalGross>=0?e.jsx(Qt,{className:"h-3 w-3 mr-1"}):e.jsx(Jt,{className:"h-3 w-3 mr-1"}),Math.abs(n.lastMonthComparison.totalGross),"% from last month"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-blue-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Ss,{className:"mr-2 h-4 w-4 text-blue-500"}),"Total Units"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.totalUnits}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"New Cars:"}),e.jsx("span",{className:"font-medium",children:n.newCars})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Used Cars:"}),e.jsx("span",{className:"font-medium",children:n.usedCars})]})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsxs("span",{className:`flex items-center ${n.lastMonthComparison.totalUnits>=0?"text-green-500":"text-red-500"}`,children:[n.lastMonthComparison.totalUnits>=0?e.jsx(Qt,{className:"h-3 w-3 mr-1"}):e.jsx(Jt,{className:"h-3 w-3 mr-1"}),Math.abs(n.lastMonthComparison.totalUnits),"% from last month"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-purple-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Or,{className:"mr-2 h-4 w-4 text-purple-500"}),"Sales Performance"]})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n.salesPerformance,"%"]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsxs("span",{className:"text-gray-500",children:["Goal: ",n.salesGoal," units"]}),e.jsxs("span",{className:"font-medium",children:[n.totalUnits,"/",n.salesGoal]})]}),e.jsx("div",{className:"h-2 w-full bg-gray-100 rounded-full",children:e.jsx("div",{className:`h-full rounded-full ${n.salesPerformance>=100?"bg-green-500":n.salesPerformance>=80?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(n.salesPerformance,100)}%`}})})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsx("span",{className:"text-gray-500",children:n.salesGoal-n.totalUnits>0?`${n.salesGoal-n.totalUnits} more units to goal`:"Goal achieved!"})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-amber-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(jo,{className:"mr-2 h-4 w-4 text-amber-500"}),"Average Per Deal"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p(n.avgPerDeal)}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Avg Front Gross:"}),e.jsx("span",{className:"font-medium",children:p(n.avgFrontGross)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Avg F&I Gross:"}),e.jsx("span",{className:"font-medium",children:p(n.avgFinanceGross)})]})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsxs("span",{className:`flex items-center ${n.lastMonthComparison.avgPerDeal>=0?"text-green-500":"text-red-500"}`,children:[n.lastMonthComparison.avgPerDeal>=0?e.jsx(Qt,{className:"h-3 w-3 mr-1"}):e.jsx(Jt,{className:"h-3 w-3 mr-1"}),Math.abs(n.lastMonthComparison.avgPerDeal),"% from last month"]})})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs(B,{className:"border hover:shadow-md transition-shadow",children:[e.jsx(W,{className:"py-2 px-4 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(wo,{className:"mr-2 h-4 w-4 text-indigo-500"}),"Team Schedule"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Ws,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm",children:"This Week"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Nr,{className:"h-4 w-4"})})]})]})}),e.jsx(V,{className:"py-2 px-0 overflow-x-auto",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"grid grid-cols-7 text-center",children:v.map((S,P)=>e.jsxs("div",{className:`p-2 ${S.isToday?"bg-blue-50 border-b-2 border-blue-500":""}`,children:[e.jsxs("div",{className:"font-medium text-xs text-gray-800",children:[S.day.substring(0,3)," ",e.jsx("span",{className:"text-gray-500",children:S.date})]}),e.jsx("div",{className:"mt-1 space-y-2",children:S.shifts.map((E,D)=>e.jsx("div",{className:"text-xs",children:E.hours!=="Off"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium text-blue-600",children:E.team}),e.jsx("div",{className:"text-gray-700",children:E.hours}),E.members&&e.jsx("div",{className:"text-gray-500 text-[10px]",children:E.members})]}):e.jsxs("div",{className:"text-gray-400 italic",children:[E.team,": Off"]})},D))})]},P))})})})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3 mb-6",children:[e.jsxs(B,{className:"md:col-span-2",children:[e.jsx(W,{children:e.jsx(z,{children:"The Das Board"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-white border-b py-2 px-1 overflow-x-auto",children:[e.jsx("div",{className:"w-10 text-center bg-gray-600 py-2 rounded-l-md",children:"#"}),e.jsx("div",{className:"w-40 flex-shrink-0 bg-gray-600 py-2 px-2",children:"Salesperson"}),e.jsxs("div",{className:"w-28 text-center bg-purple-600 py-2 flex items-center justify-center cursor-pointer hover:bg-purple-700",children:["PVR ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-center bg-green-600 py-2 flex items-center justify-center cursor-pointer hover:bg-green-700",children:["Total Gross ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-600 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-700",children:["Avg/Mo ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-500 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-600",children:["Last Mo ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-600 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-700",children:["YTD ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-500 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-600",children:["Annual ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-green-600 py-2 flex items-center justify-center cursor-pointer hover:bg-green-700",children:["New ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-amber-600 py-2 flex items-center justify-center cursor-pointer hover:bg-amber-700",children:["Used ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-right bg-indigo-600 py-2 pr-3 flex items-center justify-end cursor-pointer hover:bg-indigo-700 font-semibold rounded-r-md",children:["Current Month ",e.jsx(Rt,{className:"ml-1 h-3 w-3"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:[{name:"Sarah Johnson",units:14,frontGross:18200,backGross:14300,totalGross:32500,avgMonth:12,lastMonth:15,ytd:82,annualPace:144,newUnits:9,usedUnits:5,pvr:2321},{name:"Michael Chen",units:12,frontGross:16400,backGross:12500,totalGross:28900,avgMonth:10,lastMonth:11,ytd:65,annualPace:120,newUnits:7,usedUnits:5,pvr:2408},{name:"David Rodriguez",units:11,frontGross:14800,backGross:11600,totalGross:26400,avgMonth:9,lastMonth:10,ytd:58,annualPace:108,newUnits:4,usedUnits:7,pvr:2400},{name:"Amanda Williams",units:9,frontGross:11900,backGross:9800,totalGross:21700,avgMonth:8,lastMonth:7,ytd:48,annualPace:96,newUnits:5,usedUnits:4,pvr:2411},{name:"Robert Johnson",units:8,frontGross:10500,backGross:8700,totalGross:19200,avgMonth:7,lastMonth:9,ytd:42,annualPace:84,newUnits:3,usedUnits:5,pvr:2400}].map((S,P)=>e.jsxs("div",{className:`flex items-center py-2 px-1 ${P!==4?"border-b":""} border-gray-100 text-sm hover:bg-gray-50`,children:[e.jsx("div",{className:"w-10 flex justify-center",children:e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center
                      ${P===0?"bg-yellow-100 text-yellow-600":P===1?"bg-gray-100 text-gray-600":P===2?"bg-amber-100 text-amber-600":"bg-blue-50 text-blue-500"}`,children:e.jsx("span",{className:"text-xs font-bold",children:P+1})})}),e.jsx("div",{className:"w-40 flex-shrink-0 font-medium truncate px-2",children:S.name}),e.jsxs("div",{className:"w-28 text-center bg-purple-50",children:["$",S.pvr]}),e.jsxs("div",{className:"w-36 text-center bg-green-50",children:["$",S.totalGross.toLocaleString()]}),e.jsx("div",{className:"w-28 text-center bg-blue-50",children:S.avgMonth}),e.jsx("div",{className:"w-28 text-center",children:S.lastMonth}),e.jsx("div",{className:"w-28 text-center bg-blue-50",children:S.ytd}),e.jsx("div",{className:"w-28 text-center",children:S.annualPace}),e.jsx("div",{className:"w-24 text-center bg-green-50",children:S.newUnits}),e.jsx("div",{className:"w-24 text-center bg-amber-50",children:S.usedUnits}),e.jsx("div",{className:"w-36 text-right pr-3",children:e.jsx("span",{className:"text-lg font-bold text-indigo-700",children:S.units})})]},P))}),e.jsx("div",{className:"mt-2 pt-2 text-center",children:e.jsx(I,{variant:"ghost",size:"sm",className:"text-xs text-blue-600",children:"View All Salespeople"})})]})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Quick Actions"})}),e.jsxs(V,{className:"grid gap-4",children:[e.jsxs(I,{className:"w-full justify-start",onClick:()=>b("/dashboard/sales-manager/team"),children:[e.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Team Management"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",onClick:()=>b("/dashboard/sales-manager/goals"),children:[e.jsx(Or,{className:"mr-2 h-4 w-4"}),"Set Team Goals"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",onClick:()=>b("/dashboard/sales-manager/schedule"),children:[e.jsx(Bt,{className:"mr-2 h-4 w-4"}),"Schedule"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",onClick:()=>b("/dashboard/sales-manager/sales-report"),children:[e.jsx(yu,{className:"mr-2 h-4 w-4"}),"Sales Reports"]})]})]})]}),e.jsxs(B,{className:"mb-6 border hover:shadow-md transition-shadow",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2 border-b",children:[e.jsxs(z,{className:"text-lg font-medium flex items-center",children:[e.jsx(Sr,{className:"mr-2 h-5 w-5 text-blue-500"}),"Deals Log"]}),e.jsx(I,{variant:"outline",size:"sm",className:"h-8 text-xs px-2",children:"View All Deals"})]}),e.jsx(V,{className:"pt-4 px-0",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-grow overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs",children:[e.jsx("th",{className:"font-medium text-white py-2 pl-3 text-center bg-gray-600 w-12",children:"#"}),e.jsx("th",{className:"font-medium text-white py-2 pl-4 pr-2 text-left bg-blue-600",children:"Deal #"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-left bg-gray-600",children:"Stock #"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-left bg-gray-600",children:"Customer"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-gray-600",children:"Date"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-indigo-600",children:"N/U/CPO"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-blue-600",children:"Salesperson"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-green-600",children:"Front Gross"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-purple-600",children:"Finance Gross"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-amber-600",children:"Total Gross"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-gray-600 w-20",children:"Status"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-blue-600 w-20",children:"CSI Follow Up"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-gray-600 rounded-tr-md",children:"Action"})]})}),e.jsx("tbody",{children:[{id:"D12345",stockNumber:"S9876",customer:"Johnson",vehicleType:"N",date:"06/12/2023",salesperson:"Sarah Johnson",initials:"SJ",frontGross:1850,financeGross:1200,totalGross:3050,status:"Funded",csiFollowUp:!0},{id:"D12346",stockNumber:"S9452",customer:"Williams",vehicleType:"U",date:"06/10/2023",salesperson:"Michael Chen",initials:"MC",frontGross:1300,financeGross:950,totalGross:2250,status:"Pending",csiFollowUp:!1},{id:"D12347",stockNumber:"S8765",customer:"Martinez",vehicleType:"C",date:"06/09/2023",salesperson:"David Rodriguez",initials:"DR",frontGross:2100,financeGross:1400,totalGross:3500,status:"Funded",csiFollowUp:!0},{id:"D12348",stockNumber:"S7620",customer:"Taylor",vehicleType:"U",date:"06/07/2023",salesperson:"Amanda Williams",initials:"AW",frontGross:1750,financeGross:1050,totalGross:2800,status:"Funded",csiFollowUp:!0},{id:"D12349",stockNumber:"S8452",customer:"Garcia",vehicleType:"N",date:"06/05/2023",salesperson:"Robert Johnson",initials:"RJ",frontGross:1500,financeGross:1100,totalGross:2600,status:"Pending",csiFollowUp:!1},{id:"D12350",stockNumber:"S9123",customer:"Miller",vehicleType:"C",date:"06/04/2023",salesperson:"Sarah Johnson",initials:"SJ",frontGross:2250,financeGross:1320,totalGross:3570,status:"Funded",csiFollowUp:!0},{id:"D12351",stockNumber:"S7845",customer:"Davis",vehicleType:"U",date:"06/03/2023",salesperson:"Michael Chen",initials:"MC",frontGross:1420,financeGross:980,totalGross:2400,status:"Funded",csiFollowUp:!1},{id:"D12352",stockNumber:"S8932",customer:"Wilson",vehicleType:"N",date:"06/02/2023",salesperson:"David Rodriguez",initials:"DR",frontGross:1950,financeGross:1250,totalGross:3200,status:"Unwound",csiFollowUp:!1},{id:"D12353",stockNumber:"S7534",customer:"Thompson",vehicleType:"C",date:"06/01/2023",salesperson:"Amanda Williams",initials:"AW",frontGross:1650,financeGross:1020,totalGross:2670,status:"Funded",csiFollowUp:!0},{id:"D12354",stockNumber:"S8721",customer:"Anderson",vehicleType:"N",date:"05/31/2023",salesperson:"Robert Johnson",initials:"RJ",frontGross:2050,financeGross:1350,totalGross:3400,status:"Funded",csiFollowUp:!0}].map((S,P)=>{const E=S.status==="Funded"?"bg-green-100 text-green-800 border-green-200":S.status==="Unwound"?"bg-red-100 text-red-800 border-red-200":"bg-amber-100 text-amber-800 border-amber-200",D=10-P;return e.jsxs("tr",{className:`border-b ${P%2===1?"bg-gray-50":""} hover:bg-blue-50`,children:[e.jsx("td",{className:"py-2 px-2 text-center font-medium",children:D}),e.jsx("td",{className:"py-2 pl-4 pr-2 text-left font-medium text-blue-600",children:S.id}),e.jsx("td",{className:"py-2 px-2 text-left",children:S.stockNumber}),e.jsx("td",{className:"py-2 px-2 text-left font-medium",children:S.customer}),e.jsx("td",{className:"py-2 px-2 text-center text-gray-600",children:S.date}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${S.vehicleType==="N"?"bg-green-100 text-green-800":S.vehicleType==="U"?"bg-amber-100 text-amber-800":"bg-blue-100 text-blue-800"}`,children:S.vehicleType})}),e.jsx("td",{className:"py-2 px-2 text-center font-medium",children:S.initials}),e.jsxs("td",{className:"py-2 px-2 text-right",children:["$",S.frontGross.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right",children:["$",S.financeGross.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right font-medium text-green-600",children:["$",S.totalGross.toLocaleString()]}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${E}`,children:S.status})}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx("input",{type:"checkbox",checked:S.csiFollowUp,className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"})}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsxs(jr,{open:c&&(o==null?void 0:o.id)===S.id,onOpenChange:G=>{G||d(!1)},children:[e.jsx(co,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{i({id:S.id,frontGross:S.frontGross,status:S.status}),d(!0)},children:e.jsx(pr,{className:"h-3.5 w-3.5"})})}),e.jsxs(qs,{className:"sm:max-w-[425px]",children:[e.jsxs(Ys,{children:[e.jsx(Js,{children:"Edit Deal"}),e.jsxs(Qs,{children:["Update deal information for ",S.customer]})]}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(fe,{htmlFor:"frontGross",children:"Front End Gross ($)"}),e.jsx(be,{id:"frontGross",type:"number",value:(o==null?void 0:o.frontGross)||0,onChange:y})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(fe,{htmlFor:"status",children:"Deal Status"}),e.jsxs(mt,{value:(o==null?void 0:o.status)||"Pending",onValueChange:j,children:[e.jsx(rt,{id:"status",children:e.jsx(ht,{placeholder:"Select status"})}),e.jsxs(nt,{children:[e.jsx(Re,{value:"Pending",children:"Pending"}),e.jsx(Re,{value:"Funded",children:"Funded"}),e.jsx(Re,{value:"Unwound",children:"Unwound"})]})]}),(o==null?void 0:o.status)==="Unwound"&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Warning: Unwinding a deal may affect salesperson commissions."})]})]}),e.jsx(Ks,{children:e.jsx(I,{type:"submit",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving"]}):e.jsxs(e.Fragment,{children:[e.jsx(ea,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})})]})]})]})})]},S.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-100 border-t border-t-gray-200 font-medium",children:[e.jsx("td",{colSpan:6,className:"py-2 pl-4 text-left",children:"TOTALS"}),e.jsxs("td",{className:"py-2 px-2 text-right",children:["$",[1850,1300,2100,1750,1500,2250,1420,1950,1650,2050].reduce((S,P)=>S+P,0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right",children:["$",[1200,950,1400,1050,1100,1320,980,1250,1020,1350].reduce((S,P)=>S+P,0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right text-green-600 font-medium",children:["$",[3050,2250,3500,2800,2600,3570,2400,3200,2670,3400].reduce((S,P)=>S+P,0).toLocaleString()]}),e.jsx("td",{})]})})]}),e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-t",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Showing deals 1-10 of 45"}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(I,{variant:"outline",size:"sm",children:"Previous"}),e.jsx(I,{variant:"outline",size:"sm",children:"Next"})]})]})]}),e.jsxs("div",{className:"w-12 border-l bg-gray-50 flex flex-col items-center justify-between py-4",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(I,{variant:"outline",size:"sm",className:"w-8 h-8 p-0",children:e.jsx(Ut,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",className:"w-8 h-8 p-0",children:e.jsx(Ut,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"text-xs text-gray-500 text-center py-2",children:"10/45"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(I,{variant:"outline",size:"sm",className:"w-8 h-8 p-0",children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",className:"w-8 h-8 p-0",children:e.jsx(ke,{className:"h-4 w-4"})})]})]})]})})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Team Performance Metrics"})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Salesperson"}),e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-center",children:"Target Goal"}),e.jsx(H,{className:"text-center",children:"Sold (MTD)"}),e.jsx(H,{className:"text-right",children:"Avg Front"}),e.jsx(H,{className:"text-right",children:"Avg Back End"}),e.jsx(H,{className:"text-center",children:"CSI Follow Up"}),e.jsx(H,{className:"text-right",children:"% of Goal"})]})}),e.jsx(it,{children:[{name:"Sarah Johnson",initials:"SJ",team:"A",targetGoal:30,actualDeals:24,avgFront:1850,avgBackEnd:1200,csiFollowUp:92,percentGoal:80},{name:"Michael Chen",initials:"MC",team:"A",targetGoal:25,actualDeals:20,avgFront:1320,avgBackEnd:980,csiFollowUp:85,percentGoal:80},{name:"David Rodriguez",initials:"DR",team:"A",targetGoal:22,actualDeals:18,avgFront:1950,avgBackEnd:1250,csiFollowUp:75,percentGoal:82},{name:"Amanda Williams",initials:"AW",team:"B",targetGoal:20,actualDeals:16,avgFront:1650,avgBackEnd:1020,csiFollowUp:95,percentGoal:80},{name:"Robert Johnson",initials:"RJ",team:"B",targetGoal:18,actualDeals:15,avgFront:2050,avgBackEnd:1350,csiFollowUp:88,percentGoal:83}].map((S,P)=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:S.name}),e.jsx(U,{className:"text-center",children:e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S.team==="A"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:["Team ",S.team]})}),e.jsx(U,{className:"text-center",children:S.targetGoal}),e.jsx(U,{className:"text-center",children:S.actualDeals}),e.jsxs(U,{className:"text-right",children:["$",S.avgFront.toLocaleString()]}),e.jsxs(U,{className:"text-right",children:["$",S.avgBackEnd.toLocaleString()]}),e.jsx(U,{className:"text-center",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${S.csiFollowUp>=90?"bg-green-100 text-green-800":S.csiFollowUp>=80?"bg-blue-100 text-blue-800":"bg-amber-100 text-amber-800"}`,children:[S.csiFollowUp,"%"]})})}),e.jsx(U,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("div",{className:"w-16 h-2 bg-gray-100 rounded-full mr-2 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${S.percentGoal>=90?"bg-green-500":S.percentGoal>=70?"bg-blue-500":S.percentGoal>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.min(S.percentGoal,100)}%`}})}),e.jsxs("span",{className:"text-xs font-medium",children:[S.percentGoal,"%"]})]})})]},P))})]})})]})]})},_f=()=>{const{user:t,role:s,dealershipId:r}=et(),[n,a]=l.useState("this-month"),o={totalGross:125600,frontEndGross:82400,financeGross:43200,totalUnits:86,newCars:52,usedCars:34,salesGoal:100,salesPerformance:86,avgPerDeal:1460,avgFrontGross:958,avgFinanceGross:502,lastMonthComparison:{totalGross:8.5,frontEndGross:6.2,financeGross:12.4,totalUnits:9.3,avgPerDeal:4.8}},[i,c]=l.useState(o);l.useEffect(()=>(console.log("[GMDashboard] Rendering general manager dashboard",{userId:t==null?void 0:t.id,role:s,dealershipId:r,timestamp:new Date().toISOString()}),()=>{console.log("[GMDashboard] Unmounting general manager dashboard")}),[t,s,r]);const d=h=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(h),m=h=>{const u=new Date,f=u.toLocaleString("default",{month:"long"}),b=u.getFullYear();switch(h){case"this-month":return`${f} ${b}`;case"last-month":const p=u.getMonth()===0?"December":new Date(u.getFullYear(),u.getMonth()-1,1).toLocaleString("default",{month:"long"}),x=u.getMonth()===0?u.getFullYear()-1:u.getFullYear();return`${p} ${x}`;case"last-quarter":const v=Math.floor(u.getMonth()/3);return`Q${v===0?4:v} ${v===0?b-1:b}`;case"ytd":return`Year to Date ${b}`;case"last-year":return`${b-1}`;default:return`${f} ${b}`}};return e.jsxs("div",{className:"container py-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("div",{className:"flex-grow",children:e.jsx("h1",{className:"text-3xl font-bold",children:"General Manager Dashboard"})})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:m(n)}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bt,{className:"h-5 w-5 text-gray-500 mr-1"}),e.jsxs("select",{value:n,onChange:h=>a(h.target.value),className:"p-2 border rounded-md shadow-sm",children:[e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"last-quarter",children:"Last Quarter"}),e.jsx("option",{value:"ytd",children:"Year to Date"}),e.jsx("option",{value:"last-year",children:"Last Year"})]})]}),e.jsx("p",{className:"text-gray-500",children:"GM Performance Dashboard"})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-lg font-medium text-gray-700",children:(t==null?void 0:t.email)||"General Manager"})})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[e.jsxs(B,{className:"border-l-4 border-l-green-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(ms,{className:"mr-2 h-4 w-4 text-green-500"}),"Gross Profit"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d(i.totalGross)}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Front End Gross:"}),e.jsx("span",{className:"font-medium",children:d(i.frontEndGross)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Finance Gross:"}),e.jsx("span",{className:"font-medium",children:d(i.financeGross)})]})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsxs("span",{className:`flex items-center ${i.lastMonthComparison.totalGross>=0?"text-green-500":"text-red-500"}`,children:[i.lastMonthComparison.totalGross>=0?e.jsx(Qt,{className:"h-3 w-3 mr-1"}):e.jsx(Jt,{className:"h-3 w-3 mr-1"}),Math.abs(i.lastMonthComparison.totalGross),"% from last month"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-blue-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Ss,{className:"mr-2 h-4 w-4 text-blue-500"}),"Total Units"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.totalUnits}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"New Cars:"}),e.jsx("span",{className:"font-medium",children:i.newCars})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Used Cars:"}),e.jsx("span",{className:"font-medium",children:i.usedCars})]})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsxs("span",{className:`flex items-center ${i.lastMonthComparison.totalUnits>=0?"text-green-500":"text-red-500"}`,children:[i.lastMonthComparison.totalUnits>=0?e.jsx(Qt,{className:"h-3 w-3 mr-1"}):e.jsx(Jt,{className:"h-3 w-3 mr-1"}),Math.abs(i.lastMonthComparison.totalUnits),"% from last month"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-purple-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(Or,{className:"mr-2 h-4 w-4 text-purple-500"}),"Sales Performance"]})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[i.salesPerformance,"%"]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsxs("span",{className:"text-gray-500",children:["Goal: ",i.salesGoal," units"]}),e.jsxs("span",{className:"font-medium",children:[i.totalUnits,"/",i.salesGoal]})]}),e.jsx("div",{className:"h-2 w-full bg-gray-100 rounded-full",children:e.jsx("div",{className:`h-full rounded-full ${i.salesPerformance>=100?"bg-green-500":i.salesPerformance>=80?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(i.salesPerformance,100)}%`}})})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsx("span",{className:"text-gray-500",children:i.salesGoal-i.totalUnits>0?`${i.salesGoal-i.totalUnits} more units to goal`:"Goal achieved!"})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-amber-500",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"text-sm font-medium flex items-center",children:[e.jsx(jo,{className:"mr-2 h-4 w-4 text-amber-500"}),"Average Per Deal"]})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d(i.avgPerDeal)}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Avg Front Gross:"}),e.jsx("span",{className:"font-medium",children:d(i.avgFrontGross)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Avg F&I Gross:"}),e.jsx("span",{className:"font-medium",children:d(i.avgFinanceGross)})]})]}),e.jsx("div",{className:"flex items-center pt-2 text-xs",children:e.jsxs("span",{className:`flex items-center ${i.lastMonthComparison.avgPerDeal>=0?"text-green-500":"text-red-500"}`,children:[i.lastMonthComparison.avgPerDeal>=0?e.jsx(Qt,{className:"h-3 w-3 mr-1"}):e.jsx(Jt,{className:"h-3 w-3 mr-1"}),Math.abs(i.lastMonthComparison.avgPerDeal),"% from last month"]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-6 mb-6",children:[e.jsxs(B,{className:"col-span-12 md:col-span-6",children:[e.jsx(W,{className:"bg-green-50 border-b border-green-100",children:e.jsxs(z,{className:"text-lg font-semibold text-green-700 flex items-center",children:[e.jsx(ta,{className:"mr-2 h-5 w-5 text-yellow-500"}),"Finance Das Board"]})}),e.jsx(V,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-full",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-white border-b py-2 px-1",children:[e.jsx("div",{className:"w-10 text-center bg-gray-600 py-2 rounded-l-md",children:"#"}),e.jsx("div",{className:"w-36 flex-shrink-0 bg-gray-600 py-2 px-2",children:"F&I Manager"}),e.jsxs("div",{className:"w-28 text-center bg-purple-600 py-2 flex items-center justify-center cursor-pointer hover:bg-purple-700",children:["PVR ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-teal-600 py-2 flex items-center justify-center cursor-pointer hover:bg-teal-700",children:["VSC % ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-purple-600 py-2 flex items-center justify-center cursor-pointer hover:bg-purple-700",children:["PPM % ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-pink-600 py-2 flex items-center justify-center cursor-pointer hover:bg-pink-700",children:["PPD ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-right bg-indigo-600 py-2 pr-3 flex items-center justify-end cursor-pointer hover:bg-indigo-700 font-semibold rounded-r-md",children:["Profit ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]})]}),e.jsx("div",{children:[{name:"Ashley Rodriguez",pvr:2650,vscPen:68,ppmPen:54,ppd:3.2,profit:143200},{name:"Michael Parker",pvr:2450,vscPen:65,ppmPen:48,ppd:2.9,profit:127500},{name:"Sophia Martinez",pvr:2320,vscPen:61,ppmPen:45,ppd:2.7,profit:115300},{name:"James Wilson",pvr:2200,vscPen:58,ppmPen:42,ppd:2.5,profit:96500},{name:"Emma Johnson",pvr:2100,vscPen:55,ppmPen:38,ppd:2.3,profit:84200}].map((h,u)=>e.jsxs("div",{className:`flex items-center py-2 px-1 ${u!==4?"border-b":""} border-gray-100 text-sm hover:bg-gray-50`,children:[e.jsx("div",{className:"w-10 flex justify-center",children:e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center
                          ${u===0?"bg-yellow-100 text-yellow-600":u===1?"bg-gray-100 text-gray-600":u===2?"bg-amber-100 text-amber-600":"bg-blue-50 text-blue-500"}`,children:e.jsx("span",{className:"text-xs font-bold",children:u+1})})}),e.jsx("div",{className:"w-36 flex-shrink-0 font-medium px-2",children:h.name}),e.jsxs("div",{className:"w-28 text-center",children:["$",h.pvr]}),e.jsxs("div",{className:"w-28 text-center",children:[h.vscPen,"%"]}),e.jsxs("div",{className:"w-28 text-center",children:[h.ppmPen,"%"]}),e.jsx("div",{className:"w-24 text-center",children:h.ppd}),e.jsxs("div",{className:"w-36 text-right pr-3 font-semibold text-green-700",children:["$",h.profit.toLocaleString()]})]},u))})]})})})]}),e.jsxs(B,{className:"col-span-12 md:col-span-6",children:[e.jsx(W,{className:"bg-purple-50 border-b border-purple-100",children:e.jsxs(z,{className:"text-lg font-semibold text-purple-700 flex items-center",children:[e.jsx(Vt,{className:"h-5 w-5 text-purple-600 mr-2"}),"Sales Manager Das Board"]})}),e.jsx(V,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-full",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-white border-b py-2 px-1",children:[e.jsx("div",{className:"w-10 text-center bg-gray-600 py-2 rounded-l-md",children:"#"}),e.jsx("div",{className:"w-40 flex-shrink-0 bg-gray-600 py-2 px-2",children:"Manager"}),e.jsx("div",{className:"w-28 text-center bg-blue-600 py-2",children:"Team Units"}),e.jsx("div",{className:"w-28 text-center bg-green-600 py-2",children:"Total Gross"}),e.jsx("div",{className:"w-28 text-center bg-purple-600 py-2",children:"Avg Front"}),e.jsx("div",{className:"w-28 text-center bg-indigo-600 py-2 rounded-r-md",children:"Avg Back"})]}),[{name:"John Smith",units:45,gross:84500,avgFront:1250,avgBack:950},{name:"Jessica Lee",units:41,gross:78900,avgFront:1180,avgBack:920}].map((h,u)=>e.jsxs("div",{className:`flex items-center py-2 px-1 ${u!==1?"border-b":""} border-gray-100 text-sm hover:bg-gray-50`,children:[e.jsx("div",{className:"w-10 flex justify-center",children:u+1}),e.jsx("div",{className:"w-40 flex-shrink-0 font-medium px-2",children:h.name}),e.jsx("div",{className:"w-28 text-center",children:h.units}),e.jsxs("div",{className:"w-28 text-center",children:["$",h.gross.toLocaleString()]}),e.jsxs("div",{className:"w-28 text-center",children:["$",h.avgFront]}),e.jsxs("div",{className:"w-28 text-center",children:["$",h.avgBack]})]},u))]})})})]}),e.jsxs(B,{className:"col-span-12",children:[e.jsx(W,{className:"bg-blue-50 border-b border-blue-100",children:e.jsxs(z,{className:"text-lg font-semibold text-blue-700 flex items-center",children:[e.jsx(ta,{className:"h-5 w-5 text-yellow-500 mr-2"}),"The Das Board"]})}),e.jsx(V,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-full",children:[e.jsxs("div",{className:"flex items-center text-xs font-medium text-white border-b py-2 px-1",children:[e.jsx("div",{className:"w-10 text-center bg-gray-600 py-2 rounded-l-md",children:"#"}),e.jsx("div",{className:"w-40 flex-shrink-0 bg-gray-600 py-2 px-2",children:"Salesperson"}),e.jsxs("div",{className:"w-28 text-center bg-purple-600 py-2 flex items-center justify-center cursor-pointer hover:bg-purple-700",children:["PVR ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-center bg-green-600 py-2 flex items-center justify-center cursor-pointer hover:bg-green-700",children:["Total Gross ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-600 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-700",children:["Avg/Mo ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-500 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-600",children:["Last Mo ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-600 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-700",children:["YTD ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-28 text-center bg-blue-500 py-2 flex items-center justify-center cursor-pointer hover:bg-blue-600",children:["Annual ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-green-600 py-2 flex items-center justify-center cursor-pointer hover:bg-green-700",children:["New ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-24 text-center bg-amber-600 py-2 flex items-center justify-center cursor-pointer hover:bg-amber-700",children:["Used ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]}),e.jsxs("div",{className:"w-36 text-right bg-indigo-600 py-2 pr-3 flex items-center justify-end cursor-pointer hover:bg-indigo-700 font-semibold rounded-r-md",children:["Current Month ",e.jsx(ke,{className:"ml-1 h-3 w-3"})]})]}),e.jsx("div",{children:[{name:"Michael Scott",units:14,frontGross:18200,backGross:14300,totalGross:32500,avgMonth:12,lastMonth:15,ytd:82,annualPace:144,newUnits:9,usedUnits:5,pvr:2321},{name:"Jim Halpert",units:12,frontGross:16400,backGross:12500,totalGross:28900,avgMonth:10,lastMonth:11,ytd:65,annualPace:120,newUnits:7,usedUnits:5,pvr:2408},{name:"Dwight Schrute",units:11,frontGross:14800,backGross:11600,totalGross:26400,avgMonth:9,lastMonth:10,ytd:58,annualPace:108,newUnits:4,usedUnits:7,pvr:2400},{name:"Pam Beesly",units:9,frontGross:11900,backGross:9800,totalGross:21700,avgMonth:8,lastMonth:7,ytd:48,annualPace:96,newUnits:5,usedUnits:4,pvr:2411},{name:"Stanley Hudson",units:8,frontGross:10500,backGross:8700,totalGross:19200,avgMonth:7,lastMonth:9,ytd:42,annualPace:84,newUnits:3,usedUnits:5,pvr:2400}].map((h,u)=>e.jsxs("div",{className:`flex items-center py-2 px-1 ${u!==4?"border-b":""} border-gray-100 text-sm hover:bg-gray-50`,children:[e.jsx("div",{className:"w-10 flex justify-center",children:e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center
                          ${u===0?"bg-yellow-100 text-yellow-600":u===1?"bg-gray-100 text-gray-600":u===2?"bg-amber-100 text-amber-600":"bg-blue-50 text-blue-500"}`,children:e.jsx("span",{className:"text-xs font-bold",children:u+1})})}),e.jsx("div",{className:"w-40 flex-shrink-0 font-medium truncate px-2",children:h.name}),e.jsxs("div",{className:"w-28 text-center bg-purple-50",children:["$",h.pvr]}),e.jsxs("div",{className:"w-36 text-center bg-green-50",children:["$",h.totalGross.toLocaleString()]}),e.jsx("div",{className:"w-28 text-center bg-blue-50",children:h.avgMonth}),e.jsx("div",{className:"w-28 text-center",children:h.lastMonth}),e.jsx("div",{className:"w-28 text-center bg-blue-50",children:h.ytd}),e.jsx("div",{className:"w-28 text-center",children:h.annualPace}),e.jsx("div",{className:"w-24 text-center bg-green-50",children:h.newUnits}),e.jsx("div",{className:"w-24 text-center bg-amber-50",children:h.usedUnits}),e.jsx("div",{className:"w-36 text-right pr-3",children:e.jsx("span",{className:"text-lg font-bold text-indigo-700",children:h.units})})]},u))})]})})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-7 mb-6",children:[e.jsxs(B,{className:"col-span-4",children:[e.jsxs(W,{children:[e.jsx(z,{children:"Department Performance"}),e.jsx(Be,{children:"Overall business metrics for the current month"})]}),e.jsx(V,{className:"pl-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[100px] text-sm",children:"Sales"}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"bg-blue-500 h-2 w-[85%] rounded-full"})}),e.jsx("div",{className:"w-[50px] text-right text-sm",children:"85%"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[100px] text-sm",children:"Finance"}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"bg-green-500 h-2 w-[92%] rounded-full"})}),e.jsx("div",{className:"w-[50px] text-right text-sm",children:"92%"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[100px] text-sm",children:"Service"}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"bg-amber-500 h-2 w-[78%] rounded-full"})}),e.jsx("div",{className:"w-[50px] text-right text-sm",children:"78%"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[100px] text-sm",children:"Parts"}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"bg-purple-500 h-2 w-[68%] rounded-full"})}),e.jsx("div",{className:"w-[50px] text-right text-sm",children:"68%"})]})]})})]}),e.jsxs(B,{className:"col-span-3",children:[e.jsx(W,{children:e.jsx(z,{children:"Quick Actions"})}),e.jsxs(V,{className:"grid gap-4",children:[e.jsxs(I,{className:"w-full justify-start",children:[e.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Dealership Reports"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Staff Management"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",children:[e.jsx(e0,{className:"mr-2 h-4 w-4"}),"Inventory Overview"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",children:[e.jsx(bu,{className:"mr-2 h-4 w-4"}),"Financial Analysis"]})]})]})]})]})};function $s({value:t=0,max:s=100,className:r,indicatorClassName:n,...a}){const o=Math.min(Math.max(0,t/s*100),100);return e.jsx("div",{className:ge("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...a,children:e.jsx("div",{className:ge("h-full bg-primary transition-all",n),style:{width:`${o}%`}})})}const Un=[{id:"sales",name:"Sales"},{id:"finance_manager",name:"F&I Manager"},{id:"sales_manager",name:"Sales Manager"},{id:"general_manager",name:"General Manager"},{id:"viewer",name:"Viewer"}],qw=[{firstName:"John",lastName:"Smith",email:"john.smith@exampletest.com",roleId:"sales"},{firstName:"Emily",lastName:"Davis",email:"emily.davis@exampletest.com",roleId:"sales"},{firstName:"Carlos",lastName:"Rodriguez",email:"carlos.rodriguez@exampletest.com",roleId:"sales"},{firstName:"Sarah",lastName:"Johnson",email:"sarah.johnson@exampletest.com",roleId:"sales_manager"},{firstName:"David",lastName:"Chen",email:"david.chen@exampletest.com",roleId:"sales_manager"},{firstName:"Mike",lastName:"Williams",email:"mike.williams@exampletest.com",roleId:"finance_manager"},{firstName:"Lisa",lastName:"Taylor",email:"lisa.taylor@exampletest.com",roleId:"finance_manager"},{firstName:"Robert",lastName:"Thomas",email:"robert.thomas@exampletest.com",roleId:"general_manager"},{firstName:"Michelle",lastName:"Garcia",email:"michelle.garcia@exampletest.com",roleId:"general_manager"}];function Df(){const{user:t}=et(),{toast:s}=bl(),[r,n]=l.useState(!0),[a,o]=l.useState([]),[i,c]=l.useState({}),[d,m]=l.useState(""),[h,u]=l.useState(null),[f,b]=l.useState({firstName:"",lastName:"",email:"",roleId:""}),[p,x]=l.useState({roleId:"",front_end_percent:0,back_end_percent:0,csi_bonus:0,demo_allowance:0,vsc_bonus:0,ppm_bonus:0,volume_bonus:{}}),[v,y]=l.useState(""),[j,N]=l.useState(!1),[g,w]=l.useState(!1),[S,P]=l.useState(!1),[E,D]=l.useState(!1),[G,se]=l.useState(!1),[L,T]=l.useState([{level:"tier1",bonus:0},{level:"tier2",bonus:0},{level:"tier3",bonus:0}]),[A,Y]=l.useState(null),[te,xe]=l.useState({}),[le,Q]=l.useState([]);l.useEffect(()=>{(async()=>{n(!0);try{await Promise.all([pe(),Oe()])}catch($){console.error("Error fetching data:",$),s({title:"Error",description:"Failed to load dashboard data",variant:"destructive"})}finally{n(!1)}})()},[]);const pe=async()=>{try{const{data:_,error:$}=await J.from("profiles").select(`
          id, 
          email,
          role,
          created_at
        `).order("created_at",{ascending:!1});if($){console.error("Error fetching users:",$),s({title:"Error",description:"Failed to fetch users",variant:"destructive"});return}const Z=(_==null?void 0:_.map(de=>({id:de.id,first_name:de.email.split("@")[0].split(".")[0]||"User",last_name:de.email.split("@")[0].split(".")[1]||"",email:de.email,role:de.role||"user",role_id:de.role||"user",created_at:de.created_at})))||[];o(Z),console.log("Fetched users:",Z)}catch(_){console.error("Error fetching users:",_),s({title:"Error",description:"Failed to fetch users",variant:"destructive"})}},Pe=async()=>{var Z;D(!0);let _=0,$=0;try{for(const de of qw)try{const{data:we}=await J.from("profiles").select("email").eq("email",de.email).maybeSingle();if(we){console.log(`User ${de.email} already exists, skipping...`),$++;continue}const De="Password123!",{data:Ee,error:He}=await J.auth.signUp({email:de.email,password:De,options:{data:{role:de.roleId}}});if(He){console.error(`Error creating user ${de.email}:`,He);continue}const{error:$e}=await J.from("profiles").upsert({id:(Z=Ee==null?void 0:Ee.user)==null?void 0:Z.id,email:de.email,role:de.roleId});$e?console.error(`Error updating profile for ${de.email}:`,$e):_++}catch(we){console.error(`Error processing user ${de.email}:`,we)}await pe(),s({title:"Test Users Created",description:`${_} users created, ${$} already existed.`,duration:3e3})}catch(de){console.error("Error creating test users:",de),s({title:"Error",description:"Failed to create test users",variant:"destructive"})}finally{D(!1)}},Oe=async()=>{const{data:_,error:$}=await J.from("pay_plans").select("*");if($)throw $;const Z={};_==null||_.forEach(de=>{Z[de.role_id]={roleId:de.role_id,front_end_percent:de.front_end_percent,back_end_percent:de.back_end_percent,csi_bonus:de.csi_bonus,demo_allowance:de.demo_allowance,vsc_bonus:de.vsc_bonus,ppm_bonus:de.ppm_bonus,volume_bonus:de.volume_bonus||{}}}),c(Z)},qe=async()=>{try{if(!dealershipId)return;const{success:_,limits:$,add_ons:Z}=await Gx(dealershipId);if(_&&$){Y($),Q(Z||[]);const de={},we={sales_people:0,finance_managers:0,sales_managers:0,general_managers:0,finance_assistants:0,others:0};a.forEach(De=>{const Ee=M(De.role);we[Ee]=(we[Ee]||0)+1}),Object.keys($).forEach(De=>{de[De]={current:we[De]||0,limit:$[De]}}),xe(de)}}catch(_){console.error("Error fetching user limits:",_)}},M=_=>_.includes("sales")&&!_.includes("manager")?"sales_people":_.includes("finance")&&!_.includes("manager")&&!_.includes("director")?"finance_assistants":_.includes("finance")&&(_.includes("manager")||_.includes("director"))?"finance_managers":_.includes("sales")&&_.includes("manager")?"sales_managers":_.includes("general")&&_.includes("manager")?"general_managers":"others";l.useEffect(()=>{dealershipId&&(pe(),Oe(),qe())},[dealershipId]);const re=async _=>{var $;_.preventDefault(),D(!0);try{const{success:Z,canAdd:de,currentCount:we,limit:De}=await Bx(dealershipId||"",f.roleId);if(!Z)throw new Error("Failed to check user limits");if(!de)throw new Error(`Cannot add more users with this role. Limit reached (${we}/${De}). Consider upgrading your subscription.`);const{data:Ee,error:He}=await J.auth.signUp({email:f.email,password:O(),options:{data:{role:f.roleId||"viewer",dealership_id:dealershipId}}});if(He)throw He;const{error:$e}=await J.from("profiles").upsert({id:($=Ee==null?void 0:Ee.user)==null?void 0:$.id,email:f.email,role:f.roleId||"viewer",dealership_id:dealershipId,first_name:f.firstName,last_name:f.lastName});if($e)throw console.error("Error updating profile:",$e),$e;s({title:"Success",description:"User created successfully"}),b({firstName:"",lastName:"",email:"",roleId:Un[0].id}),await pe(),await qe()}catch(Z){console.error("Error creating user:",Z),s({title:"Error",description:Z instanceof Error?Z.message:"Failed to create user",variant:"destructive"})}finally{D(!1)}},ne=async _=>{if(_.preventDefault(),!g){ue();return}se(!0);try{const $=L.reduce((de,we)=>(we.bonus>0&&(de[we.level]=we.bonus),de),{}),{error:Z}=await J.rpc("update_pay_plan",{p_role_id:p.roleId,p_front_end_percent:p.front_end_percent,p_back_end_percent:p.back_end_percent,p_csi_bonus:p.csi_bonus,p_demo_allowance:p.demo_allowance,p_vsc_bonus:p.vsc_bonus,p_ppm_bonus:p.ppm_bonus,p_volume_bonus:$});if(Z)throw Z;s({title:"Success",description:"Pay plan updated successfully"}),x({roleId:"",front_end_percent:0,back_end_percent:0,csi_bonus:0,demo_allowance:0,vsc_bonus:0,ppm_bonus:0,volume_bonus:{}}),T([{level:"tier1",bonus:0},{level:"tier2",bonus:0},{level:"tier3",bonus:0}]),await Oe()}catch($){console.error("Error updating pay plan:",$),s({title:"Error",description:$.message||"Failed to update pay plan",variant:"destructive"})}finally{se(!1)}},O=()=>Math.random().toString(36).slice(-8)+Math.random().toString(36).toUpperCase().slice(-4),ue=async()=>{v==="admin123"?(w(!0),N(!0),s({title:"Authenticated",description:"You can now modify pay plans"})):s({title:"Error",description:"Invalid admin password",variant:"destructive"})},K=_=>{m(_);const $=i[_];if($){x({...$});const Z=[...L];Object.entries($.volume_bonus||{}).forEach(([de,we])=>{const De=Z.findIndex(Ee=>Ee.level===de);De>=0&&(Z[De].bonus=we)}),T(Z)}else x({roleId:_,front_end_percent:0,back_end_percent:0,csi_bonus:0,demo_allowance:0,vsc_bonus:0,ppm_bonus:0,volume_bonus:{}}),T([{level:"tier1",bonus:0},{level:"tier2",bonus:0},{level:"tier3",bonus:0}])},ce=(_,$)=>{const Z=[...L];Z[_].bonus=$,T(Z)},X=async(_,$)=>{try{const{error:Z}=await J.from("profiles").update({role:$}).eq("id",_);if(Z)throw Z;o(de=>de.map(we=>we.id===_?{...we,role:$,role_id:$,isEditing:!1}:we)),u(null),s({title:"Success",description:"User role updated successfully"})}catch(Z){console.error("Error updating user role:",Z),s({title:"Error",description:"Failed to update user role",variant:"destructive"})}},F=_=>{u(h===_?null:_)};return r?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(Je,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"container mx-auto p-4 space-y-8",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dealership Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users and pay plans for your dealership"})]}),e.jsxs(_r,{defaultValue:"users",className:"w-full",children:[e.jsxs(Xs,{className:"grid w-full grid-cols-3",children:[e.jsx(Ve,{value:"users",children:"User Management"}),e.jsx(Ve,{value:"payplans",children:"Pay Plan Setup"}),e.jsx(Ve,{value:"scheduler",children:"Dealership Hours"})]}),e.jsxs(ze,{value:"users",className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Add New User"}),e.jsx(Be,{children:"Create a new dealership staff account"})]}),e.jsx(V,{children:e.jsxs("form",{onSubmit:re,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"firstName",children:"First Name"}),e.jsx(be,{id:"firstName",value:f.firstName,onChange:_=>b({...f,firstName:_.target.value}),placeholder:"John",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"lastName",children:"Last Name"}),e.jsx(be,{id:"lastName",value:f.lastName,onChange:_=>b({...f,lastName:_.target.value}),placeholder:"Doe",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"email",children:"Dealership Email"}),e.jsx(be,{id:"email",type:"email",value:f.email,onChange:_=>b({...f,email:_.target.value}),placeholder:"john.doe@dealership.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"role",children:"Role"}),e.jsxs(mt,{value:f.roleId,onValueChange:_=>b({...f,roleId:_}),children:[e.jsx(rt,{id:"role",children:e.jsx(ht,{placeholder:"Select a role"})}),e.jsx(nt,{children:Un.map(_=>e.jsx(Re,{value:_.id,children:_.name},_.id))})]})]}),e.jsxs(I,{type:"submit",disabled:E,children:[E?e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Vs,{className:"mr-2 h-4 w-4"}),"Add User"]})]})})]}),e.jsxs(B,{className:"mb-6",children:[e.jsxs(W,{children:[e.jsx(z,{children:"User Capacity"}),e.jsxs(Be,{children:["User limits based on your subscription",le.length>0&&" and add-ons"]})]}),e.jsxs(V,{children:[le.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Active Add-ons:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:le.map(_=>e.jsx(Ue,{variant:"secondary",children:_==="plus"?"+ Version":_==="plusplus"?"++ Version":_},_))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(te).map(([_,$])=>e.jsxs("div",{className:"rounded-lg border p-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium capitalize",children:_.replace("_"," ")}),e.jsxs("span",{className:$.current>=$.limit?"text-red-500 font-bold":"",children:[$.current,"/",$.limit]})]}),e.jsx($s,{value:$.current/$.limit*100,className:$.current>=$.limit?"bg-red-200":""})]},_))})]})]}),e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Existing Users"}),e.jsx(Be,{children:"Manage dealership staff accounts"})]}),e.jsx(V,{children:a.length>0?e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Email"}),e.jsx(H,{children:"Role"}),e.jsx(H,{className:"w-[150px]",children:"Actions"})]})}),e.jsx(it,{children:a.map(_=>{var $;return e.jsxs(Se,{children:[e.jsxs(U,{className:"font-medium",children:[_.first_name," ",_.last_name]}),e.jsx(U,{children:_.email}),e.jsx(U,{children:h===_.id?e.jsxs(mt,{defaultValue:(($=Un.find(Z=>Z.name.toLowerCase()===_.role))==null?void 0:$.id)||"viewer",onValueChange:Z=>X(_.id,Z),children:[e.jsx(rt,{children:e.jsx(ht,{placeholder:"Select role"})}),e.jsx(nt,{children:Un.map(Z=>e.jsx(Re,{value:Z.id,children:Z.name},Z.id))})]}):e.jsx("span",{className:"px-2 py-1 bg-primary/10 text-primary rounded-full text-xs",children:_.role})}),e.jsx(U,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>F(_.id),children:h===_.id?e.jsx(sa,{className:"h-4 w-4"}):e.jsx(pr,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",children:e.jsx(qa,{className:"h-4 w-4"})})]})})]},_.id)})})]}):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No users found. Add your first user above."})})]}),e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Load Test Users"}),e.jsx(Be,{children:"Add test users to the system"})]}),e.jsxs(V,{children:[e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsx("p",{className:"text-sm",children:"This will create the following test users:"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md border",children:[e.jsx("p",{className:"font-medium mb-2",children:"Sales People:"}),e.jsxs("ul",{className:"text-sm list-disc pl-5 space-y-1 mb-3",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"John Smith"})," - john.smith@exampletest.com"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Emily Davis"})," - emily.davis@exampletest.com"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Carlos Rodriguez"})," - carlos.rodriguez@exampletest.com"]})]}),e.jsx("p",{className:"font-medium mb-2",children:"Sales Managers:"}),e.jsxs("ul",{className:"text-sm list-disc pl-5 space-y-1 mb-3",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Sarah Johnson"})," - sarah.johnson@exampletest.com"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"David Chen"})," - david.chen@exampletest.com"]})]}),e.jsx("p",{className:"font-medium mb-2",children:"F&I Managers:"}),e.jsxs("ul",{className:"text-sm list-disc pl-5 space-y-1 mb-3",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Mike Williams"})," - mike.williams@exampletest.com"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Lisa Taylor"})," - lisa.taylor@exampletest.com"]})]}),e.jsx("p",{className:"font-medium mb-2",children:"General Managers:"}),e.jsxs("ul",{className:"text-sm list-disc pl-5 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Robert Thomas"})," - robert.thomas@exampletest.com"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Michelle Garcia"})," - michelle.garcia@exampletest.com"]})]})]}),e.jsxs("p",{className:"text-sm text-amber-600 mt-2",children:["Note: All test users will be created with the password"," ",e.jsx("strong",{children:"Password123!"})]})]}),e.jsxs(I,{onClick:Pe,disabled:E,children:[E?e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Vs,{className:"mr-2 h-4 w-4"}),"Load Test Users"]})]})]})]}),e.jsx(ze,{value:"payplans",className:"space-y-6",children:e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Pay Plan Configuration"}),e.jsxs(Be,{children:["Set up compensation structures for different roles",!g&&e.jsxs("div",{className:"mt-2 text-sm text-yellow-600 bg-yellow-50 p-2 rounded border border-yellow-200",children:[e.jsx(m0,{className:"inline-block h-4 w-4 mr-1"}),"This section requires administrator verification"]})]})]}),e.jsx(V,{children:g?e.jsxs("form",{onSubmit:ne,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"payPlanRole",children:"Select Role to Configure"}),e.jsxs(mt,{value:p.roleId,onValueChange:K,children:[e.jsx(rt,{id:"payPlanRole",children:e.jsx(ht,{placeholder:"Select a role"})}),e.jsx(nt,{children:Un.map(_=>e.jsx(Re,{value:_.id,children:_.name},_.id))})]})]}),p.roleId&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"frontEndPercent",children:"Front End %"}),e.jsx(be,{id:"frontEndPercent",type:"number",min:"0",max:"100",step:"0.1",value:p.front_end_percent,onChange:_=>x({...p,front_end_percent:parseFloat(_.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"backEndPercent",children:"Back End %"}),e.jsx(be,{id:"backEndPercent",type:"number",min:"0",max:"100",step:"0.1",value:p.back_end_percent,onChange:_=>x({...p,back_end_percent:parseFloat(_.target.value)||0})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"csiBonus",children:"CSI Bonus ($)"}),e.jsx(be,{id:"csiBonus",type:"number",min:"0",step:"1",value:p.csi_bonus,onChange:_=>x({...p,csi_bonus:parseFloat(_.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"demoAllowance",children:"Demo Allowance ($)"}),e.jsx(be,{id:"demoAllowance",type:"number",min:"0",step:"1",value:p.demo_allowance,onChange:_=>x({...p,demo_allowance:parseFloat(_.target.value)||0})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"vscBonus",children:"VSC Bonus ($)"}),e.jsx(be,{id:"vscBonus",type:"number",min:"0",step:"1",value:p.vsc_bonus,onChange:_=>x({...p,vsc_bonus:parseFloat(_.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"ppmBonus",children:"PPM Bonus ($)"}),e.jsx(be,{id:"ppmBonus",type:"number",min:"0",step:"1",value:p.ppm_bonus,onChange:_=>x({...p,ppm_bonus:parseFloat(_.target.value)||0})})]})]}),e.jsxs("div",{children:[e.jsx(fe,{children:"Volume Bonus Tiers"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4 mt-2",children:L.map((_,$)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:`tier-${$}`,children:_.level==="tier1"?"Tier 1 (1-10 units)":_.level==="tier2"?"Tier 2 (11-20 units)":"Tier 3 (21+ units)"}),e.jsx(be,{id:`tier-${$}`,type:"number",min:"0",step:"1",value:_.bonus,onChange:Z=>ce($,parseFloat(Z.target.value)||0)})]},_.level))})]}),e.jsxs(I,{type:"submit",disabled:G||!p.roleId,children:[G?e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ea,{className:"mr-2 h-4 w-4"}),"Save Pay Plan"]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"adminPassword",children:"Admin Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{id:"adminPassword",type:S?"text":"password",value:v,onChange:_=>y(_.target.value),placeholder:"Enter admin password to unlock"}),e.jsx("button",{type:"button",onClick:()=>P(!S),className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:S?e.jsx(xl,{className:"h-4 w-4"}):e.jsx(pl,{className:"h-4 w-4"})})]})]}),e.jsxs(I,{onClick:ue,children:[e.jsx(u0,{className:"mr-2 h-4 w-4"}),"Unlock Pay Plan Management"]})]})}),e.jsx($t,{className:"bg-gray-50 border-t",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pay plans are confidential and should only be modified by authorized personnel. All changes are logged for auditing purposes."})})]})}),e.jsx(ze,{value:"scheduler",className:"space-y-6",children:e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Dealership Schedule"}),e.jsx(Be,{children:"Configure your dealership's operating hours for the scheduling system"})]}),e.jsx(V,{children:e.jsxs("form",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(_=>e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx("div",{children:e.jsx(fe,{className:"text-base",children:_})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:`${_.toLowerCase()}-open`,children:"Open"}),e.jsxs(mt,{defaultValue:"09:00",children:[e.jsx(rt,{id:`${_.toLowerCase()}-open`,children:e.jsx(ht,{placeholder:"Open Time"})}),e.jsx(nt,{children:Array.from({length:13},($,Z)=>Z+6).map($=>e.jsx(Re,{value:`${$}:00`,children:$>12?`${$-12}:00 PM`:$===12?"12:00 PM":`${$}:00 AM`},`${$}:00`))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:`${_.toLowerCase()}-close`,children:"Close"}),e.jsxs(mt,{defaultValue:"18:00",children:[e.jsx(rt,{id:`${_.toLowerCase()}-close`,children:e.jsx(ht,{placeholder:"Close Time"})}),e.jsx(nt,{children:Array.from({length:13},($,Z)=>Z+10).map($=>e.jsx(Re,{value:`${$}:00`,children:$>12?`${$-12}:00 PM`:$===12?"12:00 PM":`${$}:00 AM`},`${$}:00`))})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(fe,{htmlFor:`${_.toLowerCase()}-closed`,className:"flex items-center space-x-2 cursor-pointer",children:e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"checkbox",id:`${_.toLowerCase()}-closed`,className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",defaultChecked:_==="Sunday"}),e.jsx("span",{className:"ml-2 text-sm",children:"Closed"})]})})})]},_))}),e.jsxs(I,{type:"submit",children:[e.jsx(ea,{className:"mr-2 h-4 w-4"}),"Save Schedule"]})]})}),e.jsx($t,{className:"bg-gray-50 border-t",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"These hours will be used by the scheduling system to determine when appointments can be booked."})})]})})]})]})}function Yw(){const{user:t,dealershipId:s}=et(),[r,n]=l.useState([]),[a,o]=l.useState([{id:"salesperson",name:"Sales Person"},{id:"finance_manager",name:"F&I Manager"},{id:"sales_manager",name:"Sales Manager"},{id:"general_manager",name:"General Manager"},{id:"finance_director",name:"Finance Director"},{id:"finance_assistant",name:"Finance Assistant"},{id:"gsm",name:"GSM"}]),[i,c]=l.useState({email:"",firstName:"",lastName:"",roleId:"",phoneNumber:"",password:""}),[d,m]=l.useState(null),[h,u]=l.useState(null),[f,b]=l.useState(!0),[p,x]=l.useState(!1),[v,y]=l.useState(!1),[j,N]=l.useState({});l.useEffect(()=>{s&&(g(),w())},[s]);const g=async()=>{try{const A=(await Td()).find(Y=>Y.id===s);if(A){m(A);const Y=A.settings||{user_limits:{sales_people:10,finance_managers:3,sales_managers:3,general_managers:1,finance_directors:0,finance_assistants:0,gsm:0},add_ons:[],tier:"dealership"};u(Y),console.log("[DealershipUserManagement] Dealership settings:",Y)}}catch(T){console.error("[DealershipUserManagement] Error fetching dealership info:",T),Le({title:"Error",description:"Failed to fetch dealership information",variant:"destructive"})}},w=async()=>{try{if(b(!0),!s)throw new Error("No dealership ID available");const T=await Md(s);n(T);const A={};T.forEach(Y=>{A[Y.role_id]=(A[Y.role_id]||0)+1}),N(A),console.log("[DealershipUserManagement] User counts by role:",A)}catch(T){console.error("[DealershipUserManagement] Error fetching users:",T),Le({title:"Error",description:"Failed to fetch users",variant:"destructive"})}finally{b(!1)}},S=T=>{const{name:A,value:Y}=T.target;c(te=>({...te,[A]:Y}))},P=T=>{c(A=>({...A,roleId:T}))},E=()=>{const T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()";let A="";for(let Y=0;Y<12;Y++)A+=T.charAt(Math.floor(Math.random()*T.length));c(Y=>({...Y,password:A}))},D=T=>{if(!h||!h.user_limits)return!1;const A=h.user_limits,Y=j[T]||0;switch(T){case"salesperson":return Y>=A.sales_people;case"finance_manager":return Y>=A.finance_managers;case"sales_manager":return Y>=A.sales_managers;case"general_manager":return Y>=A.general_managers;case"finance_director":return Y>=A.finance_directors;case"finance_assistant":return Y>=A.finance_assistants;case"gsm":return Y>=A.gsm;default:return!1}},G=T=>{if(!h||!h.user_limits)return 0;const A=h.user_limits;switch(T){case"salesperson":return A.sales_people;case"finance_manager":return A.finance_managers;case"sales_manager":return A.sales_managers;case"general_manager":return A.general_managers;case"finance_director":return A.finance_directors;case"finance_assistant":return A.finance_assistants;case"gsm":return A.gsm;default:return 0}},se=async T=>{T.preventDefault();try{if(x(!0),!s)throw new Error("No dealership ID available");if(!i.email||!i.firstName||!i.lastName||!i.roleId)throw new Error("Please fill in all required fields");if(D(i.roleId))throw new Error("User limit for this role has been reached. Consider upgrading your subscription.");const A={email:i.email,password:i.password||Math.random().toString(36).slice(-12)+"A1!",first_name:i.firstName,last_name:i.lastName,role_id:i.roleId,phone_number:i.phoneNumber||void 0};console.log("[DealershipUserManagement] Creating new user:",A);const Y=await Vx(s,A);console.log("[DealershipUserManagement] User created successfully:",Y),Le({title:"Success",description:"User created successfully"}),c({email:"",firstName:"",lastName:"",roleId:"",phoneNumber:"",password:""}),y(!1),w()}catch(A){console.error("[DealershipUserManagement] Error creating user:",A),Le({title:"Error",description:A instanceof Error?A.message:"Failed to create user",variant:"destructive"})}finally{x(!1)}},L=({roleId:T,label:A})=>{const Y=j[T]||0,te=G(T),xe=Y>=te;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-sm font-medium",children:A}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:`text-sm ${xe?"text-red-400":"text-green-400"}`,children:[Y,"/",te]}),xe?e.jsx(va,{className:"ml-1 h-4 w-4 text-red-400"}):e.jsx(Cn,{className:"ml-1 h-4 w-4 text-green-400"})]})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"User Management"}),e.jsxs(jr,{open:v,onOpenChange:y,children:[e.jsx(co,{asChild:!0,children:e.jsxs(I,{className:"bg-gradient-to-r from-light-orange to-dark-orange text-white hover:scale-105 transition-all duration-300",children:[e.jsx(Zn,{className:"mr-2 h-4 w-4"}),"Add New User"]})}),e.jsxs(qs,{className:"bg-card-dark p-6 rounded-lg glow-card max-w-md mx-auto",children:[e.jsxs(Ys,{children:[e.jsx(Js,{className:"text-xl text-white mb-2",children:"Add New User"}),e.jsx(Qs,{children:"Create a new user for your dealership. They will receive an email with login instructions."})]}),e.jsxs("form",{onSubmit:se,className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"firstName",children:"First Name *"}),e.jsx(be,{id:"firstName",name:"firstName",value:i.firstName,onChange:S,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(be,{id:"lastName",name:"lastName",value:i.lastName,onChange:S,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"email",children:"Email *"}),e.jsx(be,{id:"email",name:"email",type:"email",value:i.email,onChange:S,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(be,{id:"phoneNumber",name:"phoneNumber",value:i.phoneNumber,onChange:S})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"role",children:"Role *"}),e.jsxs(mt,{value:i.roleId,onValueChange:P,children:[e.jsx(rt,{children:e.jsx(ht,{placeholder:"Select a role"})}),e.jsx(nt,{children:a.map(T=>{const A=D(T.id),Y=G(T.id);return e.jsxs(Re,{value:T.id,disabled:A,children:[T.name," ",Y>0?`(${j[T.id]||0}/${Y})`:"",A&&" - Limit reached"]},T.id)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(fe,{htmlFor:"password",children:"Temporary Password"}),e.jsx(I,{type:"button",variant:"link",className:"text-blue-400 px-0 py-0 h-auto text-xs",onClick:E,children:"Generate"})]}),e.jsx(be,{id:"password",name:"password",value:i.password,onChange:S,placeholder:"Leave blank to auto-generate"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"User will be prompted to change their password on first login."})]}),e.jsx(Ks,{children:e.jsx(I,{type:"submit",disabled:p,className:"bg-gradient-to-r from-light-orange to-dark-orange text-white px-4 py-2 rounded-md hover:scale-105 transition-all duration-300 w-full",children:p?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create User"})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(B,{className:"bg-card-dark p-6 rounded-lg glow-card",children:[e.jsxs(W,{className:"p-0 pb-4",children:[e.jsx(z,{className:"text-lg text-white",children:"User Limits"}),e.jsx(Be,{children:"Based on your subscription tier and add-ons"})]}),e.jsxs(V,{className:"p-0",children:[(h==null?void 0:h.add_ons)&&h.add_ons.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Active Add-Ons:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.add_ons.includes("plus")&&e.jsx(Ue,{className:"bg-blue-900/20 text-blue-400 border-blue-800",children:"+ Version"}),h.add_ons.includes("plusplus")&&e.jsx(Ue,{className:"bg-indigo-900/20 text-indigo-400 border-indigo-800",children:"++ Version"})]})]}),e.jsxs("div",{className:"space-y-1 border-t border-gray-700 pt-3",children:[e.jsx(L,{roleId:"salesperson",label:"Sales People"}),e.jsx(L,{roleId:"finance_manager",label:"F&I Managers"}),e.jsx(L,{roleId:"sales_manager",label:"Sales Managers"}),e.jsx(L,{roleId:"general_manager",label:"General Managers"}),e.jsx(L,{roleId:"finance_director",label:"Finance Directors"}),e.jsx(L,{roleId:"finance_assistant",label:"Finance Assistants"}),e.jsx(L,{roleId:"gsm",label:"GSM"})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-700",children:e.jsx(I,{variant:"outline",className:"w-full",onClick:()=>window.open("/upgrade","_blank"),children:"Upgrade Subscription"})})]})]}),e.jsxs(B,{className:"md:col-span-2 bg-card-dark p-6 rounded-lg glow-card",children:[e.jsxs(W,{className:"p-0 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(z,{className:"text-lg text-white",children:"Users"}),e.jsx(I,{variant:"outline",size:"sm",onClick:w,disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."]}):"Refresh"})]}),e.jsx(Be,{children:"Manage users for your dealership"})]}),e.jsx(V,{className:"p-0 pt-4",children:f?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(Je,{className:"h-8 w-8 animate-spin text-blue-500"})}):r.length===0?e.jsxs("div",{className:"text-center p-8 border border-dashed border-gray-700 rounded-lg",children:[e.jsx(Ur,{className:"h-12 w-12 mx-auto text-gray-500 mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-1",children:"No Users Yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add your first user to get started"}),e.jsxs(I,{onClick:()=>y(!0),className:"bg-gradient-to-r from-light-orange to-dark-orange text-white",children:[e.jsx(Zn,{className:"mr-2 h-4 w-4"}),"Add First User"]})]}):e.jsx("div",{className:"border rounded-md border-gray-700",children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{className:"bg-deep-black text-white text-lg font-semibold",children:[e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Email"}),e.jsx(H,{children:"Role"}),e.jsx(H,{children:"Added"}),e.jsx(H,{className:"text-right",children:"Actions"})]})}),e.jsx(it,{children:r.map(T=>{var A;return e.jsxs(Se,{className:"border-gray-700",children:[e.jsx(U,{className:"font-medium text-gray-300",children:T.name}),e.jsx(U,{className:"text-gray-300",children:T.email}),e.jsx(U,{children:((A=a.find(Y=>Y.id===T.role_id))==null?void 0:A.name)||T.role_id}),e.jsx(U,{className:"text-gray-400",children:new Date(T.created_at).toLocaleDateString()}),e.jsx(U,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"ghost",size:"icon",children:e.jsx(pr,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"icon",children:e.jsx(Oi,{className:"h-4 w-4 text-red-500"})})]})})]},T.id)})})]})})})]})]})]})}function Kw(){const{user:t,dealershipId:s}=et(),[r,n]=l.useState("dashboard");return e.jsx(vt,{title:"Admin Dashboard",children:e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs(_r,{defaultValue:"dashboard",className:"space-y-6",onValueChange:n,children:[e.jsxs(Xs,{className:"grid w-full grid-cols-3",children:[e.jsx(Ve,{value:"dashboard",children:"Dashboard"}),e.jsx(Ve,{value:"users",children:"User Management"}),e.jsx(Ve,{value:"settings",children:"Settings"})]}),e.jsx(ze,{value:"dashboard",className:"space-y-6",children:e.jsx(Df,{})}),e.jsx(ze,{value:"users",className:"space-y-6",children:e.jsx(Yw,{})}),e.jsx(ze,{value:"settings",className:"space-y-6",children:e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Dealership Settings"}),e.jsx(Be,{children:"Configure your dealership settings and preferences"})]}),e.jsx(V,{children:e.jsx("p",{children:"Settings panel coming soon..."})})]})})]})})})}function Jw(){const{user:t}=et(),s=yt(),{toast:r}=bl(),[n,a]=l.useState(!0),[o,i]=l.useState("dealerships"),[c,d]=l.useState([]),[m,h]=l.useState([]),[u,f]=l.useState([]),[b,p]=l.useState(""),[x,v]=l.useState("all"),[y,j]=l.useState("all"),[N,g]=l.useState("all"),[w,S]=l.useState(null),[P,E]=l.useState(null),[D,G]=l.useState(null),[se,L]=l.useState(!1),[T,A]=l.useState(null),[Y,te]=l.useState(null),[xe,le]=l.useState([]),[Q,pe]=l.useState(null),[Pe,Oe]=l.useState([]),[qe,M]=l.useState(null),[re,ne]=l.useState(null),[O,ue]=l.useState(!1),[K,ce]=l.useState({name:"",location:"",schedule_type:"Standard",pay_config_id:1}),[X,F]=l.useState(""),[_,$]=l.useState(null),[Z,de]=l.useState([]),[we,De]=l.useState([]),[Ee,He]=l.useState(0),[$e,zt]=l.useState(0),[ct,pt]=l.useState(""),[Qe,gt]=l.useState(""),[dt,gs]=l.useState([]),[Ct,It]=l.useState(!1),[vs,Ts]=l.useState(null),[Pt,Ms]=l.useState([]),[Mt,Jo]=l.useState("level_1");l.useEffect(()=>{var ee;if(t){const Ne=((ee=t.email)==null?void 0:ee.split("@")[0])||"Admin";F(Ne.charAt(0).toUpperCase()+Ne.slice(1).replace(/\./g," "))}},[t]),l.useEffect(()=>{(async()=>{try{if(a(!0),console.log("[GroupAdminDashboard] Loading mock data for admin panel"),$r()){console.log("[GroupAdminDashboard] Direct auth user detected, using mock data");const Ne={monday:{open:"09:00",close:"20:00",closed:!1},tuesday:{open:"09:00",close:"20:00",closed:!1},wednesday:{open:"09:00",close:"20:00",closed:!1},thursday:{open:"09:00",close:"20:00",closed:!1},friday:{open:"09:00",close:"20:00",closed:!1},saturday:{open:"10:00",close:"18:00",closed:!1},sunday:{open:"11:00",close:"16:00",closed:!0}},Ze={dealership_id:0,min_sales_per_month:8,target_sales_per_month:12,min_gross_per_unit:1200,target_gross_per_unit:1800,min_csi_score:85,optimal_team_size:5,max_teams:4,performance_weight:{volume:40,gross:40,csi:20}},Ye=[{id:1,name:"Downtown Motors",location:"Downtown",schedule_type:"Standard",working_hours:"Mon-Sat: 9AM-8PM, Sun: 11AM-6PM",pay_config_id:1,pay_config_name:"Standard Commission",schedule:{...Ne,sunday:{open:"11:00",close:"18:00",closed:!1}},scheduler_config:{...Ze,dealership_id:1,min_sales_per_month:10,target_sales_per_month:15,optimal_team_size:6}},{id:2,name:"Westside Auto",location:"West Side",schedule_type:"Extended",working_hours:"Mon-Sat: 8AM-9PM, Sun: 10AM-7PM",pay_config_id:2,pay_config_name:"Performance Plus",schedule:{...Ne,monday:{open:"08:00",close:"21:00",closed:!1},tuesday:{open:"08:00",close:"21:00",closed:!1},wednesday:{open:"08:00",close:"21:00",closed:!1},thursday:{open:"08:00",close:"21:00",closed:!1},friday:{open:"08:00",close:"21:00",closed:!1},saturday:{open:"09:00",close:"21:00",closed:!1},sunday:{open:"10:00",close:"19:00",closed:!1}},scheduler_config:{...Ze,dealership_id:2,min_sales_per_month:8,target_sales_per_month:12}},{id:3,name:"Eastside Dealership",location:"East Side",schedule_type:"Standard",working_hours:"Mon-Sat: 9AM-8PM, Sun: Closed",pay_config_id:1,pay_config_name:"Standard Commission",schedule:{...Ne,sunday:{open:"10:00",close:"16:00",closed:!0}},scheduler_config:{...Ze,dealership_id:3,optimal_team_size:4,max_teams:3}}],_t=[{id:1,name:"John Smith",email:"john.smith@example.com",role:"sales_person",dealership_id:1,dealership_name:"Downtown Motors",team:"Team A",status:"active",created_at:"2023-01-15T08:30:00Z",last_login:"2023-05-05T14:22:10Z"},{id:2,name:"Sarah Johnson",email:"sarah.j@example.com",role:"sales_person",dealership_id:2,dealership_name:"Westside Auto",team:"Team B",status:"active",created_at:"2023-02-10T10:15:00Z",last_login:"2023-05-04T16:45:30Z"},{id:3,name:"Robert Davis",email:"robert.d@example.com",role:"sales_manager",dealership_id:1,dealership_name:"Downtown Motors",team:"Team A",status:"active",created_at:"2022-11-20T09:00:00Z",last_login:"2023-05-05T11:20:15Z"},{id:4,name:"Michael Lee",email:"michael.lee@example.com",role:"finance_manager",dealership_id:1,dealership_name:"Downtown Motors",team:"Team A",status:"active",created_at:"2022-12-05T14:30:00Z",last_login:"2023-05-04T09:15:45Z"},{id:5,name:"Jessica Chen",email:"j.chen@example.com",role:"finance_director",dealership_id:3,dealership_name:"Eastside Dealership",team:"Team C",status:"active",created_at:"2023-01-25T11:45:00Z",last_login:"2023-05-03T15:30:20Z"},{id:6,name:"David Wilson",email:"david.w@example.com",role:"general_manager",dealership_id:2,dealership_name:"Westside Auto",team:"Team B",status:"active",created_at:"2022-09-15T08:00:00Z",last_login:"2023-05-05T08:10:05Z"},{id:7,name:"Amanda Harris",email:"a.harris@example.com",role:"sales_person",dealership_id:3,dealership_name:"Eastside Dealership",team:"Team C",status:"inactive",created_at:"2022-10-10T09:30:00Z",last_login:"2023-04-15T10:20:30Z"},{id:8,name:"Thomas Parker",email:"t.parker@example.com",role:"general_sales_manager",dealership_id:1,dealership_name:"Downtown Motors",team:"Team A",status:"active",created_at:"2022-08-20T10:30:00Z",last_login:"2023-05-05T09:45:30Z"}],Ft=[{id:1,name:"Sales Compensation Plans",description:"Compensation plans for sales staff",role_type:"sales",commission_structure:"Varies by template",bonus_structure:"Varies by template",templates:[{id:101,name:"Standard Sales Commission",description:"Base salary plus graduated commission on sales",role_type:"sales_person",configuration:{base_salary:3e3,commission_tiers:[{tier:1,threshold:0,rate:.05},{tier:2,threshold:10,rate:.075},{tier:3,threshold:20,rate:.1}],volume_bonus:{amount:500,threshold:10},spiffs:[{name:"New Vehicle",amount:100},{name:"Used Vehicle",amount:75}]}},{id:102,name:"Performance Plus",description:"Lower base with higher commission potential",role_type:"sales_person",configuration:{base_salary:2e3,commission_tiers:[{tier:1,threshold:0,rate:.07},{tier:2,threshold:8,rate:.1},{tier:3,threshold:16,rate:.15}],volume_bonus:{amount:1e3,threshold:15},spiffs:[{name:"New Vehicle",amount:150},{name:"Used Vehicle",amount:100}]}}]},{id:2,name:"Finance Compensation Plans",description:"Compensation plans for finance department",role_type:"finance",commission_structure:"Percentage of backend",bonus_structure:"Product-based incentives",templates:[{id:201,name:"Standard Finance Manager Plan",description:"Percentage of back-end gross with product bonuses",role_type:"finance_manager",configuration:{base_salary:4e3,backend_percentage:.08,product_bonuses:[{name:"VSA",amount:100,threshold:10},{name:"GAP",amount:75,threshold:8},{name:"PPM",amount:150,threshold:5}],csi_bonus:{threshold:90,amount:500}}},{id:202,name:"Finance Director Plan",description:"Department performance with individual metrics",role_type:"finance_director",configuration:{base_salary:6e3,backend_percentage:.05,department_bonus:{threshold:15e4,percentage:.02},product_penetration_bonus:{vsa_threshold:40,gap_threshold:35,ppm_threshold:25,amount:1e3}}}]},{id:3,name:"Management Compensation Plans",description:"Compensation plans for management staff",role_type:"management",commission_structure:"Dealership performance",bonus_structure:"Quarterly & annual targets",templates:[{id:301,name:"Sales Manager Plan",description:"Front-end focused with team performance",role_type:"sales_manager",configuration:{base_salary:5e3,frontend_percentage:.05,backend_percentage:.02,team_performance:{unit_threshold:50,amount:1e3},demo_allowance:800}},{id:302,name:"General Sales Manager Plan",description:"Overall sales department performance",role_type:"general_sales_manager",configuration:{base_salary:7e3,frontend_percentage:.04,backend_percentage:.025,department_bonus:{threshold:100,amount:2e3},quarterly_bonus:{threshold_percentage:110,amount:5e3},demo_allowance:1e3}},{id:303,name:"General Manager Plan",description:"Overall dealership performance",role_type:"general_manager",configuration:{base_salary:1e4,store_profit_percentage:.05,quarterly_target_bonus:{threshold_percentage:100,amount:1e4},annual_bonus:{threshold_percentage:105,amount:5e4},demo_allowance:1200}}]}],ks=[{user_id:1,name:"John Smith",email:"john.smith@example.com",team:"Team A",dealership_id:1,dealership_name:"Downtown Motors",units_sold:14,avg_gross_per_unit:1750,total_gross:24500,csi_score:92,performance_score:87,recommendation:"maintain",months_data:[{month:"Jan",units:12,gross:18e3},{month:"Feb",units:10,gross:16500},{month:"Mar",units:15,gross:24e3},{month:"Apr",units:11,gross:18500},{month:"May",units:14,gross:24500},{month:"Jun",units:13,gross:22e3}]},{user_id:2,name:"Sarah Johnson",email:"sarah.j@example.com",team:"Team B",dealership_id:2,dealership_name:"Westside Auto",units_sold:8,avg_gross_per_unit:2100,total_gross:16800,csi_score:88,performance_score:78,recommendation:"coach",months_data:[{month:"Jan",units:7,gross:14e3},{month:"Feb",units:9,gross:18e3},{month:"Mar",units:6,gross:12500},{month:"Apr",units:10,gross:19e3},{month:"May",units:8,gross:16800},{month:"Jun",units:7,gross:15e3}]},{user_id:7,name:"Amanda Harris",email:"a.harris@example.com",team:"Team C",dealership_id:3,dealership_name:"Eastside Dealership",units_sold:6,avg_gross_per_unit:1050,total_gross:6300,csi_score:81,performance_score:58,recommendation:"review",months_data:[{month:"Jan",units:8,gross:9e3},{month:"Feb",units:7,gross:7500},{month:"Mar",units:6,gross:6800},{month:"Apr",units:5,gross:5500},{month:"May",units:6,gross:6300},{month:"Jun",units:4,gross:4200}]},{user_id:10,name:"Mark Thompson",email:"m.thompson@example.com",team:"Team A",dealership_id:1,dealership_name:"Downtown Motors",units_sold:18,avg_gross_per_unit:1900,total_gross:34200,csi_score:95,performance_score:94,recommendation:"promote",months_data:[{month:"Jan",units:15,gross:28e3},{month:"Feb",units:16,gross:3e4},{month:"Mar",units:14,gross:27e3},{month:"Apr",units:17,gross:32e3},{month:"May",units:18,gross:34200},{month:"Jun",units:16,gross:31e3}]},{user_id:12,name:"Emily Chen",email:"e.chen@example.com",team:"Team B",dealership_id:2,dealership_name:"Westside Auto",units_sold:7,avg_gross_per_unit:950,total_gross:6650,csi_score:79,performance_score:52,recommendation:"reassign",months_data:[{month:"Jan",units:9,gross:9500},{month:"Feb",units:8,gross:8200},{month:"Mar",units:8,gross:7800},{month:"Apr",units:6,gross:6e3},{month:"May",units:7,gross:6650},{month:"Jun",units:5,gross:4800}]}],rs=Ye.filter(ns=>ns.scheduler_config).map(ns=>ns.scheduler_config);h(Ye),d(_t),f(Ft),le(ks),Oe(rs),console.log("[GroupAdminDashboard] Mock data loaded successfully"),a(!1)}else console.log("[GroupAdminDashboard] No direct auth user, would fetch from Supabase"),a(!1)}catch(Ne){console.error("[GroupAdminDashboard] Error loading data:",Ne),a(!1)}})()},[]);const Tn=()=>{let ee=c;if(w&&(ee=c.filter(Ne=>Ne.dealership_id===w.id)),P)switch(P){case"sales":ee=ee.filter(Ne=>Ne.role==="sales_person");break;case"finance":ee=ee.filter(Ne=>Ne.role==="finance_manager"||Ne.role==="finance_director");break;case"sales_managers":ee=ee.filter(Ne=>Ne.role==="sales_manager"||Ne.role==="general_sales_manager");break;case"general_manager":ee=ee.filter(Ne=>Ne.role==="general_manager");break}return ee.filter(Ne=>{const Ze=b===""||Ne.name.toLowerCase().includes(b.toLowerCase())||Ne.email.toLowerCase().includes(b.toLowerCase()),Ye=N==="all"||Ne.status===N;return Ze&&Ye})},Qo=ee=>{switch(ee){case"sales_person":return"Sales Person";case"sales_manager":return"Sales Manager";case"general_sales_manager":return"General Sales Manager";case"finance_manager":return"Finance Manager";case"finance_director":return"Finance Director";case"general_manager":return"General Manager";default:return ee.replace("_"," ")}},Mn=ee=>{s(`/dashboard/admin?dealership=${ee.id}`)},Sa=()=>{S(null),E(null),i("dealerships")},Zs=ee=>{A(ee),te(ee.schedule||null),L(!0)},Ca=()=>{if(!K.name||!K.location){r({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}const ee={id:m.length?Math.max(...m.map(Ne=>Ne.id))+1:1,name:K.name,location:K.location,schedule_type:K.schedule_type,working_hours:"Mon-Sat: 9AM-8PM, Sun: 11AM-6PM",pay_config_id:K.pay_config_id,pay_config_name:"Standard Pay Plan",schedule:{monday:{open:"09:00",close:"20:00",closed:!1},tuesday:{open:"09:00",close:"20:00",closed:!1},wednesday:{open:"09:00",close:"20:00",closed:!1},thursday:{open:"09:00",close:"20:00",closed:!1},friday:{open:"09:00",close:"20:00",closed:!1},saturday:{open:"10:00",close:"18:00",closed:!1},sunday:{open:"11:00",close:"16:00",closed:!0}}};h([...m,ee]),ue(!1),ce({name:"",location:"",schedule_type:"Standard",pay_config_id:1}),r({title:"Success",description:`Dealership "${K.name}" has been created.`,variant:"default"})};l.useEffect(()=>{(async()=>{var Ne,Ze,Ye,_t;try{a(!0),console.log("[GroupAdminDashboard] Fetching group data and dealerships");const Ft=await gr();if(!Ft){console.error("[GroupAdminDashboard] No authenticated user");return}const ks=((Ne=Ft.user_metadata)==null?void 0:Ne.name)||((Ze=Ft.email)==null?void 0:Ze.split("@")[0])||"Admin";F(ks);const rs=(Ye=Ft.user_metadata)==null?void 0:Ye.group_id;if(!rs){console.error("[GroupAdminDashboard] User is not associated with a dealership group");return}const{data:ns,error:_a}=await J.from("dealership_groups").select("*").eq("id",rs).single();if(_a||!ns){console.error("[GroupAdminDashboard] Error fetching group:",_a);return}$(ns),console.log("[GroupAdminDashboard] Fetched group:",ns);const Rs=ns.settings||{};Jo(Rs.level||"level_1"),Ms(Rs.add_ons||[]);const kn=Rs.user_limits||{sales_people:10,finance_managers:3,sales_managers:3,general_managers:1,finance_directors:0,finance_assistants:0,gsm:0,area_vps:0};Ts(kn);const Zo=kn.area_vps||0;zt(Zo),console.log("[GroupAdminDashboard] Group level:",Rs.level),console.log("[GroupAdminDashboard] Add-ons:",Rs.add_ons),console.log("[GroupAdminDashboard] User limits:",kn);const{data:as,error:Da}=await J.from("dealerships").select("*").eq("group_id",rs).order("name");if(Da){console.error("[GroupAdminDashboard] Error fetching dealerships:",Da);return}de(as),console.log("[GroupAdminDashboard] Fetched dealerships:",as.length);const{data:Ht,error:Aa}=await J.from("area_vps").select("*").eq("group_id",rs);Aa?console.error("[GroupAdminDashboard] Error fetching Area VPs:",Aa):(De(Ht||[]),He((Ht==null?void 0:Ht.length)||0),console.log("[GroupAdminDashboard] Fetched Area VPs:",Ht==null?void 0:Ht.length)),((_t=Rs.add_ons)==null?void 0:_t.includes("plusplus"))&&(console.log("[GroupAdminDashboard] Group has unlimited Area VPs"),zt(999));const ti=Math.max(0,$e-((Ht==null?void 0:Ht.length)||0));console.log("[GroupAdminDashboard] Remaining AVP slots:",ti),IS_DEV&&as.length;const C=as.map(ae=>{var ve,he,Ge,Ke,kt,Lt;const ye=((ve=ae.settings)==null?void 0:ve.schedule)||DEFAULT_SCHEDULE;return{id:ae.id,name:ae.name,location:((Ge=(he=ae.locations)==null?void 0:he[0])==null?void 0:Ge.address)||"No location",schedule_type:((Ke=ae.settings)==null?void 0:Ke.schedule_type)||"Standard",working_hours:getWorkingHoursString(ye),pay_config_id:((kt=ae.settings)==null?void 0:kt.pay_config_id)||1,pay_config_name:getPayConfigName((Lt=ae.settings)==null?void 0:Lt.pay_config_id),schedule:ye}});h(C);const k={level_1:{min:2,max:5},level_2:{min:6,max:15},level_3:{min:16,max:999}},R=Rs.level||"level_1",ie=k[R]||k.level_1;console.log("[GroupAdminDashboard] Dealership count:",as.length),console.log("[GroupAdminDashboard] Group level limits:",ie),R!=="level_3"&&as.length>=ie.max-1&&r({title:"Approaching Dealership Limit",description:`Your group is approaching the maximum of ${ie.max} dealerships for your current plan level.`,variant:"warning"})}catch(Ft){console.error("[GroupAdminDashboard] Error in fetchGroupAndDealerships:",Ft),r({title:"Error",description:"Failed to load group data",variant:"destructive"})}finally{a(!1)}})()},[]);const Dr=async ee=>{try{console.log(`[GroupAdminDashboard] Fetching users for dealership ${ee}`),a(!0),Mn(Z.find(Ye=>Ye.id===ee)||null);const Ne=await Md(ee);console.log(`[GroupAdminDashboard] Fetched ${Ne.length} users`);const Ze=Ne.map(Ye=>{var _t;return{id:Ye.id,name:`${Ye.first_name} ${Ye.last_name}`,email:Ye.email,role:((_t=Ye.roles)==null?void 0:_t.name)||"Unknown",dealership_id:ee,dealership_name:(w==null?void 0:w.name)||"Unknown",status:"active",created_at:Ye.created_at||new Date().toISOString()}});d(Ze)}catch(Ne){console.error(`[GroupAdminDashboard] Error fetching users for dealership ${ee}:`,Ne),d(mockUsers)}finally{a(!1)}},Pa=async()=>{try{if(It(!0),console.log("[GroupAdminDashboard] Adding Area VP:",{name:Qe,email:ct,dealershipCount:dt.length,dealershipIds:dt,groupLevel:Mt,addOns:Pt,currentAvpCount:Ee,maxAvpCount:$e}),!ct||!Qe||dt.length===0||!_){r({title:"Error",description:"Please provide all required information",variant:"destructive"});return}if(Ee>=$e&&$e!==999&&!Pt.includes("plusplus")){r({title:"Limit Reached",description:`You've reached the maximum of ${$e} Area VPs allowed in your plan. Upgrade to ++ Version for unlimited Area VPs.`,variant:"destructive"});return}const ee=generatePassword(),{data:Ne,error:Ze}=await J.from("roles").select("id").eq("name","area_vp").single();if(Ze||!Ne)throw new Error("Could not find Area VP role");const{data:Ye,error:_t}=await J.auth.admin.createUser({email:ct,password:ee,email_confirm:!0,user_metadata:{first_name:Qe.split(" ")[0],last_name:Qe.split(" ").slice(1).join(" "),role_id:Ne.id,is_area_vp:!0,group_id:_.id,dealership_ids:dt,group_level:Mt,group_add_ons:Pt,created_at:new Date().toISOString()}});if(_t)throw _t;const{error:Ft}=await J.from("profiles").upsert({id:Ye.user.id,name:Qe,email:ct,role_id:Ne.id,is_area_vp:!0,group_id:_.id,created_at:new Date().toISOString(),last_sign_in:null});Ft&&console.warn("[GroupAdminDashboard] Error creating profile record:",Ft);const{data:ks,error:rs}=await J.from("area_vps").insert({user_id:Ye.user.id,group_id:_.id,dealerships:dt,created_by:t==null?void 0:t.id,created_at:new Date().toISOString(),settings:{group_level:Mt,add_ons:Pt,dealership_count:dt.length}}).select().single();if(rs)throw rs;console.log("[GroupAdminDashboard] Area VP created successfully:",{id:ks.id,userId:Ye.user.id,dealershipCount:dt.length}),De([...we,{id:ks.id,user_id:Ye.user.id,name:Qe,email:ct,dealerships:dt,created_at:ks.created_at}]),He(Ee+1),pt(""),gt(""),gs([]),r({title:"Success",description:`Area VP ${Qe} added successfully. An email with login instructions will be sent.`}),console.log(`[GroupAdminDashboard] Temporary password for ${Qe}: ${ee}`),r({title:"Demo: Temporary Password",description:ee,variant:"default"})}catch(ee){console.error("[GroupAdminDashboard] Error adding Area VP:",ee),r({title:"Error",description:ee instanceof Error?ee.message:"Failed to add Area VP",variant:"destructive"})}finally{It(!1)}},Ie=async(ee,Ne)=>{try{console.log(`[GroupAdminDashboard] Removing Area VP ${ee}`);const{error:Ze}=await J.from("area_vps").delete().eq("id",ee);if(Ze)throw Ze;const{error:Ye}=await J.auth.admin.updateUserById(Ne,{user_metadata:{is_area_vp:!1,is_deactivated:!0}});Ye&&console.warn("[GroupAdminDashboard] Error updating user status:",Ye),De(we.filter(_t=>_t.id!==ee)),He(Ee-1),r({title:"Success",description:"Area VP removed successfully"})}catch(Ze){console.error("[GroupAdminDashboard] Error removing Area VP:",Ze),r({title:"Error",description:Ze instanceof Error?Ze.message:"Failed to remove Area VP",variant:"destructive"})}},Xo=ee=>{gs(Ne=>Ne.includes(ee)?Ne.filter(Ze=>Ze!==ee):[...Ne,ee])};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Dealership Group Administration"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_c,{className:"h-5 w-5 text-gray-500"}),e.jsx("span",{className:"font-medium",children:X})]})]}),e.jsxs(_r,{defaultValue:o,onValueChange:i,className:"space-y-4",children:[e.jsxs(Xs,{className:"flex justify-center",children:[e.jsxs(Ve,{value:"dealerships",className:"flex items-center",children:[e.jsx(Kn,{className:"h-4 w-4 mr-2"}),"Dealerships"]}),e.jsxs(Ve,{value:"pay-config",className:"flex items-center",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Pay Configuration"]}),e.jsxs(Ve,{value:"schedule",className:"flex items-center",children:[e.jsx(wo,{className:"h-4 w-4 mr-2"}),"Scheduling"]}),e.jsxs(Ve,{value:"dynamic-scheduler",className:"flex items-center",children:[e.jsx(d0,{className:"h-4 w-4 mr-2"}),"Dynamic Scheduler"]}),e.jsxs(Ve,{value:"area-vps",onClick:()=>i("area-vps"),children:[e.jsx(b0,{className:"w-4 h-4 mr-2"}),"Area VPs"]})]}),e.jsx(ze,{value:"dealerships",className:"space-y-4",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx(z,{children:"Dealership Settings"}),e.jsx(Be,{children:"Select a dealership to manage staff and configurations"})]}),e.jsxs(I,{onClick:()=>ue(!0),children:[e.jsx(Vs,{className:"h-4 w-4 mr-2"}),"Add Dealership"]})]})}),e.jsx(V,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Z.map(ee=>e.jsxs(B,{className:"border shadow-sm",children:[e.jsxs(W,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(z,{children:ee.name}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(pr,{className:"h-4 w-4"})})})]}),e.jsx(Be,{children:ee.location})]}),e.jsx(V,{className:"pb-2",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Schedule Type"}),e.jsx("p",{className:"text-sm",children:ee.schedule_type}),e.jsx("h4",{className:"text-sm font-medium mt-3 mb-1",children:"Pay Configuration"}),e.jsx("p",{className:"text-sm",children:ee.pay_config_name}),e.jsx("h4",{className:"text-sm font-medium mt-3 mb-1",children:"Staff Count"}),e.jsxs("p",{className:"text-sm",children:[c.filter(Ne=>Ne.dealership_id===ee.id&&Ne.status==="active").length," ","active staff members"]})]})}),e.jsx($t,{className:"pt-0",children:e.jsxs(I,{variant:"default",size:"sm",onClick:()=>Dr(ee.id),children:[e.jsx(Kn,{className:"h-4 w-4 mr-2"}),"Manage Dealership",e.jsx(gu,{className:"h-4 w-4 ml-2"})]})})]},ee.id))})})]})}),e.jsx(jr,{open:O,onOpenChange:ue,children:e.jsxs(qs,{className:"sm:max-w-md",children:[e.jsxs(Ys,{children:[e.jsx(Js,{children:"Add New Dealership"}),e.jsx(Qs,{children:"Enter the details for the new dealership location."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(fe,{htmlFor:"name",className:"text-right",children:"Name"}),e.jsx(be,{id:"name",value:K.name,onChange:ee=>ce({...K,name:ee.target.value}),className:"col-span-3",placeholder:"Enter dealership name"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(fe,{htmlFor:"location",className:"text-right",children:"Location"}),e.jsx(be,{id:"location",value:K.location,onChange:ee=>ce({...K,location:ee.target.value}),className:"col-span-3",placeholder:"City, State"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(fe,{htmlFor:"schedule-type",className:"text-right",children:"Schedule Type"}),e.jsxs(mt,{value:K.schedule_type,onValueChange:ee=>ce({...K,schedule_type:ee}),children:[e.jsx(rt,{className:"col-span-3",children:e.jsx(ht,{placeholder:"Select schedule type"})}),e.jsxs(nt,{children:[e.jsx(Re,{value:"Standard",children:"Standard"}),e.jsx(Re,{value:"Flexible",children:"Flexible"}),e.jsx(Re,{value:"Extended",children:"Extended Hours"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(fe,{htmlFor:"pay-config",className:"text-right",children:"Pay Configuration"}),e.jsxs(mt,{value:K.pay_config_id.toString(),onValueChange:ee=>ce({...K,pay_config_id:parseInt(ee)}),children:[e.jsx(rt,{className:"col-span-3",children:e.jsx(ht,{placeholder:"Select pay configuration"})}),e.jsxs(nt,{children:[e.jsx(Re,{value:"1",children:"Standard Pay Plan"}),e.jsx(Re,{value:"2",children:"Performance Based"}),e.jsx(Re,{value:"3",children:"Volume Incentive"})]})]})]})]}),e.jsxs(Ks,{children:[e.jsx(I,{variant:"outline",onClick:()=>ue(!1),children:"Cancel"}),e.jsx(I,{onClick:Ca,children:"Add Dealership"})]})]})}),e.jsx(ze,{value:"dealership-view",className:"space-y-4",children:w&&e.jsxs(B,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx(z,{children:w.name}),e.jsxs(Be,{children:[w.location," | ",w.pay_config_name]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"outline",onClick:Sa,children:"Back to Dealerships"}),e.jsxs(I,{variant:"outline",onClick:()=>Zs(w),children:[e.jsx(fr,{className:"h-4 w-4 mr-2"}),"Configure Schedule"]}),e.jsxs(I,{onClick:()=>setIsAddUserModalOpen(!0),children:[e.jsx(eo,{className:"h-4 w-4 mr-2"}),"Add New User"]})]})]})}),e.jsxs(V,{children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[e.jsxs(I,{variant:P===null?"default":"outline",onClick:()=>E(null),children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"All Staff"]}),e.jsxs(I,{variant:P==="sales"?"default":"outline",onClick:()=>E("sales"),children:[e.jsx(_c,{className:"h-4 w-4 mr-2"}),"Sales People"]}),e.jsxs(I,{variant:P==="finance"?"default":"outline",onClick:()=>E("finance"),children:[e.jsx(jo,{className:"h-4 w-4 mr-2"}),"Finance Managers"]}),e.jsxs(I,{variant:P==="sales_managers"?"default":"outline",onClick:()=>E("sales_managers"),children:[e.jsx(vu,{className:"h-4 w-4 mr-2"}),"Sales Managers"]}),e.jsxs(I,{variant:P==="general_manager"?"default":"outline",onClick:()=>E("general_manager"),children:[e.jsx(Kn,{className:"h-4 w-4 mr-2"}),"General Manager"]})]}),e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:space-y-0 md:space-x-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(gl,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(be,{type:"search",placeholder:"Search users...",className:"pl-8 w-full",value:b,onChange:ee=>p(ee.target.value)})]}),e.jsxs(mt,{value:N,onValueChange:g,children:[e.jsx(rt,{className:"w-[180px]",children:e.jsx(ht,{placeholder:"Filter by status"})}),e.jsxs(nt,{children:[e.jsx(Re,{value:"all",children:"All Statuses"}),e.jsx(Re,{value:"active",children:"Active"}),e.jsx(Re,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Team #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Tn().map(ee=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ee.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ee.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(Ue,{variant:"outline",children:Qo(ee.role)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ee.team||"Unassigned"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(Ue,{variant:ee.status==="active"?"default":"secondary",className:ee.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:ee.status==="active"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(pr,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(Oi,{className:"h-4 w-4"})})]})})]},ee.id))})]})}),Tn().length===0&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(Vt,{className:"mx-auto h-10 w-10 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No users found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No users match your search criteria."})]})]}),e.jsx($t,{children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",Tn().length," of"," ",c.filter(ee=>ee.dealership_id===w.id).length," users at this dealership"]})})]})}),e.jsx(ze,{value:"area-vps",className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Area VP Management"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[Ee," / ",$e===999?"":$e," Area VPs"]})})]}),e.jsxs("div",{className:"bg-card-dark p-4 rounded-md glow-card",children:[e.jsx("h4",{className:"font-medium text-white mb-2",children:"Your Subscription"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(Ue,{variant:"outline",className:"bg-gray-800 text-white",children:["Group Level: ",Mt==null?void 0:Mt.replace("_"," ")]}),Pt==null?void 0:Pt.map(ee=>e.jsx(Ue,{variant:"outline",className:ee==="plus"?"bg-blue-900/50 text-blue-200":"bg-purple-900/50 text-purple-200",children:ee==="plus"?"+ Version":"++ Version"},ee))]}),e.jsx("p",{className:"text-sm text-gray-400",children:$e===0?"Your current subscription does not include Area VPs. Upgrade to + Version for 1-2 Area VPs or ++ Version for unlimited Area VPs.":$e===999?"Your subscription includes unlimited Area VPs.":`Your subscription allows up to ${$e} Area VP${$e>1?"s":""}.`})]}),e.jsxs(B,{className:"bg-card-dark border-gray-700",children:[e.jsxs(W,{children:[e.jsx(z,{className:"text-white",children:"Current Area VPs"}),e.jsx(Be,{children:"Manage Area VPs who oversee multiple dealerships"})]}),e.jsx(V,{children:we.length===0?e.jsx("div",{className:"text-center py-6 text-gray-400",children:"No Area VPs have been assigned yet."}):e.jsx("div",{className:"space-y-4",children:we.map(ee=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-700 rounded-md",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:ee.name}),e.jsx("div",{className:"text-sm text-gray-400",children:ee.email}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Managing ",ee.dealerships.length," dealership(s)"]})]}),e.jsx(I,{variant:"outline",className:"border-red-700 hover:bg-red-900/20 text-red-400",onClick:()=>Ie(ee.id,ee.user_id),children:e.jsx(Oi,{className:"w-4 h-4"})})]},ee.id))})}),e.jsx($t,{children:e.jsxs(I,{onClick:()=>It(!0),className:"w-full",disabled:Ee>=$e||$e===0,children:[e.jsx(eo,{className:"w-4 h-4 mr-2"}),"Add Area VP"]})})]}),e.jsx(jr,{open:Ct,onOpenChange:It,children:e.jsxs(qs,{className:"bg-gray-800 text-white border-gray-700",children:[e.jsxs(Ys,{children:[e.jsx(Js,{children:"Add New Area VP"}),e.jsx(Qs,{children:"Area VPs can manage multiple dealerships across your group."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"avp-name",children:"Name"}),e.jsx(be,{id:"avp-name",placeholder:"Enter full name",value:Qe,onChange:ee=>gt(ee.target.value),className:"bg-gray-700 border-gray-600"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"avp-email",children:"Email"}),e.jsx(be,{id:"avp-email",type:"email",placeholder:"Enter email address",value:ct,onChange:ee=>pt(ee.target.value),className:"bg-gray-700 border-gray-600"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{children:"Assign Dealerships"}),e.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-40 overflow-y-auto p-2 bg-gray-900 rounded-md",children:Z.map(ee=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`dealership-${ee.id}`,checked:dt.includes(ee.id),onChange:()=>Xo(ee.id),className:"w-4 h-4"}),e.jsx("label",{htmlFor:`dealership-${ee.id}`,className:"text-sm",children:ee.name})]},ee.id))}),dt.length===0&&e.jsx("p",{className:"text-xs text-amber-400 mt-1",children:"Please select at least one dealership"})]})]}),e.jsxs(Ks,{children:[e.jsx(I,{variant:"outline",onClick:()=>It(!1),children:"Cancel"}),e.jsx(I,{onClick:Pa,disabled:!ct||!Qe||dt.length===0,children:"Add Area VP"})]})]})})]})})]})]})}function ps(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function zr(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}const Af=6048e5,Qw=864e5;let Xw={};function zo(){return Xw}function ca(t,s){var c,d,m,h;const r=zo(),n=(s==null?void 0:s.weekStartsOn)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((h=(m=r.locale)==null?void 0:m.options)==null?void 0:h.weekStartsOn)??0,a=ps(t),o=a.getDay(),i=(o<n?7:0)+o-n;return a.setDate(a.getDate()-i),a.setHours(0,0,0,0),a}function mo(t){return ca(t,{weekStartsOn:1})}function Ef(t){const s=ps(t),r=s.getFullYear(),n=zr(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=mo(n),o=zr(t,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const i=mo(o);return s.getTime()>=a.getTime()?r+1:s.getTime()>=i.getTime()?r:r-1}function ld(t){const s=ps(t);return s.setHours(0,0,0,0),s}function cd(t){const s=ps(t),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+t-+r}function Zw(t,s){const r=ld(t),n=ld(s),a=+r-cd(r),o=+n-cd(n);return Math.round((a-o)/Qw)}function eN(t){const s=Ef(t),r=zr(t,0);return r.setFullYear(s,0,4),r.setHours(0,0,0,0),mo(r)}function tN(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function sN(t){if(!tN(t)&&typeof t!="number")return!1;const s=ps(t);return!isNaN(Number(s))}function rN(t){const s=ps(t),r=zr(t,0);return r.setFullYear(s.getFullYear(),0,1),r.setHours(0,0,0,0),r}const nN={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},aN=(t,s,r)=>{let n;const a=nN[t];return typeof a=="string"?n=a:s===1?n=a.one:n=a.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function yi(t){return(s={})=>{const r=s.width?String(s.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const oN={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},iN={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lN={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},cN={date:yi({formats:oN,defaultWidth:"full"}),time:yi({formats:iN,defaultWidth:"full"}),dateTime:yi({formats:lN,defaultWidth:"full"})},dN={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},uN=(t,s,r,n)=>dN[t];function $n(t){return(s,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,c=r!=null&&r.width?String(r.width):i;a=t.formattingValues[c]||t.formattingValues[i]}else{const i=t.defaultWidth,c=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[c]||t.values[i]}const o=t.argumentCallback?t.argumentCallback(s):s;return a[o]}}const mN={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},hN={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},fN={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},xN={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},pN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},gN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},vN=(t,s)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},bN={ordinalNumber:vN,era:$n({values:mN,defaultWidth:"wide"}),quarter:$n({values:hN,defaultWidth:"wide",argumentCallback:t=>t-1}),month:$n({values:fN,defaultWidth:"wide"}),day:$n({values:xN,defaultWidth:"wide"}),dayPeriod:$n({values:pN,defaultWidth:"wide",formattingValues:gN,defaultFormattingWidth:"wide"})};function Gn(t){return(s,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=s.match(a);if(!o)return null;const i=o[0],c=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],d=Array.isArray(c)?jN(c,u=>u.test(i)):yN(c,u=>u.test(i));let m;m=t.valueCallback?t.valueCallback(d):d,m=r.valueCallback?r.valueCallback(m):m;const h=s.slice(i.length);return{value:m,rest:h}}}function yN(t,s){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&s(t[r]))return r}function jN(t,s){for(let r=0;r<t.length;r++)if(s(t[r]))return r}function wN(t){return(s,r={})=>{const n=s.match(t.matchPattern);if(!n)return null;const a=n[0],o=s.match(t.parsePattern);if(!o)return null;let i=t.valueCallback?t.valueCallback(o[0]):o[0];i=r.valueCallback?r.valueCallback(i):i;const c=s.slice(a.length);return{value:i,rest:c}}}const NN=/^(\d+)(th|st|nd|rd)?/i,SN=/\d+/i,CN={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},PN={any:[/^b/i,/^(a|c)/i]},_N={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},DN={any:[/1/i,/2/i,/3/i,/4/i]},AN={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},EN={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},TN={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},MN={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kN={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},RN={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},IN={ordinalNumber:wN({matchPattern:NN,parsePattern:SN,valueCallback:t=>parseInt(t,10)}),era:Gn({matchPatterns:CN,defaultMatchWidth:"wide",parsePatterns:PN,defaultParseWidth:"any"}),quarter:Gn({matchPatterns:_N,defaultMatchWidth:"wide",parsePatterns:DN,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Gn({matchPatterns:AN,defaultMatchWidth:"wide",parsePatterns:EN,defaultParseWidth:"any"}),day:Gn({matchPatterns:TN,defaultMatchWidth:"wide",parsePatterns:MN,defaultParseWidth:"any"}),dayPeriod:Gn({matchPatterns:kN,defaultMatchWidth:"any",parsePatterns:RN,defaultParseWidth:"any"})},FN={code:"en-US",formatDistance:aN,formatLong:cN,formatRelative:uN,localize:bN,match:IN,options:{weekStartsOn:0,firstWeekContainsDate:1}};function LN(t){const s=ps(t);return Zw(s,rN(s))+1}function ON(t){const s=ps(t),r=+mo(s)-+eN(s);return Math.round(r/Af)+1}function Tf(t,s){var h,u,f,b;const r=ps(t),n=r.getFullYear(),a=zo(),o=(s==null?void 0:s.firstWeekContainsDate)??((u=(h=s==null?void 0:s.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??a.firstWeekContainsDate??((b=(f=a.locale)==null?void 0:f.options)==null?void 0:b.firstWeekContainsDate)??1,i=zr(t,0);i.setFullYear(n+1,0,o),i.setHours(0,0,0,0);const c=ca(i,s),d=zr(t,0);d.setFullYear(n,0,o),d.setHours(0,0,0,0);const m=ca(d,s);return r.getTime()>=c.getTime()?n+1:r.getTime()>=m.getTime()?n:n-1}function UN(t,s){var c,d,m,h;const r=zo(),n=(s==null?void 0:s.firstWeekContainsDate)??((d=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((h=(m=r.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,a=Tf(t,s),o=zr(t,0);return o.setFullYear(a,0,n),o.setHours(0,0,0,0),ca(o,s)}function $N(t,s){const r=ps(t),n=+ca(r,s)-+UN(r,s);return Math.round(n/Af)+1}function We(t,s){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(s,"0");return r+n}const rr={y(t,s){const r=t.getFullYear(),n=r>0?r:1-r;return We(s==="yy"?n%100:n,s.length)},M(t,s){const r=t.getMonth();return s==="M"?String(r+1):We(r+1,2)},d(t,s){return We(t.getDate(),s.length)},a(t,s){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,s){return We(t.getHours()%12||12,s.length)},H(t,s){return We(t.getHours(),s.length)},m(t,s){return We(t.getMinutes(),s.length)},s(t,s){return We(t.getSeconds(),s.length)},S(t,s){const r=s.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return We(a,s.length)}},Qr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},dd={G:function(t,s,r){const n=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,s,r){if(s==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return rr.y(t,s)},Y:function(t,s,r,n){const a=Tf(t,n),o=a>0?a:1-a;if(s==="YY"){const i=o%100;return We(i,2)}return s==="Yo"?r.ordinalNumber(o,{unit:"year"}):We(o,s.length)},R:function(t,s){const r=Ef(t);return We(r,s.length)},u:function(t,s){const r=t.getFullYear();return We(r,s.length)},Q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(n);case"QQ":return We(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(n);case"qq":return We(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,s,r){const n=t.getMonth();switch(s){case"M":case"MM":return rr.M(t,s);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,s,r){const n=t.getMonth();switch(s){case"L":return String(n+1);case"LL":return We(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,s,r,n){const a=$N(t,n);return s==="wo"?r.ordinalNumber(a,{unit:"week"}):We(a,s.length)},I:function(t,s,r){const n=ON(t);return s==="Io"?r.ordinalNumber(n,{unit:"week"}):We(n,s.length)},d:function(t,s,r){return s==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):rr.d(t,s)},D:function(t,s,r){const n=LN(t);return s==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):We(n,s.length)},E:function(t,s,r){const n=t.getDay();switch(s){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,s,r,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(s){case"e":return String(o);case"ee":return We(o,2);case"eo":return r.ordinalNumber(o,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,s,r,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(s){case"c":return String(o);case"cc":return We(o,s.length);case"co":return r.ordinalNumber(o,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,s,r){const n=t.getDay(),a=n===0?7:n;switch(s){case"i":return String(a);case"ii":return We(a,s.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,s,r){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,s,r){const n=t.getHours();let a;switch(n===12?a=Qr.noon:n===0?a=Qr.midnight:a=n/12>=1?"pm":"am",s){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,s,r){const n=t.getHours();let a;switch(n>=17?a=Qr.evening:n>=12?a=Qr.afternoon:n>=4?a=Qr.morning:a=Qr.night,s){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,s,r){if(s==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return rr.h(t,s)},H:function(t,s,r){return s==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):rr.H(t,s)},K:function(t,s,r){const n=t.getHours()%12;return s==="Ko"?r.ordinalNumber(n,{unit:"hour"}):We(n,s.length)},k:function(t,s,r){let n=t.getHours();return n===0&&(n=24),s==="ko"?r.ordinalNumber(n,{unit:"hour"}):We(n,s.length)},m:function(t,s,r){return s==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):rr.m(t,s)},s:function(t,s,r){return s==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):rr.s(t,s)},S:function(t,s){return rr.S(t,s)},X:function(t,s,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(s){case"X":return md(n);case"XXXX":case"XX":return Ar(n);case"XXXXX":case"XXX":default:return Ar(n,":")}},x:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"x":return md(n);case"xxxx":case"xx":return Ar(n);case"xxxxx":case"xxx":default:return Ar(n,":")}},O:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+ud(n,":");case"OOOO":default:return"GMT"+Ar(n,":")}},z:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+ud(n,":");case"zzzz":default:return"GMT"+Ar(n,":")}},t:function(t,s,r){const n=Math.trunc(t.getTime()/1e3);return We(n,s.length)},T:function(t,s,r){const n=t.getTime();return We(n,s.length)}};function ud(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),o=n%60;return o===0?r+String(a):r+String(a)+s+We(o,2)}function md(t,s){return t%60===0?(t>0?"-":"+")+We(Math.abs(t)/60,2):Ar(t,s)}function Ar(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=We(Math.trunc(n/60),2),o=We(n%60,2);return r+a+s+o}const hd=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Mf=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},GN=(t,s)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return hd(t,s);let o;switch(n){case"P":o=s.dateTime({width:"short"});break;case"PP":o=s.dateTime({width:"medium"});break;case"PPP":o=s.dateTime({width:"long"});break;case"PPPP":default:o=s.dateTime({width:"full"});break}return o.replace("{{date}}",hd(n,s)).replace("{{time}}",Mf(a,s))},BN={p:Mf,P:GN},VN=/^D+$/,WN=/^Y+$/,zN=["D","DD","YY","YYYY"];function HN(t){return VN.test(t)}function qN(t){return WN.test(t)}function YN(t,s,r){const n=KN(t,s,r);if(console.warn(n),zN.includes(t))throw new RangeError(n)}function KN(t,s,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const JN=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,QN=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,XN=/^'([^]*?)'?$/,ZN=/''/g,e1=/[a-zA-Z]/;function t1(t,s,r){var h,u,f,b;const n=zo(),a=n.locale??FN,o=n.firstWeekContainsDate??((u=(h=n.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,i=n.weekStartsOn??((b=(f=n.locale)==null?void 0:f.options)==null?void 0:b.weekStartsOn)??0,c=ps(t);if(!sN(c))throw new RangeError("Invalid time value");let d=s.match(QN).map(p=>{const x=p[0];if(x==="p"||x==="P"){const v=BN[x];return v(p,a.formatLong)}return p}).join("").match(JN).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const x=p[0];if(x==="'")return{isToken:!1,value:s1(p)};if(dd[x])return{isToken:!0,value:p};if(x.match(e1))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(d=a.localize.preprocessor(c,d));const m={firstWeekContainsDate:o,weekStartsOn:i,locale:a};return d.map(p=>{if(!p.isToken)return p.value;const x=p.value;(qN(x)||HN(x))&&YN(x,s,String(t));const v=dd[x[0]];return v(c,x,a.localize,m)}).join("")}function s1(t){const s=t.match(XN);return s?s[1].replace(ZN,"'"):t}function r1(){var v,y,j,N,g,w,S,P,E,D,G,se,L,T,A,Y,te,xe,le,Q,pe,Pe,Oe,qe,M,re,ne,O,ue,K,ce,X;yt();const[t,s]=l.useState(!0),[r,n]=l.useState("overview"),[a,o]=l.useState([]),[i,c]=l.useState(null),[d,m]=l.useState([]),[h,u]=l.useState(!1);l.useEffect(()=>{f()},[]);const f=async()=>{try{s(!0),console.log("[AVPDashboard] Fetching Area VP data");const{data:{user:F}}=await J.auth.getUser();if(!F)throw new Error("Not authenticated");const{data:_,error:$}=await J.from("area_vps").select("*, dealership_groups(id, name, settings)").eq("user_id",F.id).single();if($||!_)throw console.error("[AVPDashboard] Error fetching AVP data:",$),new Error("You do not have Area VP permissions.");const Z=_.dealership_groups,de=_.dealerships||[];if(console.log("[AVPDashboard] AVP data retrieved:",{avpId:_.id,dealershipCount:de.length,groupId:Z==null?void 0:Z.id,groupSettings:Z==null?void 0:Z.settings}),de.length===0){console.warn("[AVPDashboard] No dealerships assigned to this Area VP"),o([]),s(!1);return}const we=(Z==null?void 0:Z.settings)||{},De=we.level||"level_1",Ee=we.add_ons||[],He=we.user_limits||{sales_people:10,finance_managers:3,sales_managers:3,general_managers:1};console.log("[AVPDashboard] Group settings:",{level:De,addOns:Ee,userLimits:He});const{data:$e,error:zt}=await J.from("dealerships").select("id, name, schema_name, locations, settings, group_id").in("id",de);if(zt)throw console.error("[AVPDashboard] Error fetching dealership data:",zt),new Error("Failed to fetch dealership data");console.log("[AVPDashboard] Retrieved dealership data for",$e.length,"dealerships");const ct=await Promise.all($e.map(async pt=>{var dt,gs;let Qe={todaySales:0,monthSales:0,goalProgress:0},gt={total:0,salesPeople:0,financeManagers:0,managers:0};try{const{data:Ct,error:It}=await J.from("profiles").select("id, role_id").eq("dealership_id",pt.id);!It&&Ct&&(gt.total=Ct.length,gt.salesPeople=Math.floor(Ct.length*.6),gt.financeManagers=Math.floor(Ct.length*.2),gt.managers=Math.floor(Ct.length*.2));const{data:vs,error:Ts}=await J.from("deals").select("id, sale_date").eq("dealership_id",pt.id).gte("sale_date",new Date(new Date().setDate(1)).toISOString());if(!Ts&&vs){Qe.monthSales=vs.length;const Pt=new Date().toISOString().split("T")[0];Qe.todaySales=vs.filter(Mt=>Mt.sale_date.startsWith(Pt)).length;const Ms=((dt=pt.settings)==null?void 0:dt.monthly_sales_goal)||100;Qe.goalProgress=Math.min(100,Math.floor(Qe.monthSales/Ms*100))}}catch(Ct){console.warn(`[AVPDashboard] Error fetching metrics for dealership ${pt.id}:`,Ct),Qe={todaySales:Math.floor(Math.random()*10),monthSales:Math.floor(Math.random()*100),goalProgress:Math.floor(Math.random()*100)},gt={total:Math.floor(Math.random()*50)+10,salesPeople:Math.floor(Math.random()*30)+5,financeManagers:Math.floor(Math.random()*5)+1,managers:Math.floor(Math.random()*5)+1}}return{...pt,performance:Qe,userCounts:gt,userLimits:{...He,...((gs=pt.settings)==null?void 0:gs.user_limits)||{}},capacity:{salesPeople:Math.floor(gt.salesPeople/He.sales_people*100),financeManagers:Math.floor(gt.financeManagers/He.finance_managers*100),managers:Math.floor(gt.managers/(He.sales_managers+He.general_managers)*100)}}}));o(ct),console.log("[AVPDashboard] Enhanced dealership data:",ct)}catch(F){console.error("[AVPDashboard] Error in fetchAvpData:",F),Le({title:"Error",description:F instanceof Error?F.message:"Failed to load Area VP data",variant:"destructive"})}finally{s(!1)}},b=async F=>{try{u(!0);const{data:_,error:$}=await J.from("profiles").select("id, name, email, role, dealership_id, last_login").eq("dealership_id",F);if($)throw $;const Z=_.map(de=>({...de,dealership_name:(i==null?void 0:i.name)||"Unknown Dealership"}));m(Z)}catch(_){console.error("Error fetching dealership users:",_),Le({title:"Error",description:"Failed to load dealership users",variant:"destructive"}),m([])}finally{u(!1)}},p=F=>{const _=a.find($=>$.id===F);_&&(c(_),b(F))},x=()=>{c(null),m([])};return t?e.jsx("div",{className:"container mx-auto py-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Je,{className:"h-12 w-12 animate-spin text-primary"})})}):i?e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs(I,{variant:"ghost",onClick:x,className:"mb-6",children:[e.jsx(yo,{className:"mr-2 h-4 w-4"})," Back to Dealerships"]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:i.name}),i.group_id&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Dealer Group: ",((v=i.dealership_groups)==null?void 0:v.name)||"Unknown Group"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(Ue,{variant:"outline",className:"text-sm",children:["Schema: ",i.schema_name]}),e.jsx(Ue,{variant:"outline",className:"text-sm",children:"Area VP Dashboard"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Today's Sales"})}),e.jsx(V,{children:e.jsx("div",{className:"text-3xl font-bold",children:((y=i.performance)==null?void 0:y.todaySales)||0})})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Month to Date"})}),e.jsx(V,{children:e.jsx("div",{className:"text-3xl font-bold",children:((j=i.performance)==null?void 0:j.monthSales)||0})})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Goal Progress"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-3xl font-bold mb-2",children:[((N=i.performance)==null?void 0:N.goalProgress)||0,"%"]}),e.jsx($s,{value:((g=i.performance)==null?void 0:g.goalProgress)||0,className:"h-2"})]})]})]}),e.jsxs(B,{className:"mb-6",children:[e.jsxs(W,{children:[e.jsx(z,{children:"Staff Capacity"}),e.jsx(Be,{children:"Current staff utilization and available positions"})]}),e.jsx(V,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(B,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Sales People"}),e.jsxs(Be,{children:[((w=i.userCounts)==null?void 0:w.salesPeople)||0," of"," ",((S=i.userLimits)==null?void 0:S.sales_people)||0," Positions Filled"]})]}),e.jsxs(V,{children:[e.jsx($s,{value:((P=i.capacity)==null?void 0:P.salesPeople)??0,className:(((E=i.capacity)==null?void 0:E.salesPeople)??0)>90?"h-2 bg-red-200":"h-2"}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsx("span",{children:"Available Positions:"}),e.jsx("span",{className:"font-medium",children:Math.max(0,(((D=i.userLimits)==null?void 0:D.sales_people)||0)-(((G=i.userCounts)==null?void 0:G.salesPeople)||0))})]})]})]}),e.jsxs(B,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Finance Managers"}),e.jsxs(Be,{children:[((se=i.userCounts)==null?void 0:se.financeManagers)||0," of"," ",((L=i.userLimits)==null?void 0:L.finance_managers)||0," Positions Filled"]})]}),e.jsxs(V,{children:[e.jsx($s,{value:((T=i.capacity)==null?void 0:T.financeManagers)??0,className:(((A=i.capacity)==null?void 0:A.financeManagers)??0)>90?"h-2 bg-red-200":"h-2"}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsx("span",{children:"Available Positions:"}),e.jsx("span",{className:"font-medium",children:Math.max(0,(((Y=i.userLimits)==null?void 0:Y.finance_managers)||0)-(((te=i.userCounts)==null?void 0:te.financeManagers)||0))})]})]})]}),e.jsxs(B,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Management"}),e.jsxs(Be,{children:[((xe=i.userCounts)==null?void 0:xe.managers)||0," of"," ",(((le=i.userLimits)==null?void 0:le.sales_managers)||0)+(((Q=i.userLimits)==null?void 0:Q.general_managers)||0)," ","Positions Filled"]})]}),e.jsxs(V,{children:[e.jsx($s,{value:((pe=i.capacity)==null?void 0:pe.managers)??0,className:(((Pe=i.capacity)==null?void 0:Pe.managers)??0)>90?"h-2 bg-red-200":"h-2"}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsx("span",{children:"Available Positions:"}),e.jsx("span",{className:"font-medium",children:Math.max(0,(((Oe=i.userLimits)==null?void 0:Oe.sales_managers)||0)+(((qe=i.userLimits)==null?void 0:qe.general_managers)||0)-(((M=i.userCounts)==null?void 0:M.managers)||0))})]})]})]})]})})]}),e.jsxs(B,{className:"mb-6",children:[e.jsxs(W,{children:[e.jsx(z,{children:"Staff Management"}),e.jsx(Be,{children:"Manage dealership users and their roles"})]}),e.jsx(V,{children:h?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(Je,{className:"h-6 w-6 animate-spin text-primary"})}):e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Email"}),e.jsx(H,{children:"Role"}),e.jsx(H,{children:"Last Login"})]})}),e.jsx(it,{children:d.length===0?e.jsx(Se,{children:e.jsx(U,{colSpan:4,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground",children:[e.jsx(Vt,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:"No users found for this dealership"})]})})}):d.map(F=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:F.name}),e.jsx(U,{children:F.email}),e.jsx(U,{children:e.jsx(Ue,{variant:"outline",children:F.role})}),e.jsx(U,{children:F.last_login?t1(new Date(F.last_login),"MMM d, yyyy"):"Never logged in"})]},F.id))})]})})]})]}):e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Area VP Dashboard"}),a.length>0&&a[0].group_id&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Dealer Group: ",((ne=(re=a[0])==null?void 0:re.dealership_groups)==null?void 0:ne.name)||"Group","  Managing"," ",a.length," Dealerships"]})]}),a.length>0&&((O=a[0])==null?void 0:O.userLimits)&&e.jsxs(Ue,{variant:"outline",className:"text-sm",children:[((K=(ue=a[0])==null?void 0:ue.userLimits)==null?void 0:K.sales_people)>20?"++ Version":((X=(ce=a[0])==null?void 0:ce.userLimits)==null?void 0:X.sales_people)>10?"+ Version":"Standard"," ","Plan"]})]}),e.jsxs(B,{className:"mb-6",children:[e.jsxs(W,{children:[e.jsx(z,{children:"Your Assigned Dealerships"}),e.jsx(Be,{children:"Manage and monitor dealerships assigned to you"})]}),e.jsx(V,{children:a.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(xn,{className:"h-10 w-10 text-amber-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Dealerships Assigned"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"You don't have any dealerships assigned to you yet. Please contact your group administrator."})]}):e.jsx("div",{className:"space-y-4",children:a.map(F=>{var _,$,Z,de,we,De,Ee,He,$e,zt,ct,pt,Qe,gt,dt,gs,Ct,It,vs,Ts,Pt,Ms,Mt;return e.jsx(B,{className:"overflow-hidden",children:e.jsxs("div",{className:"flex items-center p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:F.name}),F.capacity&&((((_=F.capacity)==null?void 0:_.salesPeople)??0)>90||((($=F.capacity)==null?void 0:$.financeManagers)??0)>90||(((Z=F.capacity)==null?void 0:Z.managers)??0)>90)&&e.jsxs(Ue,{variant:"destructive",className:"ml-2",children:[e.jsx(xn,{className:"h-3 w-3 mr-1"}),"At Capacity"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs(Ue,{variant:"secondary",className:"rounded-sm",children:[((de=F.userCounts)==null?void 0:de.total)||0," Team Members"]}),e.jsxs(Ue,{variant:"outline",className:"rounded-sm",children:[((we=F.performance)==null?void 0:we.monthSales)||0," Sales MTD"]}),e.jsxs(Ue,{variant:"outline",className:"rounded-sm",children:["Schema: ",F.schema_name]})]}),F.userLimits&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-3",children:[e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Sales:"}),e.jsxs("span",{className:(((De=F.capacity)==null?void 0:De.salesPeople)??0)>90?"text-red-500 font-bold":"",children:[(Ee=F.userCounts)==null?void 0:Ee.salesPeople,"/",(He=F.userLimits)==null?void 0:He.sales_people]})]}),e.jsx($s,{value:(($e=F.capacity)==null?void 0:$e.salesPeople)??0,className:(((zt=F.capacity)==null?void 0:zt.salesPeople)??0)>90?"h-1 mt-1 bg-red-200":"h-1 mt-1"})]}),e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"F&I:"}),e.jsxs("span",{className:(((ct=F.capacity)==null?void 0:ct.financeManagers)??0)>90?"text-red-500 font-bold":"",children:[(pt=F.userCounts)==null?void 0:pt.financeManagers,"/",(Qe=F.userLimits)==null?void 0:Qe.finance_managers]})]}),e.jsx($s,{value:((gt=F.capacity)==null?void 0:gt.financeManagers)??0,className:(((dt=F.capacity)==null?void 0:dt.financeManagers)??0)>90?"h-1 mt-1 bg-red-200":"h-1 mt-1"})]}),e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mgmt:"}),e.jsxs("span",{className:(((gs=F.capacity)==null?void 0:gs.managers)??0)>90?"text-red-500 font-bold":"",children:[(Ct=F.userCounts)==null?void 0:Ct.managers,"/",(((It=F.userLimits)==null?void 0:It.sales_managers)||0)+(((vs=F.userLimits)==null?void 0:vs.general_managers)||0)]})]}),e.jsx($s,{value:((Ts=F.capacity)==null?void 0:Ts.managers)??0,className:(((Pt=F.capacity)==null?void 0:Pt.managers)??0)>90?"h-1 mt-1 bg-red-200":"h-1 mt-1"})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"text-sm mb-1",children:["Goal Progress:"," ",e.jsxs("span",{className:"font-semibold",children:[((Ms=F.performance)==null?void 0:Ms.goalProgress)||0,"%"]})]}),e.jsx($s,{value:((Mt=F.performance)==null?void 0:Mt.goalProgress)||0,className:"h-2 w-32 mb-2"}),e.jsxs(I,{variant:"ghost",size:"sm",onClick:()=>p(F.id),children:["Manage ",e.jsx(Nr,{className:"ml-1 h-4 w-4"})]})]})]})},F.id)})})})]}),e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{children:"Quick Analytics"}),e.jsx(Be,{children:"Performance overview across all your dealerships"})]}),e.jsxs(V,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-center py-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:a.reduce((F,_)=>{var $;return F+((($=_.performance)==null?void 0:$.todaySales)||0)},0)}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Total Sales Today"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:a.reduce((F,_)=>{var $;return F+((($=_.performance)==null?void 0:$.monthSales)||0)},0)}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Total Sales This Month"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:a.reduce((F,_)=>{var $;return F+((($=_.userCounts)==null?void 0:$.total)||0)},0)}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Total Team Members"})]})]}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs(I,{variant:"outline",children:[e.jsx(bu,{className:"mr-2 h-4 w-4"}),"View Detailed Analytics"]})})]})]})]})}const Os=[{name:"Master Admin",email:"testadmin@example.com",password:"password123",redirectPath:"/master-admin",metadata:{role:"admin",is_admin:!0}},{name:"Group Admin",email:"group1.admin@exampletest.com",password:"password123",redirectPath:"/group-admin",metadata:{role:"dealer_group_admin",is_group_admin:!0}},{name:"Dealership Admin",email:"dealer1.admin@exampletest.com",password:"password123",redirectPath:"/dashboard/admin",metadata:{role:"dealership_admin",dealership_id:1}},{name:"Sales Manager",email:"sales.manager@exampletest.com",password:"password123",redirectPath:"/dashboard/sales-manager",metadata:{role:"sales_manager",dealership_id:1}},{name:"Salesperson",email:"sales@exampletest.com",password:"password123",redirectPath:"/dashboard/sales",metadata:{role:"salesperson",dealership_id:1}}],n1=()=>{const[t,s]=l.useState(""),[r,n]=l.useState(""),[a,o]=l.useState(!1),[i,c]=l.useState(""),[d,m]=l.useState(""),[h,u]=l.useState(null),[f,b]=l.useState(0);l.useEffect(()=>{p()},[]);const p=async()=>{try{u(null);const{data:y,error:j}=await J.auth.getSession();j?(console.error("Auth check error:",j),u({error:j.message})):(console.log("Auth check result:",y),u(y))}catch(y){console.error("Exception checking auth:",y),u({error:"Exception checking auth status"})}},x=async(y=!1)=>{try{o(!0),c(""),m("");const j=y?Os[f].email:t,N=y?Os[f].password:r,g=y?Os[f].metadata:null,w=y?Os[f].redirectPath:null;console.log(`Attempting login for ${j}`),await J.auth.signOut();const{data:S,error:P}=await J.auth.signInWithPassword({email:j,password:N});if(P){console.error("Login error:",P),c(P.message);return}if(console.log("Login success:",S),g&&S.user)try{console.log("Setting user metadata:",g),await J.auth.updateUser({data:g}),m("User metadata updated successfully")}catch(E){console.error("Error setting user metadata:",E)}if(m("Login successful! Redirecting..."),xo(j)){if(j==="testadmin@example.com"){setTimeout(()=>window.location.href="/master-admin",1e3);return}if(j.includes("group")&&j.includes("@exampletest.com")){sessionStorage.setItem("is_group_admin","true"),setTimeout(()=>window.location.href="/group-admin",1e3);return}setTimeout(()=>window.location.href=w||"/dashboard",1e3);return}setTimeout(()=>window.location.href="/dashboard",1e3)}catch(j){console.error("Login exception:",j),c("Unexpected error during login")}finally{o(!1)}},v=async()=>{try{o(!0),c(""),m(""),await J.auth.signOut(),localStorage.removeItem("sb-undefined-auth-token"),sessionStorage.removeItem("is_group_admin"),m("Signed out successfully"),setTimeout(()=>window.location.reload(),1e3)}catch(y){console.error("Sign out error:",y),c("Error signing out")}finally{o(!1)}};return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 bg-gray-50",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Auth Debug Page"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"Use this page to bypass the normal authentication flow for testing"}),e.jsx("div",{className:"w-full max-w-2xl mb-8",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsxs(z,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Current Auth Status"}),e.jsxs(I,{variant:"ghost",size:"sm",onClick:p,disabled:a,children:[e.jsx(en,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),e.jsxs(V,{children:[h?e.jsx("div",{className:"bg-gray-100 p-3 rounded text-xs overflow-auto max-h-48",children:e.jsx("pre",{children:JSON.stringify(h,null,2)})}):e.jsx("p",{children:"Checking auth status..."}),(h==null?void 0:h.session)&&e.jsxs(vn,{className:"mt-4 bg-blue-50",children:[e.jsx(Er,{className:"h-4 w-4"}),e.jsxs(bn,{children:["You are currently logged in as ",e.jsx("strong",{children:h.session.user.email})]})]}),!(h!=null&&h.session)&&e.jsxs(vn,{className:"mt-4 bg-amber-50",children:[e.jsx(va,{className:"h-4 w-4"}),e.jsx(bn,{children:"You are currently not logged in"})]})]}),e.jsx($t,{className:"flex justify-end gap-2",children:e.jsx(I,{variant:"outline",onClick:v,disabled:a,children:"Force Sign Out"})})]})}),e.jsx("div",{className:"w-full max-w-2xl",children:e.jsxs(_r,{defaultValue:"presets",children:[e.jsxs(Xs,{className:"grid grid-cols-2",children:[e.jsx(Ve,{value:"presets",children:"Test Account Presets"}),e.jsx(Ve,{value:"custom",children:"Custom Login"})]}),e.jsx(ze,{value:"presets",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Login with Test Account"})}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Test Account"}),e.jsx("select",{className:"w-full p-2 border border-gray-300 rounded-md",value:f,onChange:y=>b(Number(y.target.value)),children:Os.map((y,j)=>e.jsxs("option",{value:j,children:[y.name," (",y.email,")"]},j))})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-md text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",Os[f].email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," ",Os[f].password]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Role:"})," ",Os[f].metadata.role]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Redirects to:"})," ",Os[f].redirectPath]})]}),i&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm",children:i}),d&&e.jsx("div",{className:"bg-green-50 text-green-600 p-3 rounded-md text-sm",children:d})]})}),e.jsx($t,{children:e.jsx(I,{onClick:()=>x(!0),disabled:a,className:"w-full",children:a?"Logging in...":"Login with Selected Account"})})]})}),e.jsx(ze,{value:"custom",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Custom Login"})}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx(be,{type:"email",value:t,onChange:y=>s(y.target.value),placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Password"}),e.jsx(be,{type:"password",value:r,onChange:y=>n(y.target.value),placeholder:"password"})]}),i&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm",children:i}),d&&e.jsx("div",{className:"bg-green-50 text-green-600 p-3 rounded-md text-sm",children:d})]})}),e.jsx($t,{children:e.jsx(I,{onClick:()=>x(!1),disabled:a,className:"w-full",children:a?"Logging in...":"Login Directly"})})]})})]})})]})},a1=({children:t})=>{const[s,r]=l.useState(!0),[n,a]=l.useState(!1),o=St(),i=yt();return l.useEffect(()=>{(async()=>{try{console.log("[TestUserMiddleware] Checking for test user...");const{data:d,error:m}=await J.auth.getSession();if(m){console.error("[TestUserMiddleware] Session error:",m),r(!1);return}if(!d.session){console.log("[TestUserMiddleware] No active session"),r(!1);return}const h=d.session.user,u=(h==null?void 0:h.email)||"";if(!xo(u)){console.log("[TestUserMiddleware] Not a test user:",u),r(!1);return}if(console.log("[TestUserMiddleware] Test user detected:",u),a(!0),u==="testadmin@example.com"){console.log("[TestUserMiddleware] Master admin user detected");try{await J.auth.updateUser({data:{role:"admin",is_admin:!0}}),console.log("[TestUserMiddleware] Updated metadata for master admin")}catch(f){console.error("[TestUserMiddleware] Error updating metadata:",f)}o.pathname!=="/master-admin"&&(console.log("[TestUserMiddleware] Redirecting master admin to /master-admin"),i("/master-admin",{replace:!0}))}else if(u.includes("group")&&u.includes("@exampletest.com")){console.log("[TestUserMiddleware] Group admin user detected");try{await J.auth.updateUser({data:{role:"dealer_group_admin",is_group_admin:!0}}),console.log("[TestUserMiddleware] Updated metadata for group admin"),sessionStorage.setItem("is_group_admin","true")}catch(f){console.error("[TestUserMiddleware] Error updating metadata:",f)}o.pathname!=="/group-admin"&&(console.log("[TestUserMiddleware] Redirecting group admin to /group-admin"),i("/group-admin",{replace:!0}))}else if(u.includes("admin")&&u.includes("@exampletest.com")){console.log("[TestUserMiddleware] Dealership admin user detected");try{await J.auth.updateUser({data:{role:"dealership_admin",dealership_id:1}}),console.log("[TestUserMiddleware] Updated metadata for dealership admin")}catch(f){console.error("[TestUserMiddleware] Error updating metadata:",f)}o.pathname!=="/dashboard/admin"&&(console.log("[TestUserMiddleware] Redirecting dealership admin to /dashboard/admin"),i("/dashboard/admin",{replace:!0}))}r(!1)}catch(d){console.error("[TestUserMiddleware] Unexpected error:",d),r(!1)}})()},[o.pathname,i]),s&&n?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Je,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Configuring test user access..."})]})}):e.jsx(e.Fragment,{children:t})},o1=()=>{const[t,s]=l.useState(0),[r,n]=l.useState(""),[a,o]=l.useState("idle"),[i,c]=l.useState(!1),d=yt();l.useEffect(()=>{if($r()){const u=gr();if(u){n(`Already logged in as ${u.email}. Redirecting...`),o("success");const f=setTimeout(()=>{d(Xt(u))},1500);return()=>clearTimeout(f)}}},[d]);const m=()=>{c(!0),n(""),o("idle");const u=Kt[t].email,f=Lu(u);if(f.success){n(f.message+" - Redirecting..."),o("success");const b=gr();b&&setTimeout(()=>{d(Xt(b))},1500)}else n(f.message),o("error");c(!1)},h=()=>{Ou(),n("Logged out successfully"),o("success"),window.location.reload()};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsx(z,{className:"text-2xl text-center",children:"Direct Login"}),e.jsx("p",{className:"text-center text-gray-500 text-sm",children:"Simplified login without Supabase authentication"})]}),e.jsxs(V,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Test Account"}),e.jsx("select",{className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",value:t,onChange:u=>s(Number(u.target.value)),disabled:i,children:Kt.map((u,f)=>e.jsxs("option",{value:f,children:[u.name||u.email," (",u.role,")"]},f))})]}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",Kt[t].email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Role:"})," ",Kt[t].role]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Redirects to:"})," ",Xt(Kt[t])]})]}),r&&e.jsx("div",{className:`p-3 rounded text-sm ${a==="success"?"bg-green-100 text-green-800":a==="error"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:r})]}),e.jsxs($t,{className:"flex justify-between",children:[e.jsx(I,{onClick:m,disabled:i,className:"w-full mr-2",children:i?"Logging in...":"Login as Selected User"}),$r()&&e.jsx(I,{onClick:h,variant:"outline",className:"w-1/3",children:"Log Out"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("a",{href:"/",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Return to regular login"})})]})})},i1=({children:t})=>{const[s,r]=l.useState(!0),n=yt(),a=St();return l.useEffect(()=>{var u;if(localStorage.getItem("logout_in_progress")==="true"){console.log("[DirectAuthProvider] Logout in progress, skipping redirect"),r(!1);return}const i=localStorage.getItem("force_redirect_after_login"),c=localStorage.getItem("force_redirect_timestamp"),d=c&&Date.now()-parseInt(c)<1e4;if(i&&d){console.log("[DirectAuthProvider] Force redirect detected, navigating to:",i),localStorage.removeItem("force_redirect_after_login"),localStorage.removeItem("force_redirect_timestamp"),n(i,{replace:!0}),r(!1);return}if(["/direct-login","/force-login","/logout","/reset","/","/auth","/dashboard-selector","/deal-log"].includes(a.pathname)){console.log(`[DirectAuthProvider] Skipping redirect for excluded path: ${a.pathname}`),r(!1);return}const h=new URLSearchParams(a.search);if(h.has("noredirect")||h.has("forcelogin")||h.has("reset")){console.log("[DirectAuthProvider] Skipping redirect due to special parameter"),r(!1);return}if($r()){const f=gr();if(f){if(console.log("[DirectAuthProvider] Direct auth user detected:",f.email),localStorage.getItem("directauth_timestamp")!==null&&(console.log("[DirectAuthProvider] Dashboard selector session detected - allowing specific dashboard access"),a.pathname.startsWith("/dashboard/")||a.pathname==="/master-admin"||a.pathname==="/group-admin"||a.pathname==="/deal-log")){console.log("[DirectAuthProvider] Allowing access to path:",a.pathname),r(!1);return}if(a.pathname==="/"||a.pathname==="/auth")console.log("[DirectAuthProvider] Redirecting to dashboard:",Xt(f)),n(Xt(f),{replace:!0});else{const p=Xt(f),x=((u=f.role)==null?void 0:u.toLowerCase())==="finance_manager",v=a.pathname==="/deal-log";if(x&&v){console.log("[DirectAuthProvider] Allowing finance manager to access deal-log path"),r(!1);return}a.pathname!==p&&!a.pathname.startsWith(p+"/")&&(console.log("[DirectAuthProvider] Current path doesn't match user role, redirecting:",{current:a.pathname,correct:p}),n(p,{replace:!0}))}}}r(!1)},[n,a.pathname,a.search]),s?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):e.jsx(e.Fragment,{children:t})},l1="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNhbXBsZSIsInJvbGUiOiJhdXRoZW50aWNhdGVkIiwiaWF0IjoxNjE2NDI4ODAwLCJleHAiOjE2MTY0NzIwMDB9.EXAMPLE",c1="refresh-token-example",d1=()=>{const[t,s]=l.useState(0),[r,n]=l.useState(""),[a,o]=l.useState("idle"),[i,c]=l.useState(!1);l.useEffect(()=>{new URLSearchParams(window.location.search).has("reset")&&d()},[]);const d=()=>{try{localStorage.clear(),sessionStorage.clear(),document.cookie.split(";").forEach(u=>{const[f]=u.trim().split("=");document.cookie=`${f}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}),n("All authentication data has been completely cleared. You can now use any login option."),o("success")}catch(u){console.error("Reset error:",u),n("Error while resetting: "+String(u)),o("error")}},m=()=>{try{c(!0),n(""),o("idle");const u=Kt[t];Lu(u.email);const b="sb-dasboard-auth-token",p={access_token:l1,refresh_token:c1,expires_at:Date.now()+3600*1e3,expires_in:3600,user:{id:u.id,email:u.email,role:u.role,user_metadata:{name:u.name,role:u.role,is_admin:!!u.isAdmin,is_group_admin:!!u.isGroupAdmin,dealership_id:u.dealershipId}}};localStorage.setItem(b,JSON.stringify(p)),n(`Forced login successful for ${u.email}. You can now go to:`),o("success")}catch(u){console.error("Force login error:",u),n("Error forcing login: "+String(u)),o("error")}finally{c(!1)}},h=()=>{try{localStorage.clear(),sessionStorage.clear(),n("All auth data cleared. You are now logged out."),o("success"),setTimeout(()=>window.location.reload(),1500)}catch(u){console.error("Logout error:",u),n("Error logging out: "+String(u)),o("error")}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs(B,{children:[e.jsxs(W,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(z,{className:"text-2xl text-center",children:"Force Login"}),e.jsx(I,{variant:"destructive",size:"sm",onClick:d,children:"Reset All Auth"})]}),e.jsx("p",{className:"text-center text-gray-500 text-sm",children:"Force authentication by directly manipulating local storage"})]}),e.jsxs(V,{className:"space-y-4",children:[e.jsxs(vn,{variant:"destructive",children:[e.jsx(va,{className:"h-4 w-4"}),e.jsx(bn,{children:"This is an emergency bypass. Use only when all other login methods fail."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Test Account"}),e.jsx("select",{className:"w-full p-2 border border-gray-300 rounded-md",value:t,onChange:u=>s(Number(u.target.value)),disabled:i,children:Kt.map((u,f)=>e.jsxs("option",{value:f,children:[u.name||u.email," (",u.role,")"]},f))})]}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",Kt[t].email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Role:"})," ",Kt[t].role]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Redirects to:"})," ",Xt(Kt[t])]})]}),r&&e.jsxs("div",{className:`p-3 rounded text-sm ${a==="success"?"bg-green-100 text-green-800":a==="error"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[r,a==="success"&&e.jsx("div",{className:"mt-2",children:e.jsx("a",{href:Xt(Kt[t]),className:"inline-block bg-green-600 text-white px-3 py-1 rounded mt-1 hover:bg-green-700",children:"Go to Dashboard"})})]})]}),e.jsxs($t,{className:"flex justify-between gap-2",children:[e.jsx(I,{onClick:m,disabled:i,className:"w-full",variant:"destructive",children:i?"Forcing login...":"Force Login"}),e.jsx(I,{onClick:h,variant:"outline",className:"w-1/3",children:"Clear All"})]})]}),e.jsxs("div",{className:"mt-4 text-center space-y-2",children:[e.jsx("a",{href:"/direct-login",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline block",children:"Try Regular Direct Login"}),e.jsx("a",{href:"/",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline block",children:"Return to Regular Login"})]})]})})},u1=()=>{const[t,s]=l.useState("Signing you out..."),[r,n]=l.useState(null),[a,o]=l.useState(!1),[i,c]=l.useState([]),d=yt(),m=h=>{const f=`${new Date().toISOString()} - ${h}`;console.log(`[LogoutPage] ${h}`),c(b=>[...b,f])};return l.useEffect(()=>{const h=async()=>{var p;try{const{data:x,error:v}=await J.auth.getSession(),y=!!(x!=null&&x.session);return console.log("[LogoutPage] Session check:",{hasSession:y,error:(v==null?void 0:v.message)||null,timestamp:new Date().toISOString(),sessionExpiry:(p=x==null?void 0:x.session)!=null&&p.expires_at?new Date(x.session.expires_at*1e3).toISOString():null}),y}catch(x){return console.error("[LogoutPage] Error checking session:",x),!1}},u=()=>{try{m("Clearing all storage"),localStorage.removeItem("force_redirect_after_login"),localStorage.removeItem("force_redirect_timestamp"),localStorage.removeItem("logout_in_progress");const p=Object.keys(localStorage);console.log("[LogoutPage] LocalStorage keys before clearing:",p),localStorage.clear(),sessionStorage.clear();const x=document.cookie.split(";");return console.log("[LogoutPage] Cookies before clearing:",x),x.forEach(v=>{const[y]=v.trim().split("=");document.cookie=`${y}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}),m("All storage cleared successfully"),!0}catch(p){return console.error("[LogoutPage] Error clearing storage:",p),m(`Error clearing storage: ${p instanceof Error?p.message:String(p)}`),!1}};(async()=>{try{m("Starting logout process");const p=await h();if(m(`Initial session check: ${p?"Active session found":"No active session"}`),!p){m("No active session found, just clearing storage"),u(),s("No active session. Clearing data and redirecting..."),o(!0),setTimeout(()=>{window.location.href="/auth?forcelogin=true"},1e3);return}localStorage.setItem("logout_in_progress","true"),m("Set logout_in_progress flag");try{s("Signing out from Supabase..."),m("Attempting signOut via apiService");const j=Date.now();await Wx();const N=Date.now()-j;m(`apiService.signOut completed in ${N}ms`)}catch(j){m(`Error with apiService.signOut: ${j instanceof Error?j.message:String(j)}`);try{m("Falling back to direct supabase.auth.signOut");const N=Date.now(),{error:g}=await J.auth.signOut(),w=Date.now()-N;m(g?`Direct Supabase signOut error: ${g.message}`:`Direct Supabase signOut successful in ${w}ms`)}catch(N){m(`Exception during direct Supabase signOut: ${N instanceof Error?N.message:String(N)}`)}}const x=await h();m(`Session check after signOut: ${x?"Session still exists!":"Session successfully removed"}`),s("Clearing direct auth session...");try{Ou(),m("Direct auth logout successful")}catch(j){m(`Error during direct auth logout: ${j instanceof Error?j.message:String(j)}`)}s("Clearing browser storage...");const v=u();m(`All storage cleared: ${v?"success":"failed"}`);const y=await h();m(`Final session check: ${y?"Session still exists! (unexpected)":"No session (expected)"}`),s("Logout successful! Redirecting..."),o(!0),setTimeout(()=>{m("Redirecting to auth page"),window.location.href="/auth?forcelogin=true"},1e3)}catch(p){console.error("[LogoutPage] Error during logout process:",p),m(`Logout process error: ${p instanceof Error?p.message:String(p)}`),n(`Logout failed: ${p instanceof Error?p.message:"Unknown error"}`),s("Error occurred during logout"),setTimeout(()=>{m("Redirecting after error"),window.location.href="/auth?forcelogin=true"},2e3)}})();const b=setTimeout(()=>{a||(m("Logout timeout reached, forcing redirect"),s("Logout taking too long, redirecting..."),window.location.href="/auth?forcelogin=true")},5e3);return()=>clearTimeout(b)},[d]),e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gradient-to-b from-indigo-50 to-white p-4",children:e.jsx("div",{className:"w-full max-w-md space-y-8 rounded-xl bg-white p-8 shadow-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[!a&&!r?e.jsx(Je,{className:"h-12 w-12 animate-spin text-indigo-600"}):r?e.jsx("div",{className:"text-red-500",children:""}):e.jsx("div",{className:"text-green-500",children:""}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"Logout Failed":a?"Logged Out":"Logging Out"}),e.jsx("p",{className:"text-center text-gray-600",children:t}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r}),e.jsx("p",{className:"text-sm text-gray-500",children:a?"Redirecting to login page...":r?"Trying to redirect to login page...":"You will be redirected to the login page automatically."}),!1]})})})},m1=()=>{const{user:t,hasSession:s}=et(),r=yt(),[n,a]=l.useState(5),[o,i]=l.useState(null);return l.useEffect(()=>{const d=(()=>{var u,f,b;return t?((u=t.user_metadata)==null?void 0:u.is_group_admin)||((f=t.email)==null?void 0:f.toLowerCase().includes("group"))&&((b=t.email)==null?void 0:b.toLowerCase().includes("@exampletest.com"))?(console.log("[TestLoginRedirect] User is a group admin, redirecting to /group-admin"),"/group-admin"):t.email==="testadmin@example.com"||t.email==="testadmin@exampletest.com"?(console.log("[TestLoginRedirect] User is master admin, redirecting to /master-admin"),"/master-admin"):"/dashboard":"/auth"})();i(d);const m=setInterval(()=>{a(h=>h<=1?(clearInterval(m),console.log(`[TestLoginRedirect] Redirecting to ${d}`),window.location.href=d,0):h-1)},1e3);return()=>clearInterval(m)},[t,r,s]),e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gradient-to-b from-indigo-50 to-white p-4",children:e.jsx("div",{className:"w-full max-w-md space-y-8 rounded-xl bg-white p-8 shadow-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx(Je,{className:"h-12 w-12 animate-spin text-indigo-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Redirecting..."}),e.jsx("p",{className:"text-center text-gray-600",children:t?e.jsxs(e.Fragment,{children:["Welcome, ",t.email,"!"]}):e.jsx(e.Fragment,{children:"No user detected, redirecting to login."})}),o&&e.jsxs("p",{className:"text-center text-gray-600",children:["You will be redirected to ",e.jsx("span",{className:"font-bold",children:o})," in"," ",n," seconds..."]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>{o&&(window.location.href=o)},className:"rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700",children:"Go Now"})})]})})})},h1=()=>{const[t,s]=l.useState("idle"),[r,n]=l.useState("Click the button to log in as group admin"),[a,o]=l.useState(3);l.useEffect(()=>{new URLSearchParams(window.location.search).get("auto")==="true"&&i()},[]),l.useEffect(()=>{if(t!=="success")return;const c=setInterval(()=>{o(d=>d<=1?(clearInterval(c),window.location.href="/group-admin",0):d-1)},1e3);return()=>clearInterval(c)},[t]);const i=async()=>{s("loading"),n("Logging in...");try{if(await J.auth.signOut(),localStorage.clear(),"logout"in window)try{window.logout()}catch(m){console.error("Error calling direct logout:",m)}localStorage.setItem("bypass_redirect","/group-admin"),await new Promise(m=>setTimeout(m,500));const{data:c,error:d}=await J.auth.signInWithPassword({email:"group1.admin@exampletest.com",password:"password123"});if(d)throw d;console.log("[GroupAdminBypass] Login successful:",c),await J.auth.updateUser({data:{is_group_admin:!0,role:"dealer_group_admin"}}),await J.from("profiles").update({is_group_admin:!0,role:"dealer_group_admin"}).eq("id",c.user.id),s("success"),n("Login successful! Redirecting to group admin dashboard..."),setTimeout(()=>{window.location.href="/group-admin"},3e3)}catch(c){console.error("[GroupAdminBypass] Login error:",c),s("error"),n(`Login failed: ${c instanceof Error?c.message:"Unknown error"}`)}};return e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gradient-to-b from-indigo-50 to-white p-4",children:e.jsx("div",{className:"w-full max-w-md space-y-8 rounded-xl bg-white p-8 shadow-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Group Admin Login Bypass"}),e.jsx("p",{className:"text-center text-gray-600",children:r}),t==="loading"&&e.jsx(Je,{className:"h-12 w-12 animate-spin text-indigo-600"}),t==="success"&&e.jsxs("p",{className:"text-green-600 font-semibold",children:["Redirecting in ",a," seconds..."]}),t==="error"&&e.jsx("p",{className:"text-red-600",children:"An error occurred. Please try again."}),t==="idle"&&e.jsx("button",{onClick:i,className:"rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700",children:"Login as Group Admin"}),t==="error"&&e.jsx("button",{onClick:i,className:"rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700",children:"Try Again"}),e.jsx("a",{href:"/",className:"text-sm text-indigo-600 hover:underline",children:"Back to regular login"})]})})})},f1=()=>{const[t,s]=l.useState(!1),[r,n]=l.useState("Select a dashboard to access"),[a,o]=l.useState(null),[i,c]=l.useState(!0),d=[{name:"Master Admin",path:"/master-admin",email:"testadmin@example.com",role:"admin"},{name:"Group Admin",path:"/group-admin",email:"group1.admin@exampletest.com",role:"dealer_group_admin"},{name:"Dealership Admin",path:"/dashboard/admin",email:"dealer1.admin@exampletest.com",role:"dealership_admin"},{name:"Finance Manager",path:"/dashboard/finance",email:"finance1@exampletest.com",role:"finance_manager"},{name:"Single Finance Manager",path:"/dashboard/single-finance",email:"finance.single@exampletest.com",role:"finance_manager"},{name:"Sales Manager",path:"/dashboard/sales-manager",email:"sales.manager@exampletest.com",role:"sales_manager"},{name:"General Manager",path:"/dashboard/gm",email:"gm@exampletest.com",role:"general_manager"},{name:"Salesperson",path:"/dashboard/sales",email:"sales@exampletest.com",role:"salesperson"}],m=u=>{try{console.log(`[DashboardSelector] Using direct bypass for ${u.name}`),console.log("[DashboardSelector] Clearing all auth data"),localStorage.removeItem("direct_auth_user"),localStorage.removeItem("directauth_user"),localStorage.removeItem("directauth_timestamp"),localStorage.removeItem("supabase.auth.token"),localStorage.removeItem("supabase.auth.expires_at"),localStorage.removeItem("supabase.auth.expires_in"),setTimeout(()=>{console.log("[DashboardSelector] Setting new auth data for",u.email);const f={id:`${u.role}-id-${Date.now()}`,email:u.email,role:u.role,isAdmin:u.role==="admin",isGroupAdmin:u.role==="dealer_group_admin",name:u.name};localStorage.setItem("directauth_user",JSON.stringify(f)),localStorage.setItem("directauth_timestamp",Date.now().toString()),console.log(`[DashboardSelector] Redirecting to ${u.path}`),window.location.href=u.path},100)}catch(f){console.error("[DashboardSelector] Bypass error:",f),o(`Bypass failed: ${f instanceof Error?f.message:"Unknown error"}`),s(!1)}},h=async u=>{if(i){m(u);return}s(!0),o(null),n(`Accessing ${u.name} dashboard...`);try{console.log("[DashboardSelector] Clearing existing session..."),await J.auth.signOut(),localStorage.clear(),window.sessionStorage.clear(),console.log(`[DashboardSelector] Signing in as ${u.email}...`);const{data:f,error:b}=await J.auth.signInWithPassword({email:u.email,password:"test123"});if(b)throw console.error("[DashboardSelector] Sign in error:",b),b;if(!f||!f.user)throw console.error("[DashboardSelector] No user data returned from sign in"),new Error("Authentication failed - no user data returned");if(console.log(`[DashboardSelector] Logged in as ${u.email}`),u.role==="finance_manager"){console.log("[DashboardSelector] Using direct navigation for Finance Manager"),window.location.href=u.path;return}console.log(`[DashboardSelector] Updating user metadata with role: ${u.role}`);const p=await J.auth.updateUser({data:{role:u.role,is_group_admin:u.role==="dealer_group_admin"}});p.error&&console.error("[DashboardSelector] User metadata update error:",p.error),console.log(`[DashboardSelector] Updating profile record for user: ${f.user.id}`);const x=await J.from("profiles").update({role:u.role,is_group_admin:u.role==="dealer_group_admin"}).eq("id",f.user.id);x.error&&console.error("[DashboardSelector] Profile update error:",x.error),console.log(`[DashboardSelector] Redirecting to: ${u.path}`),window.location.href=u.path}catch(f){console.error("[DashboardSelector] Error:",f),o(`Login failed: ${f instanceof Error?f.message:"Unknown error"}`),s(!1)}};return e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-gradient-to-b from-indigo-50 to-white p-4",children:e.jsx("div",{className:"w-full max-w-md space-y-8 rounded-xl bg-white p-8 shadow-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Direct Access"}),e.jsx("p",{className:"text-sm text-red-500 font-bold",children:"FOR DEVELOPMENT USE ONLY"}),e.jsxs("div",{className:"flex items-center mb-2 w-full justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Authentication Method:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(!0),className:`px-3 py-1 text-xs rounded ${i?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Quick Bypass"}),e.jsx("button",{onClick:()=>c(!1),className:`px-3 py-1 text-xs rounded ${i?"bg-gray-200 text-gray-700":"bg-blue-600 text-white"}`,children:"Full Auth"})]})]}),a&&e.jsx("div",{className:"p-4 rounded-md bg-red-50 text-red-800 w-full",children:e.jsx("p",{children:a})}),e.jsx("p",{className:"text-center text-gray-600",children:r}),e.jsx("div",{className:"grid grid-cols-1 gap-3 w-full",children:d.map(u=>e.jsx("button",{onClick:()=>h(u),disabled:t,className:`p-3 rounded-md text-white w-full
                  ${t?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"}
                  ${u.name==="Master Admin"?"bg-purple-700 hover:bg-purple-800":""}
                  ${u.name==="Group Admin"?"bg-green-600 hover:bg-green-700":""}
                  ${u.name==="Finance Manager"?"bg-indigo-600 hover:bg-indigo-700":""}
                `,children:u.name},u.path))}),t&&e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-700"}),e.jsx("div",{className:"mt-6 border-t border-gray-200 pt-4 w-full",children:e.jsx("a",{href:"/",className:"text-sm text-blue-600 hover:underline",children:"Back to regular login"})})]})})})},Bn=[{id:1,name:"Sarah Johnson",email:"sarah.johnson@dealership.com",phone:"(555) 123-4567",role:"Sales Associate",team:"Team A",status:"active",performance:"top",joinDate:"2021-03-12",deals:24,lastActivity:"2 hours ago"},{id:2,name:"Michael Chen",email:"michael.chen@dealership.com",phone:"(555) 234-5678",role:"Sales Associate",team:"Team A",status:"active",performance:"high",joinDate:"2021-06-15",deals:20,lastActivity:"4 hours ago"},{id:3,name:"David Rodriguez",email:"david.rodriguez@dealership.com",phone:"(555) 345-6789",role:"Sales Associate",team:"Team A",status:"active",performance:"high",joinDate:"2022-01-07",deals:18,lastActivity:"35 minutes ago"},{id:4,name:"Amanda Williams",email:"amanda.williams@dealership.com",phone:"(555) 456-7890",role:"Sales Associate",team:"Team B",status:"active",performance:"medium",joinDate:"2022-03-28",deals:16,lastActivity:"1 day ago"},{id:5,name:"Robert Johnson",email:"robert.johnson@dealership.com",phone:"(555) 567-8901",role:"Sales Associate",team:"Team B",status:"active",performance:"medium",joinDate:"2022-05-10",deals:15,lastActivity:"3 hours ago"},{id:6,name:"Lisa Thompson",email:"lisa.thompson@dealership.com",phone:"(555) 678-9012",role:"Sales Associate",team:"Team B",status:"inactive",performance:"low",joinDate:"2022-08-22",deals:8,lastActivity:"2 weeks ago"}],ji=[{team:"Team A",members:3,dealsTotal:62,avgDealsPerMember:20.7,grossTotal:87800,avgGross:1415.5,closingRatio:32},{team:"Team B",members:3,dealsTotal:39,avgDealsPerMember:13,grossTotal:52600,avgGross:1348.7,closingRatio:28}],x1=()=>{const[t,s]=l.useState(""),[r,n]=l.useState("all"),[a,o]=l.useState("members"),[i,c]=l.useState(null),[d,m]=l.useState(""),[h,u]=l.useState(!1),[f,b]=l.useState(""),[p,x]=l.useState("#4f46e5"),v=Bn.filter(g=>{const w=g.name.toLowerCase().includes(t.toLowerCase())||g.email.toLowerCase().includes(t.toLowerCase()),S=r==="all"||g.team===r;return w&&S}),y=g=>{c(g),m(g.team)},j=()=>{console.log(`Changed ${i.name}'s team to ${d}`),c(null)},N=()=>{if(!f.trim()){alert("Please enter a team name");return}console.log(`Created new team: ${f} with color ${p}`),b(""),x("#4f46e5"),u(!1)};return e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{variant:"ghost",size:"sm",asChild:!0,className:"mr-2",children:e.jsxs(us,{to:"/dashboard",children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Team Management"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",onClick:()=>u(!0),children:[e.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Add Team"]}),e.jsxs(I,{children:[e.jsx(eo,{className:"mr-2 h-4 w-4"}),"Add Team Member"]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Total Team Members"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Bn.length}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Bn.filter(g=>g.status==="active").length," active members"]})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Total Deals (MTD)"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ji.reduce((g,w)=>g+w.dealsTotal,0)}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+8% from last month"})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Avg Deals Per Person"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(ji.reduce((g,w)=>g+w.dealsTotal,0)/Bn.filter(g=>g.status==="active").length).toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Target: 15 deals"})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Avg Closing Ratio"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[(ji.reduce((g,w)=>g+w.closingRatio*w.members,0)/Bn.filter(g=>g.status==="active").length).toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"+2.5% from last month"})]})]})]}),e.jsxs(_r,{value:a,onValueChange:o,className:"mb-6",children:[e.jsxs(Xs,{children:[e.jsxs(Ve,{value:"members",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Team Members"]}),e.jsxs(Ve,{value:"performance",children:[e.jsx(pu,{className:"h-4 w-4 mr-2"}),"Performance"]}),e.jsxs(Ve,{value:"training",children:[e.jsx(Pc,{className:"h-4 w-4 mr-2"}),"Training & Development"]})]}),e.jsx(ze,{value:"members",className:"mt-6",children:e.jsxs(B,{children:[e.jsx(W,{className:"pb-4",children:e.jsxs("div",{className:"flex justify-between flex-wrap gap-4",children:[e.jsx(z,{children:"Team Members"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(gl,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(be,{type:"search",placeholder:"Search members...",className:"w-64 pl-8",value:t,onChange:g=>s(g.target.value)})]}),e.jsxs(mt,{value:r,onValueChange:n,children:[e.jsx(rt,{className:"w-36",children:e.jsx(ht,{placeholder:"Select Team"})}),e.jsxs(nt,{children:[e.jsx(Re,{value:"all",children:"All Teams"}),e.jsx(Re,{value:"Team A",children:"Team A"}),e.jsx(Re,{value:"Team B",children:"Team B"})]})]})]})]})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Role"}),e.jsx(H,{children:"Team"}),e.jsx(H,{children:"Deals (MTD)"}),e.jsx(H,{children:"Status"}),e.jsx(H,{children:"Last Activity"}),e.jsx(H,{className:"text-right",children:"Actions"})]})}),e.jsx(it,{children:v.map(g=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Ur,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{children:g.name}),e.jsx("div",{className:"text-xs text-gray-500",children:g.email})]})]})}),e.jsx(U,{children:g.role}),e.jsx(U,{children:g.team}),e.jsx(U,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`font-medium ${g.performance==="top"?"text-green-600":g.performance==="high"?"text-blue-600":g.performance==="medium"?"text-amber-600":"text-gray-600"}`,children:g.deals}),g.performance==="top"&&e.jsx(Pc,{className:"ml-1 h-4 w-4 text-green-600"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(aa,{checked:g.status==="active",onCheckedChange:w=>{const S=w?"active":"inactive";console.log(`Set ${g.name} to ${S}`),S==="inactive"&&alert(`A notification has been sent to the Admin to delete ${g.name}.`)},id:`active-status-${g.id}`}),e.jsx("label",{htmlFor:`active-status-${g.id}`,className:"ml-2 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${g.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.status==="active"?"Active":"Inactive"})})]})}),e.jsx(U,{children:e.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[e.jsx(fr,{className:"mr-1 h-3 w-3"}),g.lastActivity]})}),e.jsx(U,{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>y(g),children:e.jsx(pr,{className:"h-4 w-4"})})})})]},g.id))})]})})]})}),e.jsx(ze,{value:"performance",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Team Performance"})}),e.jsxs(V,{children:[e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-right",children:"Total Units"}),e.jsx(H,{className:"text-right",children:"New Units"}),e.jsx(H,{className:"text-right",children:"Used Units"}),e.jsx(H,{className:"text-right",children:"Total Gross"}),e.jsx(H,{className:"text-right",children:"PVR"})]})}),e.jsx(it,{children:[{team:"Team A",members:3,totalUnits:62,newUnits:36,usedUnits:26,totalGross:124500,pvr:2008,lastMonth:58,ytd:394,avgMonthly:65.7,annualPace:788,closingRatio:32},{team:"Team B",members:2,totalUnits:38,newUnits:22,usedUnits:16,totalGross:76e3,pvr:2e3,lastMonth:30,ytd:224,avgMonthly:37.3,annualPace:448,closingRatio:28}].map(g=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:g.team}),e.jsx(U,{className:"text-right",children:g.totalUnits}),e.jsx(U,{className:"text-right",children:g.newUnits}),e.jsx(U,{className:"text-right",children:g.usedUnits}),e.jsxs(U,{className:"text-right",children:["$",g.totalGross.toLocaleString()]}),e.jsxs(U,{className:"text-right",children:["$",g.pvr]})]},g.team))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium mb-4",children:"Extended Metrics"}),e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-right",children:"Last Month"}),e.jsx(H,{className:"text-right",children:"YTD"}),e.jsx(H,{className:"text-right",children:"Avg/Month"}),e.jsx(H,{className:"text-right",children:"Annual Pace"})]})}),e.jsx(it,{children:[{team:"Team A",members:3,totalUnits:62,newUnits:36,usedUnits:26,totalGross:124500,pvr:2008,lastMonth:58,ytd:394,avgMonthly:65.7,annualPace:788,closingRatio:32},{team:"Team B",members:2,totalUnits:38,newUnits:22,usedUnits:16,totalGross:76e3,pvr:2e3,lastMonth:30,ytd:224,avgMonthly:37.3,annualPace:448,closingRatio:28}].map(g=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:g.team}),e.jsx(U,{className:"text-right",children:g.lastMonth}),e.jsx(U,{className:"text-right",children:g.ytd}),e.jsx(U,{className:"text-right",children:g.avgMonthly.toFixed(1)}),e.jsx(U,{className:"text-right",children:g.annualPace})]},g.team))})]})]})]})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Performance Indicators"})}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Closing Ratio"}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[e.jsx(Li,{className:"inline-block h-4 w-4 mr-1"}),"Good"]})]}),e.jsx("div",{className:"h-2.5 w-full bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:"85%"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"Current: 30%"}),e.jsx("span",{children:"Target: 25%"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Deals Per Person"}),e.jsxs("span",{className:"text-sm font-medium text-amber-600",children:[e.jsx(xn,{className:"inline-block h-4 w-4 mr-1"}),"Average"]})]}),e.jsx("div",{className:"h-2.5 w-full bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:"68%"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"Current: 12.2"}),e.jsx("span",{children:"Target: 15"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Customer Satisfaction"}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[e.jsx(Li,{className:"inline-block h-4 w-4 mr-1"}),"Excellent"]})]}),e.jsx("div",{className:"h-2.5 w-full bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:"92%"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"Current: 4.7/5"}),e.jsx("span",{children:"Target: 4.5/5"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Follow-up Completion"}),e.jsxs("span",{className:"text-sm font-medium text-amber-600",children:[e.jsx(xn,{className:"inline-block h-4 w-4 mr-1"}),"Needs Improvement"]})]}),e.jsx("div",{className:"h-2.5 w-full bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:"65%"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"Current: 65%"}),e.jsx("span",{children:"Target: 90%"})]})]})]})})]})]})}),e.jsx(ze,{value:"training",className:"mt-6",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Training & Development"})}),e.jsx(V,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(en,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Training Module Coming Soon"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"The training and development module is currently under development. Check back soon for updates on training courses, certifications, and skill development tracking."})]})})]})})]}),e.jsx(jr,{open:h,onOpenChange:u,children:e.jsxs(qs,{children:[e.jsxs(Ys,{children:[e.jsx(Js,{children:"Add New Team"}),e.jsx(Qs,{children:"Create a new team to organize your salespeople."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"team-name",children:"Team Name"}),e.jsx(be,{id:"team-name",placeholder:"Enter team name",value:f,onChange:g=>b(g.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"team-color",children:"Team Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",id:"team-color",value:p,onChange:g=>x(g.target.value),className:"p-0 h-9 w-9 border rounded cursor-pointer"}),e.jsx("div",{className:"text-sm",children:p})]})]})]}),e.jsxs(Ks,{children:[e.jsx(I,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(I,{onClick:N,children:"Create Team"})]})]})}),i&&e.jsx(jr,{open:!!i,onOpenChange:()=>c(null),children:e.jsxs(qs,{children:[e.jsxs(Ys,{children:[e.jsx(Js,{children:"Edit Team Assignment"}),e.jsxs(Qs,{children:["Change the team assignment for ",i.name,". Sales Managers can only modify team assignments."]})]}),e.jsxs("div",{className:"py-4",children:[e.jsx(fe,{htmlFor:"team-select",children:"Team Assignment"}),e.jsxs(mt,{value:d,onValueChange:m,children:[e.jsx(rt,{id:"team-select",children:e.jsx(ht,{placeholder:"Select Team"})}),e.jsxs(nt,{children:[e.jsx(Re,{value:"Team A",children:"Team A"}),e.jsx(Re,{value:"Team B",children:"Team B"})]})]})]}),e.jsxs(Ks,{children:[e.jsx(I,{variant:"outline",onClick:()=>c(null),children:"Cancel"}),e.jsx(I,{onClick:j,children:"Save Changes"})]})]})})]})},wi=[{id:1,name:"Sarah Johnson",team:"Team A",currentUnits:24,goalUnits:30,lastMonth:28,avgMonthly:26,grossTarget:45e3,currentGross:38500,frontGrossGoal:1200,backEndGoal:900},{id:2,name:"Michael Chen",team:"Team A",currentUnits:20,goalUnits:25,lastMonth:22,avgMonthly:21,grossTarget:38e3,currentGross:32100,frontGrossGoal:1100,backEndGoal:850},{id:3,name:"David Rodriguez",team:"Team A",currentUnits:18,goalUnits:22,lastMonth:16,avgMonthly:18,grossTarget:32e3,currentGross:28700,frontGrossGoal:950,backEndGoal:800},{id:4,name:"Amanda Williams",team:"Team B",currentUnits:16,goalUnits:20,lastMonth:14,avgMonthly:15,grossTarget:3e4,currentGross:21800,frontGrossGoal:900,backEndGoal:750},{id:5,name:"Robert Johnson",team:"Team B",currentUnits:15,goalUnits:18,lastMonth:16,avgMonthly:14,grossTarget:28e3,currentGross:19500,frontGrossGoal:850,backEndGoal:700}],fd=[{id:1,name:"Team A",members:3,currentUnits:62,goalUnits:75,lastMonth:66,grossTarget:115e3,currentGross:99300,closingRatioTarget:35,currentClosingRatio:32,frontEndTarget:1200,backEndTarget:800},{id:2,name:"Team B",members:2,currentUnits:31,goalUnits:40,lastMonth:30,grossTarget:6e4,currentGross:41300,closingRatioTarget:30,currentClosingRatio:28,frontEndTarget:1100,backEndTarget:700}],Xr={newVehicles:65,usedVehicles:50,totalUnits:115,totalGross:175e3,avgGrossPerUnit:1500,closingRatio:32},p1=()=>{const[t,s]=l.useState("individual"),[r,n]=l.useState(!1),o=(()=>{const i=wi.reduce((d,m)=>d+m.currentUnits,0),c=wi.reduce((d,m)=>d+m.goalUnits,0);return{currentUnits:i,goalUnits:c,percentage:Math.round(i/c*100)}})();return e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{variant:"ghost",size:"sm",asChild:!0,className:"mr-2",children:e.jsxs(us,{to:"/dashboard",children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Set Team Goals"})]}),e.jsx(I,{onClick:()=>n(!r),children:r?e.jsxs(e.Fragment,{children:[e.jsx(ea,{className:"mr-2 h-4 w-4"}),"Save Goals"]}):e.jsxs(e.Fragment,{children:[e.jsx(pr,{className:"mr-2 h-4 w-4"}),"Edit Goals"]})})]}),e.jsxs(B,{className:"mb-6",children:[e.jsx(W,{className:"pb-2",children:e.jsxs(z,{className:"flex items-center",children:[e.jsx(Or,{className:"mr-2 h-5 w-5 text-blue-600"}),"Monthly Dealership Targets"]})}),e.jsx(V,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"New Vehicles"}),e.jsxs("div",{className:"text-xl font-bold flex items-center",children:[e.jsx(Ss,{className:"mr-2 h-4 w-4 text-green-600"}),Xr.newVehicles]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Used Vehicles"}),e.jsxs("div",{className:"text-xl font-bold flex items-center",children:[e.jsx(Ss,{className:"mr-2 h-4 w-4 text-amber-600"}),Xr.usedVehicles]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Total Units"}),e.jsxs("div",{className:"text-xl font-bold flex items-center",children:[e.jsx(Vt,{className:"mr-2 h-4 w-4 text-blue-600"}),Xr.totalUnits]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Total Gross"}),e.jsxs("div",{className:"text-xl font-bold flex items-center",children:[e.jsx(ms,{className:"mr-2 h-4 w-4 text-purple-600"}),"$",Xr.totalGross.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Avg. Gross/Unit"}),e.jsxs("div",{className:"text-xl font-bold flex items-center",children:[e.jsx(So,{className:"mr-2 h-4 w-4 text-indigo-600"}),"$",Xr.avgGrossPerUnit.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Closing Ratio"}),e.jsxs("div",{className:"text-xl font-bold flex items-center",children:[e.jsx(s0,{className:"mr-2 h-4 w-4 text-blue-600"}),Xr.closingRatio,"%"]})]})]})})]}),e.jsxs(B,{className:"mb-6",children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{children:"Overall Goal Progress"})}),e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center mb-4 md:mb-0",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mr-4",children:e.jsx(Or,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Total Units Sold"}),e.jsxs("div",{className:"text-2xl font-bold",children:[o.currentUnits," / ",o.goalUnits]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[o.percentage,"% of monthly goal"]})]})]}),e.jsxs("div",{className:"w-full md:w-3/5",children:[e.jsx("div",{className:"h-4 w-full bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${o.percentage>=90?"bg-green-500":o.percentage>=70?"bg-blue-500":o.percentage>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.min(o.percentage,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0"}),e.jsx("span",{children:"25%"}),e.jsx("span",{children:"50%"}),e.jsx("span",{children:"75%"}),e.jsx("span",{children:"100%"})]})]})]})})]}),e.jsxs(_r,{value:t,onValueChange:s,className:"mb-6",children:[e.jsxs(Xs,{children:[e.jsxs(Ve,{value:"individual",children:[e.jsx(x0,{className:"h-4 w-4 mr-2"}),"Individual Goals"]}),e.jsxs(Ve,{value:"team",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Team Goals"]}),e.jsxs(Ve,{value:"history",children:[e.jsx(Bt,{className:"h-4 w-4 mr-2"}),"Historical Data"]})]}),e.jsx(ze,{value:"individual",className:"mt-6",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Individual Salesperson Goals"})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-right",children:"Current"}),e.jsx(H,{className:"text-right",children:"Goal"}),e.jsx(H,{className:"text-right",children:"Last Month"}),e.jsx(H,{className:"text-right",children:"Progress"}),e.jsx(H,{className:"text-right",children:"Gross"}),e.jsx(H,{className:"text-right",children:"Avg Front Gross"}),e.jsx(H,{className:"text-right",children:"Avg Back End Gross"})]})}),e.jsx(it,{children:wi.map(i=>{const c=Math.round(i.currentUnits/i.goalUnits*100),d=i.currentUnits-i.lastMonth;return e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:i.name}),e.jsx(U,{children:i.team}),e.jsx(U,{className:"text-right",children:i.currentUnits}),e.jsx(U,{className:"text-right",children:r?e.jsx(be,{type:"number",defaultValue:i.goalUnits,className:"w-16 h-8 text-right inline-block"}):i.goalUnits}),e.jsx(U,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end",children:[i.lastMonth," ",d>0?e.jsx(Qt,{className:"ml-1 h-3 w-3 text-green-600"}):d<0?e.jsx(Jt,{className:"ml-1 h-3 w-3 text-red-600"}):null]})}),e.jsx(U,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("div",{className:"w-20 h-2 bg-gray-100 rounded-full mr-2 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${c>=90?"bg-green-500":c>=70?"bg-blue-500":c>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.min(c,100)}%`}})}),e.jsxs("span",{className:"text-xs",children:[c,"%"]})]})}),e.jsxs(U,{className:"text-right",children:["$",i.currentGross.toLocaleString()," / $",i.grossTarget.toLocaleString()]}),e.jsx(U,{className:"text-right",children:r?e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(be,{type:"number",defaultValue:i.frontGrossGoal,min:"0",max:"9999",step:"1",className:"w-20 h-8 text-right inline-block"}),e.jsx("span",{children:"$"})]}):"$"+i.frontGrossGoal.toLocaleString(void 0,{maximumFractionDigits:0})}),e.jsx(U,{className:"text-right",children:r?e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(be,{type:"number",defaultValue:i.backEndGoal,min:"0",max:"9999",step:"1",className:"w-20 h-8 text-right inline-block"}),e.jsx("span",{children:"$"})]}):"$"+i.backEndGoal.toLocaleString(void 0,{maximumFractionDigits:0})})]},i.id)})})]})})]})}),e.jsx(ze,{value:"team",className:"mt-6",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Team Goals"})}),e.jsxs(V,{children:[e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-right",children:"Members"}),e.jsx(H,{className:"text-right",children:"Current / Goal"}),e.jsx(H,{className:"text-right",children:"Last Month"}),e.jsx(H,{className:"text-right",children:"Progress"}),e.jsx(H,{className:"text-right",children:"Gross"}),e.jsx(H,{className:"text-right",children:"Closing Ratio"})]})}),e.jsx(it,{children:fd.map(i=>{const c=Math.round(i.currentUnits/i.goalUnits*100),d=i.currentUnits-i.lastMonth;return e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:i.name}),e.jsx(U,{className:"text-right",children:i.members}),e.jsxs(U,{className:"text-right",children:[i.currentUnits," /"," ",r?e.jsx(be,{type:"number",defaultValue:i.goalUnits,className:"w-16 h-8 text-right inline-block"}):i.goalUnits]}),e.jsx(U,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end",children:[i.lastMonth," ",d>0?e.jsx(Qt,{className:"ml-1 h-3 w-3 text-green-600"}):d<0?e.jsx(Jt,{className:"ml-1 h-3 w-3 text-red-600"}):null]})}),e.jsx(U,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("div",{className:"w-20 h-2 bg-gray-100 rounded-full mr-2 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${c>=90?"bg-green-500":c>=70?"bg-blue-500":c>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.min(c,100)}%`}})}),e.jsxs("span",{className:"text-xs",children:[c,"%"]})]})}),e.jsxs(U,{className:"text-right",children:["$",i.currentGross.toLocaleString()," / $",i.grossTarget.toLocaleString()]}),e.jsxs(U,{className:"text-right",children:[i.currentClosingRatio,"% /"," ",r?e.jsx(be,{type:"number",defaultValue:i.closingRatioTarget,className:"w-12 h-8 text-right inline-block"}):`${i.closingRatioTarget}%`]})]},i.id)})})]}),e.jsxs("div",{className:"mt-8 grid md:grid-cols-2 gap-6",children:[e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm",children:"Front End / Back End Targets"})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-right",children:"Front End Target"}),e.jsx(H,{className:"text-right",children:"Back End Target"})]})}),e.jsx(it,{children:fd.map(i=>e.jsxs(Se,{children:[e.jsx(U,{children:i.name}),e.jsxs(U,{className:"text-right",children:["$",r?e.jsx(be,{type:"number",defaultValue:i.frontEndTarget,className:"w-20 h-8 text-right inline-block"}):i.frontEndTarget.toLocaleString()]}),e.jsxs(U,{className:"text-right",children:["$",r?e.jsx(be,{type:"number",defaultValue:i.backEndTarget,className:"w-20 h-8 text-right inline-block"}):i.backEndTarget.toLocaleString()]})]},`fe-${i.id}`))})]})})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm",children:"Performance Bonus Structure"})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Achievement Level"}),e.jsx(H,{className:"text-right",children:"Team Bonus"}),e.jsx(H,{className:"text-right",children:"Individual Bonus"})]})}),e.jsxs(it,{children:[e.jsxs(Se,{children:[e.jsx(U,{children:"100% of Goal"}),e.jsx(U,{className:"text-right",children:"$1,000"}),e.jsx(U,{className:"text-right",children:"$500"})]}),e.jsxs(Se,{children:[e.jsx(U,{children:"110% of Goal"}),e.jsx(U,{className:"text-right",children:"$2,000"}),e.jsx(U,{className:"text-right",children:"$1,000"})]}),e.jsxs(Se,{children:[e.jsx(U,{children:"120% of Goal"}),e.jsx(U,{className:"text-right",children:"$3,500"}),e.jsx(U,{className:"text-right",children:"$1,500"})]})]})]})})]})]})]})]})}),e.jsx(ze,{value:"history",className:"mt-6",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Historical Performance"})}),e.jsx(V,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Bt,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Historical Data Module Coming Soon"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"The historical performance and goals tracking module is currently under development. Check back soon for detailed reports on past performance and goal achievement."})]})})]})})]})]})},xd=[{id:1,name:"Sarah Johnson",team:"Team A",color:"#4f46e5"},{id:2,name:"Michael Chen",team:"Team A",color:"#4f46e5"},{id:3,name:"David Rodriguez",team:"Team A",color:"#4f46e5"},{id:4,name:"Amanda Williams",team:"Team B",color:"#0891b2"},{id:5,name:"Robert Johnson",team:"Team B",color:"#0891b2"}],Ha=[{id:1,name:"Opening (9am-6pm)",color:"#22c55e"},{id:2,name:"Mid (10am-7pm)",color:"#3b82f6"},{id:3,name:"Closing (12pm-9pm)",color:"#8b5cf6"},{id:4,name:"Weekend (9am-5pm)",color:"#f59e0b"},{id:5,name:"Off",color:"#e5e7eb"}],Ni=[{date:"2023-06-12",day:"Monday",shifts:[{memberId:1,shiftTypeId:1},{memberId:2,shiftTypeId:1},{memberId:3,shiftTypeId:1},{memberId:4,shiftTypeId:5},{memberId:5,shiftTypeId:5}]},{date:"2023-06-13",day:"Tuesday",shifts:[{memberId:1,shiftTypeId:1},{memberId:2,shiftTypeId:1},{memberId:3,shiftTypeId:1},{memberId:4,shiftTypeId:5},{memberId:5,shiftTypeId:5}]},{date:"2023-06-14",day:"Wednesday",shifts:[{memberId:1,shiftTypeId:2},{memberId:2,shiftTypeId:2},{memberId:3,shiftTypeId:2},{memberId:4,shiftTypeId:5},{memberId:5,shiftTypeId:5}]},{date:"2023-06-15",day:"Thursday",shifts:[{memberId:1,shiftTypeId:5},{memberId:2,shiftTypeId:5},{memberId:3,shiftTypeId:5},{memberId:4,shiftTypeId:1},{memberId:5,shiftTypeId:1}]},{date:"2023-06-16",day:"Friday",shifts:[{memberId:1,shiftTypeId:5},{memberId:2,shiftTypeId:5},{memberId:3,shiftTypeId:5},{memberId:4,shiftTypeId:3},{memberId:5,shiftTypeId:3}]},{date:"2023-06-17",day:"Saturday",shifts:[{memberId:1,shiftTypeId:4},{memberId:2,shiftTypeId:4},{memberId:3,shiftTypeId:4},{memberId:4,shiftTypeId:4},{memberId:5,shiftTypeId:4}]},{date:"2023-06-18",day:"Sunday",shifts:[{memberId:1,shiftTypeId:5},{memberId:2,shiftTypeId:5},{memberId:3,shiftTypeId:5},{memberId:4,shiftTypeId:4},{memberId:5,shiftTypeId:5}]}],Si=(t=new Date)=>{const s=[],r=new Date(t);r.setDate(r.getDate()-r.getDay());for(let n=0;n<7;n++)s.push(new Date(r)),r.setDate(r.getDate()+1);return s},pd=t=>t.toISOString().split("T")[0],g1=()=>{const[t,s]=l.useState(new Date),[r,n]=l.useState("week"),[a,o]=l.useState(Si()),[i,c]=l.useState(null),[d,m]=l.useState(null),[h,u]=l.useState(null),f=j=>{const N=new Date(a[0]);N.setDate(N.getDate()+(j==="next"?7:-7)),o(Si(N))},b=j=>Ha.find(N=>N.id===j),p=(j,N)=>{const g=Ni.find(S=>S.date===N);if(!g)return null;const w=g.shifts.find(S=>S.memberId===j);return w?b(w.shiftTypeId):null},x=(j,N)=>{const g=Ni.find(S=>S.date===N);if(!g)return;const w=g.shifts.find(S=>S.memberId===j);c({memberId:j,date:N}),m(xd.find(S=>S.id===j)),u(w?b(w.shiftTypeId):null)},v=()=>{console.log("Saving shift:",{memberId:d.id,date:i.date,shiftTypeId:h.id}),c(null),m(null),u(null)},y=new Intl.DateTimeFormat("en-US",{month:"long",year:"numeric"}).format(a[0]);return e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{variant:"ghost",size:"sm",asChild:!0,className:"mr-2",children:e.jsxs(us,{to:"/dashboard",children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Sales Schedule Configurator"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(o0,{className:"mr-2 h-4 w-4"}),"Copy Last Week"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Export Schedule"]}),e.jsxs(I,{children:[e.jsx(ea,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]}),e.jsxs(B,{className:"mb-6",children:[e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bt,{className:"h-5 w-5 text-gray-500 mr-2"}),e.jsx(z,{children:y})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>f("prev"),children:[e.jsx(Ws,{className:"h-4 w-4"}),"Previous Week"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>o(Si(new Date)),children:"Today"}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>f("next"),children:["Next Week",e.jsx(Nr,{className:"ml-2 h-4 w-4"})]})]})]})}),e.jsx(V,{className:"pb-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-full",children:[e.jsxs("div",{className:"grid grid-cols-8 border-b",children:[e.jsx("div",{className:"font-medium text-sm p-3 border-r bg-gray-50",children:"Team Member"}),a.map((j,N)=>{const g=new Date().toDateString()===j.toDateString();return e.jsxs("div",{className:`p-3 text-center border-r last:border-r-0 ${g?"bg-blue-50":"bg-gray-50"}`,children:[e.jsx("div",{className:"font-medium text-sm",children:j.toLocaleDateString("en-US",{weekday:"short"})}),e.jsx("div",{className:`text-xs ${g?"font-bold text-blue-700":"text-gray-500"}`,children:j.toLocaleDateString("en-US",{month:"short",day:"numeric"})})]},N)})]}),xd.map(j=>e.jsxs("div",{className:"grid grid-cols-8 border-b last:border-b-0",children:[e.jsxs("div",{className:"p-3 flex items-center border-r bg-gray-50",children:[e.jsx("div",{className:"w-2 h-2 rounded-full mr-2",style:{backgroundColor:j.color}}),e.jsx("div",{className:"text-sm font-medium",children:j.name})]}),a.map((N,g)=>{const w=pd(N),S=p(j.id,w);return e.jsx("div",{className:"p-2 border-r last:border-r-0 text-center cursor-pointer hover:bg-gray-50",onClick:()=>x(j.id,w),children:S?e.jsx("div",{className:"text-xs p-1 rounded",style:{backgroundColor:S.color+"20",borderLeft:`3px solid ${S.color}`},children:S.name}):e.jsx("div",{className:"text-xs text-gray-400 italic p-1",children:"Unassigned"})},`${j.id}-${g}`)})]},j.id))]})})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Team Coverage"})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Day"}),e.jsx(H,{children:"Date"}),e.jsx(H,{className:"text-right",children:"Opening"}),e.jsx(H,{className:"text-right",children:"Mid"}),e.jsx(H,{className:"text-right",children:"Closing"}),e.jsx(H,{className:"text-right",children:"Off"})]})}),e.jsx(it,{children:a.map((j,N)=>{const g=pd(j),w=Ni.find(P=>P.date===g),S={opening:0,mid:0,closing:0,weekend:0,off:0};return w&&w.shifts.forEach(P=>{P.shiftTypeId===1?S.opening++:P.shiftTypeId===2?S.mid++:P.shiftTypeId===3?S.closing++:P.shiftTypeId===4?S.weekend++:P.shiftTypeId===5&&S.off++}),e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:j.toLocaleDateString("en-US",{weekday:"short"})}),e.jsx(U,{children:j.toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(U,{className:"text-right",children:S.opening>0?S.opening:"-"}),e.jsx(U,{className:"text-right",children:S.mid>0?S.mid:"-"}),e.jsx(U,{className:"text-right",children:S.closing>0||S.weekend>0?S.closing+S.weekend:"-"}),e.jsx(U,{className:"text-right",children:S.off>0?S.off:"-"})]},N)})})]})})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Shift Types"})}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-4",children:[Ha.map(j=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full mr-2",style:{backgroundColor:j.color}}),e.jsx("div",{className:"flex-grow",children:e.jsx("div",{className:"font-medium text-sm",children:j.name})}),e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(pr,{className:"h-4 w-4"})})]},j.id)),e.jsxs(I,{variant:"outline",className:"w-full mt-2",size:"sm",children:[e.jsx(Vs,{className:"h-4 w-4 mr-2"}),"Add Shift Type"]})]})})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Edit Shift"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"member",children:"Team Member"}),e.jsx("div",{className:"text-sm font-medium mt-1",children:d==null?void 0:d.name})]}),e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"date",children:"Date"}),e.jsx("div",{className:"text-sm font-medium mt-1",children:new Date(i.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"shift-type",children:"Shift Type"}),e.jsxs(mt,{value:(h==null?void 0:h.id.toString())||"",onValueChange:j=>{const N=Ha.find(g=>g.id===parseInt(j));u(N)},children:[e.jsx(rt,{id:"shift-type",children:e.jsx(ht,{placeholder:"Select a shift type"})}),e.jsx(nt,{children:Ha.map(j=>e.jsx(Re,{value:j.id.toString(),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:j.color}}),j.name]})},j.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>{c(null),m(null),u(null)},children:"Cancel"}),e.jsx(I,{onClick:v,children:"Save"})]})]})]})})]})};function v1(t){const s=b1(t),r=l.forwardRef((n,a)=>{const{children:o,...i}=n,c=l.Children.toArray(o),d=c.find(j1);if(d){const m=d.props.children,h=c.map(u=>u===d?l.Children.count(m)>1?l.Children.only(null):l.isValidElement(m)?m.props.children:null:u);return e.jsx(s,{...i,ref:a,children:l.isValidElement(m)?l.cloneElement(m,void 0,h):null})}return e.jsx(s,{...i,ref:a,children:o})});return r.displayName=`${t}.Slot`,r}function b1(t){const s=l.forwardRef((r,n)=>{const{children:a,...o}=r,i=l.isValidElement(a)?N1(a):void 0,c=Me(i,n);if(l.isValidElement(a)){const d=w1(o,a.props);return a.type!==l.Fragment&&(d.ref=c),l.cloneElement(a,d)}return l.Children.count(a)>1?l.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var y1=Symbol("radix.slottable");function j1(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===y1}function w1(t,s){const r={...s};for(const n in s){const a=t[n],o=s[n];/^on[A-Z]/.test(n)?a&&o?r[n]=(...c)=>{const d=o(...c);return a(...c),d}:a&&(r[n]=a):n==="style"?r[n]={...a,...o}:n==="className"&&(r[n]=[a,o].filter(Boolean).join(" "))}return{...t,...r}}function N1(t){var n,a;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var S1=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Kl=S1.reduce((t,s)=>{const r=v1(`Primitive.${s}`),n=l.forwardRef((a,o)=>{const{asChild:i,...c}=a,d=i?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:o})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{}),Ho="Collapsible",[C1,RS]=Wt(Ho),[P1,Jl]=C1(Ho),kf=l.forwardRef((t,s)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:o,onOpenChange:i,...c}=t,[d,m]=Ps({prop:n,defaultProp:a??!1,onChange:i,caller:Ho});return e.jsx(P1,{scope:r,disabled:o,contentId:Zt(),open:d,onOpenToggle:l.useCallback(()=>m(h=>!h),[m]),children:e.jsx(Kl.div,{"data-state":Xl(d),"data-disabled":o?"":void 0,...c,ref:s})})});kf.displayName=Ho;var Rf="CollapsibleTrigger",If=l.forwardRef((t,s)=>{const{__scopeCollapsible:r,...n}=t,a=Jl(Rf,r);return e.jsx(Kl.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Xl(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:s,onClick:oe(t.onClick,a.onOpenToggle)})});If.displayName=Rf;var Ql="CollapsibleContent",Ff=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,a=Jl(Ql,t.__scopeCollapsible);return e.jsx(jt,{present:r||a.open,children:({present:o})=>e.jsx(_1,{...n,ref:s,present:o})})});Ff.displayName=Ql;var _1=l.forwardRef((t,s)=>{const{__scopeCollapsible:r,present:n,children:a,...o}=t,i=Jl(Ql,r),[c,d]=l.useState(n),m=l.useRef(null),h=Me(s,m),u=l.useRef(0),f=u.current,b=l.useRef(0),p=b.current,x=i.open||c,v=l.useRef(x),y=l.useRef(void 0);return l.useEffect(()=>{const j=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(j)},[]),xt(()=>{const j=m.current;if(j){y.current=y.current||{transitionDuration:j.style.transitionDuration,animationName:j.style.animationName},j.style.transitionDuration="0s",j.style.animationName="none";const N=j.getBoundingClientRect();u.current=N.height,b.current=N.width,v.current||(j.style.transitionDuration=y.current.transitionDuration,j.style.animationName=y.current.animationName),d(n)}},[i.open,n]),e.jsx(Kl.div,{"data-state":Xl(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!x,...o,ref:h,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...t.style},children:x&&a})});function Xl(t){return t?"open":"closed"}var D1=kf;const A1=D1,E1=If,T1=Ff,Vn=[{month:"Jan",newVehicles:42,usedVehicles:38,totalSales:80,avgGross:1820},{month:"Feb",newVehicles:38,usedVehicles:35,totalSales:73,avgGross:1750},{month:"Mar",newVehicles:45,usedVehicles:40,totalSales:85,avgGross:1780},{month:"Apr",newVehicles:48,usedVehicles:42,totalSales:90,avgGross:1850},{month:"May",newVehicles:52,usedVehicles:48,totalSales:100,avgGross:1930},{month:"Jun",newVehicles:58,usedVehicles:52,totalSales:110,avgGross:2100}],M1=[{team:"Team A",members:3,totalSales:62,salesPerMember:20.7,grossProfit:124500,avgGross:2008,closingRatio:32},{team:"Team B",members:2,totalSales:38,salesPerMember:19,grossProfit:74100,avgGross:1950,closingRatio:28}],k1=[{id:1,name:"Sarah Johnson",team:"Team A",newVehicles:24,usedVehicles:10,totalSales:34,grossProfit:68500,avgGross:2015,closingRatio:35},{id:2,name:"Michael Chen",team:"Team A",newVehicles:18,usedVehicles:8,totalSales:26,grossProfit:52e3,avgGross:2e3,closingRatio:30},{id:3,name:"David Rodriguez",team:"Team A",newVehicles:14,usedVehicles:8,totalSales:22,grossProfit:44e3,avgGross:2e3,closingRatio:28},{id:4,name:"Amanda Williams",team:"Team B",newVehicles:12,usedVehicles:8,totalSales:20,grossProfit:38e3,avgGross:1900,closingRatio:27},{id:5,name:"Robert Johnson",team:"Team B",newVehicles:10,usedVehicles:8,totalSales:18,grossProfit:36100,avgGross:2006,closingRatio:29}],_e={newVehicles:{total:120,inTransit:15,sold:58,available:47,reserved:10,daysOnLot:32},usedVehicles:{total:85,inTransit:8,sold:52,available:25,reserved:5,daysOnLot:24}},R1=[{type:"Sedan",count:42,percentage:38},{type:"SUV",count:35,percentage:32},{type:"Truck",count:18,percentage:16},{type:"Crossover",count:10,percentage:9},{type:"Luxury",count:5,percentage:5}],Dt={totalFinanced:92,cashDeals:18,avgRate:4.2,frontEndAvg:1460,backEndAvg:880,warrantyPenetration:68,gapPenetration:72},I1=[{id:1,name:"Central Motors - New Cars",isManagerStore:!0,storeType:"new",lastUpdated:"2025-05-08 14:30",totalSold:45,totalPending:14,totalBooked:38,tracking:52,currentFrontGross:68500,currentBackGross:38500,totalGross:107e3,avgFront:1522,avgBack:856,pvr:2378,trackingGross:119e3,forecastGross:11e4,overUnderGross:9e3,trackingUnits:56,forecastUnits:52,actualUnits:52,overUnderUnits:0,locations:[{id:101,name:"Downtown Branch - New Cars",lastUpdated:"2025-05-08 14:15",totalSold:24,totalPending:7,totalBooked:19,tracking:26,currentFrontGross:36750,currentBackGross:20800,totalGross:57550,avgFront:1531,avgBack:867,pvr:2398,trackingGross:62500,forecastGross:58e3,overUnderGross:4500,trackingUnits:28,forecastUnits:26,actualUnits:26,overUnderUnits:0},{id:102,name:"Westside Branch - New Cars",lastUpdated:"2025-05-08 14:30",totalSold:21,totalPending:7,totalBooked:19,tracking:26,currentFrontGross:31750,currentBackGross:17700,totalGross:49450,avgFront:1512,avgBack:843,pvr:2355,trackingGross:56500,forecastGross:52e3,overUnderGross:4500,trackingUnits:28,forecastUnits:26,actualUnits:26,overUnderUnits:0}]},{id:2,name:"Central Motors - Used Cars",isManagerStore:!0,storeType:"used",lastUpdated:"2025-05-08 14:45",totalSold:33,totalPending:10,totalBooked:27,tracking:37,currentFrontGross:44e3,currentBackGross:27300,totalGross:71300,avgFront:1333,avgBack:827,pvr:2160,trackingGross:79e3,forecastGross:75e3,overUnderGross:4e3,trackingUnits:39,forecastUnits:38,actualUnits:37,overUnderUnits:-1,locations:[{id:201,name:"Downtown Branch - Used Cars",lastUpdated:"2025-05-08 14:15",totalSold:17,totalPending:5,totalBooked:13,tracking:19,currentFrontGross:23e3,currentBackGross:14e3,totalGross:37e3,avgFront:1353,avgBack:824,pvr:2177,trackingGross:41500,forecastGross:37e3,overUnderGross:4500,trackingUnits:20,forecastUnits:19,actualUnits:19,overUnderUnits:0},{id:202,name:"Westside Branch - Used Cars",lastUpdated:"2025-05-08 14:30",totalSold:16,totalPending:5,totalBooked:14,tracking:18,currentFrontGross:21e3,currentBackGross:13300,totalGross:34300,avgFront:1313,avgBack:831,pvr:2144,trackingGross:37500,forecastGross:38e3,overUnderGross:-500,trackingUnits:19,forecastUnits:19,actualUnits:18,overUnderUnits:-1}]},{id:3,name:"North Region Dealerships",isManagerStore:!1,storeType:"other",lastUpdated:"2025-05-08 13:45",totalSold:64,totalPending:19,totalBooked:55,tracking:72,currentFrontGross:95200,currentBackGross:52600,totalGross:147800,avgFront:1487,avgBack:822,pvr:2309,trackingGross:165e3,forecastGross:16e4,overUnderGross:5e3,trackingUnits:78,forecastUnits:75,actualUnits:72,overUnderUnits:-3,locations:[{id:301,name:"North City Branch",lastUpdated:"2025-05-08 13:45",totalSold:36,totalPending:10,totalBooked:30,tracking:40,currentFrontGross:54e3,currentBackGross:29600,totalGross:83600,avgFront:1500,avgBack:822,pvr:2322,trackingGross:93e3,forecastGross:9e4,overUnderGross:3e3,trackingUnits:42,forecastUnits:40,actualUnits:40,overUnderUnits:0},{id:302,name:"Eastside Branch",lastUpdated:"2025-05-08 13:30",totalSold:28,totalPending:9,totalBooked:25,tracking:32,currentFrontGross:41200,currentBackGross:23e3,totalGross:64200,avgFront:1471,avgBack:821,pvr:2292,trackingGross:72e3,forecastGross:7e4,overUnderGross:2e3,trackingUnits:36,forecastUnits:35,actualUnits:32,overUnderUnits:-3}]}],F1=({data:t})=>e.jsxs(B,{className:"mb-5",children:[e.jsx(W,{className:"pb-2 pt-4",children:e.jsx(z,{className:"text-xl",children:"Sales Performance"})}),e.jsx(V,{className:"p-3",children:e.jsxs("div",{className:"space-y-3",children:[t.find(s=>s.id===1)&&e.jsx(Ci,{dealerGroup:t.find(s=>s.id===1)},1),t.find(s=>s.id===2)&&e.jsx(Ci,{dealerGroup:t.find(s=>s.id===2)},2),t.filter(s=>s.id!==1&&s.id!==2).map(s=>e.jsx(Ci,{dealerGroup:s},s.id))]})})]}),Ci=({dealerGroup:t})=>{const[s,r]=l.useState(t.isManagerStore),n=i=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),o=(()=>{switch(t.storeType){case"new":return{headerBg:"bg-blue-50",border:"border-blue-200",badge:"bg-blue-100 text-blue-800",highlight:"bg-blue-50"};case"used":return{headerBg:"bg-green-50",border:"border-green-200",badge:"bg-green-100 text-green-800",highlight:"bg-green-50"};default:return{headerBg:"bg-gray-50",border:"border-gray-200",badge:"bg-gray-100 text-gray-800",highlight:"bg-gray-50"}}})();return e.jsx(A1,{open:s,onOpenChange:r,children:e.jsxs("div",{className:`border rounded-lg overflow-hidden shadow-sm ${o.border} ${t.isManagerStore?"":"text-sm"}`,children:[e.jsx("div",{className:`${o.headerBg} border-b`,children:e.jsx(E1,{asChild:!0,children:e.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[s?e.jsx(ke,{className:"h-4 w-4 mr-2 text-gray-500"}):e.jsx(Nr,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("h3",{className:"font-semibold",children:t.name}),t.isManagerStore&&e.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs ${o.badge} rounded-full`,children:"Your Store"})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(fr,{className:"h-3 w-3 mr-1"}),t.lastUpdated]})]})})}),s&&e.jsxs("div",{className:"px-3 py-3",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-3",children:[e.jsx(Wn,{label:"Sold",value:t.totalSold,icon:e.jsx(Ss,{className:"h-3 w-3"}),color:t.storeType==="new"?"blue":t.storeType==="used"?"green":"gray"}),e.jsx(Wn,{label:"Booked",value:Math.floor(t.totalBooked*.6),icon:e.jsx(v0,{className:"h-3 w-3"}),color:t.storeType==="new"?"blue":t.storeType==="used"?"green":"gray"}),e.jsx(Wn,{label:"Pending",value:t.totalPending,icon:e.jsx(fr,{className:"h-3 w-3"}),color:t.storeType==="new"?"blue":t.storeType==="used"?"green":"gray"}),e.jsx(Wn,{label:"Tracking",value:t.tracking,icon:e.jsx(So,{className:"h-3 w-3"}),color:t.storeType==="new"?"blue":t.storeType==="used"?"green":"gray"}),e.jsx(Wn,{label:"Funded",value:Math.floor(t.totalBooked*.4),icon:e.jsx(ms,{className:"h-3 w-3"}),color:t.storeType==="new"?"blue":t.storeType==="used"?"green":"gray"})]}),e.jsxs("div",{className:`${o.highlight} p-2 rounded-lg mb-3`,children:[e.jsx("h4",{className:"font-medium text-xs text-gray-500 mb-2",children:"REVENUE"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Front Gross"}),e.jsx("p",{className:"text-base font-bold",children:n(t.currentFrontGross)}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Avg: ",n(t.avgFront)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Back Gross"}),e.jsx("p",{className:"text-base font-bold",children:n(t.currentBackGross)}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Avg: ",n(t.avgBack)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total Gross"}),e.jsx("p",{className:"text-base font-bold",children:n(t.totalGross)}),e.jsxs("p",{className:"text-xs text-gray-500",children:["PVR: ",n(t.pvr)]})]})]})]}),e.jsxs("div",{className:`${o.highlight} p-2 rounded-lg`,children:[e.jsx("h4",{className:"font-medium text-xs text-gray-500 mb-2",children:"FORECAST VS ACTUAL"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-xs mb-1",children:"Gross Revenue"}),e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Tracking:"}),e.jsx("span",{className:"font-medium ml-1",children:n(t.trackingGross)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Forecast:"}),e.jsx("span",{className:"font-medium ml-1",children:n(t.forecastGross)})]}),e.jsxs("div",{className:t.overUnderGross>=0?"text-green-600":"text-red-600",children:[e.jsx("span",{className:"mr-1",children:"+/-:"}),e.jsxs("span",{className:"font-medium",children:[t.overUnderGross>=0?"+":"",n(t.overUnderGross)]})]})]}),e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${t.overUnderGross>=0?"bg-green-500":"bg-red-500"} rounded-full`,style:{width:`${Math.min(100,Math.abs(t.trackingGross/t.forecastGross*100))}%`}})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-xs mb-1",children:"Units"}),e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Tracking:"}),e.jsx("span",{className:"font-medium ml-1",children:t.trackingUnits})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Forecast:"}),e.jsx("span",{className:"font-medium ml-1",children:t.forecastUnits})]}),e.jsxs("div",{className:t.overUnderUnits>=0?"text-green-600":"text-red-600",children:[e.jsx("span",{className:"mr-1",children:"+/-:"}),e.jsxs("span",{className:"font-medium",children:[t.overUnderUnits>=0?"+":"",t.overUnderUnits]})]})]}),e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${t.overUnderUnits>=0?"bg-green-500":"bg-red-500"} rounded-full`,style:{width:`${Math.min(100,Math.abs(t.trackingUnits/t.forecastUnits*100))}%`}})})]})]})]})]}),e.jsx(T1,{children:e.jsxs("div",{className:"border-t",children:[e.jsx("div",{className:`px-3 py-2 ${o.headerBg} border-b`,children:e.jsxs("h4",{className:"font-medium text-xs",children:["Dealership Locations (",t.locations.length,")"]})}),t.locations.map((i,c)=>e.jsxs("div",{className:`px-3 py-2 ${c<t.locations.length-1?"border-b":""}`,children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-sm",children:i.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx(fr,{className:"h-3 w-3 inline mr-1"}),i.lastUpdated]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-2 text-xs",children:[e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"text-gray-500 uppercase font-medium",children:"Sold"}),e.jsx("p",{className:"font-bold",children:i.totalSold})]}),e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"text-gray-500 uppercase font-medium",children:"Booked"}),e.jsx("p",{className:"font-bold",children:Math.floor(i.totalBooked*.6)})]}),e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"text-gray-500 uppercase font-medium",children:"Pending"}),e.jsx("p",{className:"font-bold",children:i.totalPending})]}),e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"text-gray-500 uppercase font-medium",children:"Tracking"}),e.jsx("p",{className:"font-bold",children:i.tracking})]}),e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"text-gray-500 uppercase font-medium",children:"Funded"}),e.jsx("p",{className:"font-bold",children:Math.floor(i.totalBooked*.4)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs mb-2",children:[e.jsxs("div",{className:`${o.highlight} p-1 rounded flex justify-between`,children:[e.jsx("span",{className:"text-gray-500",children:"Front:"}),e.jsx("span",{className:"font-medium",children:n(i.currentFrontGross)})]}),e.jsxs("div",{className:`${o.highlight} p-1 rounded flex justify-between`,children:[e.jsx("span",{className:"text-gray-500",children:"Back:"}),e.jsx("span",{className:"font-medium",children:n(i.currentBackGross)})]}),e.jsxs("div",{className:`${o.highlight} p-1 rounded flex justify-between`,children:[e.jsx("span",{className:"text-gray-500",children:"Total:"}),e.jsx("span",{className:"font-medium",children:n(i.totalGross)})]})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("div",{className:`flex-1 ${o.highlight} p-1 rounded flex justify-between`,children:[e.jsx("span",{className:"text-gray-500",children:"PVR:"}),e.jsx("span",{className:"font-medium",children:n(i.pvr)})]}),e.jsxs("div",{className:`flex-1 ${o.highlight} p-1 rounded flex justify-between`,children:[e.jsx("span",{className:"text-gray-500",children:"Gross +/-:"}),e.jsxs("span",{className:i.overUnderGross>=0?"text-green-600 font-medium":"text-red-600 font-medium",children:[i.overUnderGross>=0?"+":"",n(i.overUnderGross)]})]}),e.jsxs("div",{className:`flex-1 ${o.highlight} p-1 rounded flex justify-between`,children:[e.jsx("span",{className:"text-gray-500",children:"Units +/-:"}),e.jsxs("span",{className:i.overUnderUnits>=0?"text-green-600 font-medium":"text-red-600 font-medium",children:[i.overUnderUnits>=0?"+":"",i.overUnderUnits]})]})]})]},i.id))]})})]})})},Wn=({label:t,value:s,icon:r,color:n="blue"})=>{const a=()=>{switch(n){case"green":return"bg-green-50 text-green-600";case"blue":return"bg-blue-50 text-blue-600";default:return"bg-gray-50 text-gray-600"}};return e.jsxs("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("div",{className:`p-1 rounded-md ${a()}`,children:r}),e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t})]}),e.jsx("p",{className:"text-lg font-bold",children:s})]})},L1=()=>{const[t,s]=l.useState("overview"),[r,n]=l.useState("month"),[a,o]=l.useState("all"),c=(()=>{const d=Vn[Vn.length-1],m=Vn[Vn.length-2],h=(d.newVehicles-m.newVehicles)/m.newVehicles*100,u=(d.usedVehicles-m.usedVehicles)/m.usedVehicles*100,f=(d.totalSales-m.totalSales)/m.totalSales*100,b=(d.avgGross-m.avgGross)/m.avgGross*100;return{newVehicles:{count:d.newVehicles,change:h},usedVehicles:{count:d.usedVehicles,change:u},totalSales:{count:d.totalSales,change:f},avgGross:{value:d.avgGross,change:b}}})();return e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{variant:"ghost",size:"sm",asChild:!0,className:"mr-2",children:e.jsxs(us,{to:"/dashboard/sales-manager",children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Sales Reports"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(mt,{value:r,onValueChange:n,children:[e.jsxs(rt,{className:"w-36",children:[e.jsx(Bt,{className:"mr-2 h-4 w-4"}),e.jsx(ht,{})]}),e.jsxs(nt,{children:[e.jsx(Re,{value:"week",children:"This Week"}),e.jsx(Re,{value:"month",children:"This Month"}),e.jsx(Re,{value:"quarter",children:"This Quarter"}),e.jsx(Re,{value:"year",children:"This Year"})]})]}),e.jsxs(I,{variant:"outline",children:[e.jsx(i0,{className:"mr-2 h-4 w-4"}),"Export"]}),e.jsxs(I,{variant:"outline",children:[e.jsx(en,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]}),e.jsx(F1,{data:I1}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"New Vehicles Sold"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.newVehicles.count}),e.jsxs("div",{className:"flex items-center text-xs mt-1",children:[c.newVehicles.change>0?e.jsxs(e.Fragment,{children:[e.jsx(Qt,{className:"mr-1 h-3 w-3 text-green-600"}),e.jsxs("span",{className:"text-green-600",children:["+",c.newVehicles.change.toFixed(1),"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jt,{className:"mr-1 h-3 w-3 text-red-600"}),e.jsxs("span",{className:"text-red-600",children:[c.newVehicles.change.toFixed(1),"%"]})]}),e.jsx("span",{className:"text-gray-500 ml-1",children:"vs last month"})]})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Used Vehicles Sold"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.usedVehicles.count}),e.jsxs("div",{className:"flex items-center text-xs mt-1",children:[c.usedVehicles.change>0?e.jsxs(e.Fragment,{children:[e.jsx(Qt,{className:"mr-1 h-3 w-3 text-green-600"}),e.jsxs("span",{className:"text-green-600",children:["+",c.usedVehicles.change.toFixed(1),"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jt,{className:"mr-1 h-3 w-3 text-red-600"}),e.jsxs("span",{className:"text-red-600",children:[c.usedVehicles.change.toFixed(1),"%"]})]}),e.jsx("span",{className:"text-gray-500 ml-1",children:"vs last month"})]})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Total Sales"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.totalSales.count}),e.jsxs("div",{className:"flex items-center text-xs mt-1",children:[c.totalSales.change>0?e.jsxs(e.Fragment,{children:[e.jsx(Qt,{className:"mr-1 h-3 w-3 text-green-600"}),e.jsxs("span",{className:"text-green-600",children:["+",c.totalSales.change.toFixed(1),"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jt,{className:"mr-1 h-3 w-3 text-red-600"}),e.jsxs("span",{className:"text-red-600",children:[c.totalSales.change.toFixed(1),"%"]})]}),e.jsx("span",{className:"text-gray-500 ml-1",children:"vs last month"})]})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Avg. Gross Per Deal"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",c.avgGross.value]}),e.jsxs("div",{className:"flex items-center text-xs mt-1",children:[c.avgGross.change>0?e.jsxs(e.Fragment,{children:[e.jsx(Qt,{className:"mr-1 h-3 w-3 text-green-600"}),e.jsxs("span",{className:"text-green-600",children:["+",c.avgGross.change.toFixed(1),"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jt,{className:"mr-1 h-3 w-3 text-red-600"}),e.jsxs("span",{className:"text-red-600",children:[c.avgGross.change.toFixed(1),"%"]})]}),e.jsx("span",{className:"text-gray-500 ml-1",children:"vs last month"})]})]})]})]}),e.jsxs(_r,{value:t,onValueChange:s,className:"mb-6",children:[e.jsxs(Xs,{children:[e.jsxs(Ve,{value:"overview",children:[e.jsx(yu,{className:"h-4 w-4 mr-2"}),"Overview"]}),e.jsxs(Ve,{value:"team",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Team Performance"]}),e.jsxs(Ve,{value:"individual",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Individual Performance"]}),e.jsxs(Ve,{value:"inventory",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Inventory"]}),e.jsxs(Ve,{value:"finance",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Finance"]})]}),e.jsxs(ze,{value:"overview",className:"mt-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Monthly Sales Trend"})}),e.jsx(V,{className:"h-80",children:e.jsx("div",{className:"flex justify-center items-center h-full text-center text-gray-500",children:"[Sales Trend Chart - Interactive line chart showing sales trends over the past 6 months]"})})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Vehicle Type Distribution"})}),e.jsxs(V,{className:"h-80",children:[e.jsx("div",{className:"flex justify-center items-center h-full text-center text-gray-500",children:"[Vehicle Types Pie Chart - Distribution of vehicle types sold]"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mt-4",children:R1.map(d=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm",children:d.type}),e.jsxs("div",{className:"text-sm font-medium",children:[d.percentage,"%"]})]},d.type))})]})]})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Monthly Sales Report"})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Month"}),e.jsx(H,{className:"text-right",children:"New Vehicles"}),e.jsx(H,{className:"text-right",children:"Used Vehicles"}),e.jsx(H,{className:"text-right",children:"Total Sales"}),e.jsx(H,{className:"text-right",children:"Avg. Gross"})]})}),e.jsx(it,{children:Vn.map(d=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:d.month}),e.jsx(U,{className:"text-right",children:d.newVehicles}),e.jsx(U,{className:"text-right",children:d.usedVehicles}),e.jsx(U,{className:"text-right",children:d.totalSales}),e.jsxs(U,{className:"text-right",children:["$",d.avgGross]})]},d.month))})]})})]})]}),e.jsxs(ze,{value:"team",className:"mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Team Performance Comparison"}),e.jsxs(mt,{value:a,onValueChange:o,children:[e.jsx(rt,{className:"w-36",children:e.jsx(ht,{placeholder:"All Teams"})}),e.jsxs(nt,{children:[e.jsx(Re,{value:"all",children:"All Teams"}),e.jsx(Re,{value:"Team A",children:"Team A"}),e.jsx(Re,{value:"Team B",children:"Team B"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Sales Comparison"})}),e.jsx(V,{className:"h-80",children:e.jsx("div",{className:"flex justify-center items-center h-full text-center text-gray-500",children:"[Team Sales Comparison Chart - Bar chart comparing teams]"})})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Performance Metrics"})}),e.jsx(V,{className:"h-80",children:e.jsx("div",{className:"flex justify-center items-center h-full text-center text-gray-500",children:"[Team Performance Radar Chart - Comparing multiple metrics]"})})]})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Team Performance Details"})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-right",children:"Members"}),e.jsx(H,{className:"text-right",children:"Total Sales"}),e.jsx(H,{className:"text-right",children:"Sales/Member"}),e.jsx(H,{className:"text-right",children:"Gross Profit"}),e.jsx(H,{className:"text-right",children:"Avg. Gross"}),e.jsx(H,{className:"text-right",children:"Closing %"})]})}),e.jsx(it,{children:M1.map(d=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:d.team}),e.jsx(U,{className:"text-right",children:d.members}),e.jsx(U,{className:"text-right",children:d.totalSales}),e.jsx(U,{className:"text-right",children:d.salesPerMember.toFixed(1)}),e.jsxs(U,{className:"text-right",children:["$",d.grossProfit.toLocaleString()]}),e.jsxs(U,{className:"text-right",children:["$",d.avgGross]}),e.jsxs(U,{className:"text-right",children:[d.closingRatio,"%"]})]},d.team))})]})})]})]}),e.jsx(ze,{value:"individual",className:"mt-6",children:e.jsxs(B,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx(z,{children:"Individual Salesperson Performance"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(ju,{className:"mr-2 h-4 w-4"}),"Filter"]})})]})}),e.jsx(V,{children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{children:[e.jsx(H,{children:"Name"}),e.jsx(H,{children:"Team"}),e.jsx(H,{className:"text-right",children:"New"}),e.jsx(H,{className:"text-right",children:"Used"}),e.jsx(H,{className:"text-right",children:"Total"}),e.jsx(H,{className:"text-right",children:"Gross Profit"}),e.jsx(H,{className:"text-right",children:"Avg. Gross"}),e.jsx(H,{className:"text-right",children:"Closing %"})]})}),e.jsx(it,{children:k1.map(d=>e.jsxs(Se,{children:[e.jsx(U,{className:"font-medium",children:d.name}),e.jsx(U,{children:d.team}),e.jsx(U,{className:"text-right",children:d.newVehicles}),e.jsx(U,{className:"text-right",children:d.usedVehicles}),e.jsx(U,{className:"text-right",children:d.totalSales}),e.jsxs(U,{className:"text-right",children:["$",d.grossProfit.toLocaleString()]}),e.jsxs(U,{className:"text-right",children:["$",d.avgGross]}),e.jsxs(U,{className:"text-right",children:[d.closingRatio,"%"]})]},d.id))})]})})]})}),e.jsx(ze,{value:"inventory",className:"mt-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"New Vehicle Inventory"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Total Inventory"}),e.jsx("div",{className:"text-2xl font-bold",children:_e.newVehicles.total})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Avg. Days on Lot"}),e.jsx("div",{className:"text-2xl font-bold",children:_e.newVehicles.daysOnLot})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"Available"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.newVehicles.available," (",Math.round(_e.newVehicles.available/_e.newVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${_e.newVehicles.available/_e.newVehicles.total*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"Sold"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.newVehicles.sold," (",Math.round(_e.newVehicles.sold/_e.newVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${_e.newVehicles.sold/_e.newVehicles.total*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"Reserved"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.newVehicles.reserved," (",Math.round(_e.newVehicles.reserved/_e.newVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:`${_e.newVehicles.reserved/_e.newVehicles.total*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"In Transit"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.newVehicles.inTransit," (",Math.round(_e.newVehicles.inTransit/_e.newVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${_e.newVehicles.inTransit/_e.newVehicles.total*100}%`}})})]})]})]})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Used Vehicle Inventory"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Total Inventory"}),e.jsx("div",{className:"text-2xl font-bold",children:_e.usedVehicles.total})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Avg. Days on Lot"}),e.jsx("div",{className:"text-2xl font-bold",children:_e.usedVehicles.daysOnLot})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"Available"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.usedVehicles.available," (",Math.round(_e.usedVehicles.available/_e.usedVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${_e.usedVehicles.available/_e.usedVehicles.total*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"Sold"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.usedVehicles.sold," (",Math.round(_e.usedVehicles.sold/_e.usedVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${_e.usedVehicles.sold/_e.usedVehicles.total*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"Reserved"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.usedVehicles.reserved," (",Math.round(_e.usedVehicles.reserved/_e.usedVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:`${_e.usedVehicles.reserved/_e.usedVehicles.total*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm",children:"In Transit"}),e.jsxs("span",{className:"text-sm font-medium",children:[_e.usedVehicles.inTransit," (",Math.round(_e.usedVehicles.inTransit/_e.usedVehicles.total*100),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${_e.usedVehicles.inTransit/_e.usedVehicles.total*100}%`}})})]})]})]})]})]})}),e.jsxs(ze,{value:"finance",className:"mt-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-3 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Total Finance Deals"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Dt.totalFinanced}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(Dt.totalFinanced/(Dt.totalFinanced+Dt.cashDeals)*100),"% of total deals"]})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Cash Deals"})}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Dt.cashDeals}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(Dt.cashDeals/(Dt.totalFinanced+Dt.cashDeals)*100),"% of total deals"]})]})]}),e.jsxs(B,{children:[e.jsx(W,{className:"pb-2",children:e.jsx(z,{className:"text-sm font-medium",children:"Average Rate"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Dt.avgRate,"%"]}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"0.3% lower than last month"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-6",children:[e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Front End vs Back End"})}),e.jsxs(V,{className:"h-72",children:[e.jsx("div",{className:"flex justify-center items-center h-full text-center text-gray-500",children:"[Front End vs Back End Chart - Comparison of front-end vs back-end profit]"}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Front End Avg"}),e.jsxs("div",{className:"text-xl font-bold",children:["$",Dt.frontEndAvg]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Back End Avg"}),e.jsxs("div",{className:"text-xl font-bold",children:["$",Dt.backEndAvg]})]})]})]})]}),e.jsxs(B,{children:[e.jsx(W,{children:e.jsx(z,{children:"Product Penetration"})}),e.jsx(V,{className:"pt-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Warranty"}),e.jsxs("span",{className:"font-medium",children:[Dt.warrantyPenetration,"%"]})]}),e.jsx("div",{className:"h-3 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${Dt.warrantyPenetration}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0%"}),e.jsx("span",{children:"50%"}),e.jsx("span",{children:"100%"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"GAP Insurance"}),e.jsxs("span",{className:"font-medium",children:[Dt.gapPenetration,"%"]})]}),e.jsx("div",{className:"h-3 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${Dt.gapPenetration}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0%"}),e.jsx("span",{children:"50%"}),e.jsx("span",{children:"100%"})]})]})]})})]})]})]})]})]})},O1=()=>{const[t,s]=l.useState([]),[r,n]=l.useState(!0),[a,o]=l.useState(null),{toast:i}=bl();l.useEffect(()=>{(async()=>{try{console.log("[DealLog] Fetching user data..."),n(!0);const{data:{user:u}}=await J.auth.getUser();if(!u){console.error("[DealLog] No authenticated user found"),n(!1);return}console.log("[DealLog] User authenticated:",u.id);const{data:f,error:b}=await J.from("schema_user_mappings").select("schema_name").eq("user_id",u.id).eq("schema_type","finance_manager").single();if(b){console.error("[DealLog] Error fetching schema mapping:",b),n(!1);return}f!=null&&f.schema_name?(console.log("[DealLog] User schema found:",f.schema_name),o(f.schema_name)):(console.warn("[DealLog] No schema found for user. Using public schema as fallback."),o("public"));const p=(f==null?void 0:f.schema_name)||"public",{data:x,error:v}=await J.from(`${p}.deals`).select("*").eq("user_id",u.id).order("created_at",{ascending:!1});if(v){console.error("[DealLog] Error fetching deals:",v),i({title:"Error",description:"Could not fetch your deals. Please try again later.",variant:"destructive"}),n(!1);return}console.log("[DealLog] Deals fetched:",(x==null?void 0:x.length)||0),s(x||[])}catch(u){console.error("[DealLog] Unexpected error:",u),i({title:"Error",description:"An unexpected error occurred. Please try again later.",variant:"destructive"})}finally{n(!1)}})()},[i]);const c=h=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(h),d=h=>new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),m=()=>{n(!0),(async()=>{try{const{data:{user:u}}=await J.auth.getUser();if(!u||!a){n(!1);return}const{data:f,error:b}=await J.from(`${a}.deals`).select("*").eq("user_id",u.id).order("created_at",{ascending:!1});if(b){console.error("[DealLog] Error refreshing deals:",b),i({title:"Error",description:"Could not refresh your deals. Please try again later.",variant:"destructive"}),n(!1);return}console.log("[DealLog] Deals refreshed:",(f==null?void 0:f.length)||0),s(f||[])}catch(u){console.error("[DealLog] Unexpected error during refresh:",u)}finally{n(!1)}})()};return e.jsxs(B,{className:"w-full",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-2xl text-gray-800",children:"Deal Log"}),e.jsx(Be,{children:"View and manage your recent deals"})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:m,disabled:r,className:"ml-auto",children:[r?e.jsx(en,{className:"h-4 w-4 animate-spin"}):e.jsx(en,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:"Refresh"})]})]}),e.jsx(V,{children:t.length===0&&!r?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center text-gray-500",children:[e.jsx(Er,{className:"h-12 w-12 mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium",children:"No deals found"}),e.jsx("p",{className:"max-w-md mt-2",children:`You haven't logged any deals yet. Use the "Log New Deal" button to record your first deal.`})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(at,{children:[e.jsx(ot,{children:e.jsxs(Se,{className:"bg-gray-100",children:[e.jsx(H,{className:"font-semibold",children:"Date"}),e.jsx(H,{className:"font-semibold",children:"Customer"}),e.jsx(H,{className:"font-semibold",children:"Vehicle"}),e.jsx(H,{className:"font-semibold",children:"Deal Amount"}),e.jsx(H,{className:"font-semibold",children:"VSC Sold"}),e.jsx(H,{className:"font-semibold",children:"Product Profit"})]})}),e.jsx(it,{children:r?e.jsx(Se,{children:e.jsxs(U,{colSpan:6,className:"h-24 text-center",children:[e.jsx(en,{className:"h-5 w-5 animate-spin mx-auto"}),e.jsx("span",{className:"text-sm text-gray-500 mt-2",children:"Loading deals..."})]})}):t.map(h=>{var u,f,b,p;return e.jsxs(Se,{children:[e.jsx(U,{children:(f=(u=h.deal_details)==null?void 0:u.deal)!=null&&f.saleDate?d(h.deal_details.deal.saleDate):d(h.created_at)}),e.jsx(U,{children:(b=h.deal_details)!=null&&b.customer?`${h.deal_details.customer.firstName} ${h.deal_details.customer.lastName}`:"N/A"}),e.jsx(U,{children:(p=h.deal_details)!=null&&p.vehicle?`${h.deal_details.vehicle.year} ${h.deal_details.vehicle.make} ${h.deal_details.vehicle.model}`:"N/A"}),e.jsx(U,{children:c(h.deal_amount)}),e.jsx(U,{children:h.vsc_sold?e.jsx(Ue,{className:"bg-green-100 text-green-800 hover:bg-green-200",children:"Yes"}):e.jsx(Ue,{variant:"outline",className:"text-gray-500",children:"No"})}),e.jsx(U,{children:c(h.product_profit)})]},h.id)})})]})})})]})};var sl=["Enter"," "],U1=["ArrowDown","PageUp","Home"],Lf=["ArrowUp","PageDown","End"],$1=[...U1,...Lf],G1={ltr:[...sl,"ArrowRight"],rtl:[...sl,"ArrowLeft"]},B1={ltr:["ArrowLeft"],rtl:["ArrowRight"]},wa="Menu",[da,V1,W1]=go(wa),[Hr,Of]=Wt(wa,[W1,An,Ro]),qo=An(),Uf=Ro(),[z1,qr]=Hr(wa),[H1,Na]=Hr(wa),$f=t=>{const{__scopeMenu:s,open:r=!1,children:n,dir:a,onOpenChange:o,modal:i=!0}=t,c=qo(s),[d,m]=l.useState(null),h=l.useRef(!1),u=st(o),f=ba(a);return l.useEffect(()=>{const b=()=>{h.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>h.current=!1;return document.addEventListener("keydown",b,{capture:!0}),()=>{document.removeEventListener("keydown",b,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),e.jsx(Ml,{...c,children:e.jsx(z1,{scope:s,open:r,onOpenChange:u,content:d,onContentChange:m,children:e.jsx(H1,{scope:s,onClose:l.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:h,dir:f,modal:i,children:n})})})};$f.displayName=wa;var q1="MenuAnchor",Zl=l.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t,a=qo(r);return e.jsx(kl,{...a,...n,ref:s})});Zl.displayName=q1;var ec="MenuPortal",[Y1,Gf]=Hr(ec,{forceMount:void 0}),Bf=t=>{const{__scopeMenu:s,forceMount:r,children:n,container:a}=t,o=qr(ec,s);return e.jsx(Y1,{scope:s,forceMount:r,children:e.jsx(jt,{present:r||o.open,children:e.jsx(xa,{asChild:!0,container:a,children:n})})})};Bf.displayName=ec;var es="MenuContent",[K1,tc]=Hr(es),Vf=l.forwardRef((t,s)=>{const r=Gf(es,t.__scopeMenu),{forceMount:n=r.forceMount,...a}=t,o=qr(es,t.__scopeMenu),i=Na(es,t.__scopeMenu);return e.jsx(da.Provider,{scope:t.__scopeMenu,children:e.jsx(jt,{present:n||o.open,children:e.jsx(da.Slot,{scope:t.__scopeMenu,children:i.modal?e.jsx(J1,{...a,ref:s}):e.jsx(Q1,{...a,ref:s})})})})}),J1=l.forwardRef((t,s)=>{const r=qr(es,t.__scopeMenu),n=l.useRef(null),a=Me(s,n);return l.useEffect(()=>{const o=n.current;if(o)return Fl(o)},[]),e.jsx(sc,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:oe(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),Q1=l.forwardRef((t,s)=>{const r=qr(es,t.__scopeMenu);return e.jsx(sc,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),X1=Lr("MenuContent.ScrollLock"),sc=l.forwardRef((t,s)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:c,onEntryFocus:d,onEscapeKeyDown:m,onPointerDownOutside:h,onFocusOutside:u,onInteractOutside:f,onDismiss:b,disableOutsideScroll:p,...x}=t,v=qr(es,r),y=Na(es,r),j=qo(r),N=Uf(r),g=V1(r),[w,S]=l.useState(null),P=l.useRef(null),E=Me(s,P,v.onContentChange),D=l.useRef(0),G=l.useRef(""),se=l.useRef(0),L=l.useRef(null),T=l.useRef("right"),A=l.useRef(0),Y=p?Eo:l.Fragment,te=p?{as:X1,allowPinchZoom:!0}:void 0,xe=Q=>{var O,ue;const pe=G.current+Q,Pe=g().filter(K=>!K.disabled),Oe=document.activeElement,qe=(O=Pe.find(K=>K.ref.current===Oe))==null?void 0:O.textValue,M=Pe.map(K=>K.textValue),re=d2(M,pe,qe),ne=(ue=Pe.find(K=>K.textValue===re))==null?void 0:ue.ref.current;(function K(ce){G.current=ce,window.clearTimeout(D.current),ce!==""&&(D.current=window.setTimeout(()=>K(""),1e3))})(pe),ne&&setTimeout(()=>ne.focus())};l.useEffect(()=>()=>window.clearTimeout(D.current),[]),wl();const le=l.useCallback(Q=>{var Pe,Oe;return T.current===((Pe=L.current)==null?void 0:Pe.side)&&m2(Q,(Oe=L.current)==null?void 0:Oe.area)},[]);return e.jsx(K1,{scope:r,searchRef:G,onItemEnter:l.useCallback(Q=>{le(Q)&&Q.preventDefault()},[le]),onItemLeave:l.useCallback(Q=>{var pe;le(Q)||((pe=P.current)==null||pe.focus(),S(null))},[le]),onTriggerLeave:l.useCallback(Q=>{le(Q)&&Q.preventDefault()},[le]),pointerGraceTimerRef:se,onPointerGraceIntentChange:l.useCallback(Q=>{L.current=Q},[]),children:e.jsx(Y,{...te,children:e.jsx(Co,{asChild:!0,trapped:a,onMountAutoFocus:oe(o,Q=>{var pe;Q.preventDefault(),(pe=P.current)==null||pe.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:e.jsx(Sn,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:m,onPointerDownOutside:h,onFocusOutside:u,onInteractOutside:f,onDismiss:b,children:e.jsx(nh,{asChild:!0,...N,dir:y.dir,orientation:"vertical",loop:n,currentTabStopId:w,onCurrentTabStopIdChange:S,onEntryFocus:oe(d,Q=>{y.isUsingKeyboardRef.current||Q.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Rl,{role:"menu","aria-orientation":"vertical","data-state":ax(v.open),"data-radix-menu-content":"",dir:y.dir,...j,...x,ref:E,style:{outline:"none",...x.style},onKeyDown:oe(x.onKeyDown,Q=>{const Pe=Q.target.closest("[data-radix-menu-content]")===Q.currentTarget,Oe=Q.ctrlKey||Q.altKey||Q.metaKey,qe=Q.key.length===1;Pe&&(Q.key==="Tab"&&Q.preventDefault(),!Oe&&qe&&xe(Q.key));const M=P.current;if(Q.target!==M||!$1.includes(Q.key))return;Q.preventDefault();const ne=g().filter(O=>!O.disabled).map(O=>O.ref.current);Lf.includes(Q.key)&&ne.reverse(),l2(ne)}),onBlur:oe(t.onBlur,Q=>{Q.currentTarget.contains(Q.target)||(window.clearTimeout(D.current),G.current="")}),onPointerMove:oe(t.onPointerMove,ua(Q=>{const pe=Q.target,Pe=A.current!==Q.clientX;if(Q.currentTarget.contains(pe)&&Pe){const Oe=Q.clientX>A.current?"right":"left";T.current=Oe,A.current=Q.clientX}}))})})})})})})});Vf.displayName=es;var Z1="MenuGroup",rc=l.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t;return e.jsx(je.div,{role:"group",...n,ref:s})});rc.displayName=Z1;var e2="MenuLabel",Wf=l.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t;return e.jsx(je.div,{...n,ref:s})});Wf.displayName=e2;var ho="MenuItem",gd="menu.itemSelect",Yo=l.forwardRef((t,s)=>{const{disabled:r=!1,onSelect:n,...a}=t,o=l.useRef(null),i=Na(ho,t.__scopeMenu),c=tc(ho,t.__scopeMenu),d=Me(s,o),m=l.useRef(!1),h=()=>{const u=o.current;if(!r&&u){const f=new CustomEvent(gd,{bubbles:!0,cancelable:!0});u.addEventListener(gd,b=>n==null?void 0:n(b),{once:!0}),dl(u,f),f.defaultPrevented?m.current=!1:i.onClose()}};return e.jsx(zf,{...a,ref:d,disabled:r,onClick:oe(t.onClick,h),onPointerDown:u=>{var f;(f=t.onPointerDown)==null||f.call(t,u),m.current=!0},onPointerUp:oe(t.onPointerUp,u=>{var f;m.current||(f=u.currentTarget)==null||f.click()}),onKeyDown:oe(t.onKeyDown,u=>{const f=c.searchRef.current!=="";r||f&&u.key===" "||sl.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});Yo.displayName=ho;var zf=l.forwardRef((t,s)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...o}=t,i=tc(ho,r),c=Uf(r),d=l.useRef(null),m=Me(s,d),[h,u]=l.useState(!1),[f,b]=l.useState("");return l.useEffect(()=>{const p=d.current;p&&b((p.textContent??"").trim())},[o.children]),e.jsx(da.ItemSlot,{scope:r,disabled:n,textValue:a??f,children:e.jsx(ah,{asChild:!0,...c,focusable:!n,children:e.jsx(je.div,{role:"menuitem","data-highlighted":h?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:m,onPointerMove:oe(t.onPointerMove,ua(p=>{n?i.onItemLeave(p):(i.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:oe(t.onPointerLeave,ua(p=>i.onItemLeave(p))),onFocus:oe(t.onFocus,()=>u(!0)),onBlur:oe(t.onBlur,()=>u(!1))})})})}),t2="MenuCheckboxItem",Hf=l.forwardRef((t,s)=>{const{checked:r=!1,onCheckedChange:n,...a}=t;return e.jsx(Qf,{scope:t.__scopeMenu,checked:r,children:e.jsx(Yo,{role:"menuitemcheckbox","aria-checked":fo(r)?"mixed":r,...a,ref:s,"data-state":ac(r),onSelect:oe(a.onSelect,()=>n==null?void 0:n(fo(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Hf.displayName=t2;var qf="MenuRadioGroup",[s2,r2]=Hr(qf,{value:void 0,onValueChange:()=>{}}),Yf=l.forwardRef((t,s)=>{const{value:r,onValueChange:n,...a}=t,o=st(n);return e.jsx(s2,{scope:t.__scopeMenu,value:r,onValueChange:o,children:e.jsx(rc,{...a,ref:s})})});Yf.displayName=qf;var Kf="MenuRadioItem",Jf=l.forwardRef((t,s)=>{const{value:r,...n}=t,a=r2(Kf,t.__scopeMenu),o=r===a.value;return e.jsx(Qf,{scope:t.__scopeMenu,checked:o,children:e.jsx(Yo,{role:"menuitemradio","aria-checked":o,...n,ref:s,"data-state":ac(o),onSelect:oe(n.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,r)},{checkForDefaultPrevented:!1})})})});Jf.displayName=Kf;var nc="MenuItemIndicator",[Qf,n2]=Hr(nc,{checked:!1}),Xf=l.forwardRef((t,s)=>{const{__scopeMenu:r,forceMount:n,...a}=t,o=n2(nc,r);return e.jsx(jt,{present:n||fo(o.checked)||o.checked===!0,children:e.jsx(je.span,{...a,ref:s,"data-state":ac(o.checked)})})});Xf.displayName=nc;var a2="MenuSeparator",Zf=l.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t;return e.jsx(je.div,{role:"separator","aria-orientation":"horizontal",...n,ref:s})});Zf.displayName=a2;var o2="MenuArrow",ex=l.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t,a=qo(r);return e.jsx(Il,{...a,...n,ref:s})});ex.displayName=o2;var i2="MenuSub",[IS,tx]=Hr(i2),Yn="MenuSubTrigger",sx=l.forwardRef((t,s)=>{const r=qr(Yn,t.__scopeMenu),n=Na(Yn,t.__scopeMenu),a=tx(Yn,t.__scopeMenu),o=tc(Yn,t.__scopeMenu),i=l.useRef(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:d}=o,m={__scopeMenu:t.__scopeMenu},h=l.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return l.useEffect(()=>h,[h]),l.useEffect(()=>{const u=c.current;return()=>{window.clearTimeout(u),d(null)}},[c,d]),e.jsx(Zl,{asChild:!0,...m,children:e.jsx(zf,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":ax(r.open),...t,ref:po(s,a.onTriggerChange),onClick:u=>{var f;(f=t.onClick)==null||f.call(t,u),!(t.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:oe(t.onPointerMove,ua(u=>{o.onItemEnter(u),!u.defaultPrevented&&!t.disabled&&!r.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),h()},100))})),onPointerLeave:oe(t.onPointerLeave,ua(u=>{var b,p;h();const f=(b=r.content)==null?void 0:b.getBoundingClientRect();if(f){const x=(p=r.content)==null?void 0:p.dataset.side,v=x==="right",y=v?-5:5,j=f[v?"left":"right"],N=f[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:u.clientX+y,y:u.clientY},{x:j,y:f.top},{x:N,y:f.top},{x:N,y:f.bottom},{x:j,y:f.bottom}],side:x}),window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(u),u.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:oe(t.onKeyDown,u=>{var b;const f=o.searchRef.current!=="";t.disabled||f&&u.key===" "||G1[n.dir].includes(u.key)&&(r.onOpenChange(!0),(b=r.content)==null||b.focus(),u.preventDefault())})})})});sx.displayName=Yn;var rx="MenuSubContent",nx=l.forwardRef((t,s)=>{const r=Gf(es,t.__scopeMenu),{forceMount:n=r.forceMount,...a}=t,o=qr(es,t.__scopeMenu),i=Na(es,t.__scopeMenu),c=tx(rx,t.__scopeMenu),d=l.useRef(null),m=Me(s,d);return e.jsx(da.Provider,{scope:t.__scopeMenu,children:e.jsx(jt,{present:n||o.open,children:e.jsx(da.Slot,{scope:t.__scopeMenu,children:e.jsx(sc,{id:c.contentId,"aria-labelledby":c.triggerId,...a,ref:m,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:h=>{var u;i.isUsingKeyboardRef.current&&((u=d.current)==null||u.focus()),h.preventDefault()},onCloseAutoFocus:h=>h.preventDefault(),onFocusOutside:oe(t.onFocusOutside,h=>{h.target!==c.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:oe(t.onEscapeKeyDown,h=>{i.onClose(),h.preventDefault()}),onKeyDown:oe(t.onKeyDown,h=>{var b;const u=h.currentTarget.contains(h.target),f=B1[i.dir].includes(h.key);u&&f&&(o.onOpenChange(!1),(b=c.trigger)==null||b.focus(),h.preventDefault())})})})})})});nx.displayName=rx;function ax(t){return t?"open":"closed"}function fo(t){return t==="indeterminate"}function ac(t){return fo(t)?"indeterminate":t?"checked":"unchecked"}function l2(t){const s=document.activeElement;for(const r of t)if(r===s||(r.focus(),document.activeElement!==s))return}function c2(t,s){return t.map((r,n)=>t[(s+n)%t.length])}function d2(t,s,r){const a=s.length>1&&Array.from(s).every(m=>m===s[0])?s[0]:s,o=r?t.indexOf(r):-1;let i=c2(t,Math.max(o,0));a.length===1&&(i=i.filter(m=>m!==r));const d=i.find(m=>m.toLowerCase().startsWith(a.toLowerCase()));return d!==r?d:void 0}function u2(t,s){const{x:r,y:n}=t;let a=!1;for(let o=0,i=s.length-1;o<s.length;i=o++){const c=s[o],d=s[i],m=c.x,h=c.y,u=d.x,f=d.y;h>n!=f>n&&r<(u-m)*(n-h)/(f-h)+m&&(a=!a)}return a}function m2(t,s){if(!s)return!1;const r={x:t.clientX,y:t.clientY};return u2(r,s)}function ua(t){return s=>s.pointerType==="mouse"?t(s):void 0}var h2=$f,f2=Zl,x2=Bf,p2=Vf,g2=rc,v2=Wf,b2=Yo,y2=Hf,j2=Yf,w2=Jf,N2=Xf,S2=Zf,C2=ex,P2=sx,_2=nx,Ko="DropdownMenu",[D2,FS]=Wt(Ko,[Of]),Tt=Of(),[A2,ox]=D2(Ko),ix=t=>{const{__scopeDropdownMenu:s,children:r,dir:n,open:a,defaultOpen:o,onOpenChange:i,modal:c=!0}=t,d=Tt(s),m=l.useRef(null),[h,u]=Ps({prop:a,defaultProp:o??!1,onChange:i,caller:Ko});return e.jsx(A2,{scope:s,triggerId:Zt(),triggerRef:m,contentId:Zt(),open:h,onOpenChange:u,onOpenToggle:l.useCallback(()=>u(f=>!f),[u]),modal:c,children:e.jsx(h2,{...d,open:h,onOpenChange:u,dir:n,modal:c,children:r})})};ix.displayName=Ko;var lx="DropdownMenuTrigger",E2=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=t,o=ox(lx,r),i=Tt(r);return e.jsx(f2,{asChild:!0,...i,children:e.jsx(je.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:po(s,o.triggerRef),onPointerDown:oe(t.onPointerDown,c=>{!n&&c.button===0&&c.ctrlKey===!1&&(o.onOpenToggle(),o.open||c.preventDefault())}),onKeyDown:oe(t.onKeyDown,c=>{n||(["Enter"," "].includes(c.key)&&o.onOpenToggle(),c.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})})});E2.displayName=lx;var T2="DropdownMenuPortal",cx=t=>{const{__scopeDropdownMenu:s,...r}=t,n=Tt(s);return e.jsx(x2,{...n,...r})};cx.displayName=T2;var dx="DropdownMenuContent",ux=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=ox(dx,r),o=Tt(r),i=l.useRef(!1);return e.jsx(p2,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...n,ref:s,onCloseAutoFocus:oe(t.onCloseAutoFocus,c=>{var d;i.current||(d=a.triggerRef.current)==null||d.focus(),i.current=!1,c.preventDefault()}),onInteractOutside:oe(t.onInteractOutside,c=>{const d=c.detail.originalEvent,m=d.button===0&&d.ctrlKey===!0,h=d.button===2||m;(!a.modal||h)&&(i.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ux.displayName=dx;var M2="DropdownMenuGroup",k2=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(g2,{...a,...n,ref:s})});k2.displayName=M2;var R2="DropdownMenuLabel",mx=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(v2,{...a,...n,ref:s})});mx.displayName=R2;var I2="DropdownMenuItem",hx=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(b2,{...a,...n,ref:s})});hx.displayName=I2;var F2="DropdownMenuCheckboxItem",fx=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(y2,{...a,...n,ref:s})});fx.displayName=F2;var L2="DropdownMenuRadioGroup",O2=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(j2,{...a,...n,ref:s})});O2.displayName=L2;var U2="DropdownMenuRadioItem",xx=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(w2,{...a,...n,ref:s})});xx.displayName=U2;var $2="DropdownMenuItemIndicator",px=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(N2,{...a,...n,ref:s})});px.displayName=$2;var G2="DropdownMenuSeparator",gx=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(S2,{...a,...n,ref:s})});gx.displayName=G2;var B2="DropdownMenuArrow",V2=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(C2,{...a,...n,ref:s})});V2.displayName=B2;var W2="DropdownMenuSubTrigger",vx=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(P2,{...a,...n,ref:s})});vx.displayName=W2;var z2="DropdownMenuSubContent",bx=l.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=Tt(r);return e.jsx(_2,{...a,...n,ref:s,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bx.displayName=z2;var H2=ix,q2=cx,yx=ux,jx=mx,wx=hx,Nx=fx,Sx=xx,Cx=px,Px=gx,_x=vx,Dx=bx;const Y2=H2,K2=l.forwardRef(({className:t,inset:s,children:r,...n},a)=>e.jsxs(_x,{ref:a,className:ge("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",t),...n,children:[r,e.jsx(Nr,{className:"ml-auto"})]}));K2.displayName=_x.displayName;const J2=l.forwardRef(({className:t,...s},r)=>e.jsx(Dx,{ref:r,className:ge("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...s}));J2.displayName=Dx.displayName;const Q2=l.forwardRef(({className:t,sideOffset:s=4,...r},n)=>e.jsx(q2,{children:e.jsx(yx,{ref:n,sideOffset:s,className:ge("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...r})}));Q2.displayName=yx.displayName;const X2=l.forwardRef(({className:t,inset:s,...r},n)=>e.jsx(wx,{ref:n,className:ge("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",t),...r}));X2.displayName=wx.displayName;const Z2=l.forwardRef(({className:t,children:s,checked:r,...n},a)=>e.jsxs(Nx,{ref:a,className:ge("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Cx,{children:e.jsx(Cn,{className:"h-4 w-4"})})}),s]}));Z2.displayName=Nx.displayName;const eS=l.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(Sx,{ref:n,className:ge("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Cx,{children:e.jsx(a0,{className:"h-2 w-2 fill-current"})})}),s]}));eS.displayName=Sx.displayName;const tS=l.forwardRef(({className:t,inset:s,...r},n)=>e.jsx(jx,{ref:n,className:ge("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...r}));tS.displayName=jx.displayName;const sS=l.forwardRef(({className:t,...s},r)=>e.jsx(Px,{ref:r,className:ge("-mx-1 my-1 h-px bg-muted",t),...s}));sS.displayName=Px.displayName;const Pi=[{id:"D12345",customer:"John Smith",vehicle:"2023 Toyota Camry",vin:"1HGCM82633A123456",saleDate:"2023-05-02",salesperson:"Mike Johnson",amount:32500,status:"Completed",products:["Vehicle Service Contract (VSC)","GAP","Tire and Wheel Bundle"],profit:2200,created_at:"2023-05-02T14:30:00Z"},{id:"D12346",customer:"Sarah Williams",vehicle:"2023 Honda Accord",vin:"1HGCM82633A789012",saleDate:"2023-05-03",salesperson:"Jessica Lee",amount:28900,status:"Pending",products:["PrePaid Maintenance (PPM)"],profit:1750,created_at:"2023-05-03T11:15:00Z"},{id:"D12347",customer:"Robert Davis",vehicle:"2023 Ford Explorer",vin:"1FMHK7D83CGA12345",saleDate:"2023-05-05",salesperson:"Alex Martinez",amount:42500,status:"Completed",products:["Vehicle Service Contract (VSC)","GAP","PrePaid Maintenance (PPM)","Tire and Wheel Bundle"],profit:3100,created_at:"2023-05-05T16:45:00Z"},{id:"D12348",customer:"Emily Johnson",vehicle:"2022 Nissan Altima",vin:"1N4AL3AP8DC234567",saleDate:"2023-05-07",salesperson:"Mike Johnson",amount:26900,status:"Pending",products:["GAP"],profit:1450,created_at:"2023-05-07T09:30:00Z"},{id:"D12349",customer:"Thomas Wilson",vehicle:"2023 Chevrolet Tahoe",vin:"1GNSKBE72DR345678",saleDate:"2023-05-10",salesperson:"Jessica Lee",amount:58900,status:"Completed",products:["Vehicle Service Contract (VSC)","GAP","Paint Protection","Tire and Wheel Bundle"],profit:4200,created_at:"2023-05-10T15:00:00Z"}],rS=()=>{const[t,s]=l.useState([]),[r,n]=l.useState([]),[a,o]=l.useState("this-month"),[i,c]=l.useState({start:"",end:""}),[d,m]=l.useState(!1),[h,u]=l.useState([]),[f,b]=l.useState({mtdRevenue:0,dealsProcessed:0,productsPerDeal:0,pvr:0,productMix:{extendedWarranty:0,gapInsurance:0,paintProtection:0,tireWheel:0,ppm:0,other:0}}),[p,x]=l.useState(!0);l.useEffect(()=>{s(Pi),n(Pi.filter(N=>N.status==="Pending")),v()},[a,i]);const v=()=>{const{startDate:N,endDate:g}=j(a),w=Pi.filter(S=>{const P=new Date(S.saleDate);return P>=N&&P<=g});u(w),y(w)},y=N=>{if(N.length===0){b({mtdRevenue:0,dealsProcessed:0,productsPerDeal:0,pvr:0,productMix:{extendedWarranty:0,gapInsurance:0,paintProtection:0,tireWheel:0,ppm:0,other:0}});return}const g=N.reduce((A,Y)=>A+Y.profit,0),w=N.length;let S=0,P=0,E=0,D=0,G=0,se=0;N.forEach(A=>{A.products.forEach(Y=>{Y.includes("Vehicle Service Contract")||Y.includes("VSC")?S++:Y.includes("GAP")?P++:Y.includes("Paint Protection")?E++:Y.includes("Tire and Wheel")?D++:Y.includes("PrePaid Maintenance")||Y.includes("PPM")?G++:se++})});const L=S+P+E+D+G+se,T=A=>L>0?Math.round(A/L*100):0;b({mtdRevenue:g,dealsProcessed:w,productsPerDeal:L/w,pvr:g/w,productMix:{extendedWarranty:T(S),gapInsurance:T(P),paintProtection:T(E),tireWheel:T(D),ppm:T(G),other:T(se)}})},j=N=>{const g=new Date;let w=new Date,S=new Date;switch(N){case"this-month":w=new Date(g.getFullYear(),g.getMonth(),1),S=g;break;case"last-month":w=new Date(g.getFullYear(),g.getMonth()-1,1),S=new Date(g.getFullYear(),g.getMonth(),0);break;case"last-quarter":const P=Math.floor(g.getMonth()/3);w=new Date(g.getFullYear(),P*3-3,1),S=new Date(g.getFullYear(),P*3,0);break;case"ytd":w=new Date(g.getFullYear(),0,1),S=g;break;case"last-year":w=new Date(g.getFullYear()-1,0,1),S=new Date(g.getFullYear()-1,11,31);break;case"custom":i.start&&i.end&&(w=new Date(i.start),S=new Date(i.end));break}return{startDate:w,endDate:S}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p&&e.jsxs("div",{className:"mb-6 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg shadow-sm relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600",onClick:()=>x(!1),"aria-label":"Close promotional banner",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-4 bg-blue-500 text-white p-2 rounded-full",children:e.jsx(ta,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-800",children:"Special Promotion Active!"}),e.jsxs("p",{className:"text-blue-600",children:["Your Finance Manager subscription is currently ",e.jsx("span",{className:"line-through text-gray-500 mr-1",children:"$5/month"}),e.jsx("span",{className:"font-bold text-red-500",children:"FREE"}),e.jsx("span",{className:"text-gray-500 text-sm italic ml-1",children:"for a limited time"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Finance Manager Dashboard"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(us,{to:"/dashboard/single-finance/log-deal",children:e.jsxs(I,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Zn,{className:"mr-2 h-4 w-4"}),"Log New Deal"]})}),e.jsx(Y2,{})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(B,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium text-slate-700",children:"F&I Gross"}),e.jsx(ms,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold text-slate-900",children:["$",f.mtdRevenue.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.mtdRevenue>12e3?e.jsxs("span",{className:"text-green-500 flex items-center",children:[e.jsx(Ut,{className:"mr-1 h-4 w-4"}),"+12% from last month"]}):e.jsxs("span",{className:"text-red-600 flex items-center",children:[e.jsx(ke,{className:"mr-1 h-4 w-4"}),"-8% from last month"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium text-slate-700",children:"Deals Processed"}),e.jsx(Sr,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:f.dealsProcessed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:e.jsxs("span",{className:"text-green-500 flex items-center",children:[e.jsx(Ut,{className:"mr-1 h-4 w-4"}),"+3% from last month"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium text-slate-700",children:"Products Per Deal"}),e.jsx(Za,{className:"h-4 w-4 text-purple-500"})]}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:f.productsPerDeal.toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.productsPerDeal>=2?e.jsxs("span",{className:"text-green-500 flex items-center",children:[e.jsx(Ut,{className:"mr-1 h-4 w-4"}),"+0.2 from last month"]}):e.jsxs("span",{className:"text-red-600 flex items-center",children:[e.jsx(ke,{className:"mr-1 h-4 w-4"}),"-0.3 from last month"]})})]})]}),e.jsxs(B,{className:"border-l-4 border-l-amber-500 hover:shadow-md transition-shadow",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium text-slate-700",children:"PVR (Per Vehicle Retailed)"}),e.jsx(fl,{className:"h-4 w-4 text-amber-500"})]}),e.jsxs(V,{children:[e.jsxs("div",{className:"text-2xl font-bold text-slate-900",children:["$",f.pvr.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.pvr>1500?e.jsxs("span",{className:"text-green-500 flex items-center",children:[e.jsx(Ut,{className:"mr-1 h-4 w-4"}),"+$125 from last month"]}):e.jsxs("span",{className:"text-red-600 flex items-center",children:[e.jsx(ke,{className:"mr-1 h-4 w-4"}),"-$89 from last month"]})})]})]})]}),e.jsxs(B,{className:"col-span-12 bg-white border-slate-200 shadow-sm",children:[e.jsx(W,{className:"py-2 px-4 border-b",children:e.jsxs(z,{className:"flex items-center text-lg font-medium",children:[e.jsx(Za,{className:"mr-2 h-5 w-5 text-blue-500"}),"F&I Product Mix & Avg. Profit"]})}),e.jsxs(V,{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium flex items-center text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded-full mr-2"}),"Vehicle Service Contract (VSC)"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg. Profit"}),e.jsxs("div",{className:"font-medium text-sm",children:["$",Math.round(f.mtdRevenue*f.productMix.extendedWarranty/100).toLocaleString()]})]})]}),e.jsx("div",{className:"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-blue-600",style:{width:`${f.productMix.extendedWarranty}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-500",children:[f.productMix.extendedWarranty,"%"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium flex items-center text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-green-600 rounded-full mr-2"}),"GAP Insurance"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg. Profit"}),e.jsxs("div",{className:"font-medium text-sm",children:["$",Math.round(f.mtdRevenue*f.productMix.gapInsurance/100).toLocaleString()]})]})]}),e.jsx("div",{className:"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-green-600",style:{width:`${f.productMix.gapInsurance}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-500",children:[f.productMix.gapInsurance,"%"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium flex items-center text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-600 rounded-full mr-2"}),"PrePaid Maintenance (PPM)"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg. Profit"}),e.jsxs("div",{className:"font-medium text-sm",children:["$",Math.round(f.mtdRevenue*f.productMix.ppm/100).toLocaleString()]})]})]}),e.jsx("div",{className:"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-purple-600",style:{width:`${f.productMix.ppm}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-500",children:[f.productMix.ppm,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium flex items-center text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded-full mr-2"}),"Paint Protection"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg. Profit"}),e.jsxs("div",{className:"font-medium text-sm",children:["$",Math.round(f.mtdRevenue*f.productMix.paintProtection/100).toLocaleString()]})]})]}),e.jsx("div",{className:"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-blue-600",style:{width:`${f.productMix.paintProtection}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-500",children:[f.productMix.paintProtection,"%"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium flex items-center text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-amber-600 rounded-full mr-2"}),"Tire and Wheel Bundle"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg. Profit"}),e.jsxs("div",{className:"font-medium text-sm",children:["$",Math.round(f.mtdRevenue*f.productMix.tireWheel/100).toLocaleString()]})]})]}),e.jsx("div",{className:"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-amber-600",style:{width:`${f.productMix.tireWheel}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-500",children:[f.productMix.tireWheel,"%"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium flex items-center text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-600 rounded-full mr-2"}),"Other"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Avg. Profit"}),e.jsxs("div",{className:"font-medium text-sm",children:["$",Math.round(f.mtdRevenue*f.productMix.other/100).toLocaleString()]})]})]}),e.jsx("div",{className:"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-gray-600",style:{width:`${f.productMix.other}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-500",children:[f.productMix.other,"%"]})]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-sm",children:"Products Per Deal (PPD)"}),e.jsx("div",{className:"font-bold text-lg text-purple-600",children:f.productsPerDeal.toFixed(1)})]})})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(O1,{})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"})]})},nS=()=>{var g,w,S;const{user:t,role:s,dealershipId:r}=et(),n=St(),a=yt(),[o,i]=l.useState(!1),[c,d]=l.useState("this-month"),[m,h]=l.useState([]),[u,f]=l.useState(!1),[b,p]=l.useState(null),x=((g=t==null?void 0:t.user_metadata)==null?void 0:g.schema_name)||"";l.useEffect(()=>{if(x)v();else try{const P=localStorage.getItem("financeDeals");if(P){const E=JSON.parse(P);h(E)}}catch(P){console.error("Error loading deals from localStorage:",P)}},[x,c]);const v=async()=>{if(x){f(!0),p(null);try{console.log(`[SingleFinanceManagerDashboard] Fetching deals from schema: ${x}`);const P={},E=new Date,D=E.getMonth(),G=E.getFullYear();if(c==="this-month"){const L=new Date(G,D,1),T=new Date(G,D+1,0);P.sale_date={start:L.toISOString().split("T")[0],end:T.toISOString().split("T")[0]}}else if(c==="last-month"){const L=new Date(G,D-1,1),T=new Date(G,D,0);P.sale_date={start:L.toISOString().split("T")[0],end:T.toISOString().split("T")[0]}}else if(c==="last-quarter"){const L=Math.floor(D/3)*3-3,T=new Date(G,L,1),A=new Date(G,L+3,0);P.sale_date={start:T.toISOString().split("T")[0],end:A.toISOString().split("T")[0]}}else if(c==="ytd"){const L=new Date(G,0,1);P.sale_date={start:L.toISOString().split("T")[0],end:E.toISOString().split("T")[0]}}else if(c==="last-year"){const L=new Date(G-1,0,1),T=new Date(G-1,11,31);P.sale_date={start:L.toISOString().split("T")[0],end:T.toISOString().split("T")[0]}}const se=await zx(x,{limit:50,sortBy:"created_at",sortDirection:"desc",filter:P});if(se.success){console.log(`[SingleFinanceManagerDashboard] Fetched ${se.deals.length} deals`);const L=se.deals.map(T=>({id:T.deal_number||String(T.id),customer:T.customer_name,vehicle:T.vehicle,vin:T.vin||"",saleDate:T.sale_date,salesperson:"Self",amount:T.amount,status:T.status,products:Array.isArray(T.products)?T.products:typeof T.products=="string"?JSON.parse(T.products):[],profit:T.profit,created_at:T.created_at}));h(L)}else console.error("[SingleFinanceManagerDashboard] Error fetching deals:",se.error),p("Failed to load deals. Please try again later.")}catch(P){console.error("[SingleFinanceManagerDashboard] Exception fetching deals:",P),p("An unexpected error occurred while loading deals.")}finally{f(!1)}}};l.useEffect(()=>{n.pathname.includes("/log-deal")||n.pathname.includes("/deal-log")||n.pathname.includes("/single-finance-deal-log")?i(!0):i(!1)},[n.pathname]),l.useEffect(()=>(console.log("[SingleFinanceManagerDashboard] Rendering single finance manager dashboard",{userId:t==null?void 0:t.id,role:s,dealershipId:r,timestamp:new Date().toISOString(),path:n.pathname}),()=>{console.log("[SingleFinanceManagerDashboard] Unmounting single finance manager dashboard")}),[t,s,r,n.pathname]);const y=P=>{P.preventDefault(),a("/finance-manager/log-deal")},j=P=>{const E=new Date,D=E.toLocaleString("default",{month:"long"}),G=E.getFullYear();switch(P){case"this-month":return`${D} ${G}`;case"last-month":const se=E.getMonth()===0?"December":new Date(E.getFullYear(),E.getMonth()-1,1).toLocaleString("default",{month:"long"}),L=E.getMonth()===0?E.getFullYear()-1:E.getFullYear();return`${se} ${L}`;case"last-quarter":const T=Math.floor(E.getMonth()/3);return`Q${T===0?4:T} ${T===0?G-1:G}`;case"ytd":return`Year to Date ${G}`;case"last-year":return`${G-1}`;default:return`${D} ${G}`}};if(o)return e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Finance Manager Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Finance Manager: ",((w=t==null?void 0:t.email)==null?void 0:w.split("@")[0])||"Not Assigned"]})]}),e.jsx(I,{size:"lg",className:"bg-green-600 hover:bg-green-700",onClick:()=>a("/dashboard/single-finance"),children:"Back to Dashboard"})]}),e.jsx(nn,{dashboardType:"single-finance"})]});const N=["Present every product to every customer every time - consistency is key.","Build value first, then discuss investment. Never start with the price.","Use customer-friendly language instead of industry jargon when explaining products.","Focus on protection and peace of mind, not just financial benefits.","Keep your menu presentation simple and visual for maximum effectiveness.","Digital menus increase compliance and provide a more professional presentation.","Always congratulate the customer on their vehicle purchase before starting your presentation.","Listen to customer concerns about products and address them specifically.","Explain how each product benefits the customer's specific vehicle and usage patterns."];return e.jsxs("div",{className:"container py-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-6",children:e.jsx("div",{className:"flex-grow",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Finance Manager Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Finance Manager: ",((S=t==null?void 0:t.email)==null?void 0:S.split("@")[0])||"Not Assigned"]})]}),e.jsx("div",{className:"bg-blue-50 p-2 rounded-md mt-2 md:mt-0 border border-blue-100 max-w-2xl",children:e.jsxs("p",{className:"text-xs italic text-blue-800",children:[e.jsx(No,{className:"h-3 w-3 inline-block mr-1"}),e.jsx("strong",{children:"F&I Best Practice:"})," ",N[new Date().getDay()%N.length]]})})]})})}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h2",{className:"text-2xl font-bold mr-3",children:j(c)}),e.jsxs("select",{value:c,onChange:P=>d(P.target.value),className:"p-2 border rounded-md shadow-sm",children:[e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"last-quarter",children:"Last Quarter"}),e.jsx("option",{value:"ytd",children:"Year to Date"}),e.jsx("option",{value:"last-year",children:"Last Year"})]})]}),e.jsx(I,{size:"lg",className:"bg-green-600 hover:bg-green-700",onClick:y,children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(Zn,{className:"mr-2 h-5 w-5"}),"Log New Deal"]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(Xn,{children:[e.jsx(Ce,{path:"/",element:e.jsx(rS,{})}),e.jsx(Ce,{path:"/deals",element:e.jsx(Sf,{})}),e.jsx(Ce,{path:"*",element:e.jsx(bt,{to:"/dashboard/single-finance",replace:!0})})]})}),e.jsxs(B,{className:"border hover:shadow-md transition-shadow mt-6",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2 border-b",children:[e.jsxs(z,{className:"text-lg font-medium flex items-center",children:[e.jsx(Sr,{className:"mr-2 h-5 w-5 text-blue-500"}),"Deals Log"]}),e.jsx(I,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(us,{to:"/dashboard/single-finance/deals",children:"View All"})})]}),e.jsx(V,{className:"pt-4 px-0",children:m.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs",children:[e.jsx("th",{className:"font-medium text-white py-2 pl-3 text-center bg-gray-600 w-12",children:"#"}),e.jsx("th",{className:"font-medium text-white py-2 pl-4 pr-2 text-left bg-blue-600",children:"Deal #"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-left bg-gray-600",children:"Stock #"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-left bg-gray-600",children:"Last Name"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-gray-600",children:"Date"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-indigo-600",children:"N/U/CPO"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-teal-600",children:"VSC"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-purple-600",children:"PPM"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-green-600",children:"GAP"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-amber-600",children:"T&W/Bundle"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-pink-600",children:"PPD"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-purple-600",children:"PVR"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-right bg-green-600",children:"Total"}),e.jsx("th",{className:"font-medium text-white py-2 px-2 text-center bg-gray-600 rounded-tr-md w-20",children:"Status"})]})}),e.jsx("tbody",{children:m.slice(0,5).map((P,E)=>{const D=P.customer.split(" ").pop()||"",se=new Date(P.saleDate).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}),L=P.vehicle.toLowerCase().includes("new")?"N":P.vehicle.toLowerCase().includes("cpo")?"C":"U",T=P.products.includes("Extended Warranty")||P.products.includes("Vehicle Service Contract (VSC)")?Math.round(P.profit*.35):0,A=P.products.includes("Paint Protection")||P.products.includes("Paint and Fabric Protection")||P.products.includes("PPM")||P.products.includes("PrePaid Maintenance (PPM)")?Math.round(P.profit*.2):0,Y=P.products.includes("GAP Insurance")?Math.round(P.profit*.25):0,te=P.products.includes("Tire & Wheel")||P.products.includes("Tire & Wheel Bundle")?Math.round(P.profit*.2):0,xe=P.products.length,le=Math.round(P.profit/(xe||1)),Q=P.status==="Complete"||P.status==="Funded"?"Funded":P.status==="Canceled"||P.status==="Unwound"?"Unwound":"Pending",pe=Q==="Funded"?"bg-green-100 text-green-800 border-green-200":Q==="Unwound"?"bg-red-100 text-red-800 border-red-200":"bg-amber-100 text-amber-800 border-amber-200";return e.jsxs("tr",{className:`border-b ${E%2===1?"bg-gray-50":""} hover:bg-blue-50`,children:[e.jsx("td",{className:"py-2 px-2 text-center font-medium",children:m.length-E}),e.jsx("td",{className:"py-2 pl-4 pr-2 text-left font-medium text-blue-600",children:P.id}),e.jsx("td",{className:"py-2 px-2 text-left",children:P.id.replace("D","S")}),e.jsx("td",{className:"py-2 px-2 text-left font-medium",children:D}),e.jsx("td",{className:"py-2 px-2 text-center text-gray-600",children:se}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${L==="N"?"bg-green-100 text-green-800":L==="C"?"bg-blue-100 text-blue-800":"bg-amber-100 text-amber-800"}`,children:L})}),e.jsxs("td",{className:"py-2 px-2 text-right bg-teal-50",children:["$",T.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",A.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-green-50",children:["$",Y.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-amber-50",children:["$",te.toLocaleString()]}),e.jsx("td",{className:"py-2 px-2 text-center bg-pink-50 font-medium",children:xe}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",le.toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right font-medium text-green-600",children:["$",P.profit.toLocaleString()]}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${pe}`,children:Q})})]},P.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-100 border-t border-t-gray-200 font-medium",children:[e.jsx("td",{colSpan:6,className:"py-2 pl-4 text-left",children:"TOTALS"}),e.jsxs("td",{className:"py-2 px-2 text-right bg-teal-50",children:["$",m.slice(0,5).reduce((P,E)=>P+(E.products.includes("Extended Warranty")||E.products.includes("Vehicle Service Contract (VSC)")?Math.round(E.profit*.35):0),0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",m.slice(0,5).reduce((P,E)=>P+(E.products.includes("Paint Protection")||E.products.includes("Paint and Fabric Protection")||E.products.includes("PPM")||E.products.includes("PrePaid Maintenance (PPM)")?Math.round(E.profit*.2):0),0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-green-50",children:["$",m.slice(0,5).reduce((P,E)=>P+(E.products.includes("GAP Insurance")?Math.round(E.profit*.25):0),0).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right bg-amber-50",children:["$",m.slice(0,5).reduce((P,E)=>P+(E.products.includes("Tire & Wheel")||E.products.includes("Tire & Wheel Bundle")?Math.round(E.profit*.2):0),0).toLocaleString()]}),e.jsx("td",{className:"py-2 px-2 text-center bg-pink-50",children:(m.slice(0,5).reduce((P,E)=>P+E.products.length,0)/Math.max(1,m.slice(0,5).length)).toFixed(1)}),e.jsxs("td",{className:"py-2 px-2 text-right bg-purple-50",children:["$",Math.round(m.slice(0,5).reduce((P,E)=>P+E.profit,0)/Math.max(1,m.slice(0,5).length)).toLocaleString()]}),e.jsxs("td",{className:"py-2 px-2 text-right font-medium text-green-600",children:["$",m.slice(0,5).reduce((P,E)=>P+E.profit,0).toLocaleString()]}),e.jsx("td",{className:"py-2 px-2"})]})})]})}):e.jsx("div",{className:"py-8 text-center text-gray-500",children:'No deals logged yet. Use the "Log New Deal" button to add deals.'})})]})]})},aS=20,oS=1e3,or={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let _i=0;function iS(){return _i=(_i+1)%Number.MAX_VALUE,_i.toString()}const Di=new Map,lS=(t,s)=>{switch(s.type){case or.ADD_TOAST:return{...t,toasts:[s.toast,...t.toasts].slice(0,aS)};case or.UPDATE_TOAST:return{...t,toasts:t.toasts.map(r=>r.id===s.toast.id?{...r,...s.toast}:r)};case or.DISMISS_TOAST:{const{toastId:r}=s;if(r){const n=Di.get(r);n&&clearTimeout(n),Di.set(r,setTimeout(()=>{Di.delete(r),Qa({type:or.REMOVE_TOAST,toastId:r})},oS))}return{...t,toasts:t.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case or.REMOVE_TOAST:return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==s.toastId)}}},cS=[];let Ai={toasts:[]};function Qa(t){Ai=lS(Ai,t),cS.forEach(s=>{s(Ai)})}function Zr({...t}){const s=iS(),r=a=>Qa({type:or.UPDATE_TOAST,toast:{...a,id:s}}),n=()=>Qa({type:or.DISMISS_TOAST,toastId:s});return Qa({type:or.ADD_TOAST,toast:{...t,id:s,open:!0,onOpenChange:a=>{a||n()}}}),{id:s,dismiss:n,update:r}}const zn=[{id:"vsc",name:"Vehicle Service Contract (VSC)",profit:500},{id:"gap",name:"GAP Insurance",profit:300},{id:"ppm",name:"PrePaid Maintenance (PPM)",profit:200},{id:"tirewheel",name:"Tire & Wheel Protection",profit:150},{id:"appearance",name:"Appearance Protection",profit:100},{id:"keyreplacement",name:"Key Replacement",profit:50},{id:"theft",name:"Theft Protection",profit:150},{id:"windshield",name:"Windshield Protection",profit:75},{id:"lojack",name:"LoJack/Tracking System",profit:200},{id:"extwarranty",name:"Extended Warranty",profit:450}],dS=[{id:"pending",name:"Pending"},{id:"funded",name:"Funded"},{id:"unwound",name:"Unwound"},{id:"deaddeal",name:"Dead Deal"}];function uS(){var b;const t=yt(),{user:s}=et(),[r,n]=l.useState(!1),[a,o]=l.useState(0),[i,c]=l.useState({customerName:"",vehicle:"",vin:"",stockNumber:"",saleDate:new Date().toISOString().split("T")[0],amount:"",products:[],status:"pending",notes:""}),d=((b=s==null?void 0:s.user_metadata)==null?void 0:b.schema_name)||"";l.useEffect(()=>{console.log("[LogFinanceManagerDeal] Component mounted"),d?console.log(`[LogFinanceManagerDeal] Using schema: ${d}`):(console.error("[LogFinanceManagerDeal] No schema name found in user metadata"),Zr({title:"Error",description:"Missing configuration for deal logging. Please contact support.",variant:"destructive"})),(()=>{let x=0;i.products.forEach(v=>{const y=zn.find(j=>j.id===v);y&&(x+=y.profit)}),o(x)})()},[d,i.products]);const m=p=>{const{name:x,value:v}=p.target;c(y=>({...y,[x]:v}))},h=p=>{c(x=>{const v=x.products.includes(p)?x.products.filter(y=>y!==p):[...x.products,p];return{...x,products:v}})},u=p=>{c(x=>({...x,status:p}))},f=async p=>{if(p.preventDefault(),!d){Zr({title:"Error",description:"Missing schema information. Please contact support.",variant:"destructive"});return}if(!i.customerName||!i.vehicle){Zr({title:"Validation Error",description:"Customer name and vehicle are required fields.",variant:"destructive"});return}n(!0);try{console.log(`[LogFinanceManagerDeal] Submitting deal to schema: ${d}`);const x=i.products.map(j=>{var N;return((N=zn.find(g=>g.id===j))==null?void 0:N.name)||j}),v={customer_name:i.customerName,vehicle:i.vehicle,vin:i.vin,stock_number:i.stockNumber,sale_date:i.saleDate,amount:parseFloat(i.amount)||0,products:x,profit:a,status:i.status,deal_details:{notes:i.notes,products:i.products.map(j=>{var N,g;return{id:j,name:((N=zn.find(w=>w.id===j))==null?void 0:N.name)||j,profit:((g=zn.find(w=>w.id===j))==null?void 0:g.profit)||0}}),created_by:(s==null?void 0:s.email)||"unknown"}},y=await Hx(d,v);y.success?(Zr({title:"Success",description:"Deal logged successfully!"}),t("/dashboard/single-finance")):(console.error("[LogFinanceManagerDeal] Error logging deal:",y.error),Zr({title:"Error",description:y.message||"Failed to log deal. Please try again.",variant:"destructive"}))}catch(x){console.error("[LogFinanceManagerDeal] Exception logging deal:",x),Zr({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{n(!1)}};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Log New Deal"}),e.jsxs(I,{variant:"outline",onClick:()=>t("/dashboard/single-finance"),className:"flex items-center",children:[e.jsx(yo,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})]}),e.jsx(B,{className:"bg-card-dark p-6 rounded-lg glow-card max-w-md mx-auto",children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center border-b pb-2 mb-4",children:[e.jsx(Ur,{className:"mr-2 h-5 w-5 text-blue-400"}),"Customer Information"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"customerName",children:"Customer Name *"}),e.jsx(be,{id:"customerName",name:"customerName",value:i.customerName,onChange:m,placeholder:"Enter customer name",className:"text-gray-300",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center border-b pb-2 mb-4",children:[e.jsx(Ss,{className:"mr-2 h-5 w-5 text-green-400"}),"Vehicle Information"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"vehicle",children:"Vehicle Description *"}),e.jsx(be,{id:"vehicle",name:"vehicle",value:i.vehicle,onChange:m,placeholder:"e.g., 2023 Toyota Camry XLE",className:"text-gray-300",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"vin",children:"VIN (Last 8)"}),e.jsx(be,{id:"vin",name:"vin",value:i.vin,onChange:p=>{const x=p.target.value.toUpperCase();c(v=>({...v,vin:x}))},placeholder:"Last 8 of VIN",className:"text-gray-300",maxLength:8})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"stockNumber",children:"Stock #"}),e.jsx(be,{id:"stockNumber",name:"stockNumber",value:i.stockNumber,onChange:p=>{const x=p.target.value.toUpperCase();c(v=>({...v,stockNumber:x}))},placeholder:"Stock Number",className:"text-gray-300"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"saleDate",children:"Sale Date"}),e.jsx(be,{type:"date",id:"saleDate",name:"saleDate",value:i.saleDate,onChange:m,className:"text-gray-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"amount",children:"Deal Amount"}),e.jsx(be,{id:"amount",name:"amount",value:i.amount,onChange:p=>{const x=p.target.value.replace(/[^0-9.]/g,"");c(v=>({...v,amount:x}))},placeholder:"0.00",className:"text-gray-300"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center border-b pb-2 mb-4",children:[e.jsx(Sr,{className:"mr-2 h-5 w-5 text-purple-400"}),"Products Sold"]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:zn.map(p=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-800 rounded",children:[e.jsx(aa,{id:`product-${p.id}`,checked:i.products.includes(p.id),onCheckedChange:()=>h(p.id)}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx(fe,{htmlFor:`product-${p.id}`,className:"text-sm cursor-pointer",children:p.name}),e.jsxs("span",{className:"text-green-400 text-sm",children:["$",p.profit]})]})]},p.id))}),e.jsxs("div",{className:"flex justify-between items-center pt-2 font-bold border-t",children:[e.jsx("span",{children:"Total Profit:"}),e.jsxs("span",{className:"text-green-400",children:["$",a.toLocaleString()]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center border-b pb-2 mb-4",children:[e.jsx(t0,{className:"mr-2 h-5 w-5 text-amber-400"}),"Deal Status"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:dS.map(p=>e.jsxs("div",{className:`p-2 border rounded cursor-pointer flex items-center justify-center ${i.status===p.id?"bg-blue-900 border-blue-500":"border-gray-700 hover:bg-gray-800"}`,onClick:()=>u(p.id),children:[i.status===p.id&&e.jsx(Cn,{className:"mr-1 h-4 w-4"}),p.name]},p.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(fe,{htmlFor:"notes",children:"Notes"}),e.jsx(jl,{id:"notes",name:"notes",value:i.notes,onChange:m,placeholder:"Any additional notes about this deal...",className:"text-gray-300 min-h-[100px]"})]}),e.jsx(I,{type:"submit",disabled:r,className:"w-full py-6 bg-gradient-to-r from-light-orange to-dark-orange text-white hover:scale-105 transition-all duration-300",children:r?"Saving...":"Save Deal"})]})})]})}const Ax="1.0.0",rl="production",mS="http://localhost:5173",vd="http://localhost:3000",ts=(t,s={})=>{const r=new Date().toISOString();console.log(`[App][${r}] ${t}`,{...s,app_version:Ax,environment:rl,timestamp:r})},Ex=l.createContext(void 0),hS=({children:t})=>{const[s,r]=l.useState(null),[n,a]=l.useState(null),{setDealershipContext:o}=et();l.useEffect(()=>{s&&(ts("Setting dealership context",{dealership_id:s,dealership_name:n}),o(s))},[s,n,o]);const i={currentDealershipId:s,setCurrentDealershipId:r,currentDealershipName:n,setCurrentDealershipName:a};return e.jsx(Ex.Provider,{value:i,children:t})},fS=()=>{const t=l.useContext(Ex);if(t===void 0)throw new Error("useDealership must be used within a DealershipProvider");return t};function xS(){const t=St(),s=Dp(),{user:r,role:n}=et();return l.useEffect(()=>{ts("Navigation event",{path:t.pathname,search:t.search,type:s,state:t.state?"present":"none",hash:t.hash||"none",user_id:r==null?void 0:r.id,user_email:r==null?void 0:r.email,user_role:n});const a=performance.now(),o=performance.timeOrigin+performance.now();return()=>{const i=performance.now(),c=i-a;ts("Route render completed",{path:t.pathname,render_time_ms:c.toFixed(2),total_time_ms:(i-o).toFixed(2)}),c>1e3&&console.warn(`[Performance Warning] Slow render (${c.toFixed(2)}ms) for ${t.pathname}`)}},[t,s,r,n]),null}function bd({to:t,replace:s=!1,state:r=void 0}){const{user:n,role:a}=et();return l.useEffect(()=>{ts("Redirect triggered",{from:window.location.pathname,to:t,replace:s,has_state:r!==void 0,user_id:n==null?void 0:n.id,user_email:n==null?void 0:n.email,user_role:a})},[t,s,r,n,a]),e.jsx(bt,{to:t,replace:s,state:r})}function pS(){const{role:t,loading:s,userRole:r,user:n,hasSession:a,dealershipId:o,currentDealershipName:i,logAccessAttempt:c,isGroupAdmin:d,authCheckComplete:m}=et(),h=St();if($r()){const p=gr();if(p)return console.log("[ROLE REDIRECT] Direct auth user detected, redirecting to appropriate route",{email:p.email,role:p.role,redirectPath:Xt(p)}),e.jsx(bt,{to:Xt(p),replace:!0})}if(l.useEffect(()=>{console.warn("[DEBUG REDIRECT] Role-based redirect check",{role:t,user_role:r,user_email:n==null?void 0:n.email,dealership_id:o,dealership_name:i,is_group_admin:d,loading:s,auth_check_complete:m,has_session:a,path:h.pathname})},[t,s,h,r,n,a,o,i,d,m]),s||!m)return ts("Role redirect - Still loading or auth check incomplete",{path:h.pathname,loading:s,authCheckComplete:m}),e.jsx("div",{children:"Loading..."});if(!n||!a)return ts("Role redirect - Not authenticated",{path:h.pathname,redirect_to:"/"}),c(h.pathname,!1,{reason:"No authenticated session",redirect_to:"/"}),e.jsx(bt,{to:"/",replace:!0});ts("Role redirect - User authenticated",{user_email:n.email,role:t,user_role:r,is_admin:t==="admin"||r==="admin",is_group_admin:d,user_metadata:n.user_metadata?"present":"missing",dealership_id:o,dealership_name:i});const u=(t||r||"").toLowerCase();console.warn("[DEBUG REDIRECT] User role determined:",{roleValue:u,isGroupAdmin:d,email:n.email,dealershipId:o});let f="/dashboard/sales",b="Default to sales dashboard";return(n==null?void 0:n.email)==="testadmin@example.com"?(f="/master-admin",b="Test admin account"):d?(f="/group-admin",b="Group admin flag is set to true",console.warn("[DEBUG REDIRECT] User is redirected to Group Admin Dashboard because is_group_admin=true",{user_id:n.id,email:n.email,is_group_admin:d,role:u})):u==="dealer_group_admin"||u.includes("group_admin")||u.includes("group")||u.includes("dealergroup_admin")?(f="/group-admin",b="Dealer group admin role",console.warn("[DEBUG REDIRECT] User is redirected to Group Admin Dashboard because of role name",{user_id:n.id,email:n.email,role:u})):u==="dealership_admin"||u.includes("dealership_admin")||u==="admin"?(f="/dashboard/admin",b="Dealership admin role",console.log("[AUTH DEBUG] User is redirected to Dealership Admin Dashboard",{user_id:n.id,email:n.email,dealership_id:o,role:u})):u==="finance_manager"||u.includes("finance")?(f="/dashboard/finance",b="Finance manager role"):u==="sales_manager"||u.includes("sales_manager")?(f="/dashboard/sales-manager",b="Sales manager role"):u==="general_manager"||u.includes("general")?(f="/dashboard/gm",b="General manager role"):(f="/dashboard/sales",b="Sales role (default)"),console.warn("[DEBUG REDIRECT] Final redirection decision:",{redirectPath:f,redirectReason:b,roleValue:u,isGroupAdmin:d,email:n.email}),c(f,!0,{source_path:h.pathname,reason:b,role:u}),e.jsx(bt,{to:f,replace:!0})}function yd({children:t}){var c,d;const{user:s,isGroupAdmin:r,loading:n,userRole:a,authCheckComplete:o}=et(),i=St();if($r()){const m=gr();if(m&&m.isGroupAdmin)return console.log("[GROUP ADMIN ACCESS] Direct auth user granted access to group admin",{email:m.email,role:m.role}),e.jsx(e.Fragment,{children:t})}if(n||!o)return console.log("[GROUP ADMIN ACCESS] Still loading auth state"),e.jsx("div",{children:"Loading..."});if(i.pathname==="/group-admin"){const m=(a==null?void 0:a.toLowerCase().includes("group"))||(a==null?void 0:a.toLowerCase().includes("dealer_group_admin")),h=((c=s==null?void 0:s.email)==null?void 0:c.toLowerCase().includes("group"))&&((d=s==null?void 0:s.email)==null?void 0:d.toLowerCase().includes("@exampletest.com"));return r||m||h?(console.warn("[GROUP ADMIN ACCESS] Access granted - User is identified as a group admin",{by_flag:r,by_role:m,by_email:h,email:s==null?void 0:s.email,role:a}),e.jsx(e.Fragment,{children:t})):(console.warn("[GROUP ADMIN ACCESS] Access denied - User is not a group admin"),e.jsx(bt,{to:"/dashboard",replace:!0}))}return e.jsx(ft,{requiredRoles:["admin","dealer_group_admin","dealership_admin"],children:t})}function gS(){return l.useEffect(()=>{console.log("[ResetAuth] Clearing all auth state..."),J.auth.signOut().then(()=>{console.log("[ResetAuth] Signed out from Supabase")}).catch(t=>{console.error("[ResetAuth] Error signing out from Supabase:",t)});try{console.log("[ResetAuth] Clearing localStorage and sessionStorage"),localStorage.clear(),sessionStorage.clear(),document.cookie.split(";").forEach(t=>{const[s]=t.trim().split("=");document.cookie=`${s}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}),console.log("[ResetAuth] All storage cleared")}catch(t){console.error("[ResetAuth] Error clearing storage:",t)}return setTimeout(()=>{console.log("[ResetAuth] Redirecting to login page"),window.location.href="/"},1e3),()=>{console.log("[ResetAuth] Reset component unmounted")}},[]),e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("h1",{children:"Resetting Auth State..."}),e.jsx("p",{children:"Clearing all authentication state and redirecting to login page."})]})}function vS(){return l.useEffect(()=>{const t=async()=>{var r,n;try{const{data:a}=await J.auth.getSession();if((r=a==null?void 0:a.session)!=null&&r.user){console.warn("[App] Found authenticated user on app load:",a.session.user.email);const o=new URLSearchParams(window.location.search);if(o.has("noredirect")||o.has("forcelogin")){console.log("[App] Skipping redirect due to special parameter");return}const i=a.session.user.email||"",c=i.toLowerCase().includes("group")&&i.toLowerCase().includes("@exampletest.com"),d=!!((n=a.session.user.user_metadata)!=null&&n.is_group_admin);c||d?(console.warn("[App] FAILSAFE - Detected group admin user, redirecting"),window.location.pathname!=="/group-admin"&&(console.warn("[App] Forcing redirection to group admin dashboard"),window.location.href="/group-admin")):i.toLowerCase()==="testadmin@example.com"&&(console.warn("[App] FAILSAFE - Detected test admin user"),window.location.pathname!=="/master-admin"&&(console.warn("[App] Forcing redirection to master admin dashboard"),window.location.href="/master-admin"))}}catch(a){console.error("[App] Error in failsafe auth check:",a)}},s=new URLSearchParams(window.location.search);window.location.pathname!=="/logout"&&!s.has("noredirect")&&!s.has("forcelogin")&&t()},[]),l.useEffect(()=>{ts("Application initialized",{version:Ax,environment:rl,app_url:mS,marketing_url:vd,user_agent:navigator.userAgent,language:navigator.language,screen_size:`${window.innerWidth}x${window.innerHeight}`});const{data:{subscription:t}}=J.auth.onAuthStateChange(async(r,n)=>{if(console.warn("[DEBUG AUTH] Auth state changed:",r),r==="SIGNED_IN"&&(n!=null&&n.user)){console.warn(`[DEBUG AUTH] User signed in: ${n.user.email}`);const{data:a,error:o}=await J.from("profiles").select("is_group_admin, role").eq("id",n.user.id).maybeSingle();!o&&a&&(console.warn("[DEBUG AUTH] User profile data:",a),console.warn(`[DEBUG AUTH] is_group_admin: ${a.is_group_admin}, role: ${a.role}`),a.is_group_admin?console.warn("[DEBUG AUTH] User is a group admin, should be redirected to /group-admin"):console.warn("[DEBUG AUTH] User is NOT a group admin"))}}),s=()=>{ts("Network status change",{online:navigator.onLine})};return window.addEventListener("online",s),window.addEventListener("offline",s),()=>{t.unsubscribe(),window.removeEventListener("online",s),window.removeEventListener("offline",s)}},[]),e.jsx(Rw,{client:Iw,children:e.jsxs(Tu,{children:[e.jsx(dv,{children:e.jsx(hS,{children:e.jsx(tg,{children:e.jsx(i1,{children:e.jsxs(a1,{children:[e.jsx(xS,{}),e.jsxs(Xn,{children:[e.jsx(Ce,{path:"/",element:e.jsx(pv,{})}),e.jsx(Ce,{path:"/logout",element:e.jsx(u1,{})}),e.jsx(Ce,{path:"/direct-login",element:e.jsx(o1,{})}),e.jsx(Ce,{path:"/force-login",element:e.jsx(d1,{})}),e.jsx(Ce,{path:"/reset",element:e.jsx(gS,{})}),e.jsx(Ce,{path:"/debug-auth",element:e.jsx(n1,{})}),e.jsx(Ce,{path:"/auth-debug",element:e.jsx(Iu,{})}),e.jsx(Ce,{path:"/dashboard",element:e.jsx(ft,{children:e.jsx(pS,{})})}),e.jsx(Ce,{path:"/marketing",element:e.jsx(bd,{to:vd})}),e.jsx(Ce,{path:"/master-admin",element:e.jsx(ft,{requiredRoles:["admin"],children:e.jsx(vt,{title:"Master Admin Panel",children:e.jsx(cw,{})})})}),e.jsx(Ce,{path:"/group-admin",element:e.jsx(yd,{children:e.jsx(vt,{title:"Group Admin Dashboard",children:e.jsx(Jw,{})})})}),e.jsx(Ce,{path:"/avp-dashboard",element:e.jsx(yd,{children:e.jsx(vt,{title:"Area VP Dashboard",children:e.jsx(r1,{})})})}),e.jsx(Ce,{path:"/dashboard/admin",element:e.jsx(ft,{requiredRoles:["admin","dealership_admin"],children:e.jsx(Kw,{})})}),e.jsx(Ce,{path:"/dashboard/sales",element:e.jsx(ft,{requiredRoles:["salesperson"],children:e.jsx(vt,{children:e.jsx(Nf,{})})})}),e.jsx(Ce,{path:"/dashboard/finance/*",element:e.jsx(ft,{requiredRoles:["finance_manager"],children:e.jsx(vt,{children:e.jsx(Cf,{})})})}),e.jsx(Ce,{path:"/dashboard/single-finance/*",element:e.jsx(ft,{requiredRoles:["finance_manager"],children:e.jsx(vt,{children:e.jsx(nS,{})})})}),e.jsx(Ce,{path:"/finance-manager/log-deal",element:e.jsx(ft,{requiredRoles:["finance_manager"],children:e.jsx(vt,{children:e.jsx(uS,{})})})}),e.jsx(Ce,{path:"/deal-log",element:e.jsx(ft,{requiredRoles:["finance_manager"],children:e.jsx(vt,{children:e.jsx(nn,{})})})}),e.jsx(Ce,{path:"/finance-deal-log",element:e.jsx(ft,{requiredRoles:["finance_manager"],children:e.jsx(vt,{children:e.jsx(nn,{dashboardType:"finance"})})})}),e.jsx(Ce,{path:"/single-finance-deal-log",element:e.jsx(ft,{requiredRoles:["finance_manager"],children:e.jsx(vt,{children:e.jsx(nn,{dashboardType:"single-finance"})})})}),e.jsx(Ce,{path:"/dashboard/sales-manager/*",element:e.jsx(ft,{requiredRoles:["sales_manager"],children:e.jsx(vt,{children:e.jsxs(Xn,{children:[e.jsx(Ce,{path:"/",element:e.jsx(Pf,{})}),e.jsx(Ce,{path:"team",element:e.jsx(x1,{})}),e.jsx(Ce,{path:"goals",element:e.jsx(p1,{})}),e.jsx(Ce,{path:"schedule",element:e.jsx(g1,{})}),e.jsx(Ce,{path:"sales-report",element:e.jsx(L1,{})})]})})})}),e.jsx(Ce,{path:"/dashboard/gm",element:e.jsx(ft,{requiredRoles:["general_manager"],children:e.jsx(vt,{children:e.jsx(_f,{})})})}),e.jsx(Ce,{path:"/dealership/:dealershipId/*",element:e.jsx(bS,{})}),e.jsx(Ce,{path:"/test-login-redirect",element:e.jsx(m1,{})}),e.jsx(Ce,{path:"/group-admin-bypass",element:e.jsx(h1,{})}),e.jsx(Ce,{path:"/dashboard-selector",element:e.jsx(f1,{})}),e.jsx(Ce,{path:"*",element:e.jsx(bd,{to:"/dashboard"})})]}),e.jsx(gv,{})]})})})})}),rl!=="production"]})})}function bS(){const{dealershipId:t}=Mp(),s=t?parseInt(t,10):null;return s?(ts("Rendering dealership layout",{dealership_id:s}),e.jsx(yS,{dealershipId:s})):(ts("Invalid dealership ID in URL",{dealership_id:t}),e.jsx(bt,{to:"/dashboard",replace:!0}))}function yS({dealershipId:t}){const{setCurrentDealershipId:s,setCurrentDealershipName:r}=fS(),[n,a]=l.useState(!0);return l.useEffect(()=>{s(t),J.from("dealerships").select("name").eq("id",t).single().then(({data:o,error:i})=>{i?console.error("Error fetching dealership name:",i):o&&(r(o.name),ts("Set dealership name in context",{dealership_id:t,dealership_name:o.name})),a(!1)})},[t,s,r]),n?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(Je,{className:"h-8 w-8 animate-spin"})}):e.jsxs(Xn,{children:[e.jsx(Ce,{path:"sales",element:e.jsx(ft,{requiredRoles:["salesperson"],requiredDealership:t,children:e.jsx(vt,{children:e.jsx(Nf,{})})})}),e.jsx(Ce,{path:"finance",element:e.jsx(ft,{requiredRoles:["finance_manager"],requiredDealership:t,children:e.jsx(vt,{children:e.jsx(Cf,{})})})}),e.jsx(Ce,{path:"sales-manager",element:e.jsx(ft,{requiredRoles:["sales_manager"],requiredDealership:t,children:e.jsx(vt,{children:e.jsx(Pf,{})})})}),e.jsx(Ce,{path:"gm",element:e.jsx(ft,{requiredRoles:["general_manager"],requiredDealership:t,children:e.jsx(vt,{children:e.jsx(_f,{})})})}),e.jsx(Ce,{path:"admin",element:e.jsx(ft,{requiredRoles:["admin","dealership_admin"],requiredDealership:t,children:e.jsx(Df,{})})}),e.jsx(Ce,{path:"deal-log",element:e.jsx(ft,{requiredRoles:["finance_manager"],requiredDealership:t,children:e.jsx(vt,{children:e.jsx(nn,{})})})}),e.jsx(Ce,{path:"*",element:e.jsx(bt,{to:`/dealership/${t}/sales`,replace:!0})})]})}Xx.createRoot(document.getElementById("root")).render(e.jsx(Gs.StrictMode,{children:e.jsx(vS,{})}));
//# sourceMappingURL=index-Bp2LErjk.js.map
