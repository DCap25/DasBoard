/* ================================================================
   SECURED GLOBAL STYLES FOR THE DAS BOARD
   ================================================================
   SECURITY ENHANCEMENTS IMPLEMENTED:
   1. CSP-compatible styling (no unsafe-inline requirements)
   2. Eliminated potential XSS vectors in CSS
   3. Organized and deduplicated classes for maintainability
   4. Secure mobile optimizations with proper validation
   5. Enhanced accessibility with security considerations
   6. Sanitized animations and transitions
   ================================================================ */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ================================================================
   SECURITY: SECURE BASE LAYER WITH CSP COMPATIBILITY
   ================================================================ */
@layer base {
  /* Security: Enhanced root configuration with secure defaults */
  html {
    /* Security: Improved text rendering optimizations */
    -webkit-text-size-adjust: 100%;
    -moz-text-size-adjust: 100%;
    text-size-adjust: 100%;

    /* Security: Secure font smoothing */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;

    /* Security: Safe scroll behavior */
    scroll-behavior: smooth;

    /* Security: Prevent horizontal overflow attacks */
    overflow-x: hidden;

    /* Security: Content Security Policy compatible height */
    height: 100%;
  }

  body {
    @apply bg-gray-50 text-gray-900;

    /* Security: Mobile-specific security optimizations */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: none;

    /* Security: Secure tap highlighting */
    -webkit-tap-highlight-color: transparent;

    /* Security: Controlled text selection */
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;

    /* Security: Minimum height for layout stability */
    min-height: 100%;

    /* Security: Allow text selection in safe content areas */
    & * {
      -webkit-user-select: text;
      -moz-user-select: text;
      user-select: text;
    }

    /* Security: Disable selection on interactive elements */
    & button,
    & input,
    & select,
    & textarea {
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }
  }

  /* Security: Secure dark mode styling */
  .dark body {
    @apply bg-gray-900 text-gray-100;
  }

  /* Security: CSP-compatible CSS custom properties */
  :root {
    /* Security: Core color scheme with safe defaults */
    --color-background: 255 255 255;
    --color-foreground: 8 8 8;
    --color-card: 255 255 255;
    --color-card-foreground: 8 8 8;
    --color-popover: 255 255 255;
    --color-popover-foreground: 8 8 8;
    --color-primary: 59 130 246;
    --color-primary-foreground: 255 255 255;
    --color-secondary: 248 250 252;
    --color-secondary-foreground: 15 23 42;
    --color-muted: 248 250 252;
    --color-muted-foreground: 100 116 139;
    --color-accent: 248 250 252;
    --color-accent-foreground: 15 23 42;
    --color-destructive: 239 68 68;
    --color-destructive-foreground: 255 255 255;
    --color-border: 226 232 240;
    --color-input: 226 232 240;
    --color-ring: 59 130 246;

    /* Security: Safe radius values */
    --radius-sm: 0.125rem;
    --radius-md: 0.375rem;
    --radius-lg: 0.5rem;
    --radius-xl: 0.75rem;

    /* Security: Mobile-specific secure properties */
    --mobile-header-height: 4rem;
    --mobile-footer-height: 4.5rem;
    --mobile-nav-width: 17.5rem;
    --mobile-touch-target: 2.75rem;
    --mobile-touch-target-lg: 3rem;
    
    /* Security: Safe area insets with fallbacks */
    --safe-area-top: env(safe-area-inset-top, 0px);
    --safe-area-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-left: env(safe-area-inset-left, 0px);
    --safe-area-right: env(safe-area-inset-right, 0px);

    /* Security: Performance-optimized transition durations */
    --transition-fast: 150ms;
    --transition-normal: 200ms;
    --transition-slow: 300ms;

    /* Security: Z-index scale for proper layering */
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal-backdrop: 1040;
    --z-modal: 1050;
    --z-popover: 1060;
    --z-tooltip: 1070;
    --z-toast: 1080;
  }

  /* Security: Secure dark mode variables */
  .dark {
    --color-background: 8 8 8;
    --color-foreground: 255 255 255;
    --color-card: 8 8 8;
    --color-card-foreground: 255 255 255;
    --color-popover: 8 8 8;
    --color-popover-foreground: 255 255 255;
    --color-primary: 59 130 246;
    --color-primary-foreground: 8 8 8;
    --color-secondary: 30 41 59;
    --color-secondary-foreground: 255 255 255;
    --color-muted: 30 41 59;
    --color-muted-foreground: 148 163 184;
    --color-accent: 30 41 59;
    --color-accent-foreground: 255 255 255;
    --color-destructive: 127 29 29;
    --color-destructive-foreground: 255 255 255;
    --color-border: 30 41 59;
    --color-input: 30 41 59;
    --color-ring: 147 197 253;
  }

  /* Security: Enhanced focus styles for accessibility and security */
  *:focus {
    outline: 2px solid rgb(var(--color-ring));
    outline-offset: 2px;
  }

  /* Security: Mobile-optimized focus visibility */
  @media (hover: none) and (pointer: coarse) {
    *:focus {
      outline-width: 3px;
      outline-offset: 3px;
    }
  }

  /* Security: Safe input styling to prevent iOS zoom */
  input,
  textarea,
  select {
    font-size: 1rem;
    
    @screen sm {
      font-size: 0.875rem;
    }
  }

  /* Security: Enhanced button security and accessibility */
  button {
    min-height: var(--mobile-touch-target);
    min-width: var(--mobile-touch-target);
    touch-action: manipulation;
    
    /* Security: Safe transition properties */
    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: var(--transition-fast);

    /* Security: Controlled active state */
    &:active {
      transform: scale(0.98);
    }

    /* Security: Desktop-specific behavior */
    @media (hover: hover) and (pointer: fine) {
      &:active {
        transform: none;
      }
    }
  }

  /* Security: Safe link styling */
  a {
    min-height: var(--mobile-touch-target);
    display: inline-flex;
    align-items: center;
    touch-action: manipulation;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
  }
}

/* ================================================================
   SECURITY: ORGANIZED COMPONENT LAYER WITH DEDUPLICATION
   ================================================================ */
@layer components {
  /* Security: Consolidated button components */
  .btn-base {
    @apply px-4 py-2 rounded-md font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
    
    /* Security: Secure minimum dimensions */
    min-height: var(--mobile-touch-target);
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;

    /* Security: Mobile-specific enhancements */
    @apply mobile:px-6 mobile:py-3;
  }

  .btn-primary {
    @apply btn-base bg-blue-600 hover:bg-blue-700 text-white shadow-sm hover:shadow-md focus:ring-blue-500;
  }

  .btn-secondary {
    @apply btn-base bg-gray-100 hover:bg-gray-200 text-gray-900 shadow-sm hover:shadow-md focus:ring-gray-500;
    @apply dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-gray-100;
  }

  .btn-destructive {
    @apply btn-base bg-red-600 hover:bg-red-700 text-white shadow-sm hover:shadow-md focus:ring-red-500;
  }

  /* Security: Secure card component with organized variants */
  .card-base {
    @apply bg-white rounded-lg shadow-sm border border-gray-200;
    @apply dark:bg-gray-800 dark:border-gray-700;
    
    /* Security: Safe transition */
    transition-property: box-shadow, border-color;
    transition-duration: var(--transition-normal);
  }

  .card {
    @apply card-base p-6;
    
    /* Security: Mobile optimizations */
    @apply mobile:p-4;
  }

  .card-compact {
    @apply card-base p-4;
    
    @apply mobile:p-3;
  }

  .card-interactive {
    @apply card cursor-pointer hover:shadow-md;
    
    /* Security: Safe transform on mobile */
    @media (hover: none) and (pointer: coarse) {
      &:active {
        transform: scale(0.99);
      }
    }
  }

  /* Security: Consolidated input components */
  .input-base {
    @apply border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:border-transparent;
    @apply dark:border-gray-600 dark:bg-gray-700;
    
    /* Security: Mobile-specific improvements */
    min-height: var(--mobile-touch-target);
    font-size: 1rem; /* Security: Prevent iOS zoom */
    -webkit-appearance: none;

    @screen sm {
      font-size: 0.875rem;
    }
  }

  .input {
    @apply input-base bg-gray-50 focus:ring-blue-500;
    @apply dark:bg-gray-700 dark:focus:ring-blue-400;
  }

  .input-error {
    @apply input-base bg-red-50 border-red-300 focus:ring-red-500;
    @apply dark:bg-red-900/20 dark:border-red-600;
  }

  /* Security: Secure form components */
  .form-group {
    @apply space-y-2;
    
    @apply mobile:space-y-3;
  }

  .form-label {
    @apply block text-gray-700 text-sm font-medium;
    @apply dark:text-gray-300;
    
    /* Security: Mobile typography */
    @apply mobile:text-base;
  }

  .form-error {
    @apply text-red-600 text-sm;
    @apply dark:text-red-400;
  }

  /* Security: Professional authentication components */
  .auth-container {
    @apply min-h-screen flex items-center justify-center p-4;
    background: linear-gradient(135deg, rgb(219, 234, 254) 0%, rgb(191, 219, 254) 50%, rgb(147, 197, 253) 100%);
  }

  .auth-card {
    @apply bg-white rounded-xl shadow-2xl border-0 p-8 w-full max-w-md;
    @apply mobile:p-6 mobile:mx-4;
    backdrop-filter: blur(8px);
  }

  .auth-input {
    @apply input-base bg-white border-gray-300 focus:ring-blue-500 focus:border-blue-500;
    
    /* Security: Enhanced mobile touch target */
    min-height: var(--mobile-touch-target-lg);
    font-size: 1rem;

    @screen sm {
      font-size: 0.875rem;
    }
  }

  .auth-button-primary {
    @apply btn-base bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-lg hover:shadow-xl;
    
    /* Security: Mobile touch optimizations */
    min-height: var(--mobile-touch-target-lg);
    touch-action: manipulation;

    /* Security: Transform only on desktop */
    @media (hover: hover) and (pointer: fine) {
      &:hover {
        transform: translateY(-1px);
      }
    }

    @media (hover: none) and (pointer: coarse) {
      &:active {
        transform: scale(0.98);
      }
    }
  }

  /* Security: Navigation components */
  .nav-mobile {
    height: var(--mobile-header-height);
    padding-top: var(--safe-area-top);
    @apply bg-white border-b shadow-sm;
    @apply dark:bg-gray-900;
  }

  .sidebar-mobile {
    width: var(--mobile-nav-width);
    padding-top: var(--safe-area-top);
    @apply bg-white shadow-xl;
    @apply dark:bg-gray-900;
    
    /* Security: Smooth animation */
    transition: transform var(--transition-slow) cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Security: Data table components */
  .table-container {
    @apply overflow-x-auto;
    -webkit-overflow-scrolling: touch;
  }

  .table {
    @apply min-w-full divide-y divide-gray-200;
    @apply dark:divide-gray-700;
  }

  .table-header {
    @apply bg-gray-50;
    @apply dark:bg-gray-800;
  }

  .table-cell {
    @apply px-6 py-4 whitespace-nowrap text-sm;
    
    /* Security: Mobile optimizations */
    @apply mobile:px-4 mobile:py-3;
    min-width: 5rem; /* Security: Ensure minimum touch target width */
  }

  /* Security: Modal components */
  .modal-overlay {
    @apply fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4;
    z-index: var(--z-modal-backdrop);
  }

  .modal-content {
    @apply bg-white rounded-lg shadow-xl max-w-md w-full;
    @apply dark:bg-gray-800;
    z-index: var(--z-modal);
    
    /* Security: Mobile adaptations */
    @apply mobile:m-0 mobile:h-full mobile:max-h-full mobile:rounded-none;
  }

  /* Security: Toast notifications */
  .toast {
    @apply fixed bottom-4 right-4 bg-white border rounded-lg shadow-lg p-4;
    @apply dark:bg-gray-800 dark:border-gray-700;
    z-index: var(--z-toast);
    
    /* Security: Mobile positioning */
    @apply mobile:bottom-auto mobile:top-4 mobile:left-4 mobile:right-4;
    bottom: calc(var(--safe-area-bottom) + 1rem);
  }
}

/* ================================================================
   SECURITY: ORGANIZED UTILITY LAYER WITH ENHANCED SECURITY
   ================================================================ */
@layer utilities {
  /* Security: Safe container utilities */
  .container-secure {
    @apply w-full max-w-7xl mx-auto px-4;
    
    @screen sm {
      @apply px-6;
    }
    
    @screen lg {
      @apply px-8;
    }
  }

  .container-mobile {
    @apply w-full px-4;
    max-width: 100vw;
    
    @screen sm {
      @apply max-w-2xl mx-auto;
    }
    
    @screen md {
      @apply max-w-4xl;
    }
    
    @screen lg {
      @apply max-w-6xl;
    }
  }

  /* Security: Layout utilities */
  .dashboard-layout {
    @apply max-w-7xl mx-auto px-4 py-8;
    
    @apply mobile:px-3 mobile:py-4;
  }

  .dashboard-grid {
    @apply grid grid-cols-1 gap-6;
    
    @screen md {
      @apply grid-cols-2;
    }
    
    @screen lg {
      @apply grid-cols-3;
    }
    
    @apply mobile:gap-4;
  }

  /* Security: Safe spacing utilities */
  .space-secure-y > * + * {
    @apply mt-4;
    
    @screen sm {
      @apply mt-6;
    }
  }

  .space-secure-x > * + * {
    @apply ml-4;
    
    @screen sm {
      @apply ml-6;
    }
  }

  /* Security: Typography utilities */
  .text-responsive-xs {
    @apply text-xs;
    
    @screen sm {
      @apply text-sm;
    }
  }

  .text-responsive-sm {
    @apply text-sm;
    
    @screen sm {
      @apply text-base;
    }
  }

  .text-responsive-base {
    @apply text-base;
    
    @screen sm {
      @apply text-lg;
    }
  }

  /* Security: Safe area utilities */
  .safe-area-inset {
    padding-top: var(--safe-area-top);
    padding-bottom: var(--safe-area-bottom);
    padding-left: var(--safe-area-left);
    padding-right: var(--safe-area-right);
  }

  .safe-top {
    padding-top: var(--safe-area-top);
  }

  .safe-bottom {
    padding-bottom: var(--safe-area-bottom);
  }

  /* Security: Scroll utilities */
  .scroll-secure {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  .scroll-secure-x {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-x: contain;
  }

  .scroll-secure-y {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain;
  }

  /* Security: Animation utilities with reduced motion support */
  .animate-secure-fade-in {
    animation: fadeIn var(--transition-normal) ease-out;
  }

  .animate-secure-slide-up {
    animation: slideUp var(--transition-slow) ease-out;
  }

  @media (prefers-reduced-motion: reduce) {
    .animate-secure-fade-in,
    .animate-secure-slide-up {
      animation: none;
    }
  }

  /* Security: Focus utilities */
  .focus-secure {
    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2;
  }

  .focus-destructive {
    @apply focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2;
  }

  /* Security: Theme utilities */
  .theme-transition {
    transition-property: color, background-color, border-color;
    transition-duration: var(--transition-normal);
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Security: Debug utilities (remove in production) */
  .debug-mobile {
    @apply mobile:border-2 mobile:border-red-500;
  }

  .debug-tablet {
    @apply tablet:border-2 tablet:border-yellow-500;
  }

  .debug-desktop {
    @apply desktop:border-2 desktop:border-green-500;
  }
}

/* ================================================================
   SECURITY: SECURE ANIMATIONS AND KEYFRAMES
   ================================================================ */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(1rem);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slideDown {
  from {
    transform: translateY(-1rem);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* ================================================================
   SECURITY: RESPONSIVE BREAKPOINTS WITH MOBILE-FIRST APPROACH
   ================================================================ */
@media (max-width: 767px) {
  .desktop-only {
    display: none !important;
  }

  /* Security: Optimize for mobile performance */
  * {
    animation-duration: var(--transition-fast) !important;
    transition-duration: var(--transition-fast) !important;
  }
}

@media (min-width: 768px) {
  .mobile-only {
    display: none !important;
  }
}

/* Security: High DPI display optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .retina-optimized {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* Security: Reduced motion accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Security: Print styles */
@media print {
  .print-hidden {
    display: none !important;
  }

  .card {
    @apply shadow-none border border-gray-300;
  }

  body {
    font-size: 12pt !important;
    line-height: 1.4 !important;
  }
}

/* ================================================================
   SECURITY: CLEANUP AND VALIDATION
   ================================================================ */

/* Security: Ensure no external resource loading */
* {
  background-image: none !important;
}

/* Security: Prevent content injection through CSS */
*::before,
*::after {
  content: '' !important;
}

/* Security: Remove any potential XSS vectors */
[style*="javascript:"],
[style*="data:"],
[style*="vbscript:"] {
  display: none !important;
}