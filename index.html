<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    
    <!-- Enhanced viewport meta for optimal mobile experience -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=0.5, user-scalable=yes, viewport-fit=cover" />
    
    <!-- Mobile-specific meta tags for better UX -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="DAS Board" />
    
    <!-- Theme color for mobile browsers -->
    <meta name="theme-color" content="#3b82f6" />
    <meta name="msapplication-navbutton-color" content="#3b82f6" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    
    <!-- Enhanced favicon setup for mobile -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/manifest.json" />
    
    <!-- Preload critical fonts for mobile performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- DNS prefetch for better mobile loading -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link rel="dns-prefetch" href="//fonts.gstatic.com" />
    
    <!-- Mobile SEO and sharing optimizations -->
    <meta name="description" content="The DAS Board - Comprehensive dealership analytics and sales management dashboard optimized for mobile and desktop." />
    <meta name="keywords" content="dealership, analytics, sales, dashboard, mobile, finance, CRM" />
    <meta name="author" content="DAS Board Team" />
    
    <!-- Open Graph meta for mobile sharing -->
    <meta property="og:title" content="DAS Board - Dealership Analytics Dashboard" />
    <meta property="og:description" content="Comprehensive dealership analytics and sales management dashboard optimized for mobile and desktop." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/og-image.png" />
    <meta property="og:url" content="https://dasboard.com" />
    
    <!-- Twitter Card meta for mobile sharing -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="DAS Board - Dealership Analytics Dashboard" />
    <meta name="twitter:description" content="Comprehensive dealership analytics and sales management dashboard optimized for mobile and desktop." />
    <meta name="twitter:image" content="/twitter-image.png" />
    
    <!-- Performance hints for mobile -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="format-detection" content="date=no" />
    <meta name="format-detection" content="address=no" />
    <meta name="format-detection" content="email=no" />
    
    <!-- Security headers for mobile apps -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https:; frame-src 'none';" />
    
    <!-- Disable automatic translation on mobile -->
    <meta name="google" content="notranslate" />
    
    <!-- Mobile browser UI customization -->
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-orientations" content="portrait landscape" />
    
    <!-- Performance optimization meta tags -->
    <meta name="referrer" content="strict-origin-when-cross-origin" />
    
    <title>DAS Board</title>
    
    <!-- Inline critical CSS for mobile performance (optional) -->
    <style>
      /* Critical CSS for mobile loading performance */
      html {
        font-family: system-ui, -apple-system, sans-serif;
        line-height: 1.6;
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
      }
      
      body {
        margin: 0;
        padding: 0;
        background-color: #f9fafb;
        color: #111827;
        overflow-x: hidden;
      }
      
      /* Loading spinner for mobile */
      .loading-spinner {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40px;
        height: 40px;
        border: 3px solid #e5e7eb;
        border-top: 3px solid #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        z-index: 9999;
      }
      
      @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
      }
      
      /* Hide loading spinner when app loads */
      .app-loaded .loading-spinner {
        display: none;
      }
      
      /* Mobile-safe viewport units */
      .full-height {
        height: 100vh;
        height: 100dvh; /* Dynamic viewport height for mobile */
      }
      
      /* Prevent horizontal scroll on mobile */
      .no-scroll-x {
        overflow-x: hidden;
        max-width: 100vw;
      }
      
      /* Touch-friendly tap targets */
      button, a, [role="button"] {
        min-height: 44px;
        min-width: 44px;
        touch-action: manipulation;
      }
      
      /* Enhanced focus visibility for mobile */
      *:focus {
        outline: 2px solid #3b82f6;
        outline-offset: 2px;
      }
      
      @media (hover: none) and (pointer: coarse) {
        *:focus {
          outline-width: 3px;
          outline-offset: 3px;
        }
      }
    </style>
  </head>
  <body class="no-scroll-x">
    <!-- Loading spinner for mobile -->
    <div class="loading-spinner" id="loading-spinner"></div>
    
    <!-- Main app container with mobile optimizations -->
    <div id="root" class="full-height"></div>
    
    <!-- Module script with mobile performance optimizations -->
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Mobile-specific JavaScript optimizations -->
    <script>
      // Remove loading spinner when app loads
      window.addEventListener('load', function() {
        document.body.classList.add('app-loaded');
        const spinner = document.getElementById('loading-spinner');
        if (spinner) {
          spinner.style.display = 'none';
        }
      });
      
      // Prevent zoom on double tap for mobile (iOS Safari)
      let lastTouchEnd = 0;
      document.addEventListener('touchend', function (event) {
        const now = (new Date()).getTime();
        if (now - lastTouchEnd <= 300) {
          event.preventDefault();
        }
        lastTouchEnd = now;
      }, false);
      
      // Mobile viewport height fix for iOS
      function setMobileVH() {
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
      }
      
      // Set initial mobile viewport height
      setMobileVH();
      
      // Update on resize and orientation change
      window.addEventListener('resize', setMobileVH);
      window.addEventListener('orientationchange', function() {
        setTimeout(setMobileVH, 100);
      });
      
      // Performance optimization: Preload critical resources
      if ('connection' in navigator) {
        const connection = navigator.connection;
        // Only preload on fast connections
        if (connection.effectiveType === '4g') {
          // Add preload logic here if needed
        }
      }
      
      // Mobile-specific error handling
      window.addEventListener('error', function(e) {
        console.error('Mobile app error:', e.error);
        // Add mobile-specific error reporting here
      });
      
      // Service Worker registration disabled until sw.js is created
      // if ('serviceWorker' in navigator) {
      //   window.addEventListener('load', function() {
      //     navigator.serviceWorker.register('/sw.js')
      //       .then(function(registration) {
      //         console.log('SW registered: ', registration);
      //       })
      //       .catch(function(registrationError) {
      //         console.log('SW registration failed: ', registrationError);
      //       });
      //   });
      // }
      
      // Mobile app install prompt handling
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        // Show install button or banner
      });
      
      // Handle app install
      window.addEventListener('appinstalled', (evt) => {
        console.log('App was installed.');
      });
      
      // Mobile keyboard handling
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        // Handle virtual keyboard on mobile
        const viewport = document.querySelector('meta[name="viewport"]');
        
        function handleViewportChange() {
          if (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA') {
            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0');
          } else {
            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=0.5, user-scalable=yes, viewport-fit=cover');
          }
        }
        
        document.addEventListener('focusin', handleViewportChange);
        document.addEventListener('focusout', handleViewportChange);
      }
    </script>
  </body>
</html>